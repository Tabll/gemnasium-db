---
identifier: "CVE-2021-21328"
identifiers:
- "CVE-2021-21328"
- "GHSA-gcj9-jj38-hwmc"
package_slug: "swift/github.com/vapor/vapor"
title: "Vapor's Metrics integration could cause a system drain"
description: "This is a DoS attack against anyone who Bootstraps a metrics backend
  for their Vapor app with the following attack vector:\n\n1. send unlimited requests
  against a vapor instance with different paths. this will create “unlimited” counters
  and timers, which will eventually drain the system.\n2. downstream services might
  suffer from this attack as well by being spammed with error paths"
date: "2023-06-09"
pubdate: "2023-06-09"
affected_range: "<4.40.1"
fixed_versions:
- "4.40.1"
affected_versions: "All versions before 4.40.1"
not_impacted: "All versions starting from 4.40.1"
solution: "Upgrade to version 4.40.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-21328"
- "https://github.com/advisories/GHSA-gcj9-jj38-hwmc"
- "https://github.com/vapor/vapor/security/advisories/GHSA-gcj9-jj38-hwmc"
- "https://github.com/vapor/vapor/commit/e3aa712508db2854ac0ab905696c65fd88fa7e23"
- "https://github.com/vapor/vapor"
- "https://github.com/vapor/vapor/releases/tag/4.40.1"
- "https://vapor.codes"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L"
uuid: "ecb1d6b9-23f7-4786-ab4e-a6990817cdb6"
cwe_ids:
- "CWE-400"
- "CWE-937"
- "CWE-1035"
