---
identifier: "CVE-2024-21631"
identifiers:
- "CVE-2024-21631"
- "GHSA-r6r4-5pr8-gjcp"
package_slug: "swift/github.com/vapor/vapor"
title: "Vapor contains an integer overflow in URI leading to potential host spoofing"
description: "Vapor's `vapor_urlparser_parse` function uses `uint16_t` indexes when
  parsing a URI's components, which may cause integer overflows when parsing untrusted
  inputs.\n\nThis vulnerability does not affect Vapor directly but could impact applications
  relying on the URI type for validating user input.\n\nThe URI type is used in several
  places in Vapor. A developer may decide to use URI to represent a URL in their application
  (especially if that URL is then passed to the HTTP Client) and rely on its public
  properties and methods. However, URI may fail to properly parse a valid (albeit
  abnormally long) URL, due to string ranges being converted to 16-bit integers. An
  attacker may use this behaviour to trick the application into accepting a URL to
  an untrusted destination.\n\nBy padding the port number with zeros, an attacker
  can cause an integer overflow to occur when the URL authority is parsed and, as
  a result, spoof the host."
date: "2024-02-09"
pubdate: "2024-01-03"
affected_range: "<4.90.0"
fixed_versions:
- "4.90.0"
affected_versions: "All versions before 4.90.0"
not_impacted: "All versions starting from 4.90.0"
solution: "Upgrade to version 4.90.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-21631"
- "https://github.com/advisories/GHSA-r6r4-5pr8-gjcp"
- "https://github.com/vapor/vapor/security/advisories/GHSA-r6r4-5pr8-gjcp"
- "https://github.com/vapor/vapor/commit/6db3d917b5ce5024a84eb265ef65691383305d70"
- "https://github.com/vapor/vapor"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N"
uuid: "e0435f92-06e8-4ee5-a06d-88e2de927222"
cwe_ids:
- "CWE-1104"
- "CWE-190"
- "CWE-937"
- "CWE-1035"
