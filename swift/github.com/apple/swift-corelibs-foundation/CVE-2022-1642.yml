---
identifier: "CVE-2022-1642"
identifiers:
- "CVE-2022-1642"
- "GHSA-239c-6cv2-wwx8"
package_slug: "swift/github.com/apple/swift-corelibs-foundation"
title: "Swift-corelibs-foundation denial of service in JSON decoding with JSONDecoder"
description: "A program using swift-corelibs-foundation is vulnerable to a denial
  of service attack caused by a potentially malicious source producing a JSON document
  containing a type mismatch.\n\nThis vulnerability is caused by the interaction between
  a deserialization mechanism offered by the Swift standard library, the Codable protocol;
  and the JSONDecoder class offered by swift-corelibs-foundation, which can deserialize
  types that adopt the Codable protocol based on the content of a provided JSON document.
  When a type that adopts Codable requests the initialization of a field with an integer
  value, the JSONDecoder class uses a type-erased container with different accessor
  methods to attempt and coerce a corresponding JSON value and produce an integer.
  In the case the JSON value was a numeric literal with a floating-point portion,
  JSONDecoder used different type-eraser methods during validation than it did during
  the final casting of the value. The checked casting produces a deterministic crash
  due to this mismatch.\n\nThe JSONDecoder class is often wrapped by popular Swift-based
  web frameworks to parse the body of HTTP requests and perform basic type validation.
  This makes the attack low-effort: sending a specifically crafted JSON document during
  a request to these endpoints will cause them to crash.\n\nThe attack does not have
  any confidentiality or integrity risks in and of itself; the crash is produced deterministically
  by an abort function that ensures that execution does not continue in the face of
  this violation of assumptions. However, unexpected crashes can lead to violations
  of invariants in services, so it's possible that this attack can be used to trigger
  error conditions that escalate the risk. Producing a denial of service may also
  be the goal of an attacker in itself."
date: "2023-06-07"
pubdate: "2023-06-07"
affected_range: "<5.6.2"
fixed_versions:
- "5.6.2"
affected_versions: "All versions before 5.6.2"
not_impacted: "All versions starting from 5.6.2"
solution: "Upgrade to version 5.6.2 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-1642"
- "https://github.com/advisories/GHSA-239c-6cv2-wwx8"
- "https://github.com/apple/swift-corelibs-foundation/security/advisories/GHSA-239c-6cv2-wwx8"
- "https://github.com/apple/swift-corelibs-foundation/commit/b541491f73b39007a38f3ff5a0cbe89d09ef1614"
- "https://github.com/apple/swift-corelibs-foundation"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
uuid: "9d5b15c2-11eb-4821-91e2-a4863d1cd342"
cwe_ids:
- "CWE-704"
- "CWE-937"
- "CWE-1035"
