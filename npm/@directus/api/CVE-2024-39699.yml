---
identifier: "CVE-2024-39699"
identifiers:
- "CVE-2024-39699"
- "GHSA-8p72-rcq4-h6pw"
package_slug: "npm/@directus/api"
title: "Directus Blind SSRF On File Import"
description: "There was already a reported SSRF vulnerability via file import. [https://github.com/directus/directus/security/advisories/GHSA-j3rg-3rgm-537h](https://github.com/directus/directus/security/advisories/GHSA-j3rg-3rgm-537h)\nIt
  was fixed by resolving all DNS names and checking if the requested IP is an internal
  IP address.\n\nHowever it is possible to bypass this security measure and execute
  a SSRF using redirects. Directus allows redirects when importing file from the URL
  and does not check the result URL. Thus, it is possible to execute a request to
  an internal IP, for example to 127.0.0.1.\n\nHowever, it is blind SSRF, because
  Directus also uses response interception technique to get the information about
  the connect from the socket directly and it does not show a response if the IP address
  is internal (nice fix, by the way :) ).\n\nBut the blindness does not fully mitigate
  the impact of the vulnerability. The blind SSRF is still exploitable in the real
  life scenarios, because there could be a vulnerable software inside of the network
  which can be exploited with GET request. I will show the example in the PoC. Also,
  you can check [HackTricks](https://book.hacktricks.xyz/pentesting-web/ssrf-server-side-request-forgery/ssrf-vulnerable-platforms)
  page with some known cases."
date: "2024-07-08"
pubdate: "2024-07-08"
affected_range: "<17.1.0"
fixed_versions:
- "17.1.0"
affected_versions: "All versions before 17.1.0"
not_impacted: "All versions starting from 17.1.0"
solution: "Upgrade to version 17.1.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-39699"
- "https://github.com/advisories/GHSA-8p72-rcq4-h6pw"
- "https://github.com/directus/directus/security/advisories/GHSA-8p72-rcq4-h6pw"
- "https://github.com/directus/directus/commit/d577b44231c0923aca99cac5770fd853801caee1"
- "https://github.com/directus/directus"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:N/A:N"
uuid: "25722d4f-f5c1-4615-8f0d-16c2943cb5f9"
cwe_ids:
- "CWE-918"
- "CWE-937"
- "CWE-1035"
