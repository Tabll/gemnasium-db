---
identifier: "CVE-2023-48223"
identifiers:
- "GHSA-c2ff-88x2-x9pg"
- "CVE-2023-48223"
package_slug: "npm/fast-jwt"
title: "JWT Algorithm Confusion"
description: "fast-jwt provides fast JSON Web Token (JWT) implementation. Prior to
  version 3.3.2, the fast-jwt library does not properly prevent JWT algorithm confusion
  for all public key types. The 'publicKeyPemMatcher' in 'fast-jwt/src/crypto.js'
  does not properly match all common PEM formats for public keys. To exploit this
  vulnerability, an attacker needs to craft a malicious JWT token containing the HS256
  algorithm, signed with the public RSA key of the victim application. This attack
  will only work if the victim application utilizes a public key containing the `BEGIN
  RSA PUBLIC KEY` header. Applications using the RS256 algorithm, a public key with
  a `BEGIN RSA PUBLIC KEY` header, and calling the verify function without explicitly
  providing an algorithm, is vulnerable to this algorithm confusion attack which allows
  attackers to sign arbitrary payloads which will be accepted by the verifier. Version
  3.3.2 contains a patch for this issue. As a workaround, change line 29 of `blob/master/src/crypto.js`
  to include a regular expression."
date: "2023-11-29"
pubdate: "2023-11-20"
affected_range: "<3.3.2"
fixed_versions:
- "3.3.2"
affected_versions: "All versions before 3.3.2"
not_impacted: "All versions starting from 3.3.2"
solution: "Upgrade to version 3.3.2 or above."
urls:
- "https://github.com/nearform/fast-jwt/security/advisories/GHSA-c2ff-88x2-x9pg"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-48223"
- "https://github.com/nearform/fast-jwt/commit/15a6e92c9adb39acde41a9b11cec0cbde8ad763b"
- "https://github.com/nearform/fast-jwt/blob/master/src/crypto.js#L29"
- "https://github.com/nearform/fast-jwt/releases/tag/v3.3.2"
- "https://github.com/advisories/GHSA-c2ff-88x2-x9pg"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N"
uuid: "386617a8-993f-4ea4-b077-a17b298df46f"
cwe_ids:
- "CWE-1035"
- "CWE-937"
