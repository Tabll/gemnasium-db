---
identifier: "CVE-2023-49803"
identifiers:
- "GHSA-qxrj-hx23-xp82"
- "CVE-2023-49803"
package_slug: "npm/@koa/cors"
title: "Origin Validation Error"
description: "@koa/cors npm provides Cross-Origin Resource Sharing (CORS) for koa,
  a web framework for Node.js. Prior to version 5.0.0, the middleware operates in
  a way that if an allowed origin is not provided, it will return an `Access-Control-Allow-Origin`
  header with the value of the origin from the request. This behavior completely disables
  one of the most crucial elements of browsers - the Same Origin Policy (SOP), this
  could cause a very serious security threat to the users of this middleware. If such
  behavior is expected, for instance, when middleware is used exclusively for prototypes
  and not for production applications, it should be heavily emphasized in the documentation
  along with an indication of the risks associated with such behavior, as many users
  may not be aware of it. Version 5.0.0 fixes this vulnerability."
date: "2023-12-12"
pubdate: "2023-12-11"
affected_range: "<5.0.0"
fixed_versions:
- "5.0.0"
affected_versions: "All versions before 5.0.0"
not_impacted: "All versions starting from 5.0.0"
solution: "Upgrade to version 5.0.0 or above."
urls:
- "https://github.com/koajs/cors/security/advisories/GHSA-qxrj-hx23-xp82"
- "https://github.com/koajs/cors/commit/f31dac99f5355c41e7d4dd3c4a80c5f154941a11"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-49803"
- "https://github.com/advisories/GHSA-qxrj-hx23-xp82"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N"
uuid: "72526295-dcf9-423e-8e76-715598ddee62"
cwe_ids:
- "CWE-1035"
- "CWE-346"
- "CWE-937"
