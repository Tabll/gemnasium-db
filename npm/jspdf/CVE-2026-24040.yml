---
identifier: "CVE-2026-24040"
identifiers:
- "CVE-2026-24040"
- "GHSA-cjw8-79x6-5cj4"
package_slug: "npm/jspdf"
title: "jsPDF has Shared State Race Condition in addJS Plugin"
description: "The addJS method in the jspdf Node.js build utilizes a shared module-scoped
  variable (text) to store JavaScript content. When used in a concurrent environment
  (e.g., a Node.js web server), this variable is shared across all requests.\n\nIf
  multiple requests generate PDFs simultaneously, the JavaScript content intended
  for one user may be overwritten by a subsequent request before the document is generated.
  This results in Cross-User Data Leakage, where the PDF generated for User A contains
  the JavaScript payload (and any embedded sensitive data) intended for User B.\n\nTypically,
  this only affects server-side environments, although the same race conditions might
  occur if jsPDF runs client-side.\n\n```js\nimport { jsPDF } from \"jspdf\";\n\nconst
  docA = new jsPDF();\nconst docB = new jsPDF();\n\n// 1. User A sets their script
  (stored in shared 'text' variable)\ndocA.addJS('console.log(\"Secret A\");');\n\n//
  2. User B sets their script (overwrites shared 'text' variable)\ndocB.addJS('console.log(\"Secret
  B\");');\n\n// 3. User A saves their PDF (reads current 'text' variable)\ndocA.save(\"userA.pdf\");\n\n//
  Result: userA.pdf contains \"Secret B\" instead of \"Secret A\"\n```"
date: "2026-02-02"
pubdate: "2026-02-02"
affected_range: "<4.1.0"
fixed_versions:
- "4.1.0"
affected_versions: "All versions before 4.1.0"
not_impacted: "All versions starting from 4.1.0"
solution: "Upgrade to version 4.1.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2026-24040"
- "https://github.com/advisories/GHSA-cjw8-79x6-5cj4"
- "https://github.com/parallax/jsPDF/security/advisories/GHSA-cjw8-79x6-5cj4"
- "https://github.com/parallax/jsPDF/commit/2863e5c26afef211a545e8c174ab4d5fce3b8c0e"
- "https://github.com/parallax/jsPDF"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N"
cvss_v4: "CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:L/VI:L/VA:N/SC:N/SI:N/SA:N"
uuid: "1ed74b0e-46a0-45b6-bcb2-991a754c952c"
cwe_ids:
- "CWE-200"
- "CWE-362"
- "CWE-937"
- "CWE-1035"
