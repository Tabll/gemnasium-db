---
identifier: "CVE-2022-23541"
identifiers:
- "CVE-2022-23541"
- "GHSA-hjrf-2m68-5959"
package_slug: "npm/jsonwebtoken"
title: "Improper Restriction of Security Token Assignment"
description: "jsonwebtoken is an implementation of JSON Web Tokens. Versions `<= 8.5.1`
  of `jsonwebtoken` library can be misconfigured so that passing a poorly implemented
  key retrieval function referring to the `secretOrPublicKey` argument from the readme
  link will result in incorrect verification of tokens. There is a possibility of
  using a different algorithm and key combination in verification, other than the
  one that was used to sign the tokens. Specifically, tokens signed with an asymmetric
  public key could be verified with a symmetric HS256 algorithm. This can lead to
  successful validation of forged tokens. If your application is supporting usage
  of both symmetric key and asymmetric key in jwt.verify() implementation with the
  same key retrieval function. This issue has been patched, please update to version
  9.0.0."
date: "2023-11-07"
pubdate: "2022-12-22"
affected_range: "<=8.5.1"
fixed_versions:
- "9.0.0"
affected_versions: "All versions up to 8.5.1"
not_impacted: "All versions after 8.5.1"
solution: "Upgrade to version 9.0.0 or above."
urls:
- "https://github.com/auth0/node-jsonwebtoken/security/advisories/GHSA-hjrf-2m68-5959"
- "https://github.com/auth0/node-jsonwebtoken/commit/e1fa9dcc12054a8681db4e6373da1b30cf7016e3"
- "https://nvd.nist.gov/vuln/detail/CVE-2022-23541"
- "https://github.com/auth0/node-jsonwebtoken/releases/tag/v9.0.0"
- "https://github.com/advisories/GHSA-hjrf-2m68-5959"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L"
uuid: "3530bea2-c21e-4f45-9e2c-d0e9322ba1aa"
cwe_ids:
- "CWE-1035"
- "CWE-937"
