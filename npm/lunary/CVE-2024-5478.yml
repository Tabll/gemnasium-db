---
identifier: "CVE-2024-5478"
identifiers:
- "CVE-2024-5478"
- "GHSA-rpx8-fg6w-rm6x"
package_slug: "npm/lunary"
title: "lunary-ai/lunary XSS in SAML metadata endpoint"
description: "A Cross-site Scripting (XSS) vulnerability exists in the SAML metadata
  endpoint `/auth/saml/${org?.id}/metadata` of lunary-ai/lunary version 1.2.7. The
  vulnerability arises due to the application's failure to escape or validate the
  `orgId` parameter supplied by the user before incorporating it into the generated
  response. Specifically, the endpoint generates XML responses for SAML metadata,
  where the `orgId` parameter is directly embedded into the XML structure without
  proper sanitization or validation. This flaw allows an attacker to inject arbitrary
  JavaScript code into the generated SAML metadata page, leading to potential theft
  of user cookies or authentication tokens."
date: "2024-07-19"
pubdate: "2024-06-06"
affected_range: "<=1.2.7"
fixed_versions: []
affected_versions: "All versions up to 1.2.7"
not_impacted: ""
solution: "Unfortunately, there is no solution available yet."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-5478"
- "https://github.com/advisories/GHSA-rpx8-fg6w-rm6x"
- "https://github.com/lunary-ai/lunary"
- "https://github.com/lunary-ai/lunary/blob/main/packages/backend/src/api/v1/auth/saml.ts#L34"
- "https://huntr.com/bounties/e899f496-d493-4c06-b596-cb0a88ad451b"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N"
uuid: "5f58dd32-083c-4ff8-b882-d8571fdc58a9"
cwe_ids:
- "CWE-79"
- "CWE-937"
- "CWE-1035"
