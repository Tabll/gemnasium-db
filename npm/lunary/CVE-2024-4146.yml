---
identifier: "CVE-2024-4146"
identifiers:
- "CVE-2024-4146"
- "GHSA-w5xm-mx47-v7c8"
package_slug: "npm/lunary"
title: "lunary-ai/lunary allows users unauthorized access to projects"
description: "In lunary-ai/lunary version v1.2.13, an improper authorization vulnerability
  exists that allows unauthorized users to access and manipulate projects within an
  organization they should not have access to. Specifically, the vulnerability is
  located in the `checkProjectAccess` method within the authorization middleware,
  which fails to adequately verify if a user has the correct permissions to access
  a specific project. Instead, it only checks if the user is part of the organization
  owning the project, overlooking the necessary check against the `account_project`
  table for explicit project access rights. This flaw enables attackers to gain complete
  control over all resources within a project, including the ability to create, update,
  read, and delete any resource, compromising the privacy and security of sensitive
  information."
date: "2024-06-10"
pubdate: "2024-06-08"
affected_range: "<1.2.26"
fixed_versions:
- "1.2.26"
affected_versions: "All versions before 1.2.26"
not_impacted: "All versions starting from 1.2.26"
solution: "Upgrade to version 1.2.26 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-4146"
- "https://github.com/advisories/GHSA-w5xm-mx47-v7c8"
- "https://github.com/lunary-ai/lunary/commit/c43b6c62035f32ca455f66d5fd22ba661648cde7"
- "https://github.com/lunary-ai/lunary"
- "https://huntr.com/bounties/a749e696-b398-4260-b2d0-b0054b9fffa7"
cvss_v3: "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "26be9fd0-5f70-4f3c-822e-c0f462f90d61"
cwe_ids:
- "CWE-285"
- "CWE-937"
- "CWE-1035"
