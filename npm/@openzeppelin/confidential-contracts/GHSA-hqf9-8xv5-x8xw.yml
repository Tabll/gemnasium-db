---
identifier: "GHSA-hqf9-8xv5-x8xw"
identifiers:
- "GHSA-hqf9-8xv5-x8xw"
package_slug: "npm/@openzeppelin/confidential-contracts"
title: "ERC7984ERC20Wrapper: once a wrapper is filled, subsequent wrap requests do
  not revert and result in loss of funds."
description: "The `ERC7984` contract tracks total supply using a confidential `euint64`
  value. If a call to the internal `_mint` function would result in the total supply
  overflowing, the call fails silently. The `wrap` and `onTransferReceived` functions
  in `ERC7984ERC20Wrapper` assume that `_mint` won't fail silently and do not check
  the return value. If the mint function fails silently, users do not receive the
  confidential wrapped token but still send the underlying token, resulting in a loss
  of funds.\n\nBy default (without overriding `rate()`, the wrapper fills up after
  wrapping ~18.4 trillion tokens. There are very few tokens of value with sufficient
  total supply to result in the filling of the wrapper. That said, we recommend upgrading
  to `0.3.1` to remove this issue."
date: "2026-01-05"
pubdate: "2026-01-05"
affected_range: "<0.3.1"
fixed_versions:
- "0.3.1"
affected_versions: "All versions before 0.3.1"
not_impacted: "All versions starting from 0.3.1"
solution: "Upgrade to version 0.3.1 or above."
urls:
- "https://github.com/advisories/GHSA-hqf9-8xv5-x8xw"
- "https://github.com/OpenZeppelin/openzeppelin-confidential-contracts/security/advisories/GHSA-hqf9-8xv5-x8xw"
- "https://github.com/OpenZeppelin/openzeppelin-confidential-contracts"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N"
cvss_v4: "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N"
uuid: "2ee9426d-56f8-4315-af0f-307eee9e6d20"
cwe_ids:
- "CWE-190"
- "CWE-937"
- "CWE-1035"
