---
identifier: "CVE-2023-40014"
identifiers:
- "GHSA-g4vp-m682-qqmp"
- "CVE-2023-40014"
package_slug: "npm/@openzeppelin/contracts-upgradeable"
title: "Improper Encoding or Escaping of Output"
description: "OpenZeppelin Contracts is a library for secure smart contract development.
  Starting in version 4.0.0 and prior to version 4.9.3, contracts using `ERC2771Context`
  along with a custom trusted forwarder may see `_msgSender` return `address(0)` in
  calls that originate from the forwarder with calldata shorter than 20 bytes. This
  combination of circumstances does not appear to be common, in particular it is not
  the case for `MinimalForwarder` from OpenZeppelin Contracts, or any deployed forwarder
  the team is aware of, given that the signer address is appended to all calls that
  originate from these forwarders. The problem has been patched in v4.9.3.\n"
date: "2023-08-11"
pubdate: "2023-08-11"
affected_range: ">=4.0.0 <4.9.3"
fixed_versions:
- "4.9.3"
affected_versions: "All versions starting from 4.0.0 before 4.9.3"
not_impacted: "All versions before 4.0.0, all versions starting from 4.9.3"
solution: "Upgrade to version 4.9.3 or above."
urls:
- "https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-g4vp-m682-qqmp"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-40014"
- "https://github.com/OpenZeppelin/openzeppelin-contracts/pull/4481"
- "https://github.com/OpenZeppelin/openzeppelin-contracts/pull/4484"
- "https://github.com/OpenZeppelin/openzeppelin-contracts/commit/9445f96223041abf2bf08daa56f8da50b674cbcd"
- "https://github.com/OpenZeppelin/openzeppelin-contracts/commit/e4435eed757d4309436b1e06608e97b6d6e2fdb5"
- "https://github.com/OpenZeppelin/openzeppelin-contracts/blob/v4.9.3/CHANGELOG.md"
- "https://github.com/OpenZeppelin/openzeppelin-contracts/releases/tag/v4.9.3"
- "https://github.com/advisories/GHSA-g4vp-m682-qqmp"
uuid: "9fe9c326-0411-4359-aa36-d121fb72ae3b"
cwe_ids:
- "CWE-1035"
- "CWE-116"
- "CWE-937"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N"
