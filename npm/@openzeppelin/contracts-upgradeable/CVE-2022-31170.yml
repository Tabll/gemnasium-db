---
identifier: "CVE-2022-31170"
identifiers:
- "GHSA-qh9x-gcfh-pcrw"
- "CVE-2022-31170"
package_slug: "npm/@openzeppelin/contracts-upgradeable"
title: "Improper Input Validation"
description: "OpenZeppelin Contracts is a library for smart contract development.
  Versions 4.0.0 until 4.7.1 is vulnerable to ERC165Checker reverting instead of returning
  `false`. `ERC165Checker.supportsInterface` is designed to always successfully return
  a boolean, and under no circumstance revert. However, an incorrect assumption about
  Solidity 0.8's `abi.decode` allows some cases to revert, given a target contract
  that does not implement EIP-165 as expected, specifically if it returns a value
  other than 0 or 1. The contracts that may be affected are those that use `ERC165Checker`
  to check for support for an interface and then handle the lack of support in a way
  other than reverting. The issue was patched in version 4.7.1."
date: "2022-07-21"
pubdate: "2022-07-21"
affected_range: ">=4.0.0 <4.7.1"
fixed_versions:
- "4.7.1"
affected_versions: "All versions starting from 4.0.0 before 4.7.1"
not_impacted: "All versions before 4.0.0, all versions starting from 4.7.1"
solution: "Upgrade to version 4.7.1 or above."
urls:
- "https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-qh9x-gcfh-pcrw"
- "https://github.com/OpenZeppelin/openzeppelin-contracts/pull/3552"
- "https://github.com/advisories/GHSA-qh9x-gcfh-pcrw"
uuid: "2cc01cf5-ed15-485d-8b82-8134e2153b6b"
cwe_ids:
- "CWE-1035"
- "CWE-20"
- "CWE-937"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N"
