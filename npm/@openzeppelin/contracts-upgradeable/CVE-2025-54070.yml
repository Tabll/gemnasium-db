---
identifier: "CVE-2025-54070"
identifiers:
- "CVE-2025-54070"
- "GHSA-9rcw-c2f9-2j55"
package_slug: "npm/@openzeppelin/contracts-upgradeable"
title: "OpenZeppelin Contracts Bytes's lastIndexOf function with position argument
  performs out-of-bound memory access on empty buffers"
description: "The `lastIndexOf(bytes,byte,uint256)` function of the `Bytes.sol` library
  may access uninitialized memory when the following two conditions hold: 1) the provided
  buffer length is empty (i.e. `buffer.length == 0`) and position is not `2**256 -
  1` (i.e. `pos != type(uint256).max`).\n\nThe `pos` argument could be used to access
  arbitrary data outside of the buffer bounds. This could lead to the operation running
  out of gas, or returning an invalid index (outside of the empty buffer). Processing
  this invalid result for accessing the `buffer` would cause a revert under normal
  conditions.\n\nWhen triggered, the function reads memory at offset `buffer + 0x20
  + pos`. If memory at that location (outside theÂ `buffer`) matches the search pattern,
  the function would return an out of bound index instead of the expected `type(uint256).max`.
  This creates unexpected behavior where callers receive a valid-looking index pointing
  outside buffer bounds.\n\nSubsequent memory accesses that don't check bounds and
  use the returned index must carefully review the potential impact depending on their
  setup. Code relying on this function returning `type(uint256).max` for empty buffers
  or using the returned index without bounds checking could exhibit undefined behavior."
date: "2025-07-17"
pubdate: "2025-07-17"
affected_range: ">=5.2.0 <5.4.0"
fixed_versions:
- "5.4.0"
affected_versions: "All versions starting from 5.2.0 before 5.4.0"
not_impacted: "All versions before 5.2.0, all versions starting from 5.4.0"
solution: "Upgrade to version 5.4.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2025-54070"
- "https://github.com/advisories/GHSA-9rcw-c2f9-2j55"
- "https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-9rcw-c2f9-2j55"
- "https://github.com/OpenZeppelin/openzeppelin-contracts/pull/5797"
- "https://github.com/OpenZeppelin/openzeppelin-contracts"
- "https://github.com/OpenZeppelin/openzeppelin-contracts/releases/tag/v5.4.0"
cvss_v3: "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:N"
uuid: "9243089c-6f96-46d0-8b33-a3ebaf46ac4a"
cwe_ids:
- "CWE-125"
- "CWE-937"
- "CWE-1035"
