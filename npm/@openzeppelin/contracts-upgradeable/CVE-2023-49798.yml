---
identifier: "CVE-2023-49798"
identifiers:
- "GHSA-699g-q6qh-q4v8"
- "CVE-2023-49798"
package_slug: "npm/@openzeppelin/contracts-upgradeable"
title: "Always-Incorrect Control Flow Implementation"
description: "OpenZeppelin Contracts is a library for smart contract development.
  A merge issue when porting the 5.0.1 patch to the 4.9 branch caused a line duplication.
  In the version of `Multicall.sol` released in `@openzeppelin/contracts@4.9.4` and
  `@openzeppelin/contracts-upgradeable@4.9.4`, all subcalls are executed twice. Concretely,
  this exposes a user to unintentionally duplicate operations like asset transfers.
  The duplicated delegatecall was removed in version 4.9.5. The 4.9.4 version is marked
  as deprecated. Users are advised to upgrade. There are no known workarounds for
  this issue."
date: "2023-12-12"
pubdate: "2023-12-12"
affected_range: "=4.9.4"
fixed_versions:
- "4.9.5"
affected_versions: "Version 4.9.4"
not_impacted: "All versions before 4.9.4, all versions after 4.9.4"
solution: "Upgrade to version 4.9.5 or above."
urls:
- "https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-699g-q6qh-q4v8"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-49798"
- "https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/commit/31f9fb9d171f60b2271b2b9c6f62d43302bf9489"
- "https://github.com/OpenZeppelin/openzeppelin-contracts/commit/88ac712e06832bce73b41e8166cded2729e25205"
- "https://github.com/advisories/GHSA-699g-q6qh-q4v8"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N"
uuid: "1cd92fb7-4f1a-4e84-af51-65ccfd25051d"
cwe_ids:
- "CWE-1035"
- "CWE-670"
- "CWE-937"
