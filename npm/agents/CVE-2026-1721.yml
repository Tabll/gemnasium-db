---
identifier: "CVE-2026-1721"
identifiers:
- "CVE-2026-1721"
- "GHSA-cvhv-6xm6-c3v4"
package_slug: "npm/agents"
title: "Cloudflare Agents is Vulnerable to Reflected Cross-Site Scripting in the AI
  Playground's OAuth callback handler"
description: "Summary\n\nA Reflected Cross-Site Scripting (XSS) vulnerability was
  discovered in the AI Playground's OAuth callback handler. The `error_description`
  query parameter was directly interpolated into an HTML script tag without proper
  escaping, allowing attackers to execute arbitrary JavaScript in the context of the
  victim's session.\n\nRoot cause\n\nThe OAuth callback handler in `site/ai-playground/src/server.ts`
  directly interpolated the `authError` value, sourced from the `error_description`
  query parameter,  into an inline `<script>` tag.\n\nImpact\n\nAn attacker could
  craft a malicious link that, when clicked by a victim, would:\n\n*  Steal user chat
  message history - Access all LLM interactions stored in the user's session.\n\n\n*
  \ Access connected MCP Servers - Interact with any MCP servers connected to the
  victim's session (public or authenticated/private), potentially allowing the attacker
  to perform actions on the victim's behalf\n\n\nMitigation:\n\n*  PR:  https://github.com/cloudflare/agents/pull/841
  https://github.com/cloudflare/agents/pull/841\n*  Agents-sdk users should upgrade
  to agents@0.3.10\n*  Developers using configureOAuthCallback with custom error handling
  in their own applications should ensure all user-controlled input is escaped before
  interpolation."
date: "2026-02-13"
pubdate: "2026-02-13"
affected_range: "<0.3.10"
fixed_versions:
- "0.3.10"
affected_versions: "All versions before 0.3.10"
not_impacted: "All versions starting from 0.3.10"
solution: "Upgrade to version 0.3.10 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2026-1721"
- "https://github.com/advisories/GHSA-cvhv-6xm6-c3v4"
- "https://github.com/cloudflare/agents/pull/841"
- "https://github.com/cloudflare/agents/commit/3f490d045844e4884db741afbb66ca1fe65d4093"
- "https://github.com/cloudflare/agents"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:N"
cvss_v4: "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:A/VC:N/VI:N/VA:N/SC:H/SI:L/SA:N"
uuid: "9830dd6f-cfc5-475c-a861-935476dcd465"
cwe_ids:
- "CWE-79"
- "CWE-937"
- "CWE-1035"
