---
identifier: "CVE-2026-1664"
identifiers:
- "CVE-2026-1664"
- "GHSA-r7x9-8ph7-w8cg"
package_slug: "npm/agents"
title: "Cloudflare Agents SDK has Insecure Direct Object Reference (IDOR) via Header-Based
  Email Routing"
description: "An Insecure Direct Object Reference (CWE-639) has been found to exist
  in createHeaderBasedEmailResolver() function within the Cloudflare Agents SDK. The
  issue occurs because the Message-ID and References headers are parsed to derive
  the target agentName and agentId without proper validation or origin checks, allowing
  an external attacker with control of these headers to route inbound mail to arbitrary
  Durable Object instances and namespaces."
date: "2026-02-03"
pubdate: "2026-02-03"
affected_range: "<0.3.7"
fixed_versions:
- "0.3.7"
affected_versions: "All versions before 0.3.7"
not_impacted: "All versions starting from 0.3.7"
solution: "Upgrade to version 0.3.7 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2026-1664"
- "https://github.com/advisories/GHSA-r7x9-8ph7-w8cg"
- "https://github.com/cloudflare/agents/security/advisories/GHSA-r7x9-8ph7-w8cg"
- "https://github.com/cloudflare/agents"
- "https://github.com/cloudflare/agents/blob/main/docs/email.md"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N"
cvss_v4: "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:L/VI:L/VA:N/SC:L/SI:L/SA:N"
uuid: "aaf971e2-1d1e-4c14-9f95-f6f45534b5d6"
cwe_ids:
- "CWE-639"
- "CWE-937"
- "CWE-1035"
