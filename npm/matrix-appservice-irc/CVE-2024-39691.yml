---
identifier: "CVE-2024-39691"
identifiers:
- "CVE-2024-39691"
- "GHSA-w9mh-5x8j-9754"
package_slug: "npm/matrix-appservice-irc"
title: "Malicious Matrix homeserver can leak truncated message content of messages
  it shouldn't have access to"
description: "The fix for GHSA-wm4w-7h2q-3pf7 / [CVE-2024-32000](https://www.cve.org/CVERecord?id=CVE-2024-32000)
  included in matrix-appservice-irc 2.0.0 relied on the Matrix homeserver-provided
  timestamp to determine whether a user has access to the event they're replying to
  when determining whether or not to include a truncated version of the original event
  in the IRC message. Since this value is controlled by external entities, a malicious
  Matrix homeserver joined to a room in which a matrix-appservice-irc bridge instance
  (before version 2.0.1) is present can fabricate the timestamp with the intent of
  tricking the bridge into leaking room messages the homeserver should not have access
  to."
date: "2024-07-05"
pubdate: "2024-07-05"
affected_range: "<2.0.1"
fixed_versions:
- "2.0.1"
affected_versions: "All versions before 2.0.1"
not_impacted: "All versions starting from 2.0.1"
solution: "Upgrade to version 2.0.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-39691"
- "https://github.com/advisories/GHSA-w9mh-5x8j-9754"
- "https://github.com/matrix-org/matrix-appservice-irc/security/advisories/GHSA-w9mh-5x8j-9754"
- "https://github.com/matrix-org/matrix-appservice-irc/pull/1804"
- "https://github.com/matrix-org/matrix-appservice-irc/commit/1835e047f269001054be4c68867797aa12372a0f"
- "https://github.com/matrix-org/matrix-appservice-irc"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N"
uuid: "48ff8c8b-fe2f-43c7-b7d3-35fd587e971f"
cwe_ids:
- "CWE-280"
- "CWE-755"
- "CWE-937"
- "CWE-1035"
