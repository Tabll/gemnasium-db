---
identifier: "CVE-2023-48238"
identifiers:
- "GHSA-4xw9-cx39-r355"
- "CVE-2023-48238"
package_slug: "npm/json-web-token"
title: "json-web-token library is vulnerable to a JWT algorithm confusion attack"
description: "joaquimserafim/json-web-token is a javascript library use to interact
  with JSON Web Tokens (JWT) which are a compact URL-safe means of representing claims
  to be transferred between two parties. Affected versions of the json-web-token library
  is vulnerable to a JWT algorithm confusion attack. On line 86 of the 'index.js'
  file, the algorithm to use for verifying the signature of the JWT token is taken
  from the JWT token, which at that point is still unverified and thus shouldn't be
  trusted. To exploit this vulnerability, an attacker needs to craft a malicious JWT
  token containing the HS256 algorithm, signed with the public RSA key of the victim
  application. This attack will only work against this library is the RS256 algorithm
  is in use, however it is a best practice to use that algorithm."
date: "2023-11-29"
pubdate: "2023-11-17"
affected_range: "<3.1.1"
fixed_versions:
- "3.1.1"
affected_versions: "All versions before 3.1.1"
not_impacted: "All versions starting from 3.1.1"
solution: "Upgrade to version 3.1.1 or above."
urls:
- "https://github.com/joaquimserafim/json-web-token/security/advisories/GHSA-4xw9-cx39-r355"
- "https://github.com/joaquimserafim/json-web-token/blob/acf6a462471e1b14187eb77414e9161b8b7bff7e/index.js#L86"
- "https://github.com/advisories/GHSA-4xw9-cx39-r355"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N"
uuid: "0dbddae4-b332-4f42-a8fb-ad6972ee9961"
cwe_ids:
- "CWE-1035"
- "CWE-345"
- "CWE-937"
