---
identifier: "CVE-2021-22964"
identifiers:
- "GHSA-pgh6-m65r-2rhq"
- "CVE-2021-22964"
package_slug: "npm/fastify-static"
title: "URL Redirection to Untrusted Site ('Open Redirect')"
description: "A redirect vulnerability in the `fastify-static` module allows remote
  attackers to redirect Mozilla Firefox users to arbitrary websites via a double slash
  `//` followed by a domain: `http://localhost:3000//a//youtube.com/%2e%2e%2f%2e%2e`.A
  DoS vulnerability is possible if the URL contains invalid characters `curl --path-as-is
  \"http://localhost:3000//^/..\"`The issue shows up on all the `fastify-static` applications
  that set `redirect: true` option. By default, it is `false`."
date: "2021-10-21"
pubdate: "2021-10-12"
affected_range: ">=4.2.4 <4.4.1"
fixed_versions:
- "4.4.1"
affected_versions: "All versions starting from 4.2.4 before 4.4.1"
not_impacted: "All versions before 4.2.4, all versions starting from 4.4.1"
solution: "Upgrade to version 4.4.1 or above."
urls:
- "https://github.com/fastify/fastify-static/security/advisories/GHSA-pgh6-m65r-2rhq"
- "https://github.com/fastify/fastify-static/commit/c31f17d107cb19a0e96733c80a9abf16c56166d4"
- "https://nvd.nist.gov/vuln/detail/CVE-2021-22964"
- "https://hackerone.com/reports/1361804"
- "https://github.com/advisories/GHSA-pgh6-m65r-2rhq"
cvss_v2: "AV:N/AC:M/Au:N/C:P/I:P/A:P"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:H"
uuid: "a679cae3-a243-45ca-aa82-3279e6ec26f0"
cwe_ids:
- "CWE-1035"
- "CWE-601"
- "CWE-937"
