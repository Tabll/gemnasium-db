---
identifier: "CVE-2021-40829"
identifiers:
- "CVE-2021-40829"
- "GHSA-743r-5g92-5vgf"
package_slug: "npm/aws-iot-device-sdk-v2"
title: "Improper certificate management in AWS IoT Device SDK v2"
description: "Connections initialized by the AWS IoT Device SDK v2 for Java (versions
  prior to 1.4.2), Python (versions prior to 1.6.1), C++ (versions prior to 1.12.7)
  and Node.js (versions prior to 1.5.3) did not verify server certificate hostname
  during TLS handshake when overriding Certificate Authorities (CA) in their trust
  stores on MacOS. This issue has been addressed in aws-c-io submodule versions 0.10.5
  onward. This issue affects: Amazon Web Services AWS IoT Device SDK v2 for Java versions
  prior to 1.4.2 on macOS. Amazon Web Services AWS IoT Device SDK v2 for Python versions
  prior to 1.6.1 on macOS. Amazon Web Services AWS IoT Device SDK v2 for C++ versions
  prior to 1.12.7 on macOS. Amazon Web Services AWS IoT Device SDK v2 for Node.js
  versions prior to 1.5.3 on macOS. Amazon Web Services AWS-C-IO 0.10.4 on macOS."
date: "2024-11-18"
pubdate: "2021-11-24"
affected_range: "<1.5.3"
fixed_versions:
- "1.5.3"
affected_versions: "All versions before 1.5.3"
not_impacted: "All versions starting from 1.5.3"
solution: "Upgrade to version 1.5.3 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-40829"
- "https://github.com/advisories/GHSA-743r-5g92-5vgf"
- "https://github.com/aws/aws-iot-device-sdk-cpp-v2"
- "https://github.com/aws/aws-iot-device-sdk-java-v2"
- "https://github.com/aws/aws-iot-device-sdk-java-v2/commits/v1.4.2"
- "https://github.com/aws/aws-iot-device-sdk-js-v2"
- "https://github.com/aws/aws-iot-device-sdk-python-v2"
- "https://github.com/awslabs/aws-c-io"
- "https://github.com/pypa/advisory-database/tree/main/vulns/awsiotsdk/PYSEC-2021-862.yaml"
cvss_v2: "AV:A/AC:L/Au:N/C:P/I:P/A:P"
cvss_v3: "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "779b50ff-3180-4238-967f-946155d70df8"
cwe_ids:
- "CWE-295"
- "CWE-937"
- "CWE-1035"
