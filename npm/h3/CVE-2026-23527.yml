---
identifier: "CVE-2026-23527"
identifiers:
- "CVE-2026-23527"
- "GHSA-mp2g-9vg9-f4cg"
package_slug: "npm/h3"
title: "h3 v1 has Request Smuggling (TE.TE) issue"
description: "I was digging into h3 v1 (specifically v1.15.4) and found a critical
  HTTP Request Smuggling vulnerability.\n\nBasically, `readRawBody` is doing a strict
  case-sensitive check for the Transfer-Encoding header. It explicitly looks for \"chunked\",
  but per the RFC, this header should be case-insensitive.\n\n**The Bug**: If I send
  a request with Transfer-Encoding: ChuNked (mixed case), h3 misses it. Since it doesn't
  see \"chunked\" and there's no Content-Length, it assumes the body is empty and
  processes the request immediately.\n\nThis leaves the actual body sitting on the
  socket, which triggers a classic TE.TE Desync (Request Smuggling) if the app is
  running behind a Layer 4 proxy or anything that doesn't normalize headers (like
  AWS NLB or Node proxies).\n\n**Vulnerable Code** (`src/utils/body.ts`):\n\n```js\nif
  (\n!Number.parseInt(event.node.req.headers[\"content-length\"] || \"\") &&\n!String(event.node.req.headers[\"transfer-encoding\"]
  ?? \"\")\n.split(\",\")\n.map((e) => e.trim())\n.filter(Boolean)\n.includes(\"chunked\")
  // <--- This is the issue. \"ChuNkEd\" returns false here.\n) {\nreturn Promise.resolve(undefined);\n}\n```\n\nI
  verified this locally:\n\n- Sent a `Transfer-Encoding: ChunKed` request without
  a closing 0 chunk.\n- Express hangs (correctly waiting for data).\n- h3 responds
  immediately (vulnerable, thinks body is length 0).\n\n**Impact**: Since H3/Nuxt/Nitro
  is often used in containerized setups behind TCP load balancers, an attacker can
  use this to smuggle requests past WAFs or desynchronize the socket to poison other
  users' connections.\n\n**Fix**: Just need to normalize the header value before checking:
  ` .map((e) => e.trim().toLowerCase())`"
date: "2026-01-15"
pubdate: "2026-01-15"
affected_range: "<1.15.5"
fixed_versions:
- "1.15.5"
affected_versions: "All versions before 1.15.5"
not_impacted: "All versions starting from 1.15.5"
solution: "Upgrade to version 1.15.5 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2026-23527"
- "https://github.com/advisories/GHSA-mp2g-9vg9-f4cg"
- "https://github.com/h3js/h3/security/advisories/GHSA-mp2g-9vg9-f4cg"
- "https://github.com/h3js/h3"
- "https://github.com/h3js/h3/releases/tag/v1.15.5"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:L"
uuid: "fa139ca5-5fff-48bf-a438-a9abe19795a7"
cwe_ids:
- "CWE-444"
- "CWE-937"
- "CWE-1035"
