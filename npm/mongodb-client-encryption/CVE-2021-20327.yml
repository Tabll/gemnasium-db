---
identifier: "CVE-2021-20327"
identifiers:
- "CVE-2021-20327"
- "GHSA-rjmf-p882-645m"
package_slug: "npm/mongodb-client-encryption"
title: "mongodb-client-encryption vulnerable to Improper Certificate Validation"
description: "A specific version of the Node.js mongodb-client-encryption module does
  not perform correct validation of the KMS server’s certificate. This vulnerability
  in combination with a privileged network position active MITM attack could result
  in interception of traffic between the Node.js driver and the KMS service rendering
  client-side field level encryption (CSFLE) ineffective. This issue was discovered
  during internal testing and affects mongodb-client-encryption module version 1.2.0,
  which was available from 2021-Jan-29 and deprecated in the NPM Registry on 2021-Feb-04.
  This vulnerability does not impact driver traffic payloads with CSFLE-supported
  key services from applications residing inside the AWS, GCP, and Azure nework fabrics
  due to compensating controls in these environments. This issue does not impact driver
  workloads that don’t use Field Level Encryption. This issue affect MongoDB Node.js
  Driver mongodb-client-encryption module version 1.2.0"
date: "2024-09-16"
pubdate: "2021-04-12"
affected_range: ">=1.2.0 <1.2.1||=1.2.0"
fixed_versions:
- "1.2.1"
affected_versions: "All versions starting from 1.2.0 before 1.2.1, version 1.2.0"
not_impacted: ""
solution: "Upgrade to version 1.2.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-20327"
- "https://github.com/advisories/GHSA-rjmf-p882-645m"
- "https://github.com/mongodb/libmongocrypt/commit/76365515ff8754b9f705e56428dd0d7efa7f541b"
- "https://github.com/mongodb/libmongocrypt"
- "https://jira.mongodb.org/browse/NODE-3125"
- "https://www.npmjs.com/advisories/1660"
cvss_v2: "AV:A/AC:M/Au:N/C:P/I:P/A:N"
cvss_v3: "CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N"
uuid: "c2e5f0ab-d222-40ab-a1d4-e1d49be11b78"
cwe_ids:
- "CWE-295"
- "CWE-937"
- "CWE-1035"
