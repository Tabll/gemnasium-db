---
identifier: "CVE-2022-39386"
identifiers:
- "CVE-2022-39386"
- "GHSA-4pcg-wr6c-h9cq"
- "GMS-2022-6369"
package_slug: "npm/@fastify/websocket"
title: "Crash on malformed packet"
description: "@fastify/websocket provides WebSocket support for Fastify. Any application
  using @fastify/websocket could crash if a specific, malformed packet is sent. All
  versions of fastify-websocket are also impacted. That module is deprecated, so it
  will not be patched. This has been patched in version 7.1.1 (fastify v4) and version
  5.0.1 (fastify v3). There are currently no known workarounds. However, it should
  be possible to attach the error handler manually. The recommended path is upgrading
  to the patched versions."
date: "2022-11-09"
pubdate: "2022-11-08"
affected_range: "<=5.0.0||>=6.0.0 <7.1.1"
fixed_versions:
- "5.0.1"
- "7.1.1"
affected_versions: "All versions starting from 5.0.0 before 5.0.1, all versions starting
  from 6.0.0 up to 7.1.1"
not_impacted: "All versions starting from 5.0.1 up to 6.0.0, all versions starting
  from 7.1.1"
solution: "Upgrade to version 5.0.1, 7.1.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-39386"
- "https://github.com/fastify/fastify-websocket/security/advisories/GHSA-4pcg-wr6c-h9cq"
- "https://github.com/fastify/fastify-websocket/releases/tag/v5.0.1"
- "https://github.com/fastify/fastify-websocket/releases/tag/v7.1.1"
- "https://github.com/advisories/GHSA-4pcg-wr6c-h9cq"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
uuid: "64c5300e-d5ac-4704-a73d-e970464f627e"
cwe_ids:
- "CWE-1035"
- "CWE-937"
