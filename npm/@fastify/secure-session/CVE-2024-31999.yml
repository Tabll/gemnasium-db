---
identifier: "CVE-2024-31999"
identifiers:
- "CVE-2024-31999"
- "GHSA-9wwp-q7wq-jx35"
package_slug: "npm/@fastify/secure-session"
title: "@fastify/secure-session: Reuse of destroyed secure session cookie"
description: "At the end of the request handling, it will encrypt all data in the
  session with a secret key and attach the ciphertext as a cookie value with the defined
  cookie name. After that, the session on the server side is destroyed. When an encrypted
  cookie with matching session name is provided with subsequent requests, it will
  decrypt the ciphertext to get the data. The plugin then creates a new session with
  the data in the ciphertext. Thus theoretically the web instance is still accessing
  the data from a server-side session, but technically that session is generated solely
  from a user provided cookie (which is assumed to be non-craftable because it is
  encrypted with a secret key not known to the user).\n\nThe issue exists in the session
  removal process. In the delete function of the code, when the session is deleted,
  it is marked for deletion. However, if an attacker could gain access to the cookie,
  they could keep using it forever."
date: "2024-04-10"
pubdate: "2024-04-10"
affected_range: "<7.3.0"
fixed_versions:
- "7.3.0"
affected_versions: "All versions before 7.3.0"
not_impacted: "All versions starting from 7.3.0"
solution: "Upgrade to version 7.3.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-31999"
- "https://github.com/advisories/GHSA-9wwp-q7wq-jx35"
- "https://github.com/fastify/fastify-secure-session/security/advisories/GHSA-9wwp-q7wq-jx35"
- "https://github.com/fastify/fastify-secure-session/commit/56d66642ecc633cff0606927601e81cdac361370"
- "https://github.com/fastify/fastify-secure-session"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N"
uuid: "d6962ff8-0be4-4469-85b5-753589ece4af"
cwe_ids:
- "CWE-613"
- "CWE-937"
- "CWE-1035"
