---
identifier: "CVE-2025-65099"
identifiers:
- "CVE-2025-65099"
- "GHSA-5hhx-v7f6-x7gv"
package_slug: "npm/@anthropic-ai/claude-code"
title: "Claude Code vulnerable to command execution prior to startup trust dialog"
description: "When using Claude Code with Yarn installed, Yarn config files can trigger
  code execution when running yarn --version. This could lead to a bypass of the directory
  trust dialog in Claude Code, as plugins and yarnPath could be executed prior to
  the user accepting the risks of working in an untrusted directory. Users on standard
  Claude Code auto-update will have received this fix automatically. Users performing
  manual updates are advised to update to the latest version.\n\nThank you to Benjamin
  Faller, Redguard AG and Michael Hess for reporting this issue!"
date: "2025-12-22"
pubdate: "2025-11-19"
affected_range: "<1.0.39"
fixed_versions:
- "1.0.39"
affected_versions: "All versions before 1.0.39"
not_impacted: "All versions starting from 1.0.39"
solution: "Upgrade to version 1.0.39 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2025-65099"
- "https://github.com/advisories/GHSA-5hhx-v7f6-x7gv"
- "https://github.com/anthropics/claude-code/security/advisories/GHSA-5hhx-v7f6-x7gv"
- "https://github.com/anthropics/claude-code"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
cvss_v4: "CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:P/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N"
uuid: "da590377-789f-458a-861b-0d62fc3f7fb9"
cwe_ids:
- "CWE-94"
- "CWE-937"
- "CWE-1035"
