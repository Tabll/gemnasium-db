---
identifier: "CVE-2022-39263"
identifiers:
- "GHSA-4rxr-27mm-mxq9"
- "CVE-2022-39263"
package_slug: "npm/@next-auth/upstash-redis-adapter"
title: "Improper Authentication"
description: "`@next-auth/upstash-redis-adapter` is the Upstash Redis adapter for
  NextAuth.js, which provides authentication for Next.js. Applications that use `next-auth`
  Email Provider and `@next-auth/upstash-redis-adapter` before v3.0.2 are affected
  by this vulnerability. The Upstash Redis adapter implementation does not check for
  both the identifier (email) and the token, but only checking for the identifier
  when verifying the token in the email callback flow. An attacker who knows about
  the victim's email could easily sign in as the victim, given the attacker also knows
  about the verification token's expired duration. The vulnerability is patched in
  v3.0.2. A workaround is available. Using Advanced Initialization, developers can
  check the requests and compare the query's token and identifier before proceeding."
date: "2022-09-30"
pubdate: "2022-09-30"
affected_range: "<3.0.2"
fixed_versions:
- "3.0.2"
affected_versions: "All versions before 3.0.2"
not_impacted: "All versions starting from 3.0.2"
solution: "Upgrade to version 3.0.2 or above."
urls:
- "https://github.com/nextauthjs/next-auth/security/advisories/GHSA-4rxr-27mm-mxq9"
- "https://nvd.nist.gov/vuln/detail/CVE-2022-39263"
- "https://github.com/nextauthjs/next-auth/commit/d16e04848ee703cf797724194d4ad2907fe125a9"
- "https://github.com/advisories/GHSA-4rxr-27mm-mxq9"
uuid: "0de76146-b325-4e6b-b5a8-46427a12d548"
cwe_ids:
- "CWE-1035"
- "CWE-287"
- "CWE-937"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H"
