---
identifier: "CVE-2022-46175"
identifiers:
- "GHSA-9c47-m6qq-7p4h"
- "CVE-2022-46175"
package_slug: "npm/json5"
title: "Improperly Controlled Modification of Object Prototype Attributes ('Prototype
  Pollution')"
description: "JSON5 is an extension to the popular JSON file format that aims to be
  easier to write and maintain by hand (e.g. for config files). The `parse` method
  of the JSON5 library before and including version `2.2.1` does not restrict parsing
  of keys named `__proto__`, allowing specially crafted strings to pollute the prototype
  of the resulting object. This vulnerability pollutes the prototype of the object
  returned by `JSON5.parse` and not the global Object prototype, which is the commonly
  understood definition of Prototype Pollution. However, polluting the prototype of
  a single object can have significant security impact for an application if the object
  is later used in trusted operations. This vulnerability could allow an attacker
  to set arbitrary and unexpected keys on the object returned from `JSON5.parse`.
  The actual impact will depend on how applications utilize the returned object and
  how they filter unwanted keys, but could include denial of service, cross-site scripting,
  elevation of privilege, and in extreme cases, remote code execution. `JSON5.parse`
  should restrict parsing of `__proto__` keys when parsing JSON strings to objects.
  As a point of reference, the `JSON.parse` method included in JavaScript ignores
  `__proto__` keys. Simply changing `JSON5.parse` to `JSON.parse` in the examples
  above mitigates this vulnerability. This vulnerability is patched in json5 version
  2.2.2 and later."
date: "2023-11-26"
pubdate: "2022-12-24"
affected_range: "<1.0.2||>=2.0.0 <2.2.2"
fixed_versions:
- "1.0.2"
- "2.2.2"
affected_versions: "All versions before 1.0.2, all versions starting from 2.0.0 before
  2.2.2"
not_impacted: "All versions starting from 1.0.2 before 2.0.0, all versions starting
  from 2.2.2"
solution: "Upgrade to versions 1.0.2, 2.2.2 or above."
urls:
- "https://github.com/json5/json5/security/advisories/GHSA-9c47-m6qq-7p4h"
- "https://nvd.nist.gov/vuln/detail/CVE-2022-46175"
- "https://github.com/json5/json5/issues/199"
- "https://github.com/json5/json5/issues/295"
- "https://github.com/advisories/GHSA-9c47-m6qq-7p4h"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
uuid: "1a8ca739-19bd-4b8a-8166-32737f587056"
cwe_ids:
- "CWE-1035"
- "CWE-1321"
- "CWE-937"
