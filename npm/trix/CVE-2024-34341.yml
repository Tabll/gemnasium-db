---
identifier: "CVE-2024-34341"
identifiers:
- "CVE-2024-34341"
- "GHSA-qjqp-xr96-cj99"
package_slug: "npm/trix"
title: "Trix Editor Arbitrary Code Execution Vulnerability"
description: "The Trix editor, versions prior to 2.1.1, is vulnerable to arbitrary
  code execution when copying and pasting content from the web or other documents
  with markup into the editor. The vulnerability stems from improper sanitization
  of pasted content, allowing an attacker to embed malicious scripts which are executed
  within the context of the application.\n\n**Vulnerable Versions**: Up to 2.1.0\n\n**Fixed
  Version**: 2.1.1\n\n**Vector**:\n\n- **Bug 1**: When copying content manipulated
  by a script, such as:\n\n```js\ndocument.addEventListener('copy', function(e){\ne.clipboardData.setData('text/html',
  '<div><noscript><div class=\"123</noscript>456<img src=1 onerror=alert(1)//\"></div></noscript></div>');\ne.preventDefault();\n});\n```\n\nand
  pasting into the Trix editor, the script within the content is executed.\n\n- **Bug
  2**: Similar execution occurs with content structured as:"
date: "2024-05-07"
pubdate: "2024-05-07"
affected_range: "<2.1.1"
fixed_versions:
- "2.1.1"
affected_versions: "All versions before 2.1.1"
not_impacted: "All versions starting from 2.1.1"
solution: "Upgrade to version 2.1.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-34341"
- "https://github.com/advisories/GHSA-qjqp-xr96-cj99"
- "https://github.com/basecamp/trix/security/advisories/GHSA-qjqp-xr96-cj99"
- "https://github.com/basecamp/trix/pull/1147"
- "https://github.com/basecamp/trix/pull/1149"
- "https://github.com/basecamp/trix/commit/1a5c68a14d48421fc368e30026f4a7918028b7ad"
- "https://github.com/basecamp/trix/commit/841ff19b53f349915100bca8fcb488214ff93554"
- "https://github.com/basecamp/trix"
- "https://github.com/basecamp/trix/releases/tag/v2.1.1"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N"
uuid: "08794eec-95bc-4949-a31b-1eb26159ea9c"
cwe_ids:
- "CWE-79"
- "CWE-937"
- "CWE-1035"
