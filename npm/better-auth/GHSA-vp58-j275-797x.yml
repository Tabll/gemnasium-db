---
identifier: "GHSA-vp58-j275-797x"
identifiers:
- "GHSA-vp58-j275-797x"
package_slug: "npm/better-auth"
title: "Better Auth allows bypassing the trustedOrigins Protection which leads to
  ATO"
description: "A bypass was discovered in the trustedOrigins validation logicâ€”affecting
  both absolute URL entries and wildcard domain patterns. This flaw allows an attacker
  to construct a malicious callbackURL that passes origin checks and triggers an open
  redirect.\n\nBecause redirect endpoints include sensitive tokens (such as password-reset
  tokens), this vulnerability can enable one-click account takeover if a victim clicks
  a crafted link."
date: "2025-12-09"
pubdate: "2025-02-24"
affected_range: "<1.1.21"
fixed_versions:
- "1.1.21"
affected_versions: "All versions before 1.1.21"
not_impacted: "All versions starting from 1.1.21"
solution: "Upgrade to version 1.1.21 or above."
urls:
- "https://github.com/advisories/GHSA-vp58-j275-797x"
- "https://github.com/better-auth/better-auth/security/advisories/GHSA-vp58-j275-797x"
- "https://github.com/better-auth/better-auth/commit/b381cac7aafd6aa53ef78b6ab771ebfa24643c80"
- "https://github.com/better-auth/better-auth"
- "https://github.com/better-auth/better-auth/blob/ddebd0358d74376ea64541512d0167dd4377f182/packages/better-auth/src/api/middlewares/origin-check.ts#L53"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:H/A:N"
uuid: "ac7a91be-ee4e-4f95-96bc-f9fd8ebd7c48"
cwe_ids:
- "CWE-601"
- "CWE-937"
- "CWE-1035"
