---
identifier: "CVE-2023-40013"
identifiers:
- "CVE-2023-40013"
- "GHSA-xc2r-jf2x-gjr8"
package_slug: "npm/external-svg-loader"
title: "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
description: "SVG Loader is a javascript library that fetches SVGs using XMLHttpRequests
  and injects the SVG code in the tag's place. According to the docs, svg-loader will
  strip all JS code before injecting the SVG file for security reasons but the input
  sanitization logic is not sufficient and can be trivially bypassed. This allows
  an attacker to craft a malicious SVG which can result in Cross-site Scripting (XSS).
  When trying to sanitize the svg the lib removes event attributes such as `onmouseover`,
  `onclick` but the list of events is not exhaustive. Any website which uses external-svg-loader
  and allows its users to provide svg src, upload svg files would be susceptible to
  stored XSS attack. This issue has been addressed in commit `d3562fc08` which is
  included in releases from 1.6.9. Users are advised to upgrade. There are no known
  workarounds for this vulnerability."
date: "2023-08-23"
pubdate: "2023-08-14"
affected_range: "<1.6.9"
fixed_versions:
- "1.6.9"
affected_versions: "All versions before 1.6.9"
not_impacted: "All versions starting from 1.6.9"
solution: "Upgrade to version 1.6.9 or above."
urls:
- "https://github.com/shubhamjain/svg-loader/security/advisories/GHSA-xc2r-jf2x-gjr8"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-40013"
- "https://github.com/shubhamjain/svg-loader/commit/d3562fc08497aec5f33eb82017fa1417b3319e2c"
- "https://github.com/shubhamjain/svg-loader/blob/main/svg-loader.js#L125-L128"
- "https://github.com/shubhamjain/svg-loader/tree/main#2-enable-javascript"
- "https://github.com/advisories/GHSA-xc2r-jf2x-gjr8"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N"
uuid: "456c2b49-05f3-484c-9031-01165d2689d9"
cwe_ids:
- "CWE-1035"
- "CWE-79"
- "CWE-937"
