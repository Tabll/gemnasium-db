---
identifier: "CVE-2023-38704"
identifiers:
- "CVE-2023-38704"
- "GHSA-5r27-rw8r-7967"
package_slug: "npm/import-in-the-middle"
title: "Remote Code Execution"
description: "import-in-the-middle is a module loading interceptor specifically for
  ESM modules. The import-in-the-middle loader works by generating a wrapper module
  on the fly. The wrapper uses the module specifier to load the original module and
  add some wrapping code. Prior to version 1.4.2, it allows for remote code execution
  in cases where an application passes user-supplied input directly to the `import()`
  function. This vulnerability has been patched in import-in-the-middle version 1.4.2.\n\nSome
  workarounds are available. Do not pass any user-supplied input to `import()`. Instead,
  verify it against a set of allowed values. If using import-in-the-middle, directly
  or indirectly, and support for EcmaScript Modules is not needed, ensure that no
  options are set, either via command-line or the `NODE_OPTIONS` environment variable,
  that would enable loader hooks."
date: "2023-08-11"
pubdate: "2023-08-07"
affected_range: "<1.4.2"
fixed_versions:
- "1.4.2"
affected_versions: "All versions before 1.4.2"
not_impacted: "All versions starting from 1.4.2"
solution: "Upgrade to version 1.4.2 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-38704"
- "https://github.com/DataDog/import-in-the-middle/commit/2531cdd9d1d73f9eaa87c16967f60cb276c1971b"
- "https://github.com/DataDog/import-in-the-middle/security/advisories/GHSA-5r27-rw8r-7967"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "9969bb23-09e7-40f6-93f8-b30392c9f356"
cwe_ids:
- "CWE-1035"
- "CWE-937"
