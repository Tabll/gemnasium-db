---
identifier: "CVE-2022-39218"
identifiers:
- "GHSA-cmr8-5w4c-44v8"
- "CVE-2022-39218"
package_slug: "npm/@fastly/js-compute"
title: "Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG)"
description: "The JS Compute Runtime for Fastly's Compute@Edge platform provides the
  environment JavaScript is executed in when using the Compute@Edge JavaScript SDK.
  In versions prior to 0.5.3, the `Math.random` and `crypto.getRandomValues` methods
  fail to use sufficiently random values. The initial value to seed the PRNG (pseudorandom
  number generator) is baked-in to the final WebAssembly module, making the sequence
  of random values for that specific WebAssembly module predictable. An attacker can
  use the fixed seed to predict random numbers generated by these functions and bypass
  cryptographic security controls, for example to disclose sensitive data encrypted
  by functions that use these generators. The problem has been patched in version
  0.5.3. No known workarounds exist."
date: "2022-09-21"
pubdate: "2022-09-20"
affected_range: ">=0.4.0 <0.5.3"
fixed_versions:
- "0.5.3"
affected_versions: "All versions starting from 0.4.0 before 0.5.3"
not_impacted: "All versions before 0.4.0, all versions starting from 0.5.3"
solution: "Upgrade to version 0.5.3 or above."
urls:
- "https://github.com/fastly/js-compute-runtime/security/advisories/GHSA-cmr8-5w4c-44v8"
- "https://github.com/fastly/js-compute-runtime/commit/65524ffc962644e9fc39f4b368a326b6253912a9"
- "https://nvd.nist.gov/vuln/detail/CVE-2022-39218"
- "https://github.com/advisories/GHSA-cmr8-5w4c-44v8"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"
uuid: "b69d116c-8705-41a4-a385-7b5657024f5a"
cwe_ids:
- "CWE-1035"
- "CWE-335"
- "CWE-937"
