---
identifier: "CVE-2021-32804"
identifiers:
- "GHSA-3jfq-g458-7qm9"
- "CVE-2021-32804"
package_slug: "npm/tar"
title: "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
description: "The npm package \"tar\" (aka node-tar) before versions 6.1.1, 5.0.6,
  4.4.14, and 3.3.2 has a arbitrary File Creation/Overwrite vulnerability due to insufficient
  absolute path sanitization. node-tar aims to prevent extraction of absolute file
  paths by turning absolute paths into relative paths when the `preservePaths` flag
  is not set to `true`. This is achieved by stripping the absolute path root from
  any absolute file paths contained in a tar file. For example `/home/user/.bashrc`
  would turn into `home/user/.bashrc`. This logic was insufficient when file paths
  contained repeated path roots such as `////home/user/.bashrc`. `node-tar` would
  only strip a single path root from such paths. When given an absolute file path
  with repeating path roots, the resulting path (e.g. `///home/user/.bashrc`) would
  still resolve to an absolute path, thus allowing arbitrary file creation and overwrite.
  This issue was addressed in releases 3.2.2, 4.4.14, 5.0.6 and 6.1.1. Users may work
  around this vulnerability without upgrading by creating a custom `onentry` method
  which sanitizes the `entry.path` or a `filter` method which removes entries with
  absolute paths. See referenced GitHub Advisory for details. Be aware of CVE-2021-32803
  which fixes a similar bug in later versions of tar."
date: "2021-10-21"
pubdate: "2021-08-03"
affected_range: "<3.2.2||>=4.0.0 <4.4.14||>=5.0.0 <5.0.6||>=6.0.0 <6.1.1"
fixed_versions:
- "3.2.2"
- "4.4.14"
- "5.0.6"
- "6.1.1"
affected_versions: "All versions before 3.2.2, all versions starting from 4.0.0 before
  4.4.14, all versions starting from 5.0.0 before 5.0.6, all versions starting from
  6.0.0 before 6.1.1"
not_impacted: "All versions starting from 3.2.2 before 4.0.0, all versions starting
  from 4.4.14 before 5.0.0, all versions starting from 5.0.6 before 6.0.0, all versions
  starting from 6.1.1"
solution: "Upgrade to versions 3.2.2, 4.4.14, 5.0.6, 6.1.1 or above."
urls:
- "https://github.com/npm/node-tar/security/advisories/GHSA-3jfq-g458-7qm9"
- "https://github.com/npm/node-tar/commit/1f036ca23f64a547bdd6c79c1a44bc62e8115da4"
- "https://www.npmjs.com/advisories/1770"
- "https://www.npmjs.com/package/tar"
- "https://nvd.nist.gov/vuln/detail/CVE-2021-32804"
- "https://www.oracle.com/security-alerts/cpuoct2021.html"
- "https://github.com/advisories/GHSA-3jfq-g458-7qm9"
cvss_v2: "AV:N/AC:M/Au:N/C:N/I:P/A:P"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:H"
uuid: "8d63f9f1-0a88-4f8d-b423-48892f01c709"
cwe_ids:
- "CWE-1035"
- "CWE-22"
- "CWE-78"
- "CWE-937"
