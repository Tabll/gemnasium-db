---
identifier: "CVE-2021-41174"
identifiers:
- "GHSA-3j9m-hcv9-rpj8"
- "CVE-2021-41174"
package_slug: "npm/@grafana/data"
title: "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
description: "Grafana is an open-source platform for monitoring and observability.
  arbitrary JavaScript content may be executed within the context of the victim's
  browser. The user visiting the malicious link must be unauthenticated and the link
  must be for a page that contains the login button in the menu bar. The url has to
  be crafted to exploit AngularJS rendering and contain the interpolation binding
  for AngularJS expressions. AngularJS uses double curly braces for interpolation
  binding: {{ }} ex: {{constructor.constructor(‘alert(1)’)()}}. When the user follows
  the link and the page renders, the login button will contain the original link with
  a query parameter to force a redirect to the login page. The URL is not validated
  and the AngularJS rendering engine will execute the JavaScript expression contained
  in the URL. Users are advised to upgrade as soon as possible. If for some reason
  you cannot upgrade, you can use a reverse proxy or similar to block access to block
  the literal string {{ in the path."
date: "2021-11-29"
pubdate: "2021-11-08"
affected_range: ">=8.0.0 <8.2.3"
fixed_versions:
- "8.2.3"
affected_versions: "All versions starting from 8.0.0 before 8.2.3"
not_impacted: "All versions before 8.0.0, all versions starting from 8.2.3"
solution: "Upgrade to version 8.2.3 or above."
urls:
- "https://github.com/grafana/grafana/security/advisories/GHSA-3j9m-hcv9-rpj8"
- "https://github.com/grafana/grafana/commit/31b78d51c693d828720a5b285107a50e6024c912"
- "https://github.com/grafana/grafana/commit/3cb5214fa45eb5a571fd70d6c6edf0d729983f82"
- "https://github.com/grafana/grafana/commit/fb85ed691290d211a5baa44d9a641ab137f0de88"
- "https://nvd.nist.gov/vuln/detail/CVE-2021-41174"
- "https://security.netapp.com/advisory/ntap-20211125-0003/"
- "https://github.com/advisories/GHSA-3j9m-hcv9-rpj8"
cvss_v2: "AV:N/AC:M/Au:N/C:N/I:P/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N"
uuid: "35963801-c88c-4b69-a91b-782735339643"
cwe_ids:
- "CWE-1035"
- "CWE-79"
- "CWE-79"
- "CWE-937"
