---
identifier: "CVE-2025-64525"
identifiers:
- "CVE-2025-64525"
- "GHSA-hr2q-hp5q-x767"
package_slug: "npm/astro"
title: "Astro vulnerable to URL manipulation via headers, leading to middleware and
  CVE-2025-61925 bypass"
description: "In impacted versions of Astro using [on-demand rendering](https://docs.astro.build/en/guides/on-demand-rendering/),
  request headers `x-forwarded-proto` and `x-forwarded-port` are insecurely used,
  without sanitization, to build the URL. This has several consequences the most important
  of which are:\n\n- Middleware-based protected route bypass (only via `x-forwarded-proto`)\n-
  DoS via cache poisoning (if a CDN is present)\n- SSRF (only via `x-forwarded-proto`)\n-
  URL pollution (potential SXSS, if a CDN is present)\n- WAF bypass"
date: "2025-11-13"
pubdate: "2025-11-13"
affected_range: ">=2.16.0 <5.15.5"
fixed_versions:
- "5.15.5"
affected_versions: "All versions starting from 2.16.0 before 5.15.5"
not_impacted: "All versions before 2.16.0, all versions starting from 5.15.5"
solution: "Upgrade to version 5.15.5 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2025-64525"
- "https://github.com/advisories/GHSA-hr2q-hp5q-x767"
- "https://github.com/withastro/astro/security/advisories/GHSA-hr2q-hp5q-x767"
- "https://github.com/withastro/astro/commit/dafbb1ba29912099c4faff1440033edc768af8b4"
- "https://github.com/withastro/astro"
- "https://github.com/withastro/astro/blob/970ac0f51172e1e6bff4440516a851e725ac3097/packages/astro/src/core/app/node.ts#L121"
- "https://github.com/withastro/astro/blob/970ac0f51172e1e6bff4440516a851e725ac3097/packages/astro/src/core/app/node.ts#L97"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L"
uuid: "36da1cee-c042-467a-a27d-5a8d04e2e8a4"
cwe_ids:
- "CWE-918"
- "CWE-937"
- "CWE-1035"
