---
identifier: "CVE-2024-40631"
identifiers:
- "CVE-2024-40631"
- "GHSA-h3pq-667x-r789"
package_slug: "npm/@udecode/plate-media"
title: "Plate media plugins has a XSS in media embed element when using custom URL
  parsers"
description: "Editors that use `MediaEmbedElement` and pass custom `urlParsers` to
  the `useMediaState` hook may be vulnerable to XSS if a custom parser allows `javascript:`,
  `data:` or `vbscript:` URLs to be embedded. Editors that do not use `urlParsers`
  and instead consume the `url` property directly may also be vulnerable if the URL
  is not sanitised.\n\nThe default parsers `parseTwitterUrl` and `parseVideoUrl` are
  not affected.\n\nExamples of vulnerable code:\n\n```tsx\nconst { embed } = useMediaState({\nurlParsers:
  [\n// Custom parser that does not use an allowlist or validate the URL protocol\n(url)
  => ({ url }),\n],\n});\n\nreturn (\n<iframe\nsrc={embed!.url}\n// ...\n/>\n);\n```\n\n```tsx\nconst
  { url } = useMediaState();\n\nreturn (\n<iframe\n// url property used directly from
  useMediaState() with no sanitisation\nsrc={url}\n// ...\n/>\n);\n```\n\n\n```tsx\nconst
  { url } = element;\n\nreturn (\n<iframe\n// url property used directly from element
  with no sanitisation\nsrc={url}\n// ...\n/>\n);\n```"
date: "2024-07-15"
pubdate: "2024-07-15"
affected_range: "<36.0.10"
fixed_versions:
- "36.0.10"
affected_versions: "All versions before 36.0.10"
not_impacted: "All versions starting from 36.0.10"
solution: "Upgrade to version 36.0.10 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-40631"
- "https://github.com/advisories/GHSA-h3pq-667x-r789"
- "https://github.com/udecode/plate/security/advisories/GHSA-h3pq-667x-r789"
- "https://github.com/udecode/plate/commit/1bc0971774fbfb770780c9bdb94746a6f0f196a0"
- "https://github.com/udecode/plate"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N"
uuid: "7740a7f8-9839-45b7-a184-8ba2bbc7ac46"
cwe_ids:
- "CWE-79"
- "CWE-937"
- "CWE-1035"
