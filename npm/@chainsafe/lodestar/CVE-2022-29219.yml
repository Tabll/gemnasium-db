---
identifier: "CVE-2022-29219"
identifiers:
- "GHSA-cvj7-5f3c-9vg9"
- "CVE-2022-29219"
package_slug: "npm/@chainsafe/lodestar"
title: "Integer Overflow or Wraparound"
description: "Lodestar is a TypeScript implementation of the Ethereum Consensus specification.
  Prior to version 0.36.0, there is a possible consensus split given maliciously-crafted
  `AttesterSlashing` or `ProposerSlashing` being included on-chain. Because the developers
  represent `uint64` values as native javascript `number`s, there is an issue when
  those variables with large (greater than 2^53) `uint64` values are included on chain.
  In those cases, Lodestar may view valid_`AttesterSlashing` or `ProposerSlashing`
  as invalid, due to rounding errors in large `number` values. This causes a consensus
  split, where Lodestar nodes are forked away from the main network. Similarly, Lodestar
  may consider invalid `ProposerSlashing` as valid, thus including in proposed blocks
  that will be considered invalid by the network. Version 0.36.0 contains a fix for
  this issue. As a workaround, use `BigInt` to represent `Slot` and `Epoch` values
  in `AttesterSlashing` and `ProposerSlashing` objects. `BigInt` is too slow to be
  used in all `Slot` and `Epoch` cases, so one may carefully use `BigInt` just where
  necessary for consensus."
date: "2022-05-24"
pubdate: "2022-05-24"
affected_range: "<0.36.0"
fixed_versions:
- "0.36.0"
affected_versions: "All versions before 0.36.0"
not_impacted: "All versions starting from 0.36.0"
solution: "Upgrade to version 0.36.0 or above."
urls:
- "https://github.com/ChainSafe/lodestar/security/advisories/GHSA-cvj7-5f3c-9vg9"
- "https://nvd.nist.gov/vuln/detail/CVE-2022-29219"
- "https://github.com/ChainSafe/lodestar/pull/3977"
- "https://github.com/advisories/GHSA-cvj7-5f3c-9vg9"
uuid: "b6c101bb-3c6d-41cb-a02a-9ac036b35897"
cwe_ids:
- "CWE-1035"
- "CWE-190"
- "CWE-937"
cvss_v2: "AV:N/AC:L/Au:N/C:N/I:P/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N"
