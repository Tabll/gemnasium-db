---
identifier: "CVE-2023-36472"
identifiers:
- "GHSA-v8gg-4mq2-88q4"
- "CVE-2023-36472"
package_slug: "npm/@strapi/utils"
title: "Strapi may leak sensitive user information, user reset password, tokens via
  content-manager views"
description: "### Summary\nI can get access to user reset password tokens if I have
  the configure view permissions\n
  ![b37a6fd9eae06027e7d91266f1908a3d](https://user-images.githubusercontent.com/34578426/246782921-fbc007d3-ffec-45de-a1f1-a4287cd507ac.png)\n![6c1da5b3bfbb3bca97c8d064be0ecb05](https://user-images.githubusercontent.com/34578426/246783044-7d716dde-6f27-4d01-9521-42720c6ce92e.gif)
  \n\n###
  Details\n/content-manager/relations route does not remove private fields or ensure
  that they can't be selected\n\n### PoC\nInstall fresh strapi instance\nstart up
  strapi and create an account\ncreate a new content-type\ngive the content-type a
  relation with admin users and save\ngo to Admin panel roles Author and then plugins.\nEnable
  for content-manager collection types the configure view\nIn the collection time
  now only give them access to the collection you created for this.\nCreate a new
  admin user account with the Author role\nLog out and request a password reset for
  the main admin user.\nLogin on the newly created account\ngo to the collection type
  you created for this test and click the create new entry button,\nclick in the create
  new entry view on configure view.\nselect the admin user relation we created click
  on resetPasswordToken\nNow go back to the create an entry view and when selection
  the relation we created we now see the reset tokken\n\n### Impact\nImpact is that
  the none admin user now has the reset token of the admin users account and can resets
  its password using that to escalate his privilege's\n\nStill you need the configure
  view permission to be able to escalate your privilege's "
date: "2023-09-13"
pubdate: "2023-09-13"
affected_range: "<4.11.7"
fixed_versions:
- "4.11.7"
affected_versions: "All versions before 4.11.7"
not_impacted: "All versions starting from 4.11.7"
solution: "Upgrade to version 4.11.7 or above."
urls:
- "https://github.com/strapi/strapi/security/advisories/GHSA-v8gg-4mq2-88q4"
- "https://github.com/strapi/strapi/releases/tag/v4.11.7"
- "https://github.com/advisories/GHSA-v8gg-4mq2-88q4"
uuid: "d608d1c2-8d79-42ec-95de-cdb165bcf698"
cwe_ids:
- "CWE-1035"
- "CWE-937"
