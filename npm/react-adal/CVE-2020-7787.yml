---
identifier: "CVE-2020-7787"
package_slug: "npm/react-adal"
title: "Improper Authentication"
description: "It is possible for a specially crafted JWT token and request URL can
  cause the nonce, session and refresh values to be incorrectly validated, causing
  the application to treat an attacker-generated JWT token as authentic. The logical
  defect is caused by how the nonce, session and refresh values are stored in the
  browser local storage or session storage. Each key is automatically appended by
  `||`. When the received nonce and session keys are generated, the list of values
  is stored in the browser storage, separated by `||`, with `||` always appended to
  the end of the list. Since `||` will always be the last 2 characters of the stored
  values, an empty string (\"\") will always be in the list of the valid values. Therefore,
  if an empty session parameter is provided in the callback URL, and a specially-crafted
  JWT token contains an nonce value of \"\" (empty string), then `adal.js` will consider
  the JWT token as authentic."
date: "2020-12-11"
pubdate: "2020-12-09"
affected_range: ">=0"
fixed_versions: []
affected_versions: "All versions"
not_impacted: ""
solution: "Unfortunately, there is no solution available yet."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2020-7787"
cvss_v2: "AV:N/AC:L/Au:N/C:N/I:P/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N"
uuid: "a22b57a7-c573-4ca9-b287-ef4ecf947275"
cwe_ids:
- "CWE-1035"
- "CWE-287"
- "CWE-937"
identifiers:
- "CVE-2020-7787"
