---
identifier: "CVE-2024-45389"
identifiers:
- "CVE-2024-45389"
- "GHSA-gprj-6m2f-j9hx"
package_slug: "npm/pagefind"
title: "DOM clobbering could escalate to Cross-site Scripting (XSS)"
description: "Pagefind initializes its dynamic JavaScript and WebAssembly files relative
  to the location of the first script you load. This information is gathered by looking
  up the value of `document.currentScript.src`.\n\nIt is possible to \"clobber\" this
  lookup with otherwise benign HTML on the page, for example:\n```html\n<img name=\"currentScript\"
  src=\"blob:https://xxx.xxx.xxx/ui.js\"></img>\n```\n\nThis will cause `document.currentScript.src`
  to resolve as an external domain, which will then be used by Pagefind to load dependencies.\n\nThis
  exploit would only work in the case that an attacker could inject HTML to your live,
  hosted, website. In these cases, this would act as a way to escalate the privilege
  available to an attacker. This assumes they have the ability to add some elements
  to the page (for example, `img` tags with a `name` attribute), but not others, as
  adding a `script` to the page would itself be the XSS vector.\n\nPagefind has tightened
  this resolution by ensuring the source is loaded from a valid script element. There
  are no reports of this being exploited in the wild via Pagefind."
date: "2024-09-03"
pubdate: "2024-09-03"
affected_range: "<1.1.1"
fixed_versions:
- "1.1.1"
affected_versions: "All versions before 1.1.1"
not_impacted: "All versions starting from 1.1.1"
solution: "Upgrade to version 1.1.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-45389"
- "https://github.com/advisories/GHSA-gprj-6m2f-j9hx"
- "https://github.com/CloudCannon/pagefind/security/advisories/GHSA-gprj-6m2f-j9hx"
- "https://github.com/webpack/webpack/security/advisories/GHSA-4vvj-4cpr-p986"
- "https://github.com/CloudCannon/pagefind/commit/14ec96864eabaf1d7d809d5da0186a8856261eeb"
- "https://github.com/CloudCannon/pagefind"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:H"
uuid: "7f1b4ee0-0faf-4bfb-9727-b0d8c4f4db2d"
cwe_ids:
- "CWE-79"
- "CWE-937"
- "CWE-1035"
