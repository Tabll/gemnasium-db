---
identifier: "GHSA-73rr-hh4g-fpgx"
identifiers:
- "GHSA-73rr-hh4g-fpgx"
package_slug: "npm/diff"
title: "jsdiff has a Denial of Service vulnerability in parsePatch and applyPatch"
description: "Attempting to parse a patch whose filename headers contain the line
  break characters `\\r`, `\\u2028`, or `\\u2029` can cause the `parsePatch` method
  to enter an infinite loop. It then consumes memory without limit until the process
  crashes due to running out of memory.\n\nApplications are therefore likely to be
  vulnerable to a denial-of-service attack if they call `parsePatch` with a user-provided
  patch as input. A large payload is not needed to trigger the vulnerability, so size
  limits on user input do not provide any protection. Furthermore, some applications
  may be vulnerable even when calling `parsePatch` on a patch generated by the application
  itself if the user is nonetheless able to control the filename headers (e.g. by
  directly providing the filenames of the files to be diffed).\n\nThe `applyPatch`
  method is similarly affected if (and only if) called with a string representation
  of a patch as an argument, since under the hood it parses that string using `parsePatch`.
  Other methods of the library are unaffected.\n\nFinally, a second and lesser bug
  - a ReDOS - also exhibits when those same line break characters are present in a
  patch's *patch* header (also known as its \"leading garbage\"). A maliciously-crafted
  patch header of length *n* can take `parsePatch` O(*n*Â³) time to parse."
date: "2026-01-14"
pubdate: "2026-01-14"
affected_range: "<8.0.3"
fixed_versions:
- "8.0.3"
affected_versions: "All versions before 8.0.3"
not_impacted: "All versions starting from 8.0.3"
solution: "Upgrade to version 8.0.3 or above."
urls:
- "https://github.com/advisories/GHSA-73rr-hh4g-fpgx"
- "https://github.com/kpdecker/jsdiff/security/advisories/GHSA-73rr-hh4g-fpgx"
- "https://github.com/kpdecker/jsdiff/pull/649"
- "https://github.com/kpdecker/jsdiff/commit/15a1585230748c8ae6f8274c202e0c87309142f5"
- "https://github.com/kpdecker/jsdiff"
uuid: "6da01e8b-12c8-4c52-b39f-f47a507ff6b2"
cwe_ids:
- "CWE-1333"
- "CWE-400"
- "CWE-937"
- "CWE-1035"
