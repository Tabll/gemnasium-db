---
identifier: "CVE-2022-36045"
identifiers:
- "CVE-2022-36045"
- "GHSA-p4cc-w597-6cpm"
- "GMS-2022-3787"
package_slug: "npm/nodebb"
title: "Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"
description: "NodeBB Forum Software is powered by Node.js and supports either Redis,
  MongoDB, or a PostgreSQL database. It utilizes web sockets for instant interactions
  and real-time notifications. `utils.generateUUID`, a helper function available in
  essentially all versions of NodeBB (as far back as v1.0.1 and potentially earlier)
  used a cryptographically insecure Pseudo-random number generator (`Math.random()`),
  which meant that a specially crafted script combined with multiple invocations of
  the password reset functionality could enable an attacker to correctly calculate
  the reset code for an account they do not have access to. This vulnerability impacts
  all installations of NodeBB. The vulnerability allows for an attacker to take over
  any account without the involvement of the victim, and as such, the remediation
  should be applied immediately (either via NodeBB upgrade or cherry-pick of the specific
  changeset. The vulnerability has been patched in version 2.x and 1.19.x. There is
  no known workaround, but the patch sets listed above will fully patch the vulnerability."
date: "2022-09-06"
pubdate: "2022-08-31"
affected_range: "<1.19.8||=2.0.0"
fixed_versions: []
affected_versions: "All versions before 1.19.8, version 2.0.0"
not_impacted: ""
solution: "Unfortunately, there is no solution available yet."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-36045"
- "https://github.com/NodeBB/NodeBB/commit/81e3c1ba488d03371a5ce8d0ebb5c5803026e0f9"
- "https://github.com/NodeBB/NodeBB/security/advisories/GHSA-p4cc-w597-6cpm"
- "https://github.com/NodeBB/NodeBB/commit/e802fab87f94a13f397f04cfe6068f2f7ddf7888"
- "https://github.com/advisories/GHSA-p4cc-w597-6cpm"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "12c50f96-5f27-48f4-aff8-32b6fca12cb2"
cwe_ids:
- "CWE-1035"
- "CWE-338"
- "CWE-937"
