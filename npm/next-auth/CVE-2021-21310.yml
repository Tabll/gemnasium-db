---
identifier: "CVE-2021-21310"
package_slug: "npm/next-auth"
title: "Authentication Bypass by Spoofing"
description: "In next-auth there is a token verification vulnerability. Implementations
  using the Prisma database adapter in conjunction with the Email provider are impacted.
  Implementations using the Email provider with the default database adapter are not
  impacted. Implementations using the Prisma database adapter but not using the Email
  provider are not impacted. The Prisma database adapter was checking the verification
  token, but was not verifying the email address associated with that token. This
  made it possible to use a valid token to sign in as another user when using the
  Prima adapter in conjunction with the Email provider."
date: "2021-02-19"
pubdate: "2021-02-11"
affected_range: "<3.3.0"
fixed_versions:
- "3.3.0"
affected_versions: "All versions before 3.3.0"
not_impacted: "All versions starting from 3.3.0"
solution: "Upgrade to version 3.3.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-21310"
cvss_v2: "AV:N/AC:M/Au:N/C:P/I:N/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N"
uuid: "1881b53c-d099-4299-82ff-c4f4688bdaab"
cwe_ids:
- "CWE-1035"
- "CWE-290"
- "CWE-937"
identifiers:
- "CVE-2021-21310"
- "GHSA-pg53-56cg-4m8q"
