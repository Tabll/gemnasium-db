---
identifier: "CVE-2022-31093"
identifiers:
- "CVE-2022-31093"
- "GHSA-g5fm-jp9v-2432"
- "GMS-2022-2609"
package_slug: "npm/next-auth"
title: "Improper Check for Unusual or Exceptional Conditions"
description: "NextAuth.js is a complete open source authentication solution for Next.js
  applications. In affected versions an attacker can send a request to an app using
  NextAuth.js with an invalid `callbackUrl` query parameter, which internally is converted
  to a `URL` object. The URL instantiation would fail due to a malformed URL being
  passed into the constructor, causing it to throw an unhandled error which led to
  the **API route handler timing out and logging in to fail**. This has been remedied
  in versions 3.29.5 and 4.5.0. If for some reason you cannot upgrade, the workaround
  requires you to rely on Advanced Initialization. Please see the documentation for
  more."
date: "2022-07-07"
pubdate: "2022-06-27"
affected_range: ">=3.0.0 <3.29.5||>=4.0.0 <4.5.0"
fixed_versions:
- "3.29.5"
- "4.5.0"
affected_versions: "All versions starting from 3.0.0 before 3.29.5, all versions starting
  from 4.0.0 before 4.5.0"
not_impacted: "All versions before 3.0.0, all versions starting from 3.29.5 before
  4.0.0, all versions starting from 4.5.0"
solution: "Upgrade to versions 3.29.5, 4.5.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-31093"
- "https://github.com/nextauthjs/next-auth/commit/25517b73153332d948114bacdff3b5908de91d85"
- "https://github.com/nextauthjs/next-auth/commit/e498483b23273d1bfc81be68339607f88d411bd6"
- "https://next-auth.js.org/configuration/initialization#advanced-initialization"
- "https://github.com/nextauthjs/next-auth/security/advisories/GHSA-g5fm-jp9v-2432"
- "https://github.com/advisories/GHSA-g5fm-jp9v-2432"
cvss_v2: "AV:N/AC:L/Au:N/C:N/I:N/A:P"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
uuid: "108d507c-1828-49a5-8e53-0f8d1dc89032"
cwe_ids:
- "CWE-1035"
- "CWE-754"
- "CWE-937"
