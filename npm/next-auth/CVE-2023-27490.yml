---
identifier: "CVE-2023-27490"
identifiers:
- "CVE-2023-27490"
- "GHSA-7r7x-4c4q-c4qf"
package_slug: "npm/next-auth"
title: "Session Fixation"
description: "NextAuth.js is an open source authentication solution for Next.js applications.
  `next-auth` applications using OAuth provider versions before `v4.20.1` have been
  found to be subject to an authentication vulnerability. A bad actor who can read
  traffic on the victim's network or who is able to social engineer the victim to
  click a manipulated login link could intercept and tamper with the authorization
  URL to **log in as the victim**, bypassing the CSRF protection. This is due to a
  partial failure during a compromised OAuth session where a session code is erroneously
  generated. This issue has been addressed in version 4.20.1. Users are advised to
  upgrade. Users unable to upgrade may using Advanced Initialization, manually check
  the callback request for state, pkce, and nonce against the provider configuration
  to prevent this issue. See the linked GHSA for details."
date: "2023-04-20"
pubdate: "2023-03-09"
affected_range: "<4.20.1"
fixed_versions:
- "4.20.1"
affected_versions: "All versions before 4.20.1"
not_impacted: "All versions starting from 4.20.1"
solution: "Upgrade to version 4.20.1 or above."
urls:
- "https://github.com/nextauthjs/next-auth/security/advisories/GHSA-7r7x-4c4q-c4qf"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-27490"
- "https://authjs.dev/reference/core/providers#checks"
- "https://danielfett.de/2020/05/16/pkce-vs-nonce-equivalent-or-not/"
- "https://github.com/nextauthjs/next-auth/compare/next-auth@4.20.0...next-auth@4.20.1#diff-cf9257195d0cb6a835ae4ff1fc73fe2cac0bab847efb0832c1f551209a972b47R55"
- "https://next-auth.js.org/configuration/initialization#advanced-initialization"
- "https://next-auth.js.org/configuration/providers/oauth"
- "https://www.rfc-editor.org/rfc/rfc6749#section-10.12"
- "https://github.com/advisories/GHSA-7r7x-4c4q-c4qf"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H"
uuid: "927af0aa-ebae-425e-9589-ceee45a65af8"
cwe_ids:
- "CWE-1035"
- "CWE-352"
- "CWE-937"
