---
identifier: "CVE-2022-35924"
identifiers:
- "CVE-2022-35924"
- "GHSA-xv97-c62v-4587"
package_slug: "npm/next-auth"
title: "Improper Input Validation"
description: "NextAuth.js is a complete open source authentication solution for Next.js
  applications. `next-auth` users who are using the `EmailProvider` either in versions
  before `4.10.3` or `3.29.10` are affected. If an attacker could forge a request
  that sent a comma-separated list of emails (eg.: `attacker@attacker.com,victim@victim.com`)
  to the sign-in endpoint, NextAuth.js would send emails to both the attacker and
  the victim's e-mail addresses. The attacker could then login as a newly created
  user with the email being `attacker@attacker.com,victim@victim.com`. This means
  that basic authorization like `email.endsWith(\"@victim.com\")` in the `signIn`
  callback would fail to communicate a threat to the developer and would let the attacker
  bypass authorization, even with an `@attacker.com` address. This vulnerability has
  been patched in `v4.10.3` and `v3.29.10` by normalizing the email value that is
  sent to the sign-in endpoint before accessing it anywhere else. We also added a
  `normalizeIdentifier` callback on the `EmailProvider` configuration, where you can
  further tweak your requirements for what your system considers a valid e-mail address.
  (E.g.: strict RFC2821 compliance). Users are advised to upgrade. There are no known
  workarounds for this vulnerability. If for some reason you cannot upgrade, you can
  normalize the incoming request using Advanced Initialization."
date: "2022-08-10"
pubdate: "2022-08-02"
affected_range: "<3.29.10||>=4.0.0 <4.10.3"
fixed_versions:
- "3.29.10"
- "4.10.3"
affected_versions: "All versions before 3.29.10, all versions starting from 4.0.0
  before 4.10.3"
not_impacted: "All versions starting from 3.29.10 before 4.0.0, all versions starting
  from 4.10.3"
solution: "Upgrade to versions 3.29.10, 4.10.3 or above."
urls:
- "https://github.com/nextauthjs/next-auth/security/advisories/GHSA-xv97-c62v-4587"
- "https://github.com/nextauthjs/next-auth/commit/afb1fcdae3cc30445038ef588e491d139b916003"
- "https://github.com/advisories/GHSA-xv97-c62v-4587"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N"
uuid: "b3253ba9-0e8e-47a3-97dd-e94fd3878f52"
cwe_ids:
- "CWE-1035"
- "CWE-863"
- "CWE-937"
