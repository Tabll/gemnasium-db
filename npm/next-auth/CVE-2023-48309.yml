---
identifier: "CVE-2023-48309"
identifiers:
- "GHSA-v64w-49xw-qq89"
- "CVE-2023-48309"
package_slug: "npm/next-auth"
title: "Possible user mocking that bypasses basic authentication"
description: "NextAuth.js provides authentication for Next.js. `next-auth` applications
  prior to version 4.24.5 that rely on the default Middleware authorization are affected
  by a vulnerability. A bad actor could create an empty/mock user, by getting hold
  of a NextAuth.js-issued JWT from an interrupted OAuth sign-in flow (state, PKCE
  or nonce). Manually overriding the `next-auth.session-token` cookie value with this
  non-related JWT would let the user simulate a logged in user, albeit having no user
  information associated with it. (The only property on this user is an opaque randomly
  generated string). This vulnerability does not give access to other users' data,
  neither to resources that require proper authorization via scopes or other means.
  The created mock user has no information associated with it (ie. no name, email,
  access_token, etc.) This vulnerability can be exploited by bad actors to peek at
  logged in user states (e.g. dashboard layout). `next-auth` `v4.24.5` contains a
  patch for the vulnerability. As a workaround, using a custom authorization callback
  for Middleware, developers can manually do a basic authentication."
date: "2023-11-25"
pubdate: "2023-11-20"
affected_range: "<4.24.5"
fixed_versions:
- "4.24.5"
affected_versions: "All versions before 4.24.5"
not_impacted: "All versions starting from 4.24.5"
solution: "Upgrade to version 4.24.5 or above."
urls:
- "https://github.com/nextauthjs/next-auth/security/advisories/GHSA-v64w-49xw-qq89"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-48309"
- "https://github.com/nextauthjs/next-auth/commit/d237059b6d0cb868c041ba18b698e0cee20a2f10"
- "https://authjs.dev/guides/basics/role-based-access-control"
- "https://next-auth.js.org/configuration/nextjs#advanced-usage"
- "https://next-auth.js.org/configuration/nextjs#middlewar"
- "https://github.com/advisories/GHSA-v64w-49xw-qq89"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N"
uuid: "0879b8cf-c3e9-41b2-84a0-9ca1fc9fff1b"
cwe_ids:
- "CWE-1035"
- "CWE-285"
- "CWE-937"
