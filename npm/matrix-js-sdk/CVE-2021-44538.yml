---
identifier: "CVE-2021-44538"
identifiers:
- "CVE-2021-44538"
package_slug: "npm/matrix-js-sdk"
title: "Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')"
description: "The olm_session_describe function in Matrix libolm is vulnerable to
  a buffer overflow. The Olm session object represents a cryptographic channel between
  two parties. Therefore, its state is partially controllable by the remote party
  of the channel. Attackers can construct a crafted sequence of messages to manipulate
  the state of the receiver's session in such a way that, for some buffer sizes, a
  buffer overflow happens on a call to olm_session_describe. Furthermore, safe buffer
  sizes were undocumented. The overflow content is partially controllable by the attacker
  and limited to ASCII spaces and digits. The known affected products are Element
  Web And SchildiChat Web."
date: "2022-01-04"
pubdate: "2021-12-14"
affected_range: ">=2.4.2 <15.2.1"
fixed_versions:
- "15.2.1"
affected_versions: "All versions starting from 2.4.2 before 15.2.1"
not_impacted: "All versions before 2.4.2, all versions starting from 15.2.1"
solution: "Upgrade to version 15.2.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-44538"
- "https://matrix.org/blog/2021/12/13/disclosure-buffer-overflow-in-libolm-and-matrix-js-sdk"
- "https://gitlab.matrix.org/matrix-org/olm/-/tags"
cvss_v2: "AV:N/AC:L/Au:N/C:P/I:P/A:P"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "822d0d5a-5f8d-498f-bf5a-7f2fa04f940e"
cwe_ids:
- "CWE-1035"
- "CWE-120"
- "CWE-937"
