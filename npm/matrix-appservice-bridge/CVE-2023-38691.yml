---
identifier: "CVE-2023-38691"
identifiers:
- "CVE-2023-38691"
- "GHSA-vc7j-h8xg-fv5x"
package_slug: "npm/matrix-appservice-bridge"
title: "Improper Authentication"
description: "matrix-appservice-bridge provides an API for setting up bridges. Starting
  in version 4.0.0 and prior to versions 8.1.2 and 9.0.1, a malicious Matrix server
  can use a foreign user's MXID in an OpenID exchange, allowing a bad actor to impersonate
  users when using the provisioning API. The library does not check that the servername
  part of the `sub` parameter (containing the user's *claimed* MXID) is the the same
  as the servername we are talking to. A malicious actor could spin up a server on
  any given domain, respond with a `sub` parameter according to the user they want
  to act as and use the resulting token to perform provisioning requests. Versions
  8.1.2 and 9.0.1 contain a patch. As a workaround, disable the provisioning API."
date: "2023-08-11"
pubdate: "2023-08-04"
affected_range: ">=4.0.0 <8.1.2||=9.0.0"
fixed_versions:
- "8.1.2"
- "9.0.1"
affected_versions: "All versions starting from 4.0.0 before 8.1.2, version 9.0.0"
not_impacted: "All versions before 4.0.0, all versions starting from 8.1.2 before
  9.0.0, all versions after 9.0.0"
solution: "Upgrade to versions 8.1.2, 9.0.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-38691"
- "https://github.com/matrix-org/matrix-appservice-bridge/commit/4c6723a5e7beda65cdf1ae5dbb882e8beaac8552"
- "https://github.com/matrix-org/matrix-appservice-bridge/security/advisories/GHSA-vc7j-h8xg-fv5x"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"
uuid: "4f40402a-2ccb-4722-b71c-3be5d2cb971c"
cwe_ids:
- "CWE-1035"
- "CWE-287"
- "CWE-937"
