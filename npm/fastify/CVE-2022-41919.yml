---
identifier: "CVE-2022-41919"
identifiers:
- "CVE-2022-41919"
- "GHSA-3fjj-p79j-c9hh"
- "GMS-2022-6953"
package_slug: "npm/fastify"
title: "Cross-Site Request Forgery (CSRF)"
description: "Fastify is a web framework with minimal overhead and plugin architecture.
  The attacker can use the incorrect `Content-Type` to bypass the `Pre-Flight` checking
  of `fetch`. `fetch()` requests with Content-Typeâ€™s essence as \"application/x-www-form-urlencoded\",
  \"multipart/form-data\", or \"text/plain\", could potentially be used to invoke
  routes that only accepts `application/json` content type, thus bypassing any CORS
  protection, and therefore they could lead to a Cross-Site Request Forgery attack.
  This issue has been patched in version 4.10.2 and 3.29.4. As a workaround, implement
  Cross-Site Request Forgery protection using `@fastify/csrf'."
date: "2023-11-07"
pubdate: "2022-11-22"
affected_range: ">=3.0.0 <3.29.4||>=4.0.0 <4.10.2"
fixed_versions:
- "3.29.4"
- "4.10.2"
affected_versions: "All versions starting from 3.0.0 before 3.29.4, all versions starting
  from 4.0.0 before 4.10.2"
not_impacted: "All versions before 3.0.0, all versions starting from 3.29.4 before
  4.0.0, all versions starting from 4.10.2"
solution: "Upgrade to versions 3.29.4, 4.10.2 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-41919"
- "https://github.com/fastify/fastify/commit/62dde76f1f7aca76e38625fe8d983761f26e6fc9"
- "https://www.npmjs.com/package/@fastify/csrf"
- "https://github.com/fastify/fastify/security/advisories/GHSA-3fjj-p79j-c9hh"
- "https://github.com/advisories/GHSA-3fjj-p79j-c9hh"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H"
uuid: "665c3ec4-0a5f-4a96-828f-eed41ee6690d"
cwe_ids:
- "CWE-1035"
- "CWE-352"
- "CWE-937"
