---
identifier: "CVE-2023-29017"
identifiers:
- "CVE-2023-29017"
- "GHSA-7jxr-cg7f-gpgv"
package_slug: "npm/vm2"
title: "Improper Control of Dynamically-Managed Code Resources"
description: "vm2 is a sandbox that can run untrusted code with allow listed Node's
  built-in modules. Prior to version 3.9.15, vm2 was not properly handling host objects
  passed to `Error.prepareStackTrace` in case of unhandled async errors. A threat
  actor could bypass the sandbox protections to gain remote code execution rights
  on the host running the sandbox. This vulnerability was patched in the release of
  version 3.9.15 of vm2. There are no known workarounds."
date: "2023-04-13"
pubdate: "2023-04-06"
affected_range: "<3.9.15"
fixed_versions:
- "3.9.15"
affected_versions: "All versions before 3.9.15"
not_impacted: "All versions starting from 3.9.15"
solution: "Upgrade to version 3.9.15 or above."
urls:
- "https://github.com/patriksimek/vm2/security/advisories/GHSA-7jxr-cg7f-gpgv"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-29017"
- "https://github.com/patriksimek/vm2/issues/515"
- "https://github.com/patriksimek/vm2/commit/d534e5785f38307b70d3aac1945260a261a94d50"
- "https://gist.github.com/seongil-wi/2a44e082001b959bfe304b62121fb76d"
- "https://github.com/advisories/GHSA-7jxr-cg7f-gpgv"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "ad41a3dc-766f-435f-8ff2-cf3e16e4815a"
cwe_ids:
- "CWE-1035"
- "CWE-913"
- "CWE-937"
