---
identifier: "CVE-2024-24828"
identifiers:
- "GHSA-22r3-9w55-cj54"
- "CVE-2024-24828"
package_slug: "npm/pkg"
title: "Incorrect Default Permissions"
description: "pkg is tool design to bundle Node.js projects into an executables. Any
  native code packages built by `pkg` are written to a hardcoded directory. On unix
  systems, this is `/tmp/pkg/*` which is a shared directory for all users on the same
  local system. There is no uniqueness to the package names within this directory,
  they are predictable. An attacker who has access to the same local system has the
  ability to replace the genuine executables in the shared directory with malicious
  executables of the same name. A user may then run the malicious executable without
  realising it has been modified. This package is deprecated. Therefore, there will
  not be a patch provided for this vulnerability. To check if your executable build
  by pkg depends on native code and is vulnerable, run the executable and check if
  `/tmp/pkg/` was created. Users should transition to actively maintained alternatives.
  We would recommend investigating Node.js 21â€™s support for single executable applications.
  Given the decision to deprecate the pkg package, there are no official workarounds
  or remediations provided by our team. Users should prioritize migrating to other
  packages that offer similar functionality with enhanced security."
date: "2024-02-09"
pubdate: "2024-02-09"
affected_range: "<=5.8.1"
fixed_versions: []
affected_versions: "All versions up to 5.8.1"
not_impacted: ""
solution: "Unfortunately, there is no solution available yet."
urls:
- "https://github.com/vercel/pkg/security/advisories/GHSA-22r3-9w55-cj54"
- "https://github.com/advisories/GHSA-22r3-9w55-cj54"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N"
uuid: "343a02b9-e643-42eb-be4b-c055090800ee"
cwe_ids:
- "CWE-1035"
- "CWE-276"
- "CWE-78"
- "CWE-937"
