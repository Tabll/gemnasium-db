---
identifier: "CVE-2023-40178"
identifiers:
- "GHSA-vx8m-6fhw-pccw"
- "CVE-2023-40178"
package_slug: "npm/@node-saml/node-saml"
title: "@node-saml/node-saml's validatePostRequestAsync does not include checkTimestampsValidityError"
description: "### Summary\n\nThe lack of checking of current timestamp allows a LogoutRequest
  XML to be reused multiple times even when the current time is past the NotOnOrAfter.
  \n\n### Details\n\nIt was noticed that in the validatePostRequestAsync() flow in
  saml.js, the current timestamp is never checked. This could present a vulnerability
  where a user who has an XML LogoutRequest could validated it if the IssueInstance
  and the NotOnOrAfter are valid along with valid credentials (signature, certificate
  etc.). \n\n### PoC\n\nI was able to validate a sample valid LogoutRequest XML multiple
  times through postman by sending it to my endpoint regardless if the current present
  time was past the NotOnOrAfter time. After some further testing, it seems that only
  the IssueInstance is checked against NotOnOrAfter. Not sure if this was the intended
  behaviour but I believe having a never expiring valid LogoutRequest could be dangerous.\n\n###
  Impact\n\nThis could impact the user where they would be logged out from an expired
  LogoutRequest. In bigger contexts, if LogoutRequests are sent out in mass to different
  SPs, this could impact many users on a large scale.\n"
date: "2023-08-21"
pubdate: "2023-08-21"
affected_range: "<4.0.5"
fixed_versions:
- "4.0.5"
affected_versions: "All versions before 4.0.5"
not_impacted: "All versions starting from 4.0.5"
solution: "Upgrade to version 4.0.5 or above."
urls:
- "https://github.com/node-saml/node-saml/security/advisories/GHSA-vx8m-6fhw-pccw"
- "https://github.com/node-saml/node-saml/commit/045e3b9c54211fdb95f96edf363679845b195cec"
- "https://github.com/node-saml/node-saml/releases/tag/v4.0.5"
- "https://github.com/advisories/GHSA-vx8m-6fhw-pccw"
uuid: "2cf30259-7dd0-4af4-b1ea-ce160fd4bd9d"
cwe_ids:
- "CWE-1035"
- "CWE-937"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L"
