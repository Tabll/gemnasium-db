---
identifier: "CVE-2023-49799"
identifiers:
- "GHSA-3wfp-253j-5jxv"
- "CVE-2023-49799"
package_slug: "npm/nuxt-api-party"
title: "Server-Side Request Forgery (SSRF)"
description: "`nuxt-api-party` is an open source module to proxy API requests. nuxt-api-party
  attempts to check if the user has passed an absolute URL to prevent the aforementioned
  attack. This has been recently changed to use the regular expression `^https?://`,
  however this regular expression can be bypassed by an absolute URL with leading
  whitespace. For example `\\nhttps://whatever.com` which has a leading newline. According
  to the fetch specification, before a fetch is made the URL is normalized. \"To normalize
  a byte sequence potentialValue, remove any leading and trailing HTTP whitespace
  bytes from potentialValue.\". This means the final request will be normalized to
  `https://whatever.com` bypassing the check and nuxt-api-party will send a request
  outside of the allow list. This could allow us to leak credentials or perform Server-Side
  Request Forgery (SSRF). This vulnerability has been addressed in version 0.22.1.
  Users are advised to upgrade. Users unable to upgrade should revert to the previous
  method of detecting absolute URLs."
date: "2023-12-12"
pubdate: "2023-12-12"
affected_range: "<0.22.0"
fixed_versions:
- "0.22.0"
affected_versions: "All versions before 0.22.0"
not_impacted: "All versions starting from 0.22.0"
solution: "Upgrade to version 0.22.0 or above."
urls:
- "https://github.com/johannschopplich/nuxt-api-party/security/advisories/GHSA-3wfp-253j-5jxv"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-49799"
- "https://github.com/johannschopplich/nuxt-api-party/commit/72762a200fc19d997a0f84bce578c28698dc5270"
- "https://fetch.spec.whatwg.org/"
- "https://fetch.spec.whatwg.org/#http-whitespace-byte"
- "https://github.com/johannschopplich/nuxt-api-party/blob/777462e1e3af1d9f8938aa33f230cd8cb6e0cc9a/src/runtime/server/handler.ts#L31"
- "https://infra.spec.whatwg.org/#byte-sequence"
- "https://github.com/advisories/GHSA-3wfp-253j-5jxv"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"
uuid: "e6389e8a-87e1-49ae-b481-83af26ca0739"
cwe_ids:
- "CWE-1035"
- "CWE-918"
- "CWE-937"
