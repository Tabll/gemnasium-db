---
identifier: "CVE-2023-40027"
identifiers:
- "CVE-2023-40027"
- "GHSA-9cvc-v7wm-992c"
package_slug: "npm/keystone"
title: "Missing Authorization"
description: "Keystone is an open source headless CMS for Node.js â€” built with GraphQL
  and React. When `ui.isAccessAllowed` is set as `undefined`, the `adminMeta` GraphQL
  query is publicly accessible (no session required). This is different to the behaviour
  of the default AdminUI middleware, which by default will only be publicly accessible
  (no session required) if a `session` strategy is not defined. This vulnerability
  does not affect developers using the `@keystone-6/auth` package, or any users that
  have written their own `ui.isAccessAllowed` (that is to say, `isAccessAllowed` is
  not `undefined`). This vulnerability does affect users who believed that their `session`
  strategy will, by default, enforce that `adminMeta` is inaccessible by the public
  in accordance with that strategy; akin to the behaviour of the AdminUI middleware.
  This vulnerability has been patched in `@keystone-6/core` version `5.5.1`. Users
  are advised to upgrade. Users unable to upgrade may opt to write their own `isAccessAllowed`
  functionality to work-around this vulnerability."
date: "2023-08-23"
pubdate: "2023-08-15"
affected_range: "<5.5.1"
fixed_versions:
- "5.5.1"
affected_versions: "All versions before 5.5.1"
not_impacted: "All versions starting from 5.5.1"
solution: "Upgrade to version 5.5.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-40027"
- "https://github.com/keystonejs/keystone/pull/8771"
- "https://github.com/keystonejs/keystone/commit/650e27e6e9b42abfb94c340c8470faf61f0ff284"
- "https://github.com/keystonejs/keystone/security/advisories/GHSA-9cvc-v7wm-992c"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N"
uuid: "d6ab74b4-e4cf-4cdb-a222-9cf063d6cb1e"
cwe_ids:
- "CWE-1035"
- "CWE-862"
- "CWE-937"
