---
identifier: "CVE-2025-69211"
identifiers:
- "CVE-2025-69211"
- "GHSA-8wpr-639p-ccrj"
package_slug: "npm/@nestjs/platform-fastify"
title: "Nest has a Fastify URL Encoding Middleware Bypass (TOCTOU)"
description: "A NestJS application is vulnerable if it meets all of the following
  criteria:\n\n1. Platform: Uses `@nestjs/platform-fastify`.\n2. Security Mechanism:
  Relies on `NestMiddleware` (via `MiddlewareConsumer`) for security checks (authentication,
  authorization, etc.), or through `app.use()`\n3. Routing: Applies middleware to
  specific routes using string paths or controllers (e.g., `.forRoutes('admin')`).\nExample
  Vulnerable Config:\n\n```ts\n// app.module.ts\nexport class AppModule implements
  NestModule {\nconfigure(consumer: MiddlewareConsumer) {\nconsumer\n.apply(AuthMiddleware)
  // Security check\n.forRoutes('admin');   // Vulnerable: Path-based restriction\n}\n}\n```\n\nAttack
  Vector:\n\n- Target Route: `/admin`\n- Middleware Path: `admin`\n- Attack Request:
  `GET /%61dmin`\n- Result: Middleware is skipped (no match on `%61dmin`), but controller
  for `/admin` is executed.\n\nConsequences:\n\n- Authentication Bypass: Unauthenticated
  users can access protected routes.\n- Authorization Bypass: Restricted administrative
  endpoints become accessible to lower-privileged users.\n- Input Validation Bypass:
  Middleware performing sanitization or validation can be skipped."
date: "2025-12-30"
pubdate: "2025-12-30"
affected_range: "<11.1.11"
fixed_versions:
- "11.1.11"
affected_versions: "All versions before 11.1.11"
not_impacted: "All versions starting from 11.1.11"
solution: "Upgrade to version 11.1.11 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2025-69211"
- "https://github.com/advisories/GHSA-8wpr-639p-ccrj"
- "https://github.com/nestjs/nest/security/advisories/GHSA-8wpr-639p-ccrj"
- "https://github.com/nestjs/nest/commit/c4cedda15a05aafec1e6045b36b0335ab850e771"
- "https://github.com/nestjs/nest"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N"
cvss_v4: "CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N"
uuid: "e9ddf9c2-a2c3-4d08-ab72-3d9de91d9201"
cwe_ids:
- "CWE-367"
- "CWE-937"
- "CWE-1035"
