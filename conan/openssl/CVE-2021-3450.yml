---
identifier: "CVE-2021-3450"
package_slug: "conan/openssl"
title: "Improper Certificate Validation"
description: "The `X509_V_FLAG_X509_STRICT` flag enables additional security checks
  of the certificates present in a certificate chain. An error in the implementation
  of this check meant that the result of a previous check to confirm that certificates
  in the chain are valid CA certificates was overwritten. This effectively bypasses
  the check that non-CA certificates must not be able to issue other certificates.
  If a `purpose` has been configured then there is a subsequent opportunity for checks
  that the certificate is a valid CA. All of the named `purpose` values implemented
  in libcrypto perform this check. Therefore, where a purpose is set the certificate
  chain will still be rejected even when the strict flag has been used. A `purpose`
  is set by default in libssl client and server certificate verification routines,
  but it can be overridden or removed by an application. In order to be affected,
  an application must explicitly set the `X509_V_FLAG_X509_STRICT` verification flag
  and either not set a `purpose` for the certificate verification or, in the case
  of TLS client or server applications, override the default `purpose`."
date: "2021-07-20"
pubdate: "2021-03-25"
affected_range: ">=1.1.1h <1.1.1k"
fixed_versions:
- "1.1.1k"
affected_versions: "All versions starting from 1.1.1h before 1.1.1k"
not_impacted: "All versions before 1.1.1h, all versions starting from 1.1.1k"
solution: "Upgrade to version 1.1.1k or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-3450"
- "https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=2a40b7bc7b94dd7de897a74571e7024f0cf0d63b"
- "https://www.openssl.org/news/secadv/20210325.txt"
cvss_v2: "AV:N/AC:M/Au:N/C:P/I:P/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N"
uuid: "825f6fc7-d399-49bb-a3aa-9308f2bdb7c1"
cwe_ids:
- "CWE-1035"
- "CWE-295"
- "CWE-937"
