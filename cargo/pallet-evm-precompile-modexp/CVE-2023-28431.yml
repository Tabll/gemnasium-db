---
identifier: "CVE-2023-28431"
identifiers:
- "CVE-2023-28431"
- "GHSA-fcmm-54jp-7vf6"
package_slug: "cargo/pallet-evm-precompile-modexp"
title: "Frontier's modexp precompile is slow for even modulus"
description: "Frontier's `modexp` precompile uses `num-bigint` crate under the hood.
  [In the implementation](https://github.com/rust-num/num-bigint/blob/6f2b8e0fc218dbd0f49bebb8db2d1a771fe6bafa/src/biguint/power.rs#L134),
  the cases for modulus being even and modulus being odd are treated separately. Odd
  modulus uses the fast Montgomery multiplication, and even modulus uses the slow
  plain power algorithm. This gas cost discrepancy was not accounted for in the `modexp`
  precompile, leading to possible denial of service attacks."
date: "2024-10-24"
pubdate: "2023-03-21"
affected_range: "<=1.0.0"
fixed_versions: []
affected_versions: "All versions up to 1.0.0"
not_impacted: ""
solution: "Unfortunately, there is no solution available yet."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-28431"
- "https://github.com/advisories/GHSA-fcmm-54jp-7vf6"
- "https://github.com/paritytech/frontier/security/advisories/GHSA-fcmm-54jp-7vf6"
- "https://github.com/paritytech/frontier/pull/1017"
- "https://github.com/paritytech/frontier/commit/5af12e94d7dfc8a0208a290643a800f55de7b219"
- "https://github.com/polkadot-evm/frontier"
- "https://github.com/rust-num/num-bigint/blob/6f2b8e0fc218dbd0f49bebb8db2d1a771fe6bafa/src/biguint/power.rs#L134"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
uuid: "6d35eca9-5f30-406b-8b75-2ab9881044df"
cwe_ids:
- "CWE-682"
- "CWE-937"
- "CWE-1035"
