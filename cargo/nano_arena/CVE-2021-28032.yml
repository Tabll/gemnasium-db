---
identifier: "CVE-2021-28032"
identifiers:
- "CVE-2021-28032"
- "GHSA-wp34-mqw5-jj85"
package_slug: "cargo/nano_arena"
title: "Use after free in nano_arena"
description: "Affected versions of this crate assumed that Borrow<Idx> was guaranteed
  to return the same value on .borrow(). The borrowed index value was used to retrieve
  a mutable reference to a value.\n\nIf the Borrow<Idx> implementation returned a
  different index, the split arena would allow retrieving the index as a mutable reference
  creating two mutable references to the same element. This violates Rust's aliasing
  rules and allows for memory safety issues such as writing out of bounds and use-after-frees.\n\nThe
  flaw was corrected in commit `6b83f9d` by storing the .borrow() value in a temporary
  variable."
date: "2023-06-13"
pubdate: "2021-08-25"
affected_range: "<0.5.2"
fixed_versions:
- "0.5.2"
affected_versions: "All versions before 0.5.2"
not_impacted: "All versions starting from 0.5.2"
solution: "Upgrade to version 0.5.2 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-28032"
- "https://github.com/advisories/GHSA-wp34-mqw5-jj85"
- "https://github.com/bennetthardwick/nano-arena/issues/1"
- "https://github.com/bennetthardwick/nano-arena/commit/6b83f9d0708337a9f8b709c1624a8587021ceba2"
- "https://github.com/bennetthardwick/nano-arena"
- "https://rustsec.org/advisories/RUSTSEC-2021-0031.html"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "4cd75ca7-7c95-4a4f-9818-22a0281ca8b0"
cwe_ids:
- "CWE-416"
- "CWE-937"
- "CWE-1035"
