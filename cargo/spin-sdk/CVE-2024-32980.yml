---
identifier: "CVE-2024-32980"
identifiers:
- "CVE-2024-32980"
- "GHSA-f3h7-gpjj-wcvh"
package_slug: "cargo/spin-sdk"
title: "Spin applications with specific configuration vulnerable to potential network
  sandbox escape"
description: "Some specifically configured Spin applications that use `self` requests
  without a specified URL authority can be induced to make requests to arbitrary hosts
  via the `Host` HTTP header.\n\nIf an application's manifest contains a component
  with configuration such as\n```toml\nallowed_outbound_hosts = [\"http://self\",
  \"https://self\"]\n```\n\nand code such as\n```rust\nlet res: Response = spin_sdk::http::send(\nRequest::new(Method::Get,
  \"/\") // Note: the request URI does not contain a URL authority\n).await?;\n```\n\nThen
  that application can be induced to send an outgoing request to another host (leading
  the app to process the response assuming it comes from another component in the
  same application). This can be induced with a request such as\n```shell\ncurl -H\"Host:
  google.com:80\" localhost:3000 # Assuming the application is served on localhost:3000\n```\n\n>
  Note: If using a SDK that does not use `wasi:http/outgoing-handler`, the port can
  be omitted from the URL."
date: "2024-05-08"
pubdate: "2024-05-08"
affected_range: "<2.4.3"
fixed_versions:
- "2.4.3"
affected_versions: "All versions before 2.4.3"
not_impacted: "All versions starting from 2.4.3"
solution: "Upgrade to version 2.4.3 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-32980"
- "https://github.com/advisories/GHSA-f3h7-gpjj-wcvh"
- "https://github.com/fermyon/spin/security/advisories/GHSA-f3h7-gpjj-wcvh"
- "https://github.com/fermyon/spin/commit/b3db535c9edb72278d4db3a201f0ed214e561354"
- "https://github.com/fermyon/spin"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N"
uuid: "dee7888b-18f1-4184-b3b9-cbf7a6eca9bb"
cwe_ids:
- "CWE-610"
- "CWE-937"
- "CWE-1035"
