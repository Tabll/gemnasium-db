---
identifier: "CVE-2023-46115"
identifiers:
- "CVE-2023-46115"
- "GHSA-2rcp-jvr4-r259"
package_slug: "cargo/tauri-cli"
title: "Tauri's Updater Private Keys Possibly Leaked via Vite Environment Variables"
description: "This advisory is not describing a vulnerability in the Tauri code base
  itself but a commonly used misconfiguration which could lead to leaking of the private
  key and updater key password into bundled Tauri applications using the Vite frontend
  in a specific configuration.\n\nThe Tauri documentation used an insecure example
  configuration in the [Vite guide](https://tauri.app/v1/guides/getting-started/setup/vite/)
  to showcase how to use Tauri together with Vite.\n\nCopying the following snippet
  `envPrefix: ['VITE_', 'TAURI_'],` from this guide into the `vite.config.ts` of a
  Tauri project possibly leads to bundling the `TAURI_PRIVATE_KEY` and `TAURI_KEY_PASSWORD`
  into the Vite frontend code and therefore leaking this value to the debug built
  of a Tauri application.\n\nThe value is automatically bundled into debug builds
  but for production builds it is not embedded, as long as it is not directly referenced
  in the frontend code. Vite statically replaces these values in production builds.
  This reduces the amount of affected applications to a very small amount of affected
  applications.\n\nTo verify if you are affected you can search for the private key
  value or the `TAURI_PRIVATE_KEY` variable inside the release build frontend assets
  (`dist/`).\n\n> Example: `grep -r \"TAURI_PRIVATE_KEY\" dist/`\n\nUsing only the
  `envPrefix: ['VITE_'],` or any other framework than Vite means you are not impacted
  by this advisory."
date: "2023-12-19"
pubdate: "2023-10-20"
affected_range: ">=2.0.0-alpha.0 <2.0.0-alpha.16||>=1.0.0 <1.5.6"
fixed_versions:
- "2.0.0-alpha.16"
- "1.5.6"
affected_versions: "All versions starting from 1.0.0 before 1.5.6, all versions starting
  from 2.0.0-alpha.0 before 2.0.0-alpha.16"
not_impacted: "All versions before 1.0.0, all versions starting from 1.5.6 before
  2.0.0-alpha.0, all versions starting from 2.0.0-alpha.16"
solution: "Upgrade to versions 1.5.6, 2.0.0-alpha.16 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-46115"
- "https://github.com/advisories/GHSA-2rcp-jvr4-r259"
- "https://github.com/tauri-apps/tauri/security/advisories/GHSA-2rcp-jvr4-r259"
- "https://github.com/tauri-apps/tauri/commit/8b166e9bf82e69ddb3200a3a825614980bd8d433"
- "https://discord.com/channels/616186924390023171/1164260301655523409"
- "https://github.com/tauri-apps/tauri"
- "https://tauri.app/v1/guides/getting-started/setup/vite"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N"
uuid: "18ac60a1-74c2-4311-b668-f4abd6870aba"
cwe_ids:
- "CWE-200"
- "CWE-522"
- "CWE-937"
- "CWE-1035"
