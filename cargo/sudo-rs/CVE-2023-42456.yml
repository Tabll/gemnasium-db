---
identifier: "CVE-2023-42456"
identifiers:
- "CVE-2023-42456"
- "GHSA-2r3c-m6v7-9354"
package_slug: "cargo/sudo-rs"
title: "sudo-rs Session File Relative Path Traversal vulnerability"
description: "An issue was discovered where usernames containing the `.` and `/` characters
  could result in the corruption of specific files on the filesystem. As usernames
  are generally not limited by the characters they can contain, a username appearing
  to be a relative path can be constructed. For example we could add a user to the
  system containing the username `../../../../bin/cp`. When logged in as a user with
  that name, that user could run `sudo -K` to clear their session record file. The
  session code then constructs the path to the session file by concatenating the username
  to the session file storage directory, resulting in a resolved path of `/bin/cp`.
  The code then clears that file, resulting in the `cp` binary effectively being removed
  from the system.\n\nAn attacker needs to be able to login as a user with a constructed
  username. Given that such a username is unlikely to exist on an existing system,
  they will also need to be able to create the users with the constructed usernames."
date: "2025-05-12"
pubdate: "2023-09-21"
affected_range: "<0.2.1"
fixed_versions:
- "0.2.1"
affected_versions: "All versions before 0.2.1"
not_impacted: "All versions starting from 0.2.1"
solution: "Upgrade to version 0.2.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-42456"
- "https://github.com/advisories/GHSA-2r3c-m6v7-9354"
- "https://github.com/memorysafety/sudo-rs/security/advisories/GHSA-2r3c-m6v7-9354"
- "https://github.com/trifectatechfoundation/sudo-rs/security/advisories/GHSA-2r3c-m6v7-9354"
- "https://github.com/memorysafety/sudo-rs/commit/bfdbda22968e3de43fa8246cab1681cfd5d5493d"
- "https://ferrous-systems.com/blog/sudo-rs-audit"
- "https://github.com/memorysafety/sudo-rs"
- "https://rustsec.org/advisories/RUSTSEC-2023-0069.html"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H"
uuid: "1669bba7-e672-4aa2-af77-09246e836a21"
cwe_ids:
- "CWE-22"
- "CWE-23"
- "CWE-937"
- "CWE-1035"
