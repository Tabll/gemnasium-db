---
identifier: "CVE-2024-45311"
identifiers:
- "CVE-2024-45311"
- "GHSA-vr26-jcq5-fjj8"
package_slug: "cargo/quinn-proto"
title: "Denial of service in quinn-proto when using `Endpoint::retry()`"
description: "As of quinn-proto 0.11, it is possible for a server to `accept()`, `retry()`,
  `refuse()`, or `ignore()` an `Incoming` connection. However, calling `retry()` on
  an unvalidated connection exposes the server to a likely panic in the following
  situations:\n\n- Calling `refuse` or `ignore` on the resulting validated connection,
  if a duplicate initial packet is received\n- This issue can go undetected until
  a server's `refuse()`/`ignore()` code path is exercised, such as to stop a denial
  of service attack.\n- Accepting when the initial packet for the resulting validated
  connection fails to decrypt or exhausts connection IDs, if a similar initial packet
  that successfully decrypts and doesn't exhaust connection IDs is received.\n- This
  issue can go undetected if clients are well-behaved.\n\nThe former situation was
  observed in a real application, while the latter is only theoretical."
date: "2024-09-03"
pubdate: "2024-09-03"
affected_range: ">=0.11.0 <0.11.7"
fixed_versions:
- "0.11.7"
affected_versions: "All versions starting from 0.11.0 before 0.11.7"
not_impacted: "All versions before 0.11.0, all versions starting from 0.11.7"
solution: "Upgrade to version 0.11.7 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-45311"
- "https://github.com/advisories/GHSA-vr26-jcq5-fjj8"
- "https://github.com/quinn-rs/quinn/security/advisories/GHSA-vr26-jcq5-fjj8"
- "https://github.com/quinn-rs/quinn/commit/e01609ccd8738bd438d86fa7185a0f85598cb58f"
- "https://github.com/quinn-rs/quinn"
- "https://github.com/quinn-rs/quinn/blob/bb02a12a8435a7732a1d762783eeacbb7e50418e/quinn-proto/src/endpoint.rs#L213"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
uuid: "7851a9a7-c9d2-43a0-a906-1a99068d1d94"
cwe_ids:
- "CWE-670"
- "CWE-937"
- "CWE-1035"
