---
identifier: "GHSA-mm7x-qfjj-5g2c"
identifiers:
- "GHSA-mm7x-qfjj-5g2c"
package_slug: "cargo/ammonia"
title: "Ammonia incorrectly handles embedded SVG and MathML leading to mutation XSS
  after removal"
description: "Affected versions of this crate did not correctly strip namespace-incompatible
  tags\nin certain situations, causing it to incorrectly account for differences between
  HTML,\nSVG, and MathML.\n\nThis vulnerability only has an effect when the `svg`
  or `math` tag is allowed,\nbecause it relies on a tag being parsed as html during
  the cleaning process, but\nserialized in a way that causes in to be parsed as xml
  by the browser.\n\nAdditionally, the application using this library must allow a
  tag that is parsed as raw text in HTML.\nThese [elements] are:\n\n* title\n* textarea\n*
  xmp\n* iframe\n* noembed\n* noframes\n* plaintext\n* noscript\n* style\n* script\n\nApplications
  that do not explicitly allow any of these tags should not be affected, since none
  are allowed by default."
date: "2025-09-22"
pubdate: "2025-09-22"
affected_range: ">=4.1.0 <4.1.2||>=4.0.0 <4.0.1||<3.3.1"
fixed_versions:
- "4.1.2"
- "4.0.1"
- "3.3.1"
affected_versions: "All versions before 3.3.1, all versions starting from 4.0.0 before
  4.0.1, all versions starting from 4.1.0 before 4.1.2"
not_impacted: "All versions starting from 3.3.1 before 4.0.0, all versions starting
  from 4.0.1 before 4.1.0, all versions starting from 4.1.2"
solution: "Upgrade to versions 3.3.1, 4.0.1, 4.1.2 or above."
urls:
- "https://github.com/advisories/GHSA-mm7x-qfjj-5g2c"
- "https://github.com/rust-ammonia/ammonia/commit/de0297111a3a1273275b670960bcd47a0481718e"
- "https://github.com/rust-ammonia/ammonia"
- "https://rustsec.org/advisories/RUSTSEC-2025-0071.html"
uuid: "bd08905a-ac9e-49d2-9e3d-dcb0ea1bdafb"
cwe_ids:
- "CWE-79"
- "CWE-937"
- "CWE-1035"
