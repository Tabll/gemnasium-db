---
identifier: "CVE-2022-39252"
identifiers:
- "CVE-2022-39252"
- "GHSA-vp68-2wrm-69qm"
package_slug: "cargo/matrix-sdk-crypto"
title: "matrix-sdk-crypto contains potential impersonation via room key forward responses"
description: "When matrix-rust-sdk before 0.6 requests a room key from our devices,
  it correctly accepts key forwards only if they are a response to a previous request.
  However, it doesn't check that the device that responded matches the device the
  key was requested from.\n\nThis allows a malicious homeserver to insert room keys
  of questionable validity into the key store in some situations, potentially assisting
  in an impersonation attack. Note that even if key injection succeeds in this way,
  all forwarded keys have the `imported` flag set, which is used as an indicator that
  such keys have lesser authentication properties (and should be marked as such in
  clients, e.g. with a grey shield besides the message)."
date: "2022-09-30"
pubdate: "2022-09-30"
affected_range: "<0.6.0"
fixed_versions:
- "0.6.0"
affected_versions: "All versions before 0.6.0"
not_impacted: "All versions starting from 0.6.0"
solution: "Upgrade to version 0.6.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-39252"
- "https://github.com/advisories/GHSA-vp68-2wrm-69qm"
- "https://github.com/matrix-org/matrix-rust-sdk/security/advisories/GHSA-vp68-2wrm-69qm"
- "https://github.com/matrix-org/matrix-rust-sdk/commit/093fb5d0aa21c0b5eaea6ec96b477f1075271cbb"
- "https://github.com/matrix-org/matrix-rust-sdk/commit/41449d2cc360e347f5d4e1c154ec1e3185f11acd"
- "https://github.com/matrix-org/matrix-rust-sdk"
- "https://github.com/matrix-org/matrix-rust-sdk/releases/tag/matrix-sdk-0.6.0"
- "https://rustsec.org/advisories/RUSTSEC-2022-0085.html"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N"
uuid: "fa29e0ed-0880-4309-9051-7e4dc3038a1d"
cwe_ids:
- "CWE-287"
- "CWE-937"
- "CWE-1035"
