---
identifier: "CVE-2021-29935"
identifiers:
- "CVE-2021-29935"
- "GHSA-vcw4-8ph6-7vw8"
package_slug: "cargo/rocket"
title: "Use after free in Rocket"
description: "Affected versions of this crate transmuted a &str to a &'static str
  before pushing it into a StackVec, this value was then popped later in the same
  function.\n\nThis was assumed to be safe because the reference would be valid while
  the method's stack was active. In between the push and the pop, however, a function
  f was called that could invoke a user provided function.\n\nIf the user provided
  panicked, then the assumption used by the function was no longer true and the transmute
  to &'static would create an illegal static reference to the string. This could result
  in a freed string being used during (such as in a Drop implementation) or after
  (e.g through catch_unwind) the panic unwinding.\n\nThis flaw was corrected in commit
  `e325e2f` by using a guard object to ensure that the &'static str was dropped inside
  the function."
date: "2023-06-13"
pubdate: "2021-08-25"
affected_range: "<0.4.7"
fixed_versions:
- "0.4.7"
affected_versions: "All versions before 0.4.7"
not_impacted: "All versions starting from 0.4.7"
solution: "Upgrade to version 0.4.7 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-29935"
- "https://github.com/advisories/GHSA-vcw4-8ph6-7vw8"
- "https://github.com/SergioBenitez/Rocket/issues/1534"
- "https://github.com/SergioBenitez/Rocket/commit/b53a906a8e170fe9b151381c66a76a872c419f9e"
- "https://github.com/SergioBenitez/Rocket/commit/e325e2fce4d9f9f392761e9fb58b418a48cef8bb"
- "https://github.com/SergioBenitez/Rocket"
- "https://rustsec.org/advisories/RUSTSEC-2021-0044.html"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L"
uuid: "8c8a0d45-a863-470b-8fff-e382d1879f18"
cwe_ids:
- "CWE-416"
- "CWE-937"
- "CWE-1035"
