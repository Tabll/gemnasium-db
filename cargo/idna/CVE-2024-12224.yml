---
identifier: "CVE-2024-12224"
identifiers:
- "CVE-2024-12224"
- "GHSA-h97m-ww89-6jmq"
package_slug: "cargo/idna"
title: "`idna` accepts Punycode labels that do not produce any non-ASCII when decoded"
description: "`idna` 0.5.0 and earlier accepts Punycode labels that do not produce
  any non-ASCII output, which means that either ASCII labels or the empty root label
  can be masked such that they appear unequal without IDNA processing or when processed
  with a different implementation and equal when processed with `idna` 0.5.0 or earlier.\n\nConcretely,
  `example.org` and `xn--example-.org` become equal after processing by `idna` 0.5.0
  or earlier. Also, `example.org.xn--` and `example.org.` become equal after processing
  by `idna` 0.5.0 or earlier.\n\nIn applications using `idna` (but not in `idna` itself)
  this may be able to lead to privilege escalation when host name comparison is part
  of a privilege check and the behavior is combined with a client that resolves domains
  with such labels instead of treating them as errors that preclude DNS resolution
  / URL fetching and with the attacker managing to introduce a DNS entry (and TLS
  certificate) for an `xn--`-masked name that turns into the name of the target when
  processed by `idna` 0.5.0 or earlier."
date: "2024-12-09"
pubdate: "2024-12-09"
affected_range: "<1.0.0"
fixed_versions:
- "1.0.0"
affected_versions: "All versions before 1.0.0"
not_impacted: "All versions starting from 1.0.0"
solution: "Upgrade to version 1.0.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-12224"
- "https://github.com/advisories/GHSA-h97m-ww89-6jmq"
- "https://bugzilla.mozilla.org/show_bug.cgi?id=1887898"
- "https://github.com/servo/rust-url"
- "https://rustsec.org/advisories/RUSTSEC-2024-0421.html"
uuid: "e310a7ba-86de-4f56-b2f6-7b346105eb96"
cwe_ids:
- "CWE-697"
- "CWE-937"
- "CWE-1035"
