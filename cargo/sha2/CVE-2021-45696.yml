---
identifier: "CVE-2021-45696"
identifiers:
- "CVE-2021-45696"
- "GHSA-fc7x-2cmc-8j2g"
package_slug: "cargo/sha2"
title: "Incorrect hash in sha2"
description: "The v0.9.7 release of the sha2 crate introduced a new AVX2-accelerated
  backend which was automatically enabled for all x86/x86_64 CPUs where AVX2 support
  was autodetected at runtime.\n\nThis backend was buggy and would miscompute results
  for long messages (i.e. messages spanning multiple SHA blocks).\n\nThe crate has
  since been yanked, but any users who upgraded to v0.9.7 should immediately upgrade
  to v0.9.8 and recompute any hashes which were previously computed by v0.9.7."
date: "2023-06-13"
pubdate: "2022-01-06"
affected_range: ">=0.9.7 <0.9.8||=0.9.7"
fixed_versions:
- "0.9.8"
affected_versions: "All versions starting from 0.9.7 before 0.9.8, version 0.9.7"
not_impacted: ""
solution: "Upgrade to version 0.9.8 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-45696"
- "https://github.com/advisories/GHSA-fc7x-2cmc-8j2g"
- "https://github.com/RustCrypto/hashes/pull/314"
- "https://github.com/RustCrypto/hashes"
- "https://raw.githubusercontent.com/rustsec/advisory-db/main/crates/sha2/RUSTSEC-2021-0100.md"
- "https://rustsec.org/advisories/RUSTSEC-2021-0100.html"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "f38c7312-2083-4073-ae35-7464b962c1e3"
cwe_ids:
- "CWE-327"
- "CWE-937"
- "CWE-1035"
