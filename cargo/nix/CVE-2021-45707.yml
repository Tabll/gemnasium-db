---
identifier: "CVE-2021-45707"
identifiers:
- "CVE-2021-45707"
- "GHSA-76w9-p8mg-j927"
package_slug: "cargo/nix"
title: "Out-of-bounds Write in nix"
description: "On certain platforms, if a user has more than 16 groups, the nix::unistd::getgrouplist
  function will call the libc getgrouplist function with a length parameter greater
  than the size of the buffer it provides, resulting in an out-of-bounds write and
  memory corruption.\n\nThe libc getgrouplist function takes an in/out parameter ngroups
  specifying the size of the group buffer. When the buffer is too small to hold all
  of the requested user's group memberships, some libc implementations, including
  glibc and Solaris libc, will modify ngroups to indicate the actual number of groups
  for the user, in addition to returning an error. The version of nix::unistd::getgrouplist
  in nix 0.16.0 and up will resize the buffer to twice its size, but will not read
  or modify the ngroups variable. Thus, if the user has more than twice as many groups
  as the initial buffer size of 8, the next call to getgrouplist will then write past
  the end of the buffer.\n\nThe issue would require editing /etc/groups to exploit,
  which is usually only editable by the root user."
date: "2024-02-21"
pubdate: "2022-01-06"
affected_range: ">=0.16.0 <0.20.2||>=0.21.0 <0.21.2||>=0.22.0 <0.22.2"
fixed_versions:
- "0.20.2"
- "0.21.2"
- "0.22.2"
affected_versions: "All versions starting from 0.16.0 before 0.20.2, all versions
  starting from 0.21.0 before 0.21.2, all versions starting from 0.22.0 before 0.22.2"
not_impacted: "All versions before 0.16.0, all versions starting from 0.20.2 before
  0.21.0, all versions starting from 0.21.2 before 0.22.0, all versions starting from
  0.22.2"
solution: "Upgrade to versions 0.20.2, 0.21.2, 0.22.2 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-45707"
- "https://github.com/advisories/GHSA-76w9-p8mg-j927"
- "https://github.com/nix-rust/nix/issues/1541"
- "https://github.com/advisories/GHSA-wgrg-5h56-jg27"
- "https://github.com/nix-rust/nix"
- "https://raw.githubusercontent.com/rustsec/advisory-db/main/crates/nix/RUSTSEC-2021-0119.md"
- "https://rustsec.org/advisories/RUSTSEC-2021-0119.html"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H"
uuid: "85c926ef-be60-42ef-ae1b-544e212c6fe8"
cwe_ids:
- "CWE-787"
- "CWE-937"
- "CWE-1035"
