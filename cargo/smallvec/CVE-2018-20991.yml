---
identifier: "CVE-2018-20991"
identifiers:
- "CVE-2018-20991"
- "GHSA-rxr4-x558-x7hw"
package_slug: "cargo/smallvec"
title: "Double free in smallvec"
description: "If an iterator passed to SmallVec::insert_many panicked in Iterator::next,
  destructors were run during unwinding while the vector was in an inconsistent state,
  possibly causing a double free (a destructor running on two copies of the same value).\n\nThis
  is fixed in smallvec 0.6.3 by ensuring that the vector's length is not updated to
  include moved items until they have been removed from their original positions.
  Items may now be leaked if Iterator::next panics, but they will not be dropped more
  than once."
date: "2023-06-13"
pubdate: "2021-08-25"
affected_range: ">=0.3.2 <0.6.3"
fixed_versions:
- "0.6.3"
affected_versions: "All versions starting from 0.3.2 before 0.6.3"
not_impacted: "All versions before 0.3.2, all versions starting from 0.6.3"
solution: "Upgrade to version 0.6.3 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2018-20991"
- "https://github.com/advisories/GHSA-rxr4-x558-x7hw"
- "https://github.com/servo/rust-smallvec/issues/96"
- "https://github.com/servo/rust-smallvec"
- "https://rustsec.org/advisories/RUSTSEC-2018-0003.html"
cvss_v3: "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "127be389-6dd8-4037-9d51-b4f0ad1dfa83"
cwe_ids:
- "CWE-415"
- "CWE-937"
- "CWE-1035"
