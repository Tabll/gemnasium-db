---
identifier: "CVE-2021-30455"
identifiers:
- "CVE-2021-30455"
- "GHSA-8gmx-cpcg-f8h5"
package_slug: "cargo/id-map"
title: "Double-free in id-map"
description: "The clone_from implementation for IdMap drops the values present in
  the map and then begins cloning values from the other map. If a .clone() call pancics,
  then the afformentioned dropped elements can be freed again.\nget_or_insert\n\nget_or_insert
  reserves space for a value, before calling the user provided insertion function
  f. If the function f panics then uninitialized or previously freed memory can be
  dropped.\nremove_set\n\nWhen removing a set of elements, ptr::drop_in_place is called
  on each of the element to be removed. If the Drop impl of one of these elements
  panics then the previously dropped elements can be dropped again."
date: "2023-06-13"
pubdate: "2021-08-25"
affected_range: "<=0.2.1"
fixed_versions: []
affected_versions: "All versions up to 0.2.1"
not_impacted: ""
solution: "Unfortunately, there is no solution available yet."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-30455"
- "https://github.com/advisories/GHSA-8gmx-cpcg-f8h5"
- "https://github.com/andrewhickman/id-map/issues/3"
- "https://github.com/andrewhickman/id-map"
- "https://rustsec.org/advisories/RUSTSEC-2021-0052.html"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "b44d6f92-ef99-4028-a3d8-3f2464d71910"
cwe_ids:
- "CWE-415"
- "CWE-937"
- "CWE-1035"
