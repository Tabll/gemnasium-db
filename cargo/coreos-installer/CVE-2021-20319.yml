---
identifier: "CVE-2021-20319"
identifiers:
- "CVE-2021-20319"
- "GHSA-3r3g-g73x-g593"
package_slug: "cargo/coreos-installer"
title: "coreos-installer improperly verifies GPG signature when decompressing gzipped
  artifact"
description: "coreos-installer fails to correctly verify GPG signatures when decompressing
  gzip-compressed artifacts.  This allows bypass of signature verification in cases
  where coreos-installer decompresses a downloaded OS image, allowing an attacker
  who can modify the OS image to compromise a newly-installed system.\n\nDefault installations
  from ISO or PXE media in Fedora CoreOS, RHEL CoreOS, and RHEL for Edge are **not**
  affected, as coreos-installer installs from an OS image shipped as part of the install
  media.\n\nThese flows are affected:\n\n1.  Installing with `--image-file`, `--image-url`,
  or `coreos.inst.image_url`.  For example, if a user has a local mirror of installation
  images, an attacker could replace an image with a gzip-compressed alternative (even
  if the file extension is `.xz`).  The result:\n\n```\n$ coreos-installer install
  --image-url http://localhost:8080/image.xz /dev/loop0\nDownloading image from http://localhost:8080/image.xz\nDownloading
  signature from http://localhost:8080/image.xz.sig\n> Read disk 749.9 MiB/749.9 MiB
  (100%)\ngpg: Signature made Mon 20 Sep 2021 02:41:50 PM EDT\ngpg: using RSA key
  8C5BA6990BDB26E19F2A1A801161AE6945719A39\ngpg: BAD signature from \"Fedora (34)
  <fedora-34-primary@fedoraproject.org>\" [ultimate]\nInstall complete.\n```\n\nNotice
  that GPG reports a bad signature, but coreos-installer continues anyway.  Automation
  that relies on coreos-installer's exit status will not notice either.\n\n2. `coreos-installer
  download --decompress --image-url`:\n\n```\n$ coreos-installer download --decompress
  --image-url http://localhost:8080/image.xz\n> Read disk 749.9 MiB/749.9 MiB (100%)\ngpg:
  Signature made Mon 20 Sep 2021 02:41:50 PM EDT\ngpg: using RSA key 8C5BA6990BDB26E19F2A1A801161AE6945719A39\ngpg:
  BAD signature from \"Fedora (34) <fedora-34-primary@fedoraproject.org>\" [ultimate]\n./image\n```\n\nAgain,
  coreos-installer reports success.\n\n3. Installing with default parameters, when
  **not** installing from the image built into live ISO or PXE media, if the hosting
  service is compromised or if an active attacker gains control of the HTTPS response.\n\n4.
  `coreos-installer download --decompress` if the hosting service is compromised or
  if an active attacker gains control of the HTTPS response."
date: "2022-06-01"
pubdate: "2021-10-12"
affected_range: "<0.10.1"
fixed_versions:
- "0.10.1"
affected_versions: "All versions before 0.10.1"
not_impacted: "All versions starting from 0.10.1"
solution: "Upgrade to version 0.10.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-20319"
- "https://github.com/advisories/GHSA-3r3g-g73x-g593"
- "https://github.com/coreos/coreos-installer/security/advisories/GHSA-3r3g-g73x-g593"
- "https://github.com/coreos/coreos-installer/pull/655"
- "https://github.com/coreos/coreos-installer/pull/659/commits/ad243c6f0eff2835b2da56ca5f7f33af76253c89"
- "https://bugzilla.redhat.com/show_bug.cgi?id=2011862"
- "https://github.com/coreos/coreos-installer"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H"
uuid: "50468111-4765-4255-9c36-a4e47d79f4ef"
cwe_ids:
- "CWE-347"
- "CWE-937"
- "CWE-1035"
