---
identifier: "CVE-2021-46102"
identifiers:
- "CVE-2021-46102"
- "GHSA-xwqr-xmgg-j69q"
package_slug: "cargo/solana_rbpf"
title: "Integer overflow in solana_rbpf"
description: "From version 0.2.14 to 0.2.16 for Solana rBPF, function \"relocate\"
  in the file src/elf.rs has an integer overflow bug because the sym.st_value is read
  directly from ELF file without checking. If the sym.st_value is rather large, an
  integer overflow is triggered while calculating the variable \"addr\" via `addr
  = (sym.st_value + refd_pa) as u64`"
date: "2023-04-26"
pubdate: "2022-01-28"
affected_range: ">=0.2.14 <0.2.17"
fixed_versions:
- "0.2.17"
affected_versions: "All versions starting from 0.2.14 before 0.2.17"
not_impacted: "All versions before 0.2.14, all versions starting from 0.2.17"
solution: "Upgrade to version 0.2.17 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-46102"
- "https://github.com/advisories/GHSA-xwqr-xmgg-j69q"
- "https://github.com/solana-labs/rbpf/pull/200"
- "https://github.com/solana-labs/rbpf/pull/236"
- "https://blocksecteam.medium.com/new-integer-overflow-bug-discovered-in-solana-rbpf-7729717159ee"
- "https://github.com/solana-labs/rbpf"
- "https://github.com/solana-labs/rbpf/blob/c14764850f0b83b58aa013248eaf6d65836c1218/src/elf.rs#L609-L630"
- "https://github.com/solana-labs/rbpf/releases/tag/v0.2.17"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
uuid: "b2cb665c-5786-4649-92de-e2f88ef7a2d6"
cwe_ids:
- "CWE-190"
- "CWE-937"
- "CWE-1035"
