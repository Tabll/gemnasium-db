---
identifier: "CVE-2025-27612"
identifiers:
- "CVE-2025-27612"
- "GHSA-5w4j-f78p-4wh9"
package_slug: "cargo/libcontainer"
title: "Libcontainer is affected by capabilities elevation similar to GHSA-f3fp-gc8g-vw66"
description: "In libcontainer, while creating a tenant container, the tenant builder
  accepts a list of capabilities to be added in the spec of tenant container. Code
  can be seen [here](https://github.com/youki-dev/youki/blob/9e63fa4da1672a78ca45100f3059a732784a5174/crates/libcontainer/src/container/tenant_builder.rs#L408)
  . The logic here adds the given capabilities to all capabilities of main container
  if present in spec, otherwise simply set provided capabilities as capabilities of
  the tenant container.\n\nHowever, GHSA-f3fp-gc8g-vw66 was opened on runc mentioning
  that setting inherited caps in any case for tenant container can lead to elevation
  of capabilities. For this, they added a fix [here](https://github.com/opencontainers/runc/blob/986451c24e17c8d4be3c454f60b1f7be4af3e8b4/exec.go#L234-L242)
  where they never set new inherited caps on tenant, and set ambient caps only if
  original container had inherited caps.\n\nSimilarly crun never sets inherited caps
  as can be seen [here](https://github.com/containers/crun/blob/3ec6298abd79e144fbf3fa6db90793ff4c0516f9/src/exec.c#L319).\n\n>
  [!NOTE]\nThis does not affect youki binary itself, as the exec implementation is
  partially broken and does not pass on the user-provided caps to tenant containers,
  this is only applicable if you are using libcontainer directly and using the tenant
  builder."
date: "2025-03-21"
pubdate: "2025-03-21"
affected_range: "<0.5.3"
fixed_versions:
- "0.5.3"
affected_versions: "All versions before 0.5.3"
not_impacted: "All versions starting from 0.5.3"
solution: "Upgrade to version 0.5.3 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2025-27612"
- "https://github.com/advisories/GHSA-5w4j-f78p-4wh9"
- "https://github.com/opencontainers/runc/security/advisories/GHSA-f3fp-gc8g-vw66"
- "https://github.com/youki-dev/youki/security/advisories/GHSA-5w4j-f78p-4wh9"
- "https://github.com/youki-dev/youki/commit/747e342d2026fbf3a395db3e2a491ebef00082f1"
- "https://github.com/containers/crun/blob/3ec6298abd79e144fbf3fa6db90793ff4c0516f9/src/exec.c#L319"
- "https://github.com/opencontainers/runc/blob/986451c24e17c8d4be3c454f60b1f7be4af3e8b4/exec.go#L234-L242"
- "https://github.com/youki-dev/youki"
- "https://github.com/youki-dev/youki/blob/9e63fa4da1672a78ca45100f3059a732784a5174/crates/libcontainer/src/container/tenant_builder.rs#L408"
- "https://man7.org/linux/man-pages/man7/capabilities.7.html"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L"
uuid: "1efbec00-be26-4805-9d89-a613e1b3a191"
cwe_ids:
- "CWE-276"
- "CWE-937"
- "CWE-1035"
