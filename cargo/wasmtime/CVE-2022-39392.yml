---
identifier: "CVE-2022-39392"
identifiers:
- "CVE-2022-39392"
- "GHSA-44mr-8vmm-wjhg"
package_slug: "cargo/wasmtime"
title: "Wasmtime out of bounds read/write with zero-memory-pages configuration"
description: "There is a bug in Wasmtime's implementation of its pooling instance
  allocator when the allocator is configured to give WebAssembly instances a maximum
  of zero pages of memory. In this configuration the virtual memory mapping for WebAssembly
  memories did not meet the compiler-required configuration requirements for safely
  executing WebAssembly modules. Wasmtime's default settings require virtual memory
  page faults to indicate that wasm reads/writes are out-of-bounds, but the pooling
  allocator's configuration would not create an appropriate virtual memory mapping
  for this meaning out of bounds reads/writes can successfully read/write memory unrelated
  to the wasm sandbox within range of the base address of the memory mapping created
  by the pooling allocator."
date: "2022-11-15"
pubdate: "2022-11-10"
affected_range: ">=2.0.0 <2.0.2||<1.0.2"
fixed_versions:
- "2.0.2"
- "1.0.2"
affected_versions: "All versions before 1.0.2, all versions starting from 2.0.0 before
  2.0.2"
not_impacted: "All versions starting from 1.0.2 before 2.0.0, all versions starting
  from 2.0.2"
solution: "Upgrade to versions 1.0.2, 2.0.2 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-39392"
- "https://github.com/advisories/GHSA-44mr-8vmm-wjhg"
- "https://github.com/bytecodealliance/wasmtime/security/advisories/GHSA-44mr-8vmm-wjhg"
- "https://github.com/bytecodealliance/wasmtime/commit/e60c3742904ccbb3e26da201c9221c38a4981d72"
- "https://github.com/bytecodealliance/wasmtime"
- "https://groups.google.com/a/bytecodealliance.org/g/sec-announce/c/c1HBDDJwNPA"
- "https://rustsec.org/advisories/RUSTSEC-2022-0076.html"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:N"
uuid: "7669889b-a48a-4fd6-bbcf-a649f3df864b"
cwe_ids:
- "CWE-119"
- "CWE-125"
- "CWE-787"
- "CWE-937"
- "CWE-1035"
