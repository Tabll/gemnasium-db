---
identifier: "CVE-2024-30266"
identifiers:
- "CVE-2024-30266"
- "GHSA-75hq-h6g9-h4q5"
package_slug: "cargo/wasmtime"
title: "Wasmtime vulnerable to panic when using a dropped extenref-typed element segment"
description: "The 19.0.0 release of Wasmtime contains a regression introduced during
  its development which can lead to a guest WebAssembly module causing a panic in
  the host runtime. A valid WebAssembly module, when executed at runtime, may cause
  this panic. The panic in question is caused when a WebAssembly module issues a `table.*`
  instruction which uses a dropped element segment with a table that also has an `externref`
  type. This causes Wasmtime to erroneously use an empty function segment instead
  of an empty externref segment to perform this operation. This mismatch in types
  causes a panic in Wasmtime when it's asserted that an externref table is only viewed
  as externrefs.\n\nThis regression was introduced during the development of the 19.0.0
  release and only affects the 19.0.0 release. This panic requires the `reference-types`
  WebAssembly feature to be enabled, and it is enabled by default. Toolchains are
  not known to generate this pattern by default so it's likely a module would need
  to be specifically crafted to trigger this panic.\n\nA panic in a host runtime represents
  a possible denial-of-service in some scenarios. This panic cannot introduce memory
  unsafety or allow WebAssembly to break outside of its sandbox, however. There is
  no possible heap corruption or memory unsafety from this panic."
date: "2025-05-02"
pubdate: "2024-04-02"
affected_range: ">=19.0.0 <19.0.1||=19.0.0"
fixed_versions:
- "19.0.1"
affected_versions: "All versions starting from 19.0.0 before 19.0.1, version 19.0.0"
not_impacted: ""
solution: "Upgrade to version 19.0.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-30266"
- "https://github.com/advisories/GHSA-75hq-h6g9-h4q5"
- "https://github.com/bytecodealliance/wasmtime/security/advisories/GHSA-75hq-h6g9-h4q5"
- "https://github.com/bytecodealliance/wasmtime/issues/8281"
- "https://github.com/bytecodealliance/wasmtime/pull/8018"
- "https://github.com/bytecodealliance/wasmtime/pull/8283"
- "https://github.com/bytecodealliance/wasmtime/commit/7f57d0bb0948fa56cc950278d0db230ed10e8664"
- "https://github.com/bytecodealliance/wasmtime"
- "https://rustsec.org/advisories/RUSTSEC-2024-0441.html"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L"
uuid: "cc05b7e1-8e59-4ef4-abe2-c0b04d82087f"
cwe_ids:
- "CWE-843"
- "CWE-937"
- "CWE-1035"
