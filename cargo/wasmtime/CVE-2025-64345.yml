---
identifier: "CVE-2025-64345"
identifiers:
- "CVE-2025-64345"
- "GHSA-hc7m-r6v8-hg9q"
package_slug: "cargo/wasmtime"
title: "Wasmtime provides unsound API access to a WebAssembly shared linear memory"
description: "Wasmtime's Rust embedder API contains an unsound interaction where a
  WebAssembly shared linear memory could be viewed as a type which provides safe access
  to the host (Rust) to the contents of the linear memory. This is not sound for shared
  linear memories, which could be modified in parallel, and this could lead to a data
  race in the host.\n\nWasmtime has a `wasmtime::Memory` type which represents linear
  memories in a WebAssembly module. Wasmtime also has `wasmtime::SharedMemory`, however,
  which represents shared linear memories introduced in the WebAssembly `threads`
  proposal. The API of `SharedMemory` does not provide accessors which return `&[u8]`
  in Rust, for example, as that's not a sound type signature when other threads could
  be modifying memory. The `wasmtime::Memory` type, however, does provide this API
  as it's intended to be used with non-shared memories where static knowledge is available
  that no concurrent or parallel reads or writes are happening. This means that it's
  not sound to represent a shared linear memory with `wasmtime::Memory` and it must
  instead be represented with `wasmtime::SharedMemory`.\n\nThere were two different,
  erroneous, methods of creating a `wasmtime::Memory` which represents a shared memory
  however:\n\n1. The [`wasmtime::Memory::new` constructor](https://docs.rs/wasmtime/latest/wasmtime/struct.Memory.html#method.new)
  takes a `MemoryType` which could be `shared`. This function did not properly reject
  shared memory types and require usage of [`SharedMemory::new`](https://docs.rs/wasmtime/latest/wasmtime/struct.SharedMemory.html#method.new)
  instead.\n2. Capturing a core dump with WebAssembly would expose all linear memories
  a `wasmtime::Memory`. This means that a core dump would perform an unsynchronized
  read of shared linear memory, possibly leading to data races.\n\nThis is a bug in
  Wasmtime's safe Rust API. It should not be possible to cause unsoundness with Wasmtime's
  embedding API if `unsafe` is not used. Embeddings which do not use the wasm threads
  proposal nor created shared memories nor actually share shared memories across threads
  are unaffected. Only if shared memories are created across threads might an embedding
  be affected."
date: "2025-11-12"
pubdate: "2025-11-12"
affected_range: ">=38.0.0 <38.0.4||>=37.0.0 <37.0.3||>=26.0.0 <36.0.3||<24.0.5"
fixed_versions:
- "38.0.4"
- "37.0.3"
- "36.0.3"
- "24.0.5"
affected_versions: "All versions before 24.0.5, all versions starting from 26.0.0
  before 36.0.3, all versions starting from 37.0.0 before 37.0.3, all versions starting
  from 38.0.0 before 38.0.4"
not_impacted: "All versions starting from 24.0.5 before 26.0.0, all versions starting
  from 36.0.3 before 37.0.0, all versions starting from 37.0.3 before 38.0.0, all
  versions starting from 38.0.4"
solution: "Upgrade to versions 24.0.5, 36.0.3, 37.0.3, 38.0.4 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2025-64345"
- "https://github.com/advisories/GHSA-hc7m-r6v8-hg9q"
- "https://github.com/bytecodealliance/wasmtime/security/advisories/GHSA-hc7m-r6v8-hg9q"
- "https://github.com/bytecodealliance/wasmtime/commit/9ebb6934f00d58b92fb68ed0e0b16c0ae828ca10"
- "https://docs.rs/wasmtime/latest/wasmtime/struct.Memory.html#method.new"
- "https://docs.rs/wasmtime/latest/wasmtime/struct.SharedMemory.html#method.new"
- "https://docs.wasmtime.dev/stability-release.html"
- "https://github.com/bytecodealliance/wasmtime"
- "https://github.com/bytecodealliance/wasmtime/releases/tag/v38.0.4"
cvss_v3: "CVSS:3.1/AV:L/AC:H/PR:H/UI:R/S:U/C:N/I:L/A:N"
uuid: "fef62c57-6fa1-4d1c-bea2-80047076e95f"
cwe_ids:
- "CWE-362"
- "CWE-937"
- "CWE-1035"
