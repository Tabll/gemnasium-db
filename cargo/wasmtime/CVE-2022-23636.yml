---
identifier: "CVE-2022-23636"
identifiers:
- "CVE-2022-23636"
- "GHSA-88xq-w8cq-xfg7"
package_slug: "cargo/wasmtime"
title: "Invalid drop of partially-initialized instances in the pooling instance allocator
  for modules with defined `externref` globals "
description: "There exists a bug in the pooling instance allocator in Wasmtime's runtime
  where a failure to instantiate an instance for a module that defines an `externref`
  global will result in an invalid drop of a `VMExternRef` via an uninitialized pointer.\n\nAs
  instance slots may be reused between consecutive instantiations, the value of the
  uninitialized pointer may be from a previous instantiation and therefore under the
  control of an attacker via a module's initial values for its globals. If the attacker
  can somehow determine an address under their control inside the mapped memory representing
  the instance pool, it is possible to trick the runtime to call `drop_in_place` on
  a trait object under the attacker's control and therefore cause remote code execution.\n\nExploiting
  the bug to cause remote code execution would be very difficult as attackers cannot
  determine the addresses of globals from code executing within the WebAssembly VM
  and the memory space for the instance pool cannot be statically determined. Operating
  system mitigations, such as [address space layout randomization](https://en.wikipedia.org/wiki/Address_space_layout_randomization),
  would additionally increase the difficulty for attackers to determine useful executable
  code to target with an exploit. It is also very unlikely that attackers will be
  able to directly influence the conditions that trigger the bug as described below.\n\nWhen
  the conditions to trigger the bug are met, however, it is much easier to exploit
  this bug to cause a denial of service by crashing the host with an invalid memory
  read.\n\nThe following engine configuration (via [Config](https://docs.rs/wasmtime/0.34.0/wasmtime/struct.Config.html))
  is required to be impacted by this bug:"
date: "2025-05-02"
pubdate: "2022-02-16"
affected_range: ">=0.34.0 <0.34.1||=0.34.0||<0.33.1"
fixed_versions:
- "0.34.1"
- "0.33.1"
affected_versions: "All versions before 0.33.1, all versions starting from 0.34.0
  before 0.34.1, version 0.34.0"
not_impacted: ""
solution: "Upgrade to versions 0.33.1, 0.34.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-23636"
- "https://github.com/advisories/GHSA-88xq-w8cq-xfg7"
- "https://github.com/bytecodealliance/wasmtime/security/advisories/GHSA-88xq-w8cq-xfg7"
- "https://github.com/bytecodealliance/wasmtime/commit/886ecc562040bef61faf19438c22285c2d62403a"
- "https://github.com/bytecodealliance/wasmtime"
- "https://rustsec.org/advisories/RUSTSEC-2022-0096.html"
cvss_v2: "AV:N/AC:M/Au:N/C:N/I:N/A:C"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "bdd57b45-e883-496b-a41d-94be8847c546"
cwe_ids:
- "CWE-824"
- "CWE-937"
- "CWE-1035"
