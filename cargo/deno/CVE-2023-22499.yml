---
identifier: "CVE-2023-22499"
identifiers:
- "CVE-2023-22499"
- "GHSA-mc52-jpm2-cqh6"
package_slug: "cargo/deno"
title: "Deno is vulnerable to race condition via interactive permission prompt spoofing"
description: "Multi-threaded programs were able to spoof interactive permission prompt
  by rewriting the prompt to suggest that program is waiting on user confirmation
  to unrelated action.\n\nA malicious program could clear the terminal screen after
  permission prompt was shown and write a generic message like so:\n```\n// Expected
  prompt\n⚠️  ┌ Deno requests read access to \"./log.txt\".\n├ Requested by `Deno.open()`
  API\n├ Run again with --allow-read to bypass this prompt.\n└ Allow? [y/n] (y = yes,
  allow; n = no, deny) >\n\n// Prompt that users would see\nDo you want to continue?\n```\n\nThis
  situation impacts users who use Web Worker API and relied on interactive permission
  prompt. The reproduction is very timing sensitive and can’t be reliably reproduced
  on every try.\n\nThis problem can not be exploited on systems that do not attach
  an interactive prompt (for example headless servers)."
date: "2023-04-03"
pubdate: "2023-01-20"
affected_range: ">=1.9.0 <1.29.3"
fixed_versions:
- "1.29.3"
affected_versions: "All versions starting from 1.9.0 before 1.29.3"
not_impacted: "All versions before 1.9.0, all versions starting from 1.29.3"
solution: "Upgrade to version 1.29.3 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-22499"
- "https://github.com/advisories/GHSA-mc52-jpm2-cqh6"
- "https://github.com/denoland/deno/security/advisories/GHSA-mc52-jpm2-cqh6"
- "https://github.com/denoland/deno/pull/17392"
- "https://github.com/denoland/deno"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H"
uuid: "15338357-61a4-4d7c-9600-a1971e530216"
cwe_ids:
- "CWE-362"
- "CWE-937"
- "CWE-1035"
