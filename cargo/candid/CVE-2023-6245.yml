---
identifier: "CVE-2023-6245"
identifiers:
- "CVE-2023-6245"
- "GHSA-7787-p7x6-fq3j"
package_slug: "cargo/candid"
title: "Candid infinite decoding loop through specially crafted payload"
description: "The Candid library causes a Denial of Service while parsing a specially
  crafted payload with `empty` data type. For example, if the payload is `record {
  * ; empty }` and  the canister interface expects `record { * }` then the rust candid
  decoder treats `empty` as an extra field required by the type.  The problem with
  type `empty` is that the candid rust library wrongly categorizes `empty` as a recoverable
  error when skipping the field and thus causing an infinite decoding loop.\n\nCanisters
  using affected versions of candid are exposed to denial of service by causing the
  decoding to run indefinitely until the canister traps due to reaching maximum instruction
  limit per execution round. Repeated exposure to the payload will result in degraded
  performance of the canister.\n\nFor asset canister users, `dfx` versions `>= 0.14.4`
  to `<= 0.15.2-beta.0` ships asset canister with an affected version of candid."
date: "2023-12-08"
pubdate: "2023-12-08"
affected_range: ">=0.9.0 <0.9.10"
fixed_versions:
- "0.9.10"
affected_versions: "All versions starting from 0.9.0 before 0.9.10"
not_impacted: "All versions before 0.9.0, all versions starting from 0.9.10"
solution: "Upgrade to version 0.9.10 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-6245"
- "https://github.com/advisories/GHSA-7787-p7x6-fq3j"
- "https://github.com/dfinity/candid/security/advisories/GHSA-7787-p7x6-fq3j"
- "https://github.com/dfinity/candid/pull/478"
- "https://github.com/dfinity/candid/commit/b233dbc2d2bcc79c9fc574dd5968269df680b073"
- "https://github.com/dfinity/candid"
- "https://github.com/dfinity/candid/blob/master/spec/Candid.md"
- "https://internetcomputer.org/docs/current/references/candid-ref"
- "https://internetcomputer.org/docs/current/references/ic-interface-spec"
- "https://rustsec.org/advisories/RUSTSEC-2023-0073.html"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
uuid: "8472dd33-1d3b-40df-be0a-5be91f6a95c8"
cwe_ids:
- "CWE-1288"
- "CWE-400"
- "CWE-835"
- "CWE-937"
- "CWE-1035"
