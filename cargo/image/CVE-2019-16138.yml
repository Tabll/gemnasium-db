---
identifier: "CVE-2019-16138"
identifiers:
- "CVE-2019-16138"
- "GHSA-m2pf-hprp-3vqm"
package_slug: "cargo/image"
title: "Use after free in image"
description: "Affected versions of this crate would call Vec::set_len on an uninitialized
  vector with user-provided type parameter, in an interface of the HDR image format
  decoder. They would then also call other code that could panic before initializing
  all instances.\n\nThis could run Drop implementations on uninitialized types, equivalent
  to use-after-free, and allow an attacker arbitrary code execution.\n\nTwo different
  fixes were applied. It is possible to conserve the interface by ensuring proper
  initialization before calling Vec::set_len. Drop is no longer called in case of
  panic, though.\n\nStarting from version 0.22, a breaking change to the interface
  requires callers to pre-allocate the output buffer and pass a mutable slice instead,
  avoiding all unsafe code."
date: "2023-06-13"
pubdate: "2021-08-25"
affected_range: ">=0.10.2 <0.21.3"
fixed_versions:
- "0.21.3"
affected_versions: "All versions starting from 0.10.2 before 0.21.3"
not_impacted: "All versions before 0.10.2, all versions starting from 0.21.3"
solution: "Upgrade to version 0.21.3 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2019-16138"
- "https://github.com/advisories/GHSA-m2pf-hprp-3vqm"
- "https://github.com/image-rs/image/pull/985"
- "https://github.com/image-rs/image"
- "https://rustsec.org/advisories/RUSTSEC-2019-0014.html"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "bb979d8b-844f-40f9-8026-a27cf164979e"
cwe_ids:
- "CWE-416"
- "CWE-937"
- "CWE-1035"
