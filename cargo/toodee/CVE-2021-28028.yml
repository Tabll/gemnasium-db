---
identifier: "CVE-2021-28028"
identifiers:
- "CVE-2021-28028"
- "GHSA-wcvp-r8j8-47pc"
package_slug: "cargo/toodee"
title: "Double free in toodee"
description: "When inserting rows from an iterator at a particular index, toodee would
  shift items over, duplicating their ownership. The space reserved for the new elements
  was based on the len() returned by the ExactSizeIterator.\n\nThis could result in
  elements in the array being freed twice if the iterator panics. Uninitialized or
  previously freed elements could also be exposed if the len() didn't match the number
  of elements.\n\nThese issues were fixed in commit `ced70c17` by temporarily setting
  the length of the array smaller while processing it and adding assertions on the
  number of elements returned by the iterator."
date: "2023-06-13"
pubdate: "2021-09-01"
affected_range: "<0.3.0"
fixed_versions:
- "0.3.0"
affected_versions: "All versions before 0.3.0"
not_impacted: "All versions starting from 0.3.0"
solution: "Upgrade to version 0.3.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-28028"
- "https://github.com/advisories/GHSA-wcvp-r8j8-47pc"
- "https://github.com/antonmarsden/toodee/issues/13"
- "https://github.com/antonmarsden/toodee/commit/ced70c172486fb4827c172cd8238053df3d1dcdb"
- "https://github.com/antonmarsden/toodee"
- "https://rustsec.org/advisories/RUSTSEC-2021-0028.html"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "5eed31ec-b7cf-457e-9690-22de6b3cdd1a"
cwe_ids:
- "CWE-415"
- "CWE-937"
- "CWE-1035"
