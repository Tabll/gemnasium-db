---
identifier: "CVE-2021-26307"
identifiers:
- "CVE-2021-26307"
- "GHSA-jrf8-cmgg-gv2m"
package_slug: "cargo/raw-cpuid"
title: "Error on unsupported architectures in raw-cpuid"
description: "native_cpuid::cpuid_count() exposes the unsafe __cpuid_count() intrinsic
  from core::arch::x86 or core::arch::x86_64 as a safe function, and uses it internally,
  without checking the safety requirement:\n\n* The CPU the program is currently running
  on supports the function being called.\n\nCPUID is available in most, but not all,
  x86/x86_64 environments. The crate compiles only on these architectures, so others
  are unaffected. This issue is mitigated by the fact that affected programs are expected
  to crash deterministically every time.\n\nThe flaw has been fixed in v9.0.0, by
  intentionally breaking compilation when targeting SGX or 32-bit x86 without SSE.
  This covers all affected CPUs."
date: "2023-06-13"
pubdate: "2021-08-25"
affected_range: "<9.0.0"
fixed_versions:
- "9.0.0"
affected_versions: "All versions before 9.0.0"
not_impacted: "All versions starting from 9.0.0"
solution: "Upgrade to version 9.0.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-26307"
- "https://github.com/advisories/GHSA-jrf8-cmgg-gv2m"
- "https://github.com/gz/rust-cpuid/issues/40"
- "https://github.com/gz/rust-cpuid/issues/41"
- "https://github.com/RustSec/advisory-db/pull/614"
- "https://github.com/gz/rust-cpuid/commit/91b676eecd01f2163e2984215e2c0ac89e30ce75"
- "https://github.com/gz/rust-cpuid"
- "https://rustsec.org/advisories/RUSTSEC-2021-0013.html"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
uuid: "00d540e7-3c2c-47b6-a97c-4398da3fe46f"
cwe_ids:
- "CWE-400"
- "CWE-657"
- "CWE-937"
- "CWE-1035"
