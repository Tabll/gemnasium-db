---
identifier: "CVE-2021-45704"
identifiers:
- "CVE-2021-45704"
- "GHSA-cwvc-87xq-pc5m"
package_slug: "cargo/metrics-util"
title: "Out-of-bounds Write and Race Condition in metrics-util"
description: "In the affected versions of the crate, AtomicBucket<T> unconditionally
  implements Send/Sync traits. Therefore, users can create a data race to the inner
  T: !Sync by using the AtomicBucket::data_with() API. Such data races can potentially
  cause memory corruption or other undefined behavior.\n\nThe flaw was fixed in commit
  8e6daab by adding appropriate Send/Sync bounds to the Send/Sync impl of struct Block<T>
  (which is a data type contained inside AtomicBucket<T>)."
date: "2023-06-13"
pubdate: "2022-01-06"
affected_range: "<0.7.0"
fixed_versions:
- "0.7.0"
affected_versions: "All versions before 0.7.0"
not_impacted: "All versions starting from 0.7.0"
solution: "Upgrade to version 0.7.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-45704"
- "https://github.com/advisories/GHSA-cwvc-87xq-pc5m"
- "https://github.com/metrics-rs/metrics/issues/190"
- "https://github.com/metrics-rs/metrics/commit/8e6daab"
- "https://github.com/metrics-rs/metrics"
- "https://raw.githubusercontent.com/rustsec/advisory-db/main/crates/metrics-util/RUSTSEC-2021-0113.md"
- "https://rustsec.org/advisories/RUSTSEC-2021-0113.html"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "c3dc7a93-d02c-4e00-ba1d-a49c5633fc60"
cwe_ids:
- "CWE-362"
- "CWE-787"
- "CWE-937"
- "CWE-1035"
