---
identifier: "CVE-2021-29472"
identifiers:
- "GHSA-h5h8-pc6h-jvvx"
- "CVE-2021-29472"
package_slug: "packagist/composer/composer"
title: "Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')"
description: "Composer is a dependency manager for PHP. URLs for Mercurial repositories
  in the root composer.json and package source download URLs are not sanitized correctly.
  Specifically crafted URL values allow code to be executed in the HgDriver if hg/Mercurial
  is installed on the system. The impact to Composer users directly is limited as
  the composer.json file is typically under their own control and source download
  URLs can only be supplied by third party Composer repositories they explicitly trust
  to download and execute source code from, e.g. Composer plugins. The main impact
  is to services passing user input to Composer, including Packagist.org and Private
  Packagist. This allowed users to trigger remote code execution. The vulnerability
  has been patched on Packagist.org and Private Packagist within 12h of receiving
  the initial vulnerability report and based on a review of logs, to the best of our
  knowledge, was not abused by anyone. Other services/tools using VcsRepository/VcsDriver
  or derivatives may also be vulnerable and should upgrade their composer/composer
  dependency immediately. Versions 1.10.22 and 2.0.13 include patches for this issue."
date: "2021-05-27"
pubdate: "2021-04-29"
affected_range: "<1.10.22||>=2.0,<2.0.13"
fixed_versions:
- "1.10.22"
- "2.0.13"
affected_versions: "All versions before 1.10.22, all versions starting from 2.0 before
  2.0.13"
not_impacted: "All versions starting from 1.10.22 before 2.0, all versions starting
  from 2.0.13"
solution: "Upgrade to versions 1.10.22, 2.0.13 or above."
urls:
- "https://github.com/composer/composer/security/advisories/GHSA-h5h8-pc6h-jvvx"
- "https://nvd.nist.gov/vuln/detail/CVE-2021-29472"
- "https://getcomposer.org/"
- "https://www.debian.org/security/2021/dsa-4907"
- "https://lists.debian.org/debian-lts-announce/2021/05/msg00009.html"
- "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/FAQUAMGO4Q4BLNZ2OH4CXQD7UK4IO2GE/"
- "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/KN3DMFH42BJW45VT6FYF2RXKC26D6VC2/"
- "https://github.com/advisories/GHSA-h5h8-pc6h-jvvx"
cvss_v2: "AV:N/AC:L/Au:S/C:P/I:P/A:P"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
uuid: "ad40fc82-be3e-43e9-88de-458388fc514d"
cwe_ids:
- "CWE-1035"
- "CWE-78"
- "CWE-88"
- "CWE-937"
- "CWE-94"
