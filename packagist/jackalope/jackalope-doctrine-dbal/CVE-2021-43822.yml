---
identifier: "CVE-2021-43822"
identifiers:
- "CVE-2021-43822"
- "GHSA-ph98-v78f-jqrm"
package_slug: "packagist/jackalope/jackalope-doctrine-dbal"
title: "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
description: "Jackalope Doctrine-DBAL is an implementation of the PHP Content Repository
  API (PHPCR) using a relational database to persist data. In affected versions users
  can provoke SQL injections if they can specify a node name or query. Upgrade to
  resolve this issue. If that is not possible, you can escape all places where `$property`
  is used to filter `sv:name` in the class `Jackalope\\Transport\\DoctrineDBAL\\Query\\QOMWalker`:
  `XPath::escape($property)`. Node names and xpaths can contain `\"` or `;` according
  to the JCR specification. The jackalope component that translates the query object
  model into doctrine dbal queries does not properly escape the names and paths, so
  that a accordingly crafted node name can lead to an SQL injection. If queries are
  never done from user input, or if you validate the user input to not contain `;`,
  you are not affected."
date: "2021-12-17"
pubdate: "2021-12-13"
affected_range: "<1.7.4"
fixed_versions:
- "1.7.4"
affected_versions: "All versions before 1.7.4"
not_impacted: "All versions starting from 1.7.4"
solution: "Upgrade to version 1.7.4 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-43822"
- "https://github.com/jackalope/jackalope-doctrine-dbal/commit/9d179a36d320330ddb303ea3a7c98d3a33d231db"
- "https://github.com/jackalope/jackalope-doctrine-dbal/security/advisories/GHSA-ph98-v78f-jqrm"
cvss_v2: "AV:N/AC:M/Au:N/C:P/I:P/A:P"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H"
uuid: "0bf0498f-f0c8-427c-9790-36e4e141262b"
cwe_ids:
- "CWE-1035"
- "CWE-89"
- "CWE-937"
