---
identifier: "CVE-2023-46845"
identifiers:
- "CVE-2023-46845"
package_slug: "packagist/ec-cube/ec-cube"
title: "Improper Control of Generation of Code ('Code Injection')"
description: "EC-CUBE 3 series (3.0.0 to 3.0.18-p6) and 4 series (4.0.0 to 4.0.6-p3,
  4.1.0 to 4.1.2-p2, and 4.2.0 to 4.2.2) contain an arbitrary code execution vulnerability
  due to improper settings of the template engine Twig included in the product. As
  a result, arbitrary code may be executed on the server where the product is running
  by a user with an administrative privilege."
date: "2023-11-15"
pubdate: "2023-11-07"
affected_range: ">=3.0.0,<=3.0.18||>=4.0.0,<=4.0.6||>=4.1.0,<=4.1.2||>=4.2.0,<4.2.3"
fixed_versions:
- "4.0.6-p1"
- "4.1.2-p1"
- "4.2.3"
affected_versions: "All versions starting from 3.0.0 up to 3.0.18, all versions starting
  from 4.0.0 up to 4.0.6, all versions starting from 4.1.0 up to 4.1.2, all versions
  starting from 4.2.0 before 4.2.3"
not_impacted: "All versions before 3.0.0, all versions after 3.0.18 before 4.0.0,
  all versions after 4.0.6 before 4.1.0, all versions after 4.1.2 before 4.2.0, all
  versions starting from 4.2.3"
solution: "Upgrade to versions 4.0.6-p1, 4.1.2-p1, 4.2.3 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-46845"
- "https://www.ec-cube.net/info/weakness/20231026/index_40.php"
- "https://www.ec-cube.net/info/weakness/20231026/index.php"
- "https://www.ec-cube.net/info/weakness/20231026/index_3.php"
- "https://jvn.jp/en/jp/JVN29195731/"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H"
uuid: "ea9d513c-66be-4836-8fa7-da83e92ff70d"
cwe_ids:
- "CWE-1035"
- "CWE-937"
- "CWE-94"
