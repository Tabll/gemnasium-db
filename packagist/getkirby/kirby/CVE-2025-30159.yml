---
identifier: "CVE-2025-30159"
identifiers:
- "CVE-2025-30159"
- "GHSA-fw82-87p8-v6hp"
package_slug: "packagist/getkirby/kirby"
title: "Kirby vulnerable to path traversal of snippet names in the `snippet()` helper"
description: "The missing path traversal check allowed attackers to navigate and access
  all files on the server that were accessible to the PHP process, including files
  outside of the snippets root or even outside of the Kirby installation. PHP code
  within such files was executed.\n\nSuch attacks first require an attack vector in
  the site code that is caused by dynamic snippet names, such as `snippet('tags-'
  . get('tags'))`. It generally also requires knowledge of the site structure and
  the server's file system by the attacker, although it can be possible to find vulnerable
  setups through automated methods such as fuzzing.\n\nIn a vulnerable setup, this
  could cause damage to the confidentiality and integrity of the server, for example:\n\n-
  it could allow the attacker to build a map of the server's file system for subsequent
  attacks,\n- it could allow access to configuration files that may contain sensitive
  information like security tokens or\n- it could cause the unintended execution of
  PHP scripts."
date: "2025-05-13"
pubdate: "2025-05-13"
affected_range: "<3.9.8.3||>=3.10.0 <3.10.1.2||>=4.0.0 <4.7.1"
fixed_versions:
- "3.9.8.3"
- "3.10.1.2"
- "4.7.1"
affected_versions: "All versions before 3.9.8.3, all versions starting from 3.10.0
  before 3.10.1.2, all versions starting from 4.0.0 before 4.7.1"
not_impacted: "All versions starting from 3.9.8.3 before 3.10.0, all versions starting
  from 3.10.1.2 before 4.0.0, all versions starting from 4.7.1"
solution: "Upgrade to versions 3.10.1.2, 3.9.8.3, 4.7.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2025-30159"
- "https://github.com/advisories/GHSA-fw82-87p8-v6hp"
- "https://github.com/getkirby/kirby/security/advisories/GHSA-fw82-87p8-v6hp"
- "https://github.com/getkirby/kirby/commit/90acf7ed6d8d9d0697f938edc0940b4a563ddbe7"
- "https://github.com/getkirby/kirby"
- "https://github.com/getkirby/kirby/releases/tag/3.10.1.2"
- "https://github.com/getkirby/kirby/releases/tag/3.9.8.3"
- "https://github.com/getkirby/kirby/releases/tag/4.7.1"
uuid: "0019b035-e0c4-4a48-abcc-88c69dcbceb4"
cwe_ids:
- "CWE-22"
- "CWE-23"
- "CWE-937"
- "CWE-1035"
