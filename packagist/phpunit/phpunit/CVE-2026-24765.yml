---
identifier: "CVE-2026-24765"
identifiers:
- "CVE-2026-24765"
- "GHSA-vvj3-c3rp-c85p"
package_slug: "packagist/phpunit/phpunit"
title: "PHPUnit Vulnerable to Unsafe Deserialization in PHPT Code Coverage Handling"
description: "### Overview\n\nA vulnerability has been discovered involving unsafe
  deserialization of code coverage data in PHPT test execution. The vulnerability
  exists in the `cleanupForCoverage()` method, which deserializes code coverage files
  without validation, potentially allowing remote code execution if malicious `.coverage`
  files are present prior to the execution of the PHPT test.\n\n### Technical Details\n\n**Affected
  Component:** PHPT test runner, method `cleanupForCoverage()`\n**Affected Versions:**
  <= 8.5.51, <= 9.6.32, <= 10.5.61, <= 11.5.49, <= 12.5.7\n\n### Vulnerable Code Pattern\n\n```php\nif
  ($buffer !== false) {\n    // Unsafe call without restrictions\n    $coverage =
  @unserialize($buffer);\n}\n```\n\nThe vulnerability occurs when a `.coverage` file,
  which should not exist before test execution, is deserialized without the `allowed_classes`
  parameter restriction. An attacker with local file write access can place a malicious
  serialized object with a `__wakeup()` method into the file system, leading to arbitrary
  code execution during test runs with code coverage instrumentation enabled.\n\n###
  Attack Prerequisites and Constraints\n\nThis vulnerability requires **local file
  write access** to the location where PHPUnit stores or expects code coverage files
  for PHPT tests. This can occur through:\n\n* **CI/CD Pipeline Attacks:** A malicious
  pull request that places a `.coverage` file alongside test files, executed when
  the CI system runs tests using PHPUnit and collects code coverage information\n*
  **Local Development Environment:** An attacker with shell access or ability to write
  files to the project directory\n* **Compromised Dependencies:** A supply chain attack
  inserting malicious files into a package or monorepo"
date: "2026-01-27"
pubdate: "2026-01-27"
affected_range: "<8.5.52||>=9.0.0 <9.6.33||>=10.0.0 <10.5.62||>=11.0.0 <11.5.50||>=12.0.0
  <12.5.8"
fixed_versions:
- "8.5.52"
- "9.6.33"
- "10.5.62"
- "11.5.50"
- "12.5.8"
affected_versions: "All versions before 8.5.52, all versions starting from 9.0.0 before
  9.6.33, all versions starting from 10.0.0 before 10.5.62, all versions starting
  from 11.0.0 before 11.5.50, all versions starting from 12.0.0 before 12.5.8"
not_impacted: "All versions starting from 8.5.52 before 9.0.0, all versions starting
  from 9.6.33 before 10.0.0, all versions starting from 10.5.62 before 11.0.0, all
  versions starting from 11.5.50 before 12.0.0, all versions starting from 12.5.8"
solution: "Upgrade to versions 10.5.62, 11.5.50, 12.5.8, 8.5.52, 9.6.33 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2026-24765"
- "https://github.com/advisories/GHSA-vvj3-c3rp-c85p"
- "https://github.com/sebastianbergmann/phpunit/security/advisories/GHSA-vvj3-c3rp-c85p"
- "https://github.com/sebastianbergmann/phpunit/commit/613d142f5a8471ca71623ce5ca2795f79248329e"
- "https://github.com/sebastianbergmann/phpunit"
- "https://github.com/sebastianbergmann/phpunit/releases/tag/10.5.63"
- "https://github.com/sebastianbergmann/phpunit/releases/tag/11.5.50"
- "https://github.com/sebastianbergmann/phpunit/releases/tag/12.5.8"
- "https://github.com/sebastianbergmann/phpunit/releases/tag/8.5.52"
- "https://github.com/sebastianbergmann/phpunit/releases/tag/9.6.33"
- "https://owasp.org/www-project-top-10-ci-cd-security-risks/CICD-SEC-04-Poisoned-Pipeline-Execution"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
uuid: "bca55a7d-111f-40bb-8ee2-48d4ccb8c7e7"
cwe_ids:
- "CWE-502"
- "CWE-937"
- "CWE-1035"
