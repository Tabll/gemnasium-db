---
identifier: "CVE-2022-35943"
identifiers:
- "CVE-2022-35943"
- "GHSA-5hm8-vh6r-2cjq"
package_slug: "packagist/codeigniter/framework"
title: "Cross-Site Request Forgery (CSRF)"
description: "Shield is an authentication and authorization framework for CodeIgniter
  4. This vulnerability may allow [SameSite Attackers](https://canitakeyoursubdomain.name/)
  to bypass the [CodeIgniter4 CSRF protection](https://codeigniter4.github.io/userguide/libraries/security.html)
  mechanism with CodeIgniter Shield. For this attack to succeed, the attacker must
  have direct (or indirect, e.g., XSS) control over a subdomain site (e.g., `https://a.example.com/`)
  of the target site (e.g., `http://example.com/`). Upgrade to **CodeIgniter v4.2.3
  or later** and **Shield v1.0.0-beta.2 or later**. As a workaround: set `Config\\Security::$csrfProtection`
  to `'session,'`remove old session data right after login (immediately after ID and
  password match) and regenerate CSRF token right after login (immediately after ID
  and password match)"
date: "2022-08-16"
pubdate: "2022-08-12"
affected_range: "<4.2.3"
fixed_versions: []
affected_versions: "All versions before 4.2.3"
not_impacted: ""
solution: "Unfortunately, there is no solution available yet."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-35943"
- "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie/SameSite"
- "https://jub0bs.com/posts/2021-01-29-great-samesite-confusion"
- "https://codeigniter4.github.io/userguide/libraries/security.htm"
- "https://github.com/codeigniter4/shield/security/advisories/GHSA-5hm8-vh6r-2cjq"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H"
uuid: "f5d0da18-9b36-47d5-93a2-94b9d273f9a6"
cwe_ids:
- "CWE-1035"
- "CWE-352"
- "CWE-937"
