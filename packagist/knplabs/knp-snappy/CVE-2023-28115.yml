---
identifier: "CVE-2023-28115"
identifiers:
- "GHSA-gq6w-q6wh-jggc"
- "CVE-2023-28115"
package_slug: "packagist/knplabs/knp-snappy"
title: "Deserialization of Untrusted Data"
description: "Snappy is a PHP library allowing thumbnail, snapshot or PDF generation
  from a url or a html page. Prior to version 1.4.2, Snappy is vulnerable to PHAR
  deserialization due to a lack of checking on the protocol before passing it into
  the `file_exists()` function. If an attacker can upload files of any type to the
  server he can pass in the phar:// protocol to unserialize the uploaded file and
  instantiate arbitrary PHP objects. This can lead to remote code execution especially
  when snappy is used with frameworks with documented POP chains like Laravel/Symfony
  vulnerable developer code. If a user can control the output file from the `generateFromHtml()`
  function, it will invoke deserialization. This vulnerability is capable of remote
  code execution if Snappy is used with frameworks or developer code with vulnerable
  POP chains. It has been fixed in version 1.4.2."
date: "2023-03-17"
pubdate: "2023-03-17"
affected_range: "<=1.4.1"
fixed_versions:
- "1.4.2"
affected_versions: "All versions up to 1.4.1"
not_impacted: "All versions after 1.4.1"
solution: "Upgrade to version 1.4.2 or above."
urls:
- "https://github.com/KnpLabs/snappy/security/advisories/GHSA-gq6w-q6wh-jggc"
- "https://github.com/KnpLabs/snappy/commit/1ee6360cbdbea5d09705909a150df7963a88efd6"
- "https://huntr.dev/bounties/0bdddc12-ff67-4815-ab9f-6011a974f48e/"
- "https://github.com/advisories/GHSA-gq6w-q6wh-jggc"
uuid: "b46ee422-ba82-48df-8d3f-ef95cf0a06d8"
cwe_ids:
- "CWE-1035"
- "CWE-502"
- "CWE-78"
- "CWE-937"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
