---
identifier: "CVE-2022-35943"
identifiers:
- "GHSA-5hm8-vh6r-2cjq"
- "CVE-2022-35943"
package_slug: "packagist/codeigniter4/shield"
title: "Cross-Site Request Forgery (CSRF)"
description: "Shield is an authentication and authorization framework for CodeIgniter
  4. This vulnerability may allow [SameSite Attackers](https://canitakeyoursubdomain.name/)
  to bypass the [CodeIgniter4 CSRF protection](https://codeigniter4.github.io/userguide/libraries/security.html)
  mechanism with CodeIgniter Shield. For this attack to succeed, the attacker must
  have direct (or indirect, e.g., XSS) control over a subdomain site (e.g., `https://a.example.com/`)
  of the target site (e.g., `http://example.com/`). Upgrade to **CodeIgniter v4.2.3
  or later** and **Shield v1.0.0-beta.2 or later**. As a workaround: set `Config\\Security::$csrfProtection`
  to `'session,'`remove old session data right after login (immediately after ID and
  password match) and regenerate CSRF token right after login (immediately after ID
  and password match)"
date: "2022-08-18"
pubdate: "2022-08-18"
affected_range: "=1.0.0-beta"
fixed_versions:
- "1.0.0-beta.2"
affected_versions: "Version 1.0.0-beta"
not_impacted: "All versions before 1.0.0-beta, all versions after 1.0.0-beta"
solution: "Upgrade to version 1.0.0-beta.2 or above. *Note*: 1.0.0-beta.2 may be an
  unstable version. Use caution."
urls:
- "https://github.com/codeigniter4/shield/security/advisories/GHSA-5hm8-vh6r-2cjq"
- "https://nvd.nist.gov/vuln/detail/CVE-2022-35943"
- "https://github.com/codeigniter4/shield/commit/342a368536678621998c3c41d276480cd14ec6c6"
- "https://codeigniter4.github.io/userguide/libraries/security.htm"
- "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie/SameSite"
- "https://jub0bs.com/posts/2021-01-29-great-samesite-confusion"
- "https://github.com/advisories/GHSA-5hm8-vh6r-2cjq"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H"
uuid: "c1834644-b9e9-4779-b0e7-b5a8d7388104"
cwe_ids:
- "CWE-1035"
- "CWE-352"
- "CWE-79"
- "CWE-937"
