---
identifier: "CVE-2022-39284"
identifiers:
- "GHSA-745p-r637-7vvp"
- "CVE-2022-39284"
package_slug: "packagist/codeigniter4/framework"
title: "Improper Initialization"
description: "CodeIgniter is a PHP full-stack web framework. In versions prior to
  4.2.7 setting `$secure` or `$httponly` value to `true` in `Config\\Cookie` is not
  reflected in `set_cookie()` or `Response::setCookie()`. As a result cookie values
  are erroneously exposed to scripts. It should be noted that this vulnerability does
  not affect session cookies. Users are advised to upgrade to v4.2.7 or later. Users
  unable to upgrade are advised to manually construct their cookies either by setting
  the options in code or by constructing Cookie objects. Examples of each workaround
  are available in the linked GHSA."
date: "2022-10-10"
pubdate: "2022-10-06"
affected_range: "<4.2.7"
fixed_versions:
- "4.2.7"
affected_versions: "All versions before 4.2.7"
not_impacted: "All versions starting from 4.2.7"
solution: "Upgrade to version 4.2.7 or above."
urls:
- "https://github.com/codeigniter4/CodeIgniter4/security/advisories/GHSA-745p-r637-7vvp"
- "https://github.com/codeigniter4/CodeIgniter4/issues/6540"
- "https://github.com/codeigniter4/CodeIgniter4/pull/6544"
- "https://nvd.nist.gov/vuln/detail/CVE-2022-39284"
- "https://codeigniter4.github.io/userguide/helpers/cookie_helper.html#set_cookie"
- "https://codeigniter4.github.io/userguide/outgoing/response.html#CodeIgniter%5CHTTP%5CResponse::setCookie"
- "https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies#restrict_access_to_cookies"
- "https://github.com/FriendsOfPHP/security-advisories/blob/master/codeigniter4/framework/CVE-2022-39284.yaml"
- "https://github.com/advisories/GHSA-745p-r637-7vvp"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N"
uuid: "942b3b38-e80c-4a4a-9f5f-371238176a04"
cwe_ids:
- "CWE-1035"
- "CWE-665"
- "CWE-937"
