---
identifier: "CVE-2019-12331"
identifiers:
- "CVE-2019-12331"
- "GHSA-vvwv-h69m-wg6f"
package_slug: "packagist/phpoffice/phpexcel"
title: "XXE in PHPSpreadsheet due to incomplete fix for previous encoding issue"
description: "PHPOffice PhpSpreadsheet before 1.8.0 has an XXE issue. The XmlScanner
  decodes the sheet1.xml from an .xlsx to utf-8 if something else than UTF-8 is declared
  in the header. This was a security measurement to prevent CVE-2018-19277 but the
  fix is not sufficient. By double-encoding the the xml payload to utf-7 it is possible
  to bypass the check for the string ?<!ENTITY? and thus allowing for an xml external
  entity processing (XXE) attack."
date: "2025-03-06"
pubdate: "2019-11-20"
affected_range: "<=1.8.2"
fixed_versions: []
affected_versions: "All versions up to 1.8.2"
not_impacted: ""
solution: "Unfortunately, there is no solution available yet."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2019-12331"
- "https://github.com/advisories/GHSA-vvwv-h69m-wg6f"
- "https://github.com/PHPOffice/PhpSpreadsheet/pull/1041"
- "https://github.com/PHPOffice/PhpSpreadsheet/commit/0e6238c69e863b58aeece61e48ea032696c6dccd"
- "https://github.com/FriendsOfPHP/security-advisories/blob/master/phpoffice/phpspreadsheet/CVE-2019-12331.yaml"
- "https://github.com/PHPOffice/PhpSpreadsheet"
- "https://github.com/PHPOffice/PhpSpreadsheet/blob/master/CHANGELOG.md#180---2019-07-01"
- "https://github.com/PHPOffice/PhpSpreadsheet/releases/tag/1.8.0"
- "https://herolab.usd.de/security-advisories/usd-2019-0046"
cvss_v2: "AV:N/AC:M/Au:N/C:P/I:P/A:P"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H"
uuid: "01ca7151-6bae-47fc-987f-e156641f4d27"
cwe_ids:
- "CWE-611"
- "CWE-937"
- "CWE-1035"
