---
identifier: "CVE-2021-22968"
identifiers:
- "GHSA-g3p2-hfqr-9m25"
- "CVE-2021-22968"
package_slug: "packagist/concrete5/core"
title: "Improper Neutralization of Special Elements used in an OS Command ('OS Command
  Injection')"
description: "A bypass of adding remote files in Concrete CMS (previously concrete5)
  File Manager leads to remote code execution in Concrete CMS (concrete5) versions
  8.5.6 and below.The external file upload feature stages files in the public directory
  even if they have disallowed file extensions. They are stored in a directory with
  a random name, but it's possible to stall the uploads and brute force the directory
  name. You have to be an admin with the ability to upload files, but this bug gives
  you the ability to upload restricted file types and execute them depending on server
  configuration.To fix this, a check for allowed file extensions was added before
  downloading files to a tmp directory.Concrete CMS Security Team gave this a CVSS
  v3.1 score of 5.4 AV:N/AC:H/PR:H/UI:R/S:C/C:N/I:H/A:NThis fix is also in Concrete
  version 9.0.0"
date: "2021-11-23"
pubdate: "2021-11-23"
affected_range: "<8.5.7"
fixed_versions:
- "8.5.7"
affected_versions: "All versions before 8.5.7"
not_impacted: "All versions starting from 8.5.7"
solution: "Upgrade to version 8.5.7 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-22968"
- "https://hackerone.com/reports/1350444"
- "https://documentation.concretecms.org/developers/introduction/version-history/857-release-notes"
- "https://github.com/advisories/GHSA-g3p2-hfqr-9m25"
cvss_v2: "AV:N/AC:L/Au:S/C:P/I:P/A:P"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H"
uuid: "22eafbe1-579e-47c2-a692-a91482d16f02"
cwe_ids:
- "CWE-1035"
- "CWE-78"
- "CWE-937"
