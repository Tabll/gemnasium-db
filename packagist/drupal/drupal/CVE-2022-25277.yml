---
identifier: "CVE-2022-25277"
identifiers:
- "CVE-2022-25277"
package_slug: "packagist/drupal/drupal"
title: "Unrestricted Upload of File with Dangerous Type"
description: "Drupal core sanitizes filenames with dangerous extensions upon upload
  (reference: SA-CORE-2020-012) and strips leading and trailing dots from filenames
  to prevent uploading server configuration files (reference: SA-CORE-2019-010). However,
  the protections for these two vulnerabilities previously does not work correctly
  together. As a result, if the site were configured to allow the upload of files
  with an htaccess extension, these files' filenames would not be properly sanitized.
  This could allow bypassing the protections provided by Drupal core's default .htaccess
  files and possible remote code execution on Apache web servers. This issue is mitigated
  by the fact that it requires a field administrator to explicitly configure a file
  field to allow htaccess as an extension (a restricted permission), or a contributed
  module or custom code that overrides allowed file uploads."
date: "2023-05-09"
pubdate: "2023-04-26"
affected_range: ">=8.0.0,<9.3.19||>=9.4.0,<9.4.3"
fixed_versions: []
affected_versions: "All versions starting from 8.0.0 before 9.3.19, all versions starting
  from 9.4.0 before 9.4.3"
not_impacted: ""
solution: "Unfortunately, there is no solution available yet."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-25277"
- "https://www.drupal.org/sa-core-2022-014"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H"
uuid: "47fae4a3-6ff7-4239-aaaa-7f0520b39658"
cwe_ids:
- "CWE-1035"
- "CWE-434"
- "CWE-937"
