---
identifier: "CVE-2017-6930"
package_slug: "packagist/drupal/core"
title: "Language fallback can be incorrect on multilingual sites with node access
  restrictions"
description: "When using node access controls with a multilingual site, Drupal marks
  the untranslated version of a node as the default fallback for access queries. This
  fallback is used for languages that do not yet have a translated version of the
  created node. This can result in an access bypass vulnerability. This issue is mitigated
  by the fact that it only applies to sites that a) use the Content Translation module;
  and b) use a node access module such as Domain Access which implement hook_node_access_records().
  Note that the update will mark the node access tables as needing a rebuild, which
  will take a long time on sites with a large number of nodes."
date: "2019-10-02"
pubdate: "2018-03-01"
affected_range: "<8.4.5"
fixed_versions:
- "8.4.5"
affected_versions: "All versions before 8.4.5"
not_impacted: "All versions starting from 8.4.5"
solution: "Upgrade to version 8.4.5 or above."
urls:
- "http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2017-6930"
- "https://www.drupal.org/SA-CORE-2018-001"
credit: "Ken Rickard"
cvss_v2: "AV:N/AC:M/Au:N/C:P/I:P/A:P"
cvss_v3: "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "9a4fca06-342d-4a8c-a22f-0d24c790c135"
cwe_ids:
- "CWE-1035"
- "CWE-937"
identifiers:
- "CVE-2017-6930"
