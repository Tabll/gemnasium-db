---
identifier: "CVE-2024-45411"
identifiers:
- "CVE-2024-45411"
- "GHSA-6j75-5wfj-gh66"
package_slug: "packagist/twig/twig"
title: "Twig has a possible sandbox bypass"
description: "Under some circumstances, the sandbox security checks are not run which
  allows user-contributed templates to bypass the sandbox restrictions.\n\nThe security
  issue happens when all these conditions are met:\n\n* The sandbox is disabled globally;\n*
  The sandbox is enabled via a sandboxed `include()` function which references a template
  name (like `included.twig`) and not a `Template` or `TemplateWrapper` instance;\n*
  The included template has been loaded before the `include()` call but in a non-sandbox
  context (possible as the sandbox has been globally disabled)."
date: "2024-09-10"
pubdate: "2024-09-09"
affected_range: ">=1.0.0 <1.44.8||>=2.0.0 <2.16.1||>=3.12.0 <3.14.0||>=3.0.0 <3.11.1"
fixed_versions:
- "1.44.8"
- "2.16.1"
- "3.14.0"
- "3.11.1"
affected_versions: "All versions starting from 1.0.0 before 1.44.8, all versions starting
  from 2.0.0 before 2.16.1, all versions starting from 3.0.0 before 3.11.1, all versions
  starting from 3.12.0 before 3.14.0"
not_impacted: "All versions before 1.0.0, all versions starting from 1.44.8 before
  2.0.0, all versions starting from 2.16.1 before 3.0.0, all versions starting from
  3.11.1 before 3.12.0, all versions starting from 3.14.0"
solution: "Upgrade to versions 1.44.8, 2.16.1, 3.11.1, 3.14.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-45411"
- "https://github.com/advisories/GHSA-6j75-5wfj-gh66"
- "https://github.com/twigphp/Twig/security/advisories/GHSA-6j75-5wfj-gh66"
- "https://github.com/twigphp/Twig/commit/11f68e2aeb526bfaf638e30d4420d8a710f3f7c6"
- "https://github.com/twigphp/Twig/commit/2102dd135986db79192d26fb5f5817a566e0a7de"
- "https://github.com/twigphp/Twig/commit/41103dcdc2daab4c83cdd05b5b4fde5b7e41e635"
- "https://github.com/twigphp/Twig/commit/7afa198603de49d147e90d18062e7b9addcf5233"
- "https://github.com/twigphp/Twig"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N"
uuid: "e75cdd66-c95e-4d43-8e93-9150d68ec3d8"
cwe_ids:
- "CWE-693"
- "CWE-937"
- "CWE-1035"
