---
identifier: "CVE-2022-39261"
identifiers:
- "CVE-2022-39261"
- "GHSA-52m2-vc4m-jj33"
package_slug: "packagist/twig/twig"
title: "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
description: "Twig is a template language for PHP. Versions 1.x prior to 1.44.7, 2.x
  prior to 2.15.3, and 3.x prior to 3.4.3 encounter an issue when the filesystem loader
  loads templates for which the name is a user input. It is possible to use the `source`
  or `include` statement to read arbitrary files from outside the templates' directory
  when using a namespace like `@somewhere/../some.file`. In such a case, validation
  is bypassed. Versions 1.44.7, 2.15.3, and 3.4.3 contain a fix for validation of
  such template names. There are no known workarounds aside from upgrading."
date: "2023-11-07"
pubdate: "2022-09-28"
affected_range: ">=1.0.0,<1.44.7||>=2.0.0,<2.15.3||>=3.0.0,<3.4.3"
fixed_versions:
- "1.44.7"
- "2.15.3"
- "3.4.3"
affected_versions: "All versions starting from 1.0.0 before 1.44.7, all versions starting
  from 2.0.0 before 2.15.3, all versions starting from 3.0.0 before 3.4.3"
not_impacted: "All versions before 1.0.0, all versions starting from 1.44.7 before
  2.0.0, all versions starting from 2.15.3 before 3.0.0, all versions starting from
  3.4.3"
solution: "Upgrade to versions 1.44.7, 2.15.3, 3.4.3 or above."
urls:
- "https://github.com/twigphp/Twig/security/advisories/GHSA-52m2-vc4m-jj33"
- "https://nvd.nist.gov/vuln/detail/CVE-2022-39261"
- "https://github.com/twigphp/Twig/commit/35f3035c5deb0041da7b84daf02dea074ddc7a0b"
- "https://github.com/FriendsOfPHP/security-advisories/blob/master/twig/twig/CVE-2022-39261.yaml"
- "https://symfony.com/blog/twig-security-release-possibility-to-load-a-template-outside-a-configured-directory-when-using-the-filesystem-loader"
- "https://www.drupal.org/sa-core-2022-016"
- "https://github.com/advisories/GHSA-52m2-vc4m-jj33"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"
uuid: "64eaf38e-3c37-408e-8a77-1e561eba2919"
cwe_ids:
- "CWE-1035"
- "CWE-22"
- "CWE-937"
