---
identifier: "CVE-2023-24814"
identifiers:
- "CVE-2023-24814"
- "GHSA-r4f8-f93x-5qh3"
package_slug: "packagist/typo3/cms"
title: "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
description: "TYPO3 is a free and open source Content Management Framework released
  under the GNU General Public License. In affected versions the TYPO3 core component
  `GeneralUtility::getIndpEnv()` uses the unfiltered server environment variable `PATH_INFO`,
  which allows attackers to inject malicious content. In combination with the TypoScript
  setting `config.absRefPrefix=auto`, attackers can inject malicious HTML code to
  pages that have not been rendered and cached, yet. As a result, injected values
  would be cached and delivered to other website visitors (persisted cross-site scripting).
  Individual code which relies on the resolved value of `GeneralUtility::getIndpEnv('SCRIPT_NAME')`
  and corresponding usages (as shown below) is vulnerable as well. Additional investigations
  confirmed that at least Apache web server deployments using CGI (FPM, FCGI/FastCGI,
  and similar) are affected. However, there still might be the risk that other scenarios
  like nginx, IIS, or Apache/mod_php is vulnerable. The usage of server environment
  variable `PATH_INFO` has been removed from corresponding processings in `GeneralUtility::getIndpEnv()`.
  Besides that, the public property `TypoScriptFrontendController::$absRefPrefix`
  is encoded for both being used as a URI component and for being used as a prefix
  in an HTML context. This mitigates the cross-site scripting vulnerability. Users
  are advised to update to TYPO3 versions 8.7.51 ELTS, 9.5.40 ELTS, 10.4.35 LTS, 11.5.23
  LTS and 12.2.0 which fix this problem. For users who are unable to patch in a timely
  manner the TypoScript setting `config.absRefPrefix` should at least be set to a
  static path value, instead of using auto - e.g. `config.absRefPrefix=/`. This workaround
  **does not fix all aspects of the vulnerability**, and is just considered to be
  an intermediate mitigation to the most prominent manifestation."
date: "2023-02-16"
pubdate: "2023-02-07"
affected_range: ">=8.7.0,<9.7.51||>=10.0.0,<10.4.36||>=11.0.0,<11.5.23||>=12.0.0,<12.2.0"
fixed_versions:
- "10.4.36"
- "11.5.23"
- "12.2.0"
affected_versions: "All versions starting from 8.7.0 before 9.7.51, all versions starting
  from 10.0.0 before 10.4.36, all versions starting from 11.0.0 before 11.5.23, all
  versions starting from 12.0.0 before 12.2.0"
not_impacted: "All versions before 8.7.0, all versions starting from 9.7.51 before
  10.0.0, all versions starting from 10.4.36 before 11.0.0, all versions starting
  from 11.5.23 before 12.0.0, all versions starting from 12.2.0"
solution: "Upgrade to versions 10.4.36, 11.5.23, 12.2.0 or above."
urls:
- "https://github.com/TYPO3/typo3/security/advisories/GHSA-r4f8-f93x-5qh3"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-24814"
- "https://github.com/TYPO3/typo3/commit/0005a6fd86ab97eff8bf2e3a5828bf0e7cb6263a"
- "https://docs.typo3.org/m/typo3/reference-typoscript/main/en-us/Setup/Config/Index.html#absrefprefix"
- "https://github.com/FriendsOfPHP/security-advisories/blob/master/typo3/cms/CVE-2023-24814.yaml"
- "https://github.com/TYPO3/typo3/blob/v11.5.22/typo3/sysext/core/Classes/Utility/GeneralUtility.php#L2481-L2484"
- "https://github.com/TYPO3/typo3/blob/v11.5.22/typo3/sysext/frontend/Classes/Controller/TypoScriptFrontendController.php#L2547-L2549"
- "https://typo3.org/security/advisory/typo3-core-sa-2023-001"
- "https://typo3.org/security/advisory/typo3-psa-2023-001"
- "https://github.com/advisories/GHSA-r4f8-f93x-5qh3"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N"
uuid: "2e5ef9da-0b85-4904-99d8-078c8f8caa81"
cwe_ids:
- "CWE-1035"
- "CWE-79"
- "CWE-937"
