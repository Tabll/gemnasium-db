---
identifier: "CVE-2024-25121"
identifiers:
- "GHSA-rj3x-wvc6-5j66"
- "CVE-2024-25121"
package_slug: "packagist/typo3/cms-core"
title: "Improper Access Control"
description: "TYPO3 is an open source PHP based web content management system released
  under the GNU GPL. In affected versions of TYPO3 entities of the File Abstraction
  Layer (FAL) could be persisted directly via `DataHandler`. This allowed attackers
  to reference files in the fallback storage directly and retrieve their file names
  and contents. The fallback storage (\"zero-storage\") is used as a backward compatibility
  layer for files located outside properly configured file storages and within the
  public web root directory. Exploiting this vulnerability requires a valid backend
  user account. Users are advised to update to TYPO3 version 8.7.57 ELTS, 9.5.46 ELTS,
  10.4.43 ELTS, 11.5.35 LTS, 12.4.11 LTS, or 13.0.1 which fix the problem described.
  When persisting entities of the File Abstraction Layer directly via DataHandler,
  `sys_file` entities are now denied by default, and `sys_file_reference` & `sys_file_metadata`
  entities are not permitted to reference files in the fallback storage anymore. When
  importing data from secure origins, this must be explicitly enabled in the corresponding
  DataHandler instance by using `$dataHandler->isImporting = true;`.\n\n\n"
date: "2024-02-13"
pubdate: "2024-02-13"
affected_range: ">=8.0.0,<=8.7.56||>=9.0.0,<=9.5.45||>=10.0.0,<=10.4.42||>=11.0.0,<=11.5.34||>=12.0.0,<=12.4.10||=13.0.0"
fixed_versions:
- "8.7.57"
- "9.5.46"
- "10.4.43"
- "11.5.35"
- "12.4.11"
- "13.0.1"
affected_versions: "All versions starting from 8.0.0 up to 8.7.56, all versions starting
  from 9.0.0 up to 9.5.45, all versions starting from 10.0.0 up to 10.4.42, all versions
  starting from 11.0.0 up to 11.5.34, all versions starting from 12.0.0 up to 12.4.10,
  version 13.0.0"
not_impacted: "All versions before 8.0.0, all versions after 8.7.56 before 9.0.0,
  all versions after 9.5.45 before 10.0.0, all versions after 10.4.42 before 11.0.0,
  all versions after 11.5.34 before 12.0.0, all versions after 12.4.10 before 13.0.0,
  all versions after 13.0.0"
solution: "Upgrade to versions 8.7.57, 9.5.46, 10.4.43, 11.5.35, 12.4.11, 13.0.1 or
  above."
urls:
- "https://github.com/TYPO3/typo3/security/advisories/GHSA-rj3x-wvc6-5j66"
- "https://github.com/TYPO3/typo3/commit/38f0bf9a61e10365be26eb75bc23a81184dbed07"
- "https://github.com/TYPO3/typo3/commit/71e652bf84b16fd3592205f61f36750ab03db74c"
- "https://github.com/TYPO3/typo3/commit/b47b6ddf5a5f3f852c6e43f837360780c12e3c47"
- "https://typo3.org/security/advisory/typo3-core-sa-2024-006"
- "https://github.com/advisories/GHSA-rj3x-wvc6-5j66"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N"
uuid: "556fb907-a2f8-4493-8084-8234bf6cdf9c"
cwe_ids:
- "CWE-1035"
- "CWE-200"
- "CWE-284"
- "CWE-937"
...
