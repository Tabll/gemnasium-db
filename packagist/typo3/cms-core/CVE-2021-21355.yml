---
identifier: "CVE-2021-21355"
package_slug: "packagist/typo3/cms-core"
title: "Unrestricted Upload of File with Dangerous Type"
description: "Due to the lack of ensuring file extensions belong to configured allowed
  mime-types, attackers can upload arbitrary data with arbitrary file extensions -
  however, default `_fileDenyPattern_` successfully blocked files like `_.htaccess_`
  or `_malicious.php_`. Additionally, `_UploadedFileReferenceConverter_` transforming
  uploaded files into proper FileReference domain model objects handles possible file
  uploads for other extensions as well - given those extensions use the Extbase MVC
  framework, make use of FileReference items in their direct or inherited domain model
  definitions and did not implement their own type converter. In case this scenario
  applies, `_UploadedFileReferenceConverter_` accepts any file mime-type and persists
  files in the default location. In any way, uploaded files are placed in the default
  location `_/fileadmin/user_upload/_`, in most scenarios keeping the submitted filename
  - which allows attackers to directly reference files, or even correctly guess filenames
  used by other individuals, disclosing this information. No authentication is required
  to exploit this vulnerability. "
date: "2021-03-26"
pubdate: "2021-03-23"
affected_range: ">=8.0.0,<8.7.40||>=9.0.0,<9.5.25||>=10.0.0,<10.4.14||>=11.0.0,<11.1.1"
fixed_versions:
- "8.7.40"
- "9.5.25"
- "10.4.14"
- "11.1.1"
affected_versions: "All versions starting from 8.0.0 before 8.7.40, all versions starting
  from 9.0.0 before 9.5.25, all versions starting from 10.0.0 before 10.4.14, all
  versions starting from 11.0.0 before 11.1.1"
not_impacted: "All versions before 8.0.0, all versions starting from 8.7.40 before
  9.0.0, all versions starting from 9.5.25 before 10.0.0, all versions starting from
  10.4.14 before 11.0.0, all versions starting from 11.1.1"
solution: "Upgrade to versions 8.7.40, 9.5.25, 10.4.14, 11.1.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-21355"
- "https://typo3.org/security/advisory/typo3-core-sa-2021-002"
cvss_v2: "AV:N/AC:L/Au:N/C:P/I:P/A:P"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:H/A:L"
uuid: "25ba2677-c5d3-42b3-95e5-3acfcfe98551"
cwe_ids:
- "CWE-1035"
- "CWE-434"
- "CWE-552"
- "CWE-937"
identifiers:
- "CVE-2021-21355"
- "GHSA-2r6j-862c-m2v2"
