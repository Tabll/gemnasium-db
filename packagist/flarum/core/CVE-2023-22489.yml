---
identifier: "CVE-2023-22489"
identifiers:
- "CVE-2023-22489"
- "GHSA-hph3-hv3c-7725"
- "GMS-2023-11"
package_slug: "packagist/flarum/core"
title: "Missing Authorization"
description: "Flarum is a discussion platform for websites. If the first post of a
  discussion is permanently deleted but the discussion stays visible, any actor who
  can view the discussion is able to create a new reply via the REST API, no matter
  the reply permission or lock status. This includes users that don't have a validated
  email. Guests cannot successfully create a reply because the API will fail with
  a 500 error when the user ID 0 is inserted into the database. This happens because
  when the first post of a discussion is permanently deleted, the `first_post_id`
  attribute of the discussion becomes `null` which causes access control to be skipped
  for all new replies. Flarum automatically makes discussions with zero comments invisible
  so an additional condition for this vulnerability is that the discussion must have
  at least one approved reply so that `discussions.comment_count` is still above zero
  after the post deletion. This can open the discussion to uncontrolled spam or just
  unintentional replies if users still had their tab open before the vulnerable discussion
  was locked and then post a reply when they shouldn't be able to. In combination
  with the email notification settings, this could also be used as a way to send unsolicited
  emails. Versions between `v1.3.0` and `v1.6.3` are impacted. The vulnerability has
  been fixed and published as flarum/core v1.6.3. All communities running Flarum should
  upgrade as soon as possible. There are no known workarounds."
date: "2023-11-07"
pubdate: "2023-01-13"
affected_range: ">=1.3.0,<1.6.2"
fixed_versions:
- "1.6.2"
affected_versions: "All versions starting from 1.3.0 before 1.6.2"
not_impacted: "All versions before 1.3.0, all versions starting from 1.6.2"
solution: "Upgrade to version 1.6.2 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-22489"
- "https://github.com/flarum/framework/commit/12f14112a0ecd1484d97330b82beb2a145919015"
- "https://github.com/flarum/framework/security/advisories/GHSA-hph3-hv3c-7725"
- "https://github.com/flarum/framework/releases/tag/v1.6.3"
- "https://github.com/advisories/GHSA-hph3-hv3c-7725"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N"
uuid: "e5032f22-9e51-4b95-9a90-4d7401568864"
cwe_ids:
- "CWE-1035"
- "CWE-862"
- "CWE-937"
