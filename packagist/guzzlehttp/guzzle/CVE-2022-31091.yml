---
identifier: "CVE-2022-31091"
identifiers:
- "CVE-2022-31091"
- "GHSA-q559-8m2m-g699"
- "GMS-2022-2529"
package_slug: "packagist/guzzlehttp/guzzle"
title: "Exposure of Sensitive Information to an Unauthorized Actor"
description: "Guzzle, an extensible PHP HTTP client. `Authorization` and `Cookie`
  headers on requests are sensitive information. In affected versions on making a
  request which responds with a redirect to a URI with a different port, if we choose
  to follow it, we should remove the `Authorization` and `Cookie` headers from the
  request, before containing. Previously, we would only consider a change in host
  or scheme. Affected Guzzle 7 users should upgrade to Guzzle 7.4.5 as soon as possible.
  Affected users using any earlier series of Guzzle should upgrade to Guzzle 6.5.8
  or 7.4.5. Note that a partial fix was implemented in Guzzle 7.4.2, where a change
  in host would trigger removal of the curl-added Authorization header, however this
  earlier fix does not cover change in scheme or change in port. An alternative approach
  would be to use your own redirect middleware, rather than ours, if you are unable
  to upgrade. If you do not require or expect redirects to be followed, one should
  simply disable redirects all together."
date: "2023-05-21"
pubdate: "2022-06-27"
affected_range: "<6.5.8||>=7.0.0,<7.4.5"
fixed_versions:
- "6.5.8"
- "7.4.5"
affected_versions: "All versions before 6.5.8, all versions starting from 7.0.0 before
  7.4.5"
not_impacted: "All versions starting from 6.5.8 before 7.0.0, all versions starting
  from 7.4.5"
solution: "Upgrade to versions 6.5.8, 7.4.5 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-31091"
- "https://github.com/guzzle/guzzle/commit/1dd98b0564cb3f6bd16ce683cb755f94c10fbd82"
- "https://github.com/guzzle/guzzle/security/advisories/GHSA-q559-8m2m-g699"
- "https://github.com/FriendsOfPHP/security-advisories/blob/master/guzzlehttp/guzzle/CVE-2022-31091.yaml"
- "https://github.com/advisories/GHSA-q559-8m2m-g699"
cvss_v2: "AV:N/AC:L/Au:S/C:P/I:N/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N"
uuid: "f2c3c50f-9d22-4bb1-8fd3-ce213a061698"
cwe_ids:
- "CWE-1035"
- "CWE-200"
- "CWE-937"
