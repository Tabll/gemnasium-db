---
identifier: "CVE-2016-10045"
package_slug: "packagist/phpmailer/phpmailer"
title: "Remote Code Execution (0day Patch Bypass/exploit)"
description: "The patch for CVE-2016-10033 vulnerability added in PHPMailer 5.2.17
  sanitizes the `$Sender` variable by applying `escapeshellarg()` escaping before
  the value is passed to `mail()` function. It does not however take into account
  the clashing of the `escapeshellarg()` function with internal escaping with `escapeshellcmd()`
  performed by `mail()` function on the 5th parameter. As a result it is possible
  to inject an extra quote that does not get properly escaped and break out of the
  `escapeshellarg()` protection applied by the patch in PHPMailer 5.2.17."
date: "2018-10-09"
pubdate: "2016-12-30"
affected_range: "5.2.18||5.2.19"
fixed_versions:
- "5.2.20"
affected_versions: "Version 5.2.18, version 5.2.19"
solution: "Upgrade to version 5.2.20."
urls:
- "https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html"
- "https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html"
credit: "Dawid Golunski"
cvss_v2: "AV:N/AC:L/Au:N/C:P/I:P/A:P"
cvss_v3: "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "2806fe84-1e8f-411d-b3dd-b209a88a33c5"
