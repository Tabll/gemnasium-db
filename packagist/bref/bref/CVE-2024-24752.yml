---
identifier: "CVE-2024-24752"
identifiers:
- "GHSA-x4hh-frx8-98r5"
- "CVE-2024-24752"
package_slug: "packagist/bref/bref"
title: "Uncontrolled Resource Consumption"
description: "Bref enable serverless PHP on AWS Lambda. When Bref is used with the
  Event-Driven Function runtime and the handler is a `RequestHandlerInterface`, then
  the Lambda event is converted to a PSR7 object. During the conversion process, if
  the request is a MultiPart, each part is parsed and for each which contains a file,
  it is extracted and saved in `/tmp` with a random filename starting with `bref_upload_`.
  The flow mimics what plain PHP does but it does not delete the temporary files when
  the request has been processed. An attacker could fill the Lambda instance disk
  by performing multiple MultiPart requests containing files. This vulnerability is
  patched in 2.1.13."
date: "2024-02-01"
pubdate: "2024-02-01"
affected_range: "<2.1.13"
fixed_versions:
- "2.1.13"
affected_versions: "All versions before 2.1.13"
not_impacted: "All versions starting from 2.1.13"
solution: "Upgrade to version 2.1.13 or above."
urls:
- "https://github.com/brefphp/bref/security/advisories/GHSA-x4hh-frx8-98r5"
- "https://nvd.nist.gov/vuln/detail/CVE-2024-24752"
- "https://github.com/brefphp/bref/commit/350788de12880b6fd64c4c318ba995388bec840e"
- "https://github.com/brefphp/bref/blob/2.1.12/src/Event/Http/Psr7Bridge.php#L94-L125"
- "https://github.com/advisories/GHSA-x4hh-frx8-98r5"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
uuid: "bb6bb521-3ce2-47c3-837b-305a5b98bf37"
cwe_ids:
- "CWE-1035"
- "CWE-400"
- "CWE-78"
- "CWE-937"
