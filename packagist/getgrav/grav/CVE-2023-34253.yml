---
identifier: "CVE-2023-34253"
identifiers:
- "GHSA-j3v8-v77f-fvgm"
- "CVE-2023-34253"
package_slug: "packagist/getgrav/grav"
title: "Improper Control of Generation of Code ('Code Injection')"
description: "Grav is a file-based Web platform. Prior to version 1.7.42, the denylist
  introduced in commit 9d6a2d to prevent dangerous functions from being executed via
  injection of malicious templates was insufficient and could be easily subverted
  in multiple ways -- (1) using unsafe functions that are not banned, (2) using capitalised
  callable names, and (3) using fully-qualified names for referencing callables. Consequently,
  a low privileged attacker with login access to Grav Admin panel and page creation/update
  permissions is able to inject malicious templates to obtain remote code execution.
  A patch in version 1.7.42 improves the denylist."
date: "2023-07-01"
pubdate: "2023-06-16"
affected_range: "<1.7.42"
fixed_versions:
- "1.7.42"
affected_versions: "All versions before 1.7.42"
not_impacted: "All versions starting from 1.7.42"
solution: "Upgrade to version 1.7.42 or above."
urls:
- "https://github.com/getgrav/grav/security/advisories/GHSA-j3v8-v77f-fvgm"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-34253"
- "https://github.com/getgrav/grav/commit/244758d4383034fe4cd292d41e477177870b65ec"
- "https://github.com/getgrav/grav/commit/71bbed12f950de8335006d7f91112263d8504f1b"
- "https://github.com/getgrav/grav/commit/8c2c1cb72611a399f13423fc6d0e1d998c03e5c8"
- "https://github.com/getgrav/grav/commit/9d01140a63c77075ef09b26ef57cf186138151a5"
- "https://github.com/getgrav/grav/blob/1.7.40/system/src/Grav/Common/Utils.php#L1952-L2190"
- "https://huntr.dev/bounties/3ef640e6-9e25-4ecb-8ec1-64311d63fe66/"
- "https://www.github.com/getgrav/grav/commit/9d6a2dba09fd4e56f5cdfb9a399caea355bfeb83"
- "https://github.com/advisories/GHSA-j3v8-v77f-fvgm"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H"
uuid: "9f43c13b-30e8-4ce4-a2e2-23517b114294"
cwe_ids:
- "CWE-1035"
- "CWE-78"
- "CWE-937"
- "CWE-94"
