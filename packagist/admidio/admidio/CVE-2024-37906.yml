---
identifier: "CVE-2024-37906"
identifiers:
- "CVE-2024-37906"
- "GHSA-69wx-xc6j-28v3"
package_slug: "packagist/admidio/admidio"
title: "Admidio has Blind SQL Injection in ecard_send.php"
description: "### Description:\nAn SQL Injection has been identified in the `/adm_program/modules/ecards/ecard_send.php`
  source file of the Admidio Application. The SQL Injection results in a compromise
  of the application's database. The value of `ecard_recipients `POST parameter is
  being directly concatenated with the SQL query in the source code causing the SQL
  Injection.\n\nThe SQL Injection can be exploited by a member user, using blind condition-based,
  time-based, and Out of band interaction SQL Injection payloads. I successfully exploited
  SQL Injections by causing Time Delays. Advancing the payload, I was able to exfiltrate
  data from the database based on trial and error conditions and step-wise enumerating
  the characters of the database name. This was done as a POC of SQL Injection. An
  attacker could simply drop the database by providing a single payload, steal data,
  and potentially update the database according to their will. \n\n### Impact:\nSQL
  injection (SQLi) vulnerabilities can have serious consequences for the security
  of a web application and its underlying database. Attackers can use SQLi to access
  sensitive data, and modify, delete, or add data to the database. SQLi can also be
  potentially used to perform RCE. \n\n### Remediation:\nUse parameterized queries
  or prepared statements instead of concatenating user input directly into SQL queries.
  Parameterized queries ensure that user input is treated as data and not executable
  queries. \nOR \nSanitize the input before including it in the SQL Query.\n\n###
  Steps to Reproduce:\n- Intercept the POST request to `/adm_program/modules/ecards/ecard_send.php`,
  which is used to send photo as greeting card.\n- Change the value of `ecard_recipients%5B%5D`
  POST parameter to `2%2bsleep(10)`.\n- Sending the request will cause a time delay.\n\n###
  Proof Of Concept:\n\n![image](https://github.com/Admidio/admidio/assets/59286712/8ea87f4f-dad0-4df1-999d-212b07e02527)\nFigure
  1: Code Vulnerable to SQL Injection\n\n![image](https://github.com/Admidio/admidio/assets/59286712/d803a92c-3469-45aa-a844-e8aa311b55f4)\nFigure
  2: Code Vulnerable to SQL Injection\n\n![image](https://github.com/Admidio/admidio/assets/59286712/2ccdf865-2867-4dc8-abe1-f25b5e906db3)\nFigure
  3: SQLi to trigger time delay\n\n![image](https://github.com/Admidio/admidio/assets/59286712/eed06ce6-6591-427f-b98e-5314233b5996)\nFigure
  4: Data Exfiltration via Condition-based Time Delays"
date: "2024-07-29"
pubdate: "2024-07-29"
affected_range: "<4.3.9"
fixed_versions:
- "4.3.9"
affected_versions: "All versions before 4.3.9"
not_impacted: "All versions starting from 4.3.9"
solution: "Upgrade to version 4.3.9 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-37906"
- "https://github.com/advisories/GHSA-69wx-xc6j-28v3"
- "https://github.com/Admidio/admidio/security/advisories/GHSA-69wx-xc6j-28v3"
- "https://github.com/Admidio/admidio/commit/3ff02b0c64a6911ab3e81cd61077f392c0b25248"
- "https://github.com/Admidio/admidio"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H"
uuid: "50790611-7427-4f75-b201-c82b7cbd1ebd"
cwe_ids:
- "CWE-89"
- "CWE-937"
- "CWE-1035"
