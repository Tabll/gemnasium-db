---
identifier: "CVE-2023-22731"
identifiers:
- "CVE-2023-22731"
- "GHSA-93cw-f5jj-x85w"
package_slug: "packagist/shopware/core"
title: "Improper Control of Generation of Code ('Code Injection')"
description: "Shopware is an open source commerce platform based on Symfony Framework
  and Vue js. In a Twig environment **without the Sandbox extension**, it is possible
  to refer to PHP functions in twig filters like `map`, `filter`, `sort`. This allows
  a template to call any global PHP function and thus execute arbitrary code. The
  attacker must have access to a Twig environment in order to exploit this vulnerability.
  This problem has been fixed with 6.4.18.1 with an override of the specified filters
  until the integration of the Sandbox extension has been finished. Users are advised
  to upgrade. Users of major versions 6.1, 6.2, and 6.3 may also receive this fix
  via a plugin."
date: "2023-11-07"
pubdate: "2023-01-17"
affected_range: "<6.4.18.1"
fixed_versions:
- "6.4.18.1"
affected_versions: "All versions before 6.4.18.1"
not_impacted: "All versions starting from 6.4.18.1"
solution: "Upgrade to version 6.4.18.1 or above."
urls:
- "https://github.com/shopware/platform/security/advisories/GHSA-93cw-f5jj-x85w"
- "https://github.com/shopware/platform/commit/89d1ea154689cb6202e0d3a0ceeae0febb0c09e1"
- "https://docs.shopware.com/en/shopware-6-en/security-updates/security-update-01-2023?category=security-updates"
- "https://github.com/advisories/GHSA-93cw-f5jj-x85w"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
uuid: "90ae39a6-d04e-40e4-a47f-f88d53788462"
cwe_ids:
- "CWE-1035"
- "CWE-937"
- "CWE-94"
