---
identifier: "CVE-2024-42354"
identifiers:
- "CVE-2024-42354"
- "GHSA-hhcq-ph6w-494g"
package_slug: "packagist/shopware/platform"
title: "Shopware vulnerable to Improper Access Control with ManyToMany associations
  in store-api"
description: "The store-API works with regular entities and not expose all fields
  for the public API; fields need to be marked as ApiAware in the EntityDefinition.
  So only ApiAware fields of the EntityDefinition will be encoded to the final JSON.\n\nThe
  processing of the Criteria did not considered ManyToMany associations and so they
  were not considered properly and the protections didn't get used.\n\nThis issue
  cannot be reproduced with the default entities by Shopware, but can be triggered
  with extensions."
date: "2024-08-08"
pubdate: "2024-08-08"
affected_range: "<6.5.8.13||>=6.6.0.0 <6.6.5.1"
fixed_versions:
- "6.5.8.13"
- "6.6.5.1"
affected_versions: "All versions starting from 6.6.0.0 before 6.6.5.1, all versions
  before 6.5.8.13"
not_impacted: "All versions before 6.6.0.0, all versions starting from 6.6.5.1 before
  0, all versions starting from 6.5.8.13"
solution: "Upgrade to versions 6.5.8.13, 6.6.5.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-42354"
- "https://github.com/advisories/GHSA-hhcq-ph6w-494g"
- "https://github.com/shopware/shopware/security/advisories/GHSA-hhcq-ph6w-494g"
- "https://github.com/shopware/core/commit/a784aa1cec0624e36e0ee4d41aeebaed40e0442f"
- "https://github.com/shopware/core/commit/d35ee2eda5c995faeb08b3dad127eab65c64e2a2"
- "https://github.com/shopware/shopware/commit/8504ba7e56e53add6a1d5b9d45015e3d899cd0ac"
- "https://github.com/shopware/shopware/commit/ad83d38809df457efef21c37ce0996430334bf01"
- "https://github.com/shopware/shopware"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N"
uuid: "3dd411a7-643d-467d-9c7c-d623e40c56fd"
cwe_ids:
- "CWE-284"
- "CWE-937"
- "CWE-1035"
