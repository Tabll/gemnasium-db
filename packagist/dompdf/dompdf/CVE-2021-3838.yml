---
identifier: "CVE-2021-3838"
identifiers:
- "CVE-2021-3838"
- "GHSA-577p-7j7h-2jgf"
package_slug: "packagist/dompdf/dompdf"
title: "Deserialization of Untrusted Data in dompdf/dompdf"
description: "DomPDF before version 2.0.0 is vulnerable to PHAR (PHP Archive) deserialization
  due to a lack of checking on the protocol before passing it into the file_get_contents()
  function. An attacker who can upload files of any type to the server can pass in
  the phar:// protocol to unserialize the uploaded file and instantiate arbitrary
  PHP objects. This can lead to remote code execution, especially when DOMPdf is used
  with frameworks with documented POP chains like Laravel or vulnerable developer
  code."
date: "2024-11-15"
pubdate: "2024-11-15"
affected_range: "<2.0.0"
fixed_versions:
- "2.0.0"
affected_versions: "All versions before 2.0.0"
not_impacted: "All versions starting from 2.0.0"
solution: "Upgrade to version 2.0.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-3838"
- "https://github.com/advisories/GHSA-577p-7j7h-2jgf"
- "https://github.com/dompdf/dompdf/commit/99aeec1efec9213e87098d42eb09439e7ee0bb6a"
- "https://github.com/dompdf/dompdf"
- "https://huntr.com/bounties/0bdddc12-ff67-4815-ab9f-6011a974f48e"
cvss_v3: "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "0a43ab16-997b-43e6-9a70-c4a0b3a51a47"
cwe_ids:
- "CWE-502"
- "CWE-937"
- "CWE-1035"
