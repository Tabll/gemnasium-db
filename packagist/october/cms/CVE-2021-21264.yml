---
identifier: "CVE-2021-21264"
identifiers:
- "GHSA-fcr8-6q7r-m4wg"
- "CVE-2021-21264"
package_slug: "packagist/october/cms"
title: "Missing Authorization"
description: "October is a free, open-source, self-hosted CMS platform based on the
  Laravel PHP Framework. A bypass of CVE-2020-26231 (fixed in 1.0.470/471 and 1.1.1)
  was discovered that has the same impact as CVE-2020-26231 & CVE-2020-15247. An authenticated
  backend user with the `cms.manage_pages`, `cms.manage_layouts`, or `cms.manage_partials`
  permissions who would **normally** not be permitted to provide PHP code to be executed
  by the CMS due to `cms.enableSafeMode` being enabled is able to write specific Twig
  code to escape the Twig sandbox and execute arbitrary PHP. This is not a problem
  for anyone that trusts their users with those permissions to normally write & manage
  PHP within the CMS by not having `cms.enableSafeMode` enabled, but would be a problem
  for anyone relying on `cms.enableSafeMode` to ensure that users with those permissions
  in production do not have access to write & execute arbitrary PHP. Issue has been
  patched in Build 472 (v1.0.472) and v1.1.2. As a workaround, apply 
  https://github.com/octobercms/october/commit/f63519ff1e8d375df30deba63156a2fc97aa9ee7
  to your installation manually if unable to upgrade to Build 472 or v1.1.2."
date: "2021-05-13"
pubdate: "2021-05-04"
affected_range: "=1.0.471||=1.1.1"
fixed_versions:
- "1.0.472"
- "1.1.2"
affected_versions: "Version 1.0.471, version 1.1.1"
not_impacted: "All versions before 1.0.471, all versions after 1.0.471 before 1.1.1,
  all versions after 1.1.1"
solution: "Upgrade to versions 1.0.472, 1.1.2 or above."
urls:
- "https://github.com/octobercms/october/security/advisories/GHSA-fcr8-6q7r-m4wg"
- "https://nvd.nist.gov/vuln/detail/CVE-2021-21264"
- "https://github.com/advisories/GHSA-fcr8-6q7r-m4wg"
cvss_v2: "AV:L/AC:M/Au:N/C:P/I:P/A:P"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:L"
uuid: "0a853bd3-c0d2-4fd8-a97f-87a6f07f7eef"
cwe_ids:
- "CWE-1035"
- "CWE-78"
- "CWE-862"
- "CWE-937"
