---
identifier: "CVE-2024-52291"
identifiers:
- "CVE-2024-52291"
- "GHSA-jrh5-vhr9-qh7q"
package_slug: "packagist/craftcms/cms"
title: "Local File System Validation Bypass Leading to File Overwrite, Sensitive File
  Access, and Potential Code Execution"
description: "A vulnerability in CraftCMS allows an attacker to bypass local file
  system validation by utilizing a double `file://` scheme (e.g., `file://file:////`).
  This enables the attacker to specify sensitive folders as the file system, leading
  to potential file overwriting through malicious uploads, unauthorized access to
  sensitive files, and, under certain conditions, remote code execution (RCE) via
  Server-Side Template Injection (SSTI) payloads.\n\nNote that this will only work
  if you have an authenticated administrator account with allowAdminChanges enabled"
date: "2024-11-13"
pubdate: "2024-11-13"
affected_range: ">=5.0.0-RC1 <5.4.6||>=4.0.0-RC1 <4.12.5"
fixed_versions:
- "5.4.6"
- "4.12.5"
affected_versions: "All versions starting from 4.0.0-RC1 before 4.12.5, all versions
  starting from 5.0.0-RC1 before 5.4.6"
not_impacted: "All versions before 4.0.0-RC1, all versions starting from 4.12.5 before
  5.0.0-RC1, all versions starting from 5.4.6"
solution: "Upgrade to versions 4.12.5, 5.4.6 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-52291"
- "https://github.com/advisories/GHSA-jrh5-vhr9-qh7q"
- "https://github.com/craftcms/cms/security/advisories/GHSA-jrh5-vhr9-qh7q"
- "https://github.com/craftcms/cms"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:H"
uuid: "7709fb62-82be-45c4-bff2-9731405c7b40"
cwe_ids:
- "CWE-22"
- "CWE-937"
- "CWE-1035"
