---
identifier: "GHSA-xhjw-7vh5-qxqm"
identifiers:
- "GHSA-xhjw-7vh5-qxqm"
package_slug: "pypi/libosdp"
title: "LibOSDP RMAC revert to the beginning of the session"
description: "- Issues:\n  - SCS_14 is allowed on encrypted connection (osdp_phy.c)\n
  \ - No validation for RMAC_I is only in response to osdp_SCRYPT (osdp_cp.c)\n  -
  Couldn't find anything specific in the OSDP specifications indicating it is forbidden,
  I'm gussing it shouldn't be allowed according from the secure connection initialization
  flow (let me know if you think there is spec-rela\nted change that should be done)\n-
  Attack:\n  - Once RMAC_I message can be sent during a session, attacker with MITM
  access to the communication may intercept the original RMAC_I reply and save it.\n
  \ - While the session continues, the attacker will record all of the replies and
  save them, till capturing the message to be replied (can be detected by ID, length
  or time based on inspection of visual activity next to the reade\nr)\n  - Once attacker
  captures a session with the message to be replayed, he stops reseting the connection
  and waits for signal to perform the replay to of the PD to CP message (ex: by signaling
  remotly to the MIMT device or setting\n a specific timing).\n  - in order to replay,
  the attacker will craft a specific RMAC_I message in the proper seq of the execution,
  which will result in reverting the RMAC to the begining of the session.\n  - At
  that phase - attacker can replay all the messages from the begining of the session.\n\n###
  Impact\nReply attack\n\n### Patches\nThis issue has been fixed in 298576d9214b48214092eebdd892ec77be085e5a\n"
date: "2024-03-08"
pubdate: "2024-03-08"
affected_range: "<3.0.0"
fixed_versions:
- "3.0.0"
affected_versions: "All versions before 3.0.0"
not_impacted: "All versions starting from 3.0.0"
solution: "Upgrade to version 3.0.0 or above."
urls:
- "https://github.com/advisories/GHSA-xhjw-7vh5-qxqm"
- "https://github.com/goToMain/libosdp/security/advisories/GHSA-xhjw-7vh5-qxqm"
- "https://github.com/goToMain/libosdp/commit/298576d9214b48214092eebdd892ec77be085e5a"
- "https://github.com/goToMain/libosdp"
cvss_v3: "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N"
uuid: "18754e9a-49d1-4f7c-b0fe-42bacdb94ae2"
cwe_ids:
- "CWE-937"
- "CWE-1035"
