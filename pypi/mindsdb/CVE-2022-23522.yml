---
identifier: "CVE-2022-23522"
identifiers:
- "CVE-2022-23522"
- "GHSA-7x45-phmr-9wqp"
package_slug: "pypi/mindsdb"
title: "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
description: "MindsDB is an open source machine learning platform. An unsafe extraction
  is being performed using `shutil.unpack_archive()` from a remotely retrieved tarball.
  Which may lead to the writing of the extracted files to an unintended location.
  This vulnerability is sometimes called a **TarSlip** or a **ZipSlip variant**. Unpacking
  files using the high-level function `shutil.unpack_archive()` from a potentially
  malicious tarball without validating that the destination file path remained within
  the intended destination directory may cause files to be overwritten outside the
  destination directory. An attacker could craft a malicious tarball with a filename
  path, such as `../../../../../../../../etc/passwd`, and then serve the archive remotely
  using a personal bucket `s3`, thus, retrieve the tarball through **mindsdb** and
  overwrite the system files of the hosting server. This issue has been addressed
  in version 22.11.4.3. Users are advised to upgrade. Users unable to upgrade should
  avoid ingesting archives from untrusted sources."
date: "2023-04-10"
pubdate: "2023-03-30"
affected_range: "<22.11.4.3"
fixed_versions:
- "22.11.4.3"
affected_versions: "All versions before 22.11.4.3"
not_impacted: "All versions starting from 22.11.4.3"
solution: "Upgrade to version 22.11.4.3 or above."
urls:
- "https://github.com/mindsdb/mindsdb/security/advisories/GHSA-7x45-phmr-9wqp"
- "https://github.com/mindsdb/mindsdb/blob/69c76e727b8067f32b06ab83bb835a8c416c4f21/mindsdb/interfaces/storage/fs.py"
- "https://github.com/mindsdb/mindsdb/blob/69c76e727b8067f32b06ab83bb835a8c416c4f21/mindsdb/interfaces/storage/fs.py#L128..L129"
- "https://github.com/mindsdb/mindsdb/releases/tag/v22.11.4.3"
- "https://nvd.nist.gov/vuln/detail/CVE-2022-23522"
- "https://github.com/advisories/GHSA-7x45-phmr-9wqp"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
uuid: "a03ccf93-2642-4191-97aa-a3cd2f357b02"
cwe_ids:
- "CWE-1035"
- "CWE-22"
- "CWE-937"
