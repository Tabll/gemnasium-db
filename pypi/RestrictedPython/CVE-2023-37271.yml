---
identifier: "CVE-2023-37271"
identifiers:
- "GHSA-wqc8-x2pr-7jqh"
- "CVE-2023-37271"
package_slug: "pypi/RestrictedPython"
title: "Improper Control of Dynamically-Managed Code Resources"
description: "RestrictedPython is a tool that helps to define a subset of the Python
  language which allows users to provide a program input into a trusted environment.
  RestrictedPython does not check access to stack frames and their attributes. Stack
  frames are accessible within at least generators and generator expressions, which
  are allowed inside RestrictedPython. Prior to versions 6.1 and 5.3, an attacker
  with access to a RestrictedPython environment can write code that gets the current
  stack frame in a generator and then walk the stack all the way beyond the RestrictedPython
  invocation boundary, thus breaking out of the restricted sandbox and potentially
  allowing arbitrary code execution in the Python interpreter. All RestrictedPython
  deployments that allow untrusted users to write Python code in the RestrictedPython
  environment are at risk. In terms of Zope and Plone, this would mean deployments
  where the administrator allows untrusted users to create and/or edit objects of
  type `Script (Python)`, `DTML Method`, `DTML Document` or `Zope Page Template`.
  This is a non-default configuration and likely to be extremely rare. The problem
  has been fixed in versions 6.1 and 5.3."
date: "2023-07-20"
pubdate: "2023-07-10"
affected_range: "<5.3||>=6.0,<6.1"
fixed_versions:
- "5.3"
- "6.1"
affected_versions: "All versions before 5.3, all versions starting from 6.0 before 6.1"
not_impacted: "All versions starting from 5.3 before 6.0, all versions starting from 6.1"
solution: "Upgrade to versions 5.3, 6.1 or above."
urls:
- "https://github.com/zopefoundation/RestrictedPython/security/advisories/GHSA-wqc8-x2pr-7jqh"
- "https://github.com/zopefoundation/RestrictedPython/commit/c8eca66ae49081f0016d2e1f094c3d72095ef531"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-37271"
- "https://github.com/pypa/advisory-database/tree/main/vulns/restrictedpython/PYSEC-2023-118.yaml"
- "https://github.com/advisories/GHSA-wqc8-x2pr-7jqh"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H"
uuid: "6aaf2b4e-9f13-4fc8-888d-6beadc25c7f3"
cwe_ids:
- "CWE-1035"
- "CWE-78"
- "CWE-913"
- "CWE-937"
