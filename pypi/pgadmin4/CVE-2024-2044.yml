---
identifier: "CVE-2024-2044"
identifiers:
- "CVE-2024-2044"
- "GHSA-rj98-crf4-g69w"
package_slug: "pypi/pgadmin4"
title: "pgAdmin 4 vulnerable to Unsafe Deserialization and Remote Code Execution by
  an Authenticated user"
description: "pgAdmin 4 uses a file-based session management approach. The session
  files are saved on disk as pickle objects. When a user performs a request, the value
  of the session cookie 'pga4_session' is used to retrieve the file, then its content
  is deserialised, and finally its signature verified.\nThe cookie value is split
  in 2 parts at the first '!' character. The first part is the session ID (sid), while
  the second is the session digest.\n The vulnerability lies in versions of pgAdmin
  prior to 8.4 where a method loads session files by concatenating the sessions folder
  - located inside the pgAdmin 4 DATA_DIR - with the session ID. Precisely, the two
  values are concatenated using the ['os.path.join'] function. It does not set a trusted
  base-path which should not be escaped\n"
date: "2024-03-07"
pubdate: "2024-03-07"
affected_range: "<8.4"
fixed_versions:
- "8.4"
affected_versions: "All versions before 8.4"
not_impacted: "All versions starting from 8.4"
solution: "Upgrade to version 8.4 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-2044"
- "https://github.com/advisories/GHSA-rj98-crf4-g69w"
- "https://github.com/pgadmin-org/pgadmin4/issues/7258"
- "https://github.com/pgadmin-org/pgadmin4/commit/4e49d752fba72953acceeb7f4aa2e6e32d25853d"
- "https://github.com/pgadmin-org/pgadmin4"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:L/I:L/A:L"
uuid: "4ffc7ca8-ce46-4840-b7f7-19a035fca9c3"
cwe_ids:
- "CWE-937"
- "CWE-1035"
