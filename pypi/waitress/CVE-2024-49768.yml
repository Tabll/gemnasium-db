---
identifier: "CVE-2024-49768"
identifiers:
- "CVE-2024-49768"
- "GHSA-9298-4cf8-g4wj"
package_slug: "pypi/waitress"
title: "Waitress has request processing race condition in HTTP pipelining with invalid
  first request"
description: "A remote client may send a request that is exactly `recv_bytes` (defaults
  to 8192) long, followed by a secondary request using HTTP pipelining.\n\nWhen request
  lookahead is disabled (default) we won't read any more requests, and when the first
  request fails due to a parsing error, we simply close the connection.\n\nHowever
  when request lookahead is enabled, it is possible to process and receive the first
  request, start sending the error message back to the client while we read the next
  request and queue it. This will allow the secondary request to be serviced by the
  worker thread while the connection should be closed."
date: "2025-01-21"
pubdate: "2024-10-29"
affected_range: ">=2.0.0,<3.0.1"
fixed_versions:
- "3.0.1"
affected_versions: "All versions starting from 2.0.0 before 3.0.1"
not_impacted: "All versions before 2.0.0, all versions starting from 3.0.1"
solution: "Upgrade to version 3.0.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-49768"
- "https://github.com/advisories/GHSA-9298-4cf8-g4wj"
- "https://github.com/Pylons/waitress/security/advisories/GHSA-9298-4cf8-g4wj"
- "https://github.com/Pylons/waitress/commit/e4359018537af376cf24bd13616d861e2fb76f65"
- "https://github.com/Pylons/waitress"
- "https://github.com/pypa/advisory-database/tree/main/vulns/waitress/PYSEC-2024-210.yaml"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N"
uuid: "8d2ce207-0b54-4368-87b7-77a805ea189a"
cwe_ids:
- "CWE-367"
- "CWE-444"
- "CWE-937"
- "CWE-1035"
