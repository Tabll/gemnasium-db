---
identifier: "CVE-2025-27516"
identifiers:
- "CVE-2025-27516"
- "GHSA-cpwx-vrp4-4pq7"
package_slug: "pypi/Jinja2"
title: "Jinja2 vulnerable to sandbox breakout through attr filter selecting format
  method"
description: "An oversight in how the Jinja sandboxed environment interacts with the
  `|attr` filter allows an attacker that controls the content of a template to execute
  arbitrary Python code.\n\nTo exploit the vulnerability, an attacker needs to control
  the content of a template. Whether that is the case depends on the type of application
  using Jinja. This vulnerability impacts users of applications which execute untrusted
  templates.\n\nJinja's sandbox does catch calls to `str.format` and ensures they
  don't escape the sandbox. However, it's possible to use the `|attr` filter to get
  a reference to a string's plain format method, bypassing the sandbox. After the
  fix, the `|attr` filter no longer bypasses the environment's attribute lookup."
date: "2025-03-05"
pubdate: "2025-03-05"
affected_range: "<3.1.6"
fixed_versions:
- "3.1.6"
affected_versions: "All versions before 3.1.6"
not_impacted: "All versions starting from 3.1.6"
solution: "Upgrade to version 3.1.6 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2025-27516"
- "https://github.com/advisories/GHSA-cpwx-vrp4-4pq7"
- "https://github.com/pallets/jinja/security/advisories/GHSA-cpwx-vrp4-4pq7"
- "https://github.com/pallets/jinja/commit/90457bbf33b8662926ae65cdde4c4c32e756e403"
- "https://github.com/pallets/jinja"
uuid: "9da9bd74-8969-42d5-95cf-cc75ebc085d4"
cwe_ids:
- "CWE-1336"
- "CWE-937"
- "CWE-1035"
