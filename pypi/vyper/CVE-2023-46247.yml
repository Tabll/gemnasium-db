---
identifier: "CVE-2023-46247"
identifiers:
- "GHSA-6m97-7527-mh74"
- "CVE-2023-46247"
package_slug: "pypi/vyper"
title: "Incorrect Calculation"
description: "Vyper is a Pythonic Smart Contract Language for the Ethereum Virtual
  Machine (EVM). Contracts containing large arrays might underallocate the number
  of slots they need by 1. Prior to v0.3.8, the calculation to determine how many
  slots a storage variable needed used `math.ceil(type_.size_in_bytes / 32)`. The
  intermediate floating point step can produce a rounding error if there are enough
  bits set in the IEEE-754 mantissa. Roughly speaking, if `type_.size_in_bytes` is
  large (> 2**46), and slightly less than a power of 2, the calculation can overestimate
  how many slots are needed by 1. If `type_.size_in_bytes` is slightly more than a
  power of 2, the calculation can underestimate how many slots are needed by 1. This
  issue is patched in version 0.3.8."
date: "2023-12-19"
pubdate: "2023-12-13"
affected_range: "<0.3.8"
fixed_versions:
- "0.3.8"
affected_versions: "All versions before 0.3.8"
not_impacted: "All versions starting from 0.3.8"
solution: "Upgrade to version 0.3.8 or above."
urls:
- "https://github.com/vyperlang/vyper/security/advisories/GHSA-6m97-7527-mh74"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-46247"
- "https://github.com/vyperlang/vyper/commit/0bb7203b584e771b23536ba065a6efda457161bb"
- "https://github.com/vyperlang/vyper/blob/6020b8bbf66b062d299d87bc7e4eddc4c9d1c157/vyper/semantics/validation/data_positions.py#L197"
- "https://github.com/advisories/GHSA-6m97-7527-mh74"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N"
uuid: "1437c5ad-fa1a-4405-8932-146d9665ba7e"
cwe_ids:
- "CWE-1035"
- "CWE-193"
- "CWE-937"
