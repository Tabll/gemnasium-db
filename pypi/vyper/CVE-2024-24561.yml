---
identifier: "CVE-2024-24561"
identifiers:
- "CVE-2024-24561"
- "GHSA-9x7f-gwxq-6f2c"
package_slug: "pypi/vyper"
title: "Vyper's bounds check on built-in `slice()` function can be overflowed"
description: "[The bounds check for slices](https://github.com/vyperlang/vyper/blob/b01cd686aa567b32498fefd76bd96b0597c6f099/vyper/builtins/functions.py#L404-L457)
  does not account for the ability for `start + length` to overflow when the values
  aren't literals.\n\nIf a `slice()` function uses a non-literal argument for the
  `start`  or `length` variable, this creates the ability for an attacker to overflow
  the bounds check.\n\nThis issue can be used to do OOB access to storage, memory
  or calldata addresses. It can also be used to corrupt the `length` slot of the respective
  array.\n\nA contract search was performed and no vulnerable contracts were found
  in production.\n\ntracking in issue https://github.com/vyperlang/vyper/issues/3756.\npatched
  in https://github.com/vyperlang/vyper/pull/3818."
date: "2024-11-22"
pubdate: "2024-02-01"
affected_range: "<0.4.0"
fixed_versions:
- "0.4.0"
affected_versions: "All versions before 0.4.0"
not_impacted: "All versions starting from 0.4.0"
solution: "Upgrade to version 0.4.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-24561"
- "https://github.com/advisories/GHSA-9x7f-gwxq-6f2c"
- "https://github.com/vyperlang/vyper/security/advisories/GHSA-9x7f-gwxq-6f2c"
- "https://github.com/vyperlang/vyper/issues/3756"
- "https://github.com/pypa/advisory-database/tree/main/vulns/vyper/PYSEC-2024-149.yaml"
- "https://github.com/vyperlang/vyper"
- "https://github.com/vyperlang/vyper/blob/b01cd686aa567b32498fefd76bd96b0597c6f099/vyper/builtins/functions.py#L404-L457"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "bdaa22c8-9225-46f9-a014-4ce25aea48ea"
cwe_ids:
- "CWE-119"
- "CWE-937"
- "CWE-1035"
