---
identifier: "CVE-2024-22419"
identifiers:
- "GHSA-2q8v-3gqq-4f8p"
- "CVE-2024-22419"
package_slug: "pypi/vyper"
title: "Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')"
description: "Vyper is a Pythonic Smart Contract Language for the Ethereum Virtual
  Machine. The `concat` built-in can write over the bounds of the memory buffer that
  was allocated for it and thus overwrite existing valid data. The root cause is that
  the `build_IR` for `concat` does not properly adhere to the API of copy functions
  (for `>=0.3.2` the `copy_bytes` function). A contract search was performed and no
  vulnerable contracts were found in production. The buffer overflow can result in
  the change of semantics of the contract. The overflow is length-dependent and thus
  it might go unnoticed during contract testing. However, certainly not all usages
  of concat will result in overwritten valid data as we require it to be in an internal
  function and close to the return statement where other memory allocations don't
  occur. This issue has been addressed in commit `55e18f6d1` which will be included
  in future releases. Users are advised to update when possible."
date: "2024-01-19"
pubdate: "2024-01-19"
affected_range: ">=0.3.0,<=0.3.10"
fixed_versions: []
affected_versions: "All versions starting from 0.3.0 up to 0.3.10"
not_impacted: ""
solution: "Unfortunately, there is no solution available yet."
urls:
- "https://github.com/vyperlang/vyper/security/advisories/GHSA-2q8v-3gqq-4f8p"
- "https://nvd.nist.gov/vuln/detail/CVE-2024-22419"
- "https://github.com/vyperlang/vyper/issues/3737"
- "https://github.com/vyperlang/vyper/commit/55e18f6d128b2da8986adbbcccf1cd59a4b9ad6f"
- "https://github.com/advisories/GHSA-2q8v-3gqq-4f8p"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L"
uuid: "c4f83706-029c-4e12-8426-0a51e7078473"
cwe_ids:
- "CWE-1035"
- "CWE-120"
- "CWE-78"
- "CWE-937"
