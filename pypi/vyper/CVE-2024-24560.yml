---
identifier: "CVE-2024-24560"
identifiers:
- "CVE-2024-24560"
- "GHSA-gp3w-2v2m-p686"
package_slug: "pypi/vyper"
title: "Vyper's external calls can overflow return data to return input buffer"
description: "When calls to external contracts are made, we write the input buffer
  starting at byte 28, and allocate the return buffer to start at byte 0 (overlapping
  with the input buffer). When checking `RETURNDATASIZE` for dynamic types, the size
  is compared only to the minimum allowed size for that type, and not to the returned
  value's `length`. As a result, malformed return data can cause the contract to mistake
  data from the input buffer for returndata.\n\nThis advisory is given a severity
  of \"Low\" because when the called contract returns invalid ABIv2 encoded data,
  the calling contract can read different invalid data (from the dirty buffer) than
  the called contract returned."
date: "2024-11-22"
pubdate: "2024-02-02"
affected_range: "<0.4.0"
fixed_versions:
- "0.4.0"
affected_versions: "All versions before 0.4.0"
not_impacted: "All versions starting from 0.4.0"
solution: "Upgrade to version 0.4.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-24560"
- "https://github.com/advisories/GHSA-gp3w-2v2m-p686"
- "https://github.com/vyperlang/vyper/security/advisories/GHSA-gp3w-2v2m-p686"
- "https://github.com/pypa/advisory-database/tree/main/vulns/vyper/PYSEC-2024-148.yaml"
- "https://github.com/vyperlang/vyper"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N"
uuid: "d25591dd-a762-4373-9882-7f7edc4a52ee"
cwe_ids:
- "CWE-119"
- "CWE-937"
- "CWE-1035"
