---
identifier: "CVE-2024-24560"
identifiers:
- "GHSA-gp3w-2v2m-p686"
- "CVE-2024-24560"
package_slug: "pypi/vyper"
title: "Improper Restriction of Operations within the Bounds of a Memory Buffer"
description: "Vyper is a Pythonic Smart Contract Language for the Ethereum Virtual
  Machine. When calls to external contracts are made, we write the input buffer starting
  at byte 28, and allocate the return buffer to start at byte 0 (overlapping with
  the input buffer). When checking RETURNDATASIZE for dynamic types, the size is compared
  only to the minimum allowed size for that type, and not to the returned value's
  length. As a result, malformed return data can cause the contract to mistake data
  from the input buffer for returndata. When the called contract returns invalid ABIv2
  encoded data, the calling contract can read different invalid data (from the dirty
  buffer) than the called contract returned."
date: "2024-02-02"
pubdate: "2024-02-02"
affected_range: "<=0.3.10"
fixed_versions: []
affected_versions: "All versions up to 0.3.10"
not_impacted: ""
solution: "Unfortunately, there is no solution available yet."
urls:
- "https://github.com/vyperlang/vyper/security/advisories/GHSA-gp3w-2v2m-p686"
- "https://nvd.nist.gov/vuln/detail/CVE-2024-24560"
- "https://github.com/advisories/GHSA-gp3w-2v2m-p686"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N"
uuid: "d25591dd-a762-4373-9882-7f7edc4a52ee"
cwe_ids:
- "CWE-1035"
- "CWE-119"
- "CWE-937"
