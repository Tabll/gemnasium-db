---
identifier: "CVE-2021-41219"
identifiers:
- "CVE-2021-41219"
- "GHSA-4f99-p9c2-3j8x"
package_slug: "pypi/tensorflow"
title: "Undefined behavior via `nullptr` reference binding in sparse matrix multiplication"
description: "The [code for sparse matrix multiplication](https://github.com/tensorflow/tensorflow/blob/8d72537c6abf5a44103b57b9c2e22c14f5f49698/tensorflow/core/kernels/sparse_matmul_op.cc#L954-L1086)
  is vulnerable to undefined behavior via binding a reference to `nullptr`:\n\n```python\nimport
  tensorflow as tf\n\ntf.raw_ops.SparseMatMul(\na=[[1.0,1.0,1.0]],\nb=[[],[],[]],\ntranspose_a=False,\ntranspose_b=False,\na_is_sparse=False,\nb_is_sparse=True)\n```\n\nThis
  occurs whenever the dimensions of `a` or `b` are 0 or less. In the case on one of
  these is 0, an empty output tensor should be allocated (to conserve the invariant
  that output tensors are always allocated when the operation is successful) but nothing
  should be written to it (that is, we should return early from the kernel implementation).
  Otherwise, attempts to write to this empty tensor would result in heap OOB access."
date: "2024-11-07"
pubdate: "2021-11-10"
affected_range: ">=2.6.0,<2.6.1||>=2.5.0,<2.5.2||<2.4.4"
fixed_versions:
- "2.6.1"
- "2.5.2"
- "2.4.4"
affected_versions: "All versions before 2.4.4, all versions starting from 2.5.0 before
  2.5.2, all versions starting from 2.6.0 before 2.6.1"
not_impacted: "All versions starting from 2.4.4 before 2.5.0, all versions starting
  from 2.5.2 before 2.6.0, all versions starting from 2.6.1"
solution: "Upgrade to versions 2.4.4, 2.5.2, 2.6.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-41219"
- "https://github.com/advisories/GHSA-4f99-p9c2-3j8x"
- "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-4f99-p9c2-3j8x"
- "https://github.com/tensorflow/tensorflow/commit/e6cf28c72ba2eb949ca950d834dd6d66bb01cfae"
- "https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2021-628.yaml"
- "https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2021-826.yaml"
- "https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow/PYSEC-2021-411.yaml"
- "https://github.com/tensorflow/tensorflow"
cvss_v2: "AV:L/AC:L/Au:N/C:P/I:P/A:P"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
uuid: "64207407-5bfd-4d29-9f2f-5aafe166ceb5"
cwe_ids:
- "CWE-125"
- "CWE-824"
- "CWE-937"
- "CWE-1035"
