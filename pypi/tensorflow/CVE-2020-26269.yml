---
identifier: "CVE-2020-26269"
identifiers:
- "CVE-2020-26269"
- "GHSA-9jjw-hf72-3mxw"
package_slug: "pypi/tensorflow"
title: "TensorFlow vulnerable to heap out of bounds read in filesystem glob matching"
description: "The general implementation for matching filesystem paths to globbing
  pattern is vulnerable to an access out of bounds of [the array holding the directories](https://github.com/tensorflow/tensorflow/blob/458c6260265c46ebaf18052d6c61aea4b6b40926/tensorflow/core/platform/file_system_helper.cc#L127):\n\n```cc\nif
  (!fs->Match(child_path, dirs[dir_index])) { ... }\n```\n\nSince `dir_index` is [unconditionaly
  incremented](https://github.com/tensorflow/tensorflow/blob/458c6260265c46ebaf18052d6c61aea4b6b40926/tensorflow/core/platform/file_system_helper.cc#L106)
  outside of the lambda function where the vulnerable pattern occurs, this results
  in an access out of bounds issue under certain scenarios. For example, if `/tmp/x`
  is a directory that only contains a single file `y`, then the following scenario
  will cause a crash due to the out of bounds read:\n\n```python\n>>> tf.io.gfile.glob('/tmp/x/')\nSegmentation
  fault\n```\n\nThere are multiple invariants and preconditions that are assumed by
  the parallel implementation of `GetMatchingPaths` but are not verified by the PRs
  introducing it ([#40861](https://github.com/tensorflow/tensorflow/pull/40861) and
  [#44310](https://github.com/tensorflow/tensorflow/pull/44310)). Thus, we are completely
  rewriting the implementation to fully specify and validate these."
date: "2024-10-30"
pubdate: "2022-10-07"
affected_range: ">=2.4.0rc0,<2.4.0"
fixed_versions:
- "2.4.0"
affected_versions: "All versions starting from 2.4.0rc0 before 2.4.0"
not_impacted: "All versions before 2.4.0rc0, all versions starting from 2.4.0"
solution: "Upgrade to version 2.4.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2020-26269"
- "https://github.com/advisories/GHSA-9jjw-hf72-3mxw"
- "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-9jjw-hf72-3mxw"
- "https://github.com/tensorflow/tensorflow/pull/40861"
- "https://github.com/tensorflow/tensorflow/pull/44310"
- "https://github.com/tensorflow/tensorflow/commit/8b5b9dc96666a3a5d27fad7179ff215e3b74b67c"
- "https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2020-300.yaml"
- "https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2020-335.yaml"
- "https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow/PYSEC-2020-141.yaml"
- "https://github.com/tensorflow/tensorflow"
- "https://github.com/tensorflow/tensorflow/blob/458c6260265c46ebaf18052d6c61aea4b6b40926/tensorflow/core/platform/file_system_helper.cc#L106"
- "https://github.com/tensorflow/tensorflow/blob/458c6260265c46ebaf18052d6c61aea4b6b40926/tensorflow/core/platform/file_system_helper.cc#L127"
cvss_v2: "AV:N/AC:L/Au:N/C:N/I:N/A:P"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
uuid: "5472be07-3ecf-4fb0-97bf-3e29bf667e5c"
cwe_ids:
- "CWE-125"
- "CWE-937"
- "CWE-1035"
