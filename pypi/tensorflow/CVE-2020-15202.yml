---
identifier: "CVE-2020-15202"
identifiers:
- "CVE-2020-15202"
- "GHSA-h6fg-mjxg-hqq4"
package_slug: "pypi/tensorflow"
title: "Integer truncation in Shard API usage"
description: "The `Shard` API in TensorFlow expects the last argument to be a function
  taking two `int64` (i.e., `long long`) arguments

  https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/core/util/work_sharder.h#L59-L60
  However, there are several places in TensorFlow where a lambda taking `int` or `int32` arguments
  is being used
  
  https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/core/kernels/random_op.cc#L204-L205
  https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/core/kernels/random_op.cc#L317-L318
  
  In these cases, if the amount of work to be parallelized is large enough, integer truncation
  occurs. Depending on how the two arguments of the lambda are used, this can result
  in segfaults, read/write outside of heap allocated arrays, stack overflows, or data
  corruption."
date: "2024-10-28"
pubdate: "2020-09-25"
affected_range: "<1.15.4||>=2.0.0,<2.0.3||>=2.1.0,<2.1.2||>=2.2.0,<2.2.1||==2.2.0||>=2.3.0,<2.3.1||==2.3.0"
fixed_versions:
- "1.15.4"
- "2.0.3"
- "2.1.2"
- "2.2.1"
- "2.3.1"
affected_versions: "All versions before 1.15.4, all versions starting from 2.0.0 before
  2.0.3, all versions starting from 2.1.0 before 2.1.2, all versions starting from
  2.2.0 before 2.2.1, version 2.2.0, all versions starting from 2.3.0 before 2.3.1,
  version 2.3.0"
not_impacted: ""
solution: "Upgrade to versions 1.15.4, 2.0.3, 2.1.2, 2.2.1, 2.3.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2020-15202"
- "https://github.com/advisories/GHSA-h6fg-mjxg-hqq4"
- "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-h6fg-mjxg-hqq4"
- "https://github.com/tensorflow/tensorflow/commit/27b417360cbd671ef55915e4bb6bb06af8b8a832"
- "https://github.com/tensorflow/tensorflow/commit/ca8c013b5e97b1373b3bb1c97ea655e69f31a575"
- "https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2020-282.yaml"
- "https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2020-317.yaml"
- "https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow/PYSEC-2020-125.yaml"
- "https://github.com/tensorflow/tensorflow"
- "https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1"
cvss_v2: "AV:N/AC:M/Au:N/C:P/I:P/A:P"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H"
uuid: "6792f5bd-60fe-4443-8fd7-b4a283132a6c"
cwe_ids:
- "CWE-197"
- "CWE-754"
- "CWE-937"
- "CWE-1035"
