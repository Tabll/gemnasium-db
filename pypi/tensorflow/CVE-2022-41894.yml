---
identifier: "CVE-2022-41894"
identifiers:
- "CVE-2022-41894"
- "GHSA-h6q3-vv32-2cq5"
package_slug: "pypi/tensorflow"
title: "Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')"
description: "TensorFlow is an open source platform for machine learning. The reference
  kernel of the `CONV_3D_TRANSPOSE` TensorFlow Lite operator wrongly increments the
  data_ptr when adding the bias to the result. Instead of `data_ptr += num_channels;`
  it should be `data_ptr += output_num_channels;` as if the number of input channels
  is different than the number of output channels, the wrong result will be returned
  and a buffer overflow will occur if num_channels > output_num_channels. An attacker
  can craft a model with a specific number of input channels. It is then possible
  to write specific values through the bias of the layer outside the bounds of the
  buffer. This attack only works if the reference kernel resolver is used in the interpreter.
  We have patched the issue in GitHub commit 72c0bdcb25305b0b36842d746cc61d72658d2941.
  The fix will be included in TensorFlow 2.11. We will also cherrypick this commit
  on TensorFlow 2.10.1, 2.9.3, and TensorFlow 2.8.4, as these are also affected and
  still in supported range."
date: "2022-11-22"
pubdate: "2022-11-18"
affected_range: "<2.8.4||>=2.9.0,<2.9.3||>=2.10.0,<2.10.1"
fixed_versions:
- "2.8.4"
- "2.9.3"
- "2.10.1"
affected_versions: "All versions before 2.8.4, all versions starting from 2.9.0 before
  2.9.3, all versions starting from 2.10.0 before 2.10.1"
not_impacted: "All versions starting from 2.8.4 before 2.9.0, all versions starting
  from 2.9.3 before 2.10.0, all versions starting from 2.10.1"
solution: "Upgrade to versions 2.8.4, 2.9.3, 2.10.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-41894"
- "https://github.com/tensorflow/tensorflow/commit/72c0bdcb25305b0b36842d746cc61d72658d2941"
- "https://github.com/tensorflow/tensorflow/blob/091e63f0ea33def7ecad661a5ac01dcafbafa90b/tensorflow/lite/kernels/internal/reference/conv3d_transpose.h#L121"
- "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-h6q3-vv32-2cq5"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "e5e40763-35e9-4b38-9f8a-6ddbf922be84"
cwe_ids:
- "CWE-1035"
- "CWE-120"
- "CWE-937"
