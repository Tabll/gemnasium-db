---
identifier: "CVE-2022-21725"
identifiers:
- "CVE-2022-21725"
- "GHSA-v3f7-j968-4h5f"
package_slug: "pypi/tensorflow-gpu"
title: "Division by zero in Tensorflow"
description: "The [estimator for the cost of some convolution operations](https://github.com/tensorflow/tensorflow/blob/ffa202a17ab7a4a10182b746d230ea66f021fe16/tensorflow/core/grappler/costs/op_level_cost_estimator.cc#L189-L198)
  can be made to execute a division by 0:\n\n```python\nimport tensorflow as tf\n\n@tf.function\ndef
  test():\ny=tf.raw_ops.AvgPoolGrad(\norig_input_shape=[1,1,1,1],\ngrad=[[[[1.0],[1.0],[1.0]]],[[[2.0],[2.0],[2.0]]],[[[3.0],[3.0],[3.0]]]],\nksize=[1,1,1,1],\nstrides=[1,1,1,0],\npadding='VALID',\ndata_format='NCHW')\nreturn
  y\n\ntest()\n```\n\nThe function fails to check that the stride argument is stricly
  positive:\n\n```cc\nint64_t GetOutputSize(const int64_t input, const int64_t filter,\nconst
  int64_t stride, const Padding& padding) {\n// Logic for calculating output shape
  is from GetWindowedOutputSizeVerbose()\n// function in third_party/tensorflow/core/framework/common_shape_fns.cc.\nif
  (padding == Padding::VALID) {\nreturn (input - filter + stride) / stride;\n} else
  {  // SAME.\nreturn (input + stride - 1) / stride;\n}\n}\n```\n\nHence, the fix
  is to add a check for the stride argument to ensure it is valid."
date: "2024-11-13"
pubdate: "2022-02-10"
affected_range: "<2.5.3||>=2.6.0,<2.6.3||>=2.7.0,<2.7.1||==2.7.0"
fixed_versions:
- "2.5.3"
- "2.6.3"
- "2.7.1"
affected_versions: "All versions before 2.5.3, all versions starting from 2.6.0 before
  2.6.3, all versions starting from 2.7.0 before 2.7.1, version 2.7.0"
not_impacted: ""
solution: "Upgrade to versions 2.5.3, 2.6.3, 2.7.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-21725"
- "https://github.com/advisories/GHSA-v3f7-j968-4h5f"
- "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-v3f7-j968-4h5f"
- "https://github.com/tensorflow/tensorflow/commit/3218043d6d3a019756607643cf65574fbfef5d7a"
- "https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2022-49.yaml"
- "https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2022-104.yaml"
- "https://github.com/tensorflow/tensorflow"
- "https://github.com/tensorflow/tensorflow/blob/ffa202a17ab7a4a10182b746d230ea66f021fe16/tensorflow/core/grappler/costs/op_level_cost_estimator.cc#L189-L198"
cvss_v2: "AV:N/AC:L/Au:S/C:N/I:N/A:P"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
uuid: "dcc0aaf8-32e8-465e-b40f-8fcfaf12fdf1"
cwe_ids:
- "CWE-369"
- "CWE-937"
- "CWE-1035"
