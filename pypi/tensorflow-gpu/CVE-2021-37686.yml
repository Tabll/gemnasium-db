---
identifier: "CVE-2021-37686"
identifiers:
- "CVE-2021-37686"
- "GHSA-mhhc-q96p-mfm9"
package_slug: "pypi/tensorflow-gpu"
title: "Infinite loop in TFLite"
description: "The strided slice implementation in TFLite has a logic bug which can
  allow an attacker to trigger an infinite loop. This arises from newly introduced
  support for [ellipsis in axis definition](https://github.com/tensorflow/tensorflow/blob/149562d49faa709ea80df1d99fc41d005b81082a/tensorflow/lite/kernels/strided_slice.cc#L103-L122):\n\n```cc\nfor
  (int i = 0; i < effective_dims;) {\nif ((1 << i) & op_context->params->ellipsis_mask)
  {\n// ...\nint ellipsis_end_idx =\nstd::min(i + 1 + num_add_axis + op_context->input_dims
  - begin_count,\neffective_dims);\n// ...\nfor (; i < ellipsis_end_idx; ++i) {\n//
  ...\n}\ncontinue;\n}\n// ...\n++i;\n}\n```\n\nAn attacker can craft a model such
  that `ellipsis_end_idx` is smaller than `i` (e.g., always negative). In this case,
  the inner loop does not increase `i` and the `continue` statement causes execution
  to skip over the preincrement at the end of the outer loop."
date: "2024-11-13"
pubdate: "2021-08-25"
affected_range: ">=2.6.0rc0,<2.6.0rc2"
fixed_versions:
- "2.6.0rc2"
affected_versions: "All versions starting from 2.6.0rc0 before 2.6.0rc2"
not_impacted: "All versions before 2.6.0rc0, all versions starting from 2.6.0rc2"
solution: "Upgrade to version 2.6.0rc2 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-37686"
- "https://github.com/advisories/GHSA-mhhc-q96p-mfm9"
- "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-mhhc-q96p-mfm9"
- "https://github.com/tensorflow/tensorflow/commit/dfa22b348b70bb89d6d6ec0ff53973bacb4f4695"
- "https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2021-599.yaml"
- "https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2021-797.yaml"
- "https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow/PYSEC-2021-308.yaml"
- "https://github.com/tensorflow/tensorflow"
- "https://github.com/tensorflow/tensorflow/releases/tag/v2.3.4"
- "https://github.com/tensorflow/tensorflow/releases/tag/v2.4.3"
- "https://github.com/tensorflow/tensorflow/releases/tag/v2.5.1"
- "https://github.com/tensorflow/tensorflow/releases/tag/v2.6.0"
cvss_v2: "AV:L/AC:L/Au:N/C:N/I:N/A:P"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
uuid: "227281ac-f8b9-48a6-865e-a342caa0732e"
cwe_ids:
- "CWE-835"
- "CWE-937"
- "CWE-1035"
