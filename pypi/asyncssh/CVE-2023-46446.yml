---
identifier: "CVE-2023-46446"
identifiers:
- "GHSA-c35q-ffpf-5qpm"
- "CVE-2023-46446"
package_slug: "pypi/asyncssh"
title: "AsyncSSH Rogue Session Attack"
description: "An issue in AsyncSSH v2.14.0 and earlier allows attackers to control
  the remote end of an SSH \nclient session via packet injection/removal and shell
  emulation.\n\nThe rogue session attack targets any SSH client connecting to an AsyncSSH
  server, on which the \nattacker must have a shell account. The goal of the attack
  is to log the client into the attacker's \naccount without the client being able
  to detect this. At that point, due to how SSH sessions \ninteract with shell environments,
  the attacker has complete control over the remote end of the SSH \nsession. The
  attacker receives all keyboard input by the user, completely controls the terminal
  \noutput of the user's session, can send and receive data to/from forwarded network
  ports, and is \nable to create signatures with a forwarded SSH Agent, if any. The
  result is a complete break of the \nconfidentiality and integrity of the secure
  channel, providing a strong vector for a targeted \nphishing campaign against the
  user. For example, the attacker can display a password prompt and \nwait for the
  user to enter the password, elevating the attacker's position to a MitM at the \napplication
  layer and enabling perfect shell emulation.\n\nThe attacks work by the attacker
  injecting a chosen authentication request before the client's \nNewKeys. The authentication
  request sent by the attacker must be a valid authentication request \ncontaining
  his credentials. The attacker can use any authentication mechanism that does not
  require \nexchanging additional messages between client and server, such as password
  or publickey. Due to a \nstate machine flaw, the AsyncSSH server accepts the unauthenticated
  user authentication request \nmessage and defers it until the client has requested
  the authentication protocol.\n"
date: "2023-12-22"
pubdate: "2023-11-14"
affected_range: "<2.14.1"
fixed_versions:
- "2.14.1"
affected_versions: "All versions before 2.14.1"
not_impacted: "All versions starting from 2.14.1"
solution: "Upgrade to version 2.14.1 or above."
urls:
- "https://github.com/ronf/asyncssh/security/advisories/GHSA-c35q-ffpf-5qpm"
- "https://github.com/ronf/asyncssh/commit/83e43f5ea3470a8617fc388c72b062c7136efd7e"
- "https://github.com/advisories/GHSA-c35q-ffpf-5qpm"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N"
uuid: "f20503bb-efcc-4779-b941-fdb4e3299a27"
cwe_ids:
- "CWE-1035"
- "CWE-639"
- "CWE-937"
