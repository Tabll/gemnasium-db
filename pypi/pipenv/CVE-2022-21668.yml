---
identifier: "CVE-2022-21668"
identifiers:
- "CVE-2022-21668"
- "GHSA-qc9x-gjcv-465w"
package_slug: "pypi/pipenv"
title: "Pipenv's requirements.txt parsing allows malicious index url in comments"
description: "Due to a flaw in pipenv's parsing of requirements files, an attacker
  can insert a specially crafted string inside a comment anywhere within a requirements.txt
  file, which will cause victims who use pipenv to install the requirements file (e.g.
  with \"`pipenv install -r requirements.txt`\") to download dependencies from a package
  index server controlled by the attacker. By embedding malicious code in packages
  served from their malicious index server, the attacker can trigger arbitrary remote
  code execution (RCE) on the victims' systems."
date: "2024-10-11"
pubdate: "2022-01-12"
affected_range: ">=2018.10.9,<2022.1.8"
fixed_versions:
- "2022.1.8"
affected_versions: "All versions starting from 2018.10.9 before 2022.1.8"
not_impacted: "All versions before 2018.10.9, all versions starting from 2022.1.8"
solution: "Upgrade to version 2022.1.8 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-21668"
- "https://github.com/advisories/GHSA-qc9x-gjcv-465w"
- "https://github.com/pypa/pipenv/security/advisories/GHSA-qc9x-gjcv-465w"
- "https://github.com/pypa/pipenv/commit/439782a8ae36c4762c88e43d5f0d8e563371b46f"
- "https://github.com/pypa/advisory-database/tree/main/vulns/pipenv/PYSEC-2022-6.yaml"
- "https://github.com/pypa/pipenv"
- "https://github.com/pypa/pipenv/releases/tag/v2022.1.8"
- "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/56HBA3EOSLEDNCCBJVHE6DO34P56EOUM"
- "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/KCROBYHUS6DKQPCXBRPCZ5CDBNQTYAWT"
- "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/QHQRIWKDP3SVJABAPEXBIQPKDI6UP7G4"
cvss_v2: "AV:N/AC:M/Au:N/C:C/I:C/A:C"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H"
uuid: "b2ab9838-0c2b-4fc8-8ecd-74fb2b7d81a3"
cwe_ids:
- "CWE-20"
- "CWE-77"
- "CWE-937"
- "CWE-1035"
