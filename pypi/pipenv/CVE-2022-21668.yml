---
identifier: "CVE-2022-21668"
identifiers:
- "GHSA-qc9x-gjcv-465w"
- "CVE-2022-21668"
package_slug: "pypi/pipenv"
title: "Improper Neutralization of Special Elements used in an OS Command ('OS Command
  Injection')"
description: "pipenv is a Python development workflow tool. Starting with and, a flaw
  in pipenv's parsing of requirements files allows an attacker to insert a specially
  crafted string inside a comment anywhere within a requirements.txt file, which will
  cause victims who use pipenv to install the requirements file to download dependencies
  from a package index server controlled by the attacker. By embedding malicious code
  in packages served from their malicious index server, the attacker can trigger arbitrary
  remote code execution (RCE) on the victims' systems. If an attacker is able to hide
  a malicious `--index-url` option in a requirements file that a victim installs with
  pipenv, the attacker can embed arbitrary malicious code in packages served from
  their malicious index server that will be executed on the victim's host during installation
  (remote code execution/RCE). When pip installs from a source distribution, any code
  in the setup.py is executed by the install process."
date: "2022-01-12"
pubdate: "2022-01-12"
affected_range: ">=2018.10.9,<2022.1.8"
fixed_versions:
- "2022.1.8"
affected_versions: "All versions starting from 2018.10.9 before 2022.1.8"
not_impacted: "All versions before 2018.10.9, all versions starting from 2022.1.8"
solution: "Upgrade to version 2022.1.8 or above."
urls:
- "https://github.com/pypa/pipenv/security/advisories/GHSA-qc9x-gjcv-465w"
- "https://github.com/pypa/pipenv/commit/439782a8ae36c4762c88e43d5f0d8e563371b46f"
- "https://nvd.nist.gov/vuln/detail/CVE-2022-21668"
- "https://github.com/pypa/pipenv/releases/tag/v2022.1.8"
- "https://github.com/advisories/GHSA-qc9x-gjcv-465w"
cvss_v2: "AV:N/AC:M/Au:N/C:C/I:C/A:C"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H"
uuid: "b2ab9838-0c2b-4fc8-8ecd-74fb2b7d81a3"
cwe_ids:
- "CWE-1035"
- "CWE-78"
- "CWE-937"
