---
identifier: "CVE-2020-5252"
identifiers:
- "CVE-2020-5252"
- "GHSA-7q25-qrjw-6fg2"
package_slug: "pypi/safety"
title: "Malicious package may avoid detection in python auditing"
description: "# Python Auditing Vulnerability\n\nDemonstrates how a malicious package
  can insert a load-time poison pill to avoid detection by tools like Safety.\n\nTools
  that are designed to find vulnerable packages can not ever run in the same python
  environment that they are trying to protect.\n\n## Usage\n\nInstall `safety`, `insecure-package`,
  and this package with pip in the same python environment. Order doesn&amp;#39;t
  matter.\n\n1. pip install safety\n2. pip install insecure-package\n3. pip install
  dist/malicious-0.1-py3-none-any.whl\n\nRun the check\n\n4. `safety check`\n\nYou
  should see both `Running my modified safety.check` and that `insecure-package` is
  not listed in the results!\n\n\n## How it Works\n\nEverything in Python is mutable.
  The trick is getting some code to run at interpreter load time in order to do some
  patching.\n\n1. When you install this package, the `setup.py` settings installs
  a `malicious.pth` file to your `site-packages` directory.\n2. The `malicious.pth`
  file gets loaded anytime Python starts, which in turn imports our `malicious` package.\n3.
  The `malicious/__init__.py` patches the safety library with a custom function to
  avoid detection."
date: "2024-10-21"
pubdate: "2020-03-24"
affected_range: "<1.9.0"
fixed_versions:
- "1.9.0"
affected_versions: "All versions before 1.9.0"
not_impacted: "All versions starting from 1.9.0"
solution: "Upgrade to version 1.9.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2020-5252"
- "https://github.com/advisories/GHSA-7q25-qrjw-6fg2"
- "https://github.com/pyupio/safety/security/advisories/GHSA-7q25-qrjw-6fg2"
- "https://github.com/akoumjian/python-safety-vuln"
- "https://github.com/pypa/advisory-database/tree/main/vulns/safety/PYSEC-2020-101.yaml"
- "https://github.com/pyupio/safety"
- "https://mulch.dev/blog/CVE-2020-5252-python-safety-vuln"
- "https://pyup.io/posts/patched-vulnerability"
cvss_v2: "AV:L/AC:M/Au:N/C:N/I:P/A:N"
cvss_v3: "CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:N/I:H/A:N"
uuid: "8cdff8ff-2c2c-4146-a42b-4c25e0a4991a"
cwe_ids:
- "CWE-807"
- "CWE-937"
- "CWE-1035"
