---
identifier: "CVE-2021-43781"
identifiers:
- "CVE-2021-43781"
- "GHSA-xr38-w74q-r8jv"
package_slug: "pypi/invenio-app-rdm"
title: "Permissions not properly checked in Invenio-Drafts-Resources"
description: "Invenio-Drafts-Resources does not properly check permissions when a
  record is published. The vulnerability is exploitable in a default installation
  of InvenioRDM. An authenticated user is able via REST API calls to publish draft
  records of other users if they know the record identifier and the draft validates
  (e.g. all require fields filled out). An attacker is not able to modify the data
  in the record, and thus e.g. *cannot* change a record from restricted to public."
date: "2024-09-23"
pubdate: "2021-12-06"
affected_range: "<6.0.5||>=7.0.0.dev0,<7.0.0.dev5"
fixed_versions:
- "6.0.5"
- "7.0.0.dev5"
affected_versions: "All versions starting from 7.0.0.dev0 before 7.0.0.dev5, all versions
  before 6.0.5"
not_impacted: "All versions before 7.0.0.dev0, all versions starting from 7.0.0.dev5
  before 0, all versions starting from 6.0.5"
solution: "Upgrade to versions 6.0.5, 7.0.0.dev5 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-43781"
- "https://github.com/advisories/GHSA-xr38-w74q-r8jv"
- "https://github.com/inveniosoftware/invenio-drafts-resources/security/advisories/GHSA-xr38-w74q-r8jv"
- "https://github.com/inveniosoftware/invenio-drafts-resources/commit/039b0cff1ad4b952000f4d8c3a93f347108b6626"
- "https://github.com/pypa/advisory-database/tree/main/vulns/invenio-app-rdm/PYSEC-2021-837.yaml"
- "https://github.com/pypa/advisory-database/tree/main/vulns/invenio-drafts-resources/PYSEC-2021-836.yaml"
cvss_v2: "AV:N/AC:L/Au:S/C:P/I:N/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N"
uuid: "c232346d-adb5-49fa-9542-d875122c7d8e"
cwe_ids:
- "CWE-862"
- "CWE-863"
- "CWE-937"
- "CWE-1035"
