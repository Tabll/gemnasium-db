---
identifier: "CVE-2023-45815"
identifiers:
- "CVE-2023-45815"
- "GHSA-cr45-98w9-gwqx"
package_slug: "pypi/archivebox"
title: "Viewing wget extractor output while logged in as an admin allows archived
  JS to execute in the admins context"
description: "Any users who are using the `wget` or `dom` extractors and view the
  content they output.\n\nThe impact is potentially severe if you are logged in to
  the ArchiveBox admin site in the same browser session and view an archived malicious
  page designed to target your ArchiveBox instance. Malicious JS could potentially
  act using your logged-in admin credentials and add/remove/modify snapshots, add/remove/modify
  ArchiveBox users, and generally do anything an admin user could do.\n\nThe impact
  is less severe for non-logged-in users, as malicious JS cannot *modify* any archives,
  but it can still *read* all the other archived content by fetching the snapshot
  index and iterating through it.\n\nBecause all of ArchiveBox's archived content
  is served from the same host and port as the admin panel, when archived pages are
  viewed the JS executes in the same context as all the other archived pages (and
  the admin panel), defeating most of the browser's usual CORS/CSRF security protections
  and leading to this issue."
date: "2024-09-12"
pubdate: "2023-10-19"
affected_range: "<=0.6.2"
fixed_versions: []
affected_versions: "All versions up to 0.6.2"
not_impacted: ""
solution: "Unfortunately, there is no solution available yet."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-45815"
- "https://github.com/advisories/GHSA-cr45-98w9-gwqx"
- "https://github.com/ArchiveBox/ArchiveBox/security/advisories/GHSA-cr45-98w9-gwqx"
- "https://github.com/ArchiveBox/ArchiveBox/issues/239"
- "https://en.wikipedia.org/wiki/Cross-site_request_forgery"
- "https://github.com/ArchiveBox/ArchiveBox"
- "https://github.com/ArchiveBox/ArchiveBox#caveats"
- "https://github.com/ArchiveBox/ArchiveBox/wiki/Configuration#save_wget"
- "https://github.com/ArchiveBox/ArchiveBox/wiki/Publishing-Your-Archive#2-export-and-host-it-as-static-html"
- "https://github.com/ArchiveBox/ArchiveBox/wiki/Publishing-Your-Archive#security-concerns"
- "https://github.com/ArchiveBox/ArchiveBox/wiki/Security-Overview"
- "https://github.com/pypa/advisory-database/tree/main/vulns/archivebox/PYSEC-2023-229.yaml"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N"
uuid: "b2fbd141-d3c6-4756-945e-06ec7197c0c4"
cwe_ids:
- "CWE-79"
- "CWE-937"
- "CWE-1035"
