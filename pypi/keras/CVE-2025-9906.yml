---
identifier: "CVE-2025-9906"
identifiers:
- "CVE-2025-9906"
- "GHSA-36fq-jgmw-4r9c"
package_slug: "pypi/keras"
title: "Keras is vulnerable to Deserialization of Untrusted Data"
description: "### Arbitrary Code Execution in Keras\n\nKeras versions prior to 3.11.0
  allow for arbitrary code execution when loading a crafted `.keras` model archive,
  even when `safe_mode=True`.\n\nThe issue arises because the archiveâ€™s `config.json`
  is parsed before layer deserialization. This can invoke `keras.config.enable_unsafe_deserialization()`,
  effectively disabling safe mode from within the loading process itself. An attacker
  can place this call first in the archive and then include a `Lambda` layer whose
  function is deserialized from a pickle, leading to the execution of attacker-controlled
  Python code as soon as a victim loads the model file.\n\nExploitation requires a
  user to open an untrusted model; no additional privileges are needed. The fix in
  version 3.11.0 enforces safe-mode semantics *before* reading any user-controlled
  configuration and prevents the toggling of unsafe deserialization via the config
  file.\n\n**Affected versions:** < 3.11.0\n**Patched version:** 3.11.0\n\nIt is recommended
  to upgrade to version 3.11.0 or later and to avoid opening untrusted model files."
date: "2025-09-23"
pubdate: "2025-09-19"
affected_range: "<3.11.0"
fixed_versions:
- "3.11.0"
affected_versions: "All versions before 3.11.0"
not_impacted: "All versions starting from 3.11.0"
solution: "Upgrade to version 3.11.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2025-9906"
- "https://github.com/advisories/GHSA-36fq-jgmw-4r9c"
- "https://github.com/keras-team/keras/pull/21429"
- "https://github.com/keras-team/keras/commit/713172ab56b864e59e2aa79b1a51b0e728bba858"
- "https://github.com/keras-team/keras"
- "https://github.com/keras-team/keras/releases/tag/v3.11.0"
- "https://osv.dev/vulnerability/CVE-2025-9906"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H"
uuid: "2c8ceb0c-274c-4230-906f-8feb9eed6aa3"
cwe_ids:
- "CWE-502"
- "CWE-937"
- "CWE-1035"
