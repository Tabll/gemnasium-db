---
identifier: "CVE-2025-12058"
identifiers:
- "CVE-2025-12058"
- "GHSA-mq84-hjqx-cwf2"
package_slug: "pypi/keras"
title: "Keras is vulnerable to arbitrary local file loading and Server-Side Request
  Forgery"
description: "The Keras.Model.load_model method, including when executed with the
  intended security mitigation safe_mode=True, is vulnerable to arbitrary local file
  loading and Server-Side Request Forgery (SSRF).\n\n\nThis vulnerability stems from
  the way the StringLookup layer is handled during model loading from a specially
  crafted .keras archive. The constructor for the StringLookup layer accepts a vocabulary
  argument that can specify a local file path or a remote file path.\n\n*  Arbitrary
  Local File Read: An attacker can create a malicious .keras file that embeds a local
  path in the StringLookup layer's configuration. When the model is loaded, Keras
  will attempt to read the content of the specified local file and incorporate it
  into the model state (e.g., retrievable via get_vocabulary()), allowing an attacker
  to read arbitrary local files on the hosting system.\n\n\n*  Server-Side Request
  Forgery (SSRF): Keras utilizes tf.io.gfile for file operations. Since tf.io.gfile
  supports remote filesystem handlers (such as GCS and HDFS) and HTTP/HTTPS protocols,
  the same mechanism can be leveraged to fetch content from arbitrary network endpoints
  on the server's behalf, resulting in an SSRF condition.\n\n\nThe security issue
  is that the feature allowing external path loading was not properly restricted by
  the safe_mode=True flag, which was intended to prevent such unintended data access."
date: "2025-10-29"
pubdate: "2025-10-29"
affected_range: "<3.12.0"
fixed_versions:
- "3.12.0"
affected_versions: "All versions before 3.12.0"
not_impacted: "All versions starting from 3.12.0"
solution: "Upgrade to version 3.12.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2025-12058"
- "https://github.com/advisories/GHSA-mq84-hjqx-cwf2"
- "https://github.com/keras-team/keras/security/advisories/GHSA-qg93-c7p6-gg7f"
- "https://github.com/keras-team/keras/pull/21751"
- "https://github.com/keras-team/keras/commit/61ac8c1e51862c471dee7b49029c356f55531487"
- "https://github.com/keras-team/keras"
- "https://www.cve.org/CVERecord?id=CVE-2025-12058"
uuid: "c438157c-82f8-4d71-bc27-bccc092cab49"
cwe_ids:
- "CWE-502"
- "CWE-918"
- "CWE-937"
- "CWE-1035"
