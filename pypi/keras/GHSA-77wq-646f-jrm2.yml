---
identifier: "GHSA-77wq-646f-jrm2"
identifiers:
- "GHSA-77wq-646f-jrm2"
package_slug: "pypi/keras"
title: "Duplicate Advisory: The Keras `Model.load_model` method **silently** ignores
  `safe_mode=True` and allows arbitrary code execution when a `.h5`/`.hdf5` file is
  loaded."
description: "### Duplicate Advisory\nThis advisory has been withdrawn because it
  is a duplicate of GHSA-36rr-ww3j-vrjv. This link is maintained to preserve external
  references.\n\n### Original Description\nThe Keras Model.load_model method can be
  exploited to achieve arbitrary code execution, even with safe_mode=True.\n\nOne
  can create a specially crafted .h5/.hdf5 model archive that, when loaded via Model.load_model,
  will trigger arbitrary code to be executed.\n\nThis is achieved by crafting a special
  .h5 archive file that uses the Lambda layer feature of keras which allows arbitrary
  Python code in the form of pickled code. The vulnerability comes from the fact that
  the safe_mode=True option is not honored when reading .h5 archives.\n\nNote that
  the .h5/.hdf5 format is a legacy format supported by Keras 3 for backwards compatibility."
date: "2025-09-19"
pubdate: "2025-09-19"
affected_range: ">=3.0.0,<3.11.3"
fixed_versions:
- "3.11.3"
affected_versions: "All versions starting from 3.0.0 before 3.11.3"
not_impacted: "All versions before 3.0.0, all versions starting from 3.11.3"
solution: "Upgrade to version 3.11.3 or above."
urls:
- "https://github.com/advisories/GHSA-77wq-646f-jrm2"
- "https://github.com/keras-team/keras/security/advisories/GHSA-36rr-ww3j-vrjv"
- "https://nvd.nist.gov/vuln/detail/CVE-2025-9905"
- "https://github.com/keras-team/keras/pull/21602"
- "https://github.com/keras-team/keras"
uuid: "262c9ab3-1b4a-4f0d-80fb-d87998fc3be6"
cwe_ids:
- "CWE-913"
- "CWE-937"
- "CWE-1035"
