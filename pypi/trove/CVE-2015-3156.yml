---
identifier: "CVE-2015-3156"
identifiers:
- "CVE-2015-3156"
- "GHSA-98c8-36p9-gw66"
package_slug: "pypi/trove"
title: "Openstack DBaaS (Trove) Improper Link Resolution Before File Access "
description: "The `_write_config` function in `trove/guestagent/datastore/experimental/mongodb/service.py`,
  `reset_configuration` function in `trove/guestagent/datastore/experimental/postgresql/service/config.py`,
  `write_config` function in `trove/guestagent/datastore/experimental/redis/service.py`,
  `_write_mycnf` function in `trove/guestagent/datastore/mysql/service.py`, `InnoBackupEx::_run_prepare`
  function in `trove/guestagent/strategies/restore/mysql_impl.py`, `InnoBackupEx::cmd`
  function in `trove/guestagent/strategies/backup/mysql_impl.py`,`MySQLDump::cmd`
  in `trove/guestagent/strategies/backup/mysql_impl.py`, `InnoBackupExIncremental::cmd`
  function in `trove/guestagent/strategies/backup/mysql_impl.py`, `_get_actual_db_status`
  function in `trove/guestagent/datastore/experimental/cassandra/system.py` and `trove/guestagent/datastore/experimental/cassandra/service.py`,
  and multiple class CbBackup methods in `trove/guestagent/strategies/backup/experimental/couchbase_impl.py`
  in Openstack DBaaS (aka Trove) as packaged in Openstack before 2015.1.0 (aka Kilo)
  allows local users to write to configuration files via a symlink attack on a temporary
  file."
date: "2024-05-14"
pubdate: "2022-05-17"
affected_range: "<4.0.0a0"
fixed_versions:
- "4.0.0a0"
affected_versions: "All versions before 4.0.0a0"
not_impacted: "All versions starting from 4.0.0a0"
solution: "Upgrade to version 4.0.0a0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2015-3156"
- "https://github.com/advisories/GHSA-98c8-36p9-gw66"
- "https://github.com/openstack/trove/commit/61774984aa2bacfe89867fc39a402a6a4cfb8f33"
- "https://bugs.launchpad.net/trove/+bug/1398195"
- "https://bugzilla.redhat.com/show_bug.cgi?id=1216073"
- "https://github.com/openstack/trove"
- "https://github.com/openstack/trove/blob/master/trove/guestagent/datastore/experimental/cassandra/service.py#L230"
- "https://github.com/openstack/trove/blob/master/trove/guestagent/datastore/experimental/mongodb/service.py#L176"
- "https://github.com/openstack/trove/blob/master/trove/guestagent/datastore/experimental/redis/service.py#L236"
- "https://github.com/openstack/trove/blob/master/trove/guestagent/datastore/mysql/service.py#L790"
- "https://github.com/openstack/trove/blob/master/trove/guestagent/strategies/backup/experimental/couchbase_impl.py#L30"
- "https://github.com/openstack/trove/blob/master/trove/guestagent/strategies/backup/mysql_impl.py#L110"
- "https://github.com/openstack/trove/blob/master/trove/guestagent/strategies/backup/mysql_impl.py#L36"
- "https://github.com/openstack/trove/blob/master/trove/guestagent/strategies/backup/mysql_impl.py#L55"
- "https://github.com/openstack/trove/blob/master/trove/guestagent/strategies/restore/mysql_impl.py#L194"
cvss_v2: "AV:L/AC:L/Au:N/C:N/I:P/A:N"
cvss_v3: "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N"
uuid: "0177ab9e-cb4c-4fb1-92fe-feb6fad0f93c"
cwe_ids:
- "CWE-59"
- "CWE-937"
- "CWE-1035"
