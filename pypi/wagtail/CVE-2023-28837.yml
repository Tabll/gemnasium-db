---
identifier: "CVE-2023-28837"
identifiers:
- "CVE-2023-28837"
- "GHSA-33pv-vcgh-jfg9"
package_slug: "pypi/wagtail"
title: "Allocation of Resources Without Limits or Throttling"
description: "Wagtail is an open source content management system built on Django.
  Prior to versions 4.1.4 and 4.2.2, a memory exhaustion bug exists in Wagtail's handling
  of uploaded images and documents. For both images and documents, files are loaded
  into memory during upload for additional processing. A user with access to upload
  images or documents through the Wagtail admin interface could upload a file so large
  that it results in a crash of denial of service. The vulnerability is not exploitable
  by an ordinary site visitor without access to the Wagtail admin. It can only be
  exploited by admin users with permission to upload images or documents. Image uploads
  are restricted to 10MB by default, however this validation only happens on the frontend
  and on the backend after the vulnerable code. Patched versions have been released
  as Wagtail 4.1.4 and Wagtail 4.2.2). Site owners who are unable to upgrade to the
  new versions are encouraged to add extra protections outside of Wagtail to limit
  the size of uploaded files."
date: "2023-11-07"
pubdate: "2023-04-03"
affected_range: "<4.1.4||>=4.2,<4.2.2"
fixed_versions:
- "4.1.4"
- "4.2.2"
affected_versions: "All versions before 4.1.4, all versions starting from 4.2 before
  4.2.2"
not_impacted: "All versions starting from 4.1.4 before 4.2, all versions starting
  from 4.2.2"
solution: "Upgrade to versions 4.1.4, 4.2.2 or above."
urls:
- "https://github.com/wagtail/wagtail/security/advisories/GHSA-33pv-vcgh-jfg9"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-28837"
- "https://github.com/wagtail/wagtail/commit/3c0c64642b9e5b8d28b111263c7f4bddad6c3880"
- "https://github.com/wagtail/wagtail/commit/c9d2fcd650a88d76ae122646142245e5927a9165"
- "https://github.com/wagtail/wagtail/commit/cfa11bbe00dbe7ce8cd4c0bbfe2a898a690df2bf"
- "https://github.com/wagtail/wagtail/commit/d4022310cbe497993459c3136311467c7ac6329a"
- "https://docs.wagtail.org/en/stable/reference/settings.html#wagtailimages-max-upload-size"
- "https://github.com/wagtail/wagtail/releases/tag/v4.1.4"
- "https://github.com/wagtail/wagtail/releases/tag/v4.2.2"
- "https://github.com/advisories/GHSA-33pv-vcgh-jfg9"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H"
uuid: "1d0f7253-c32d-47a4-bf0e-7d4c007f96bb"
cwe_ids:
- "CWE-1035"
- "CWE-400"
- "CWE-937"
