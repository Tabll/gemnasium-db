---
identifier: "CVE-2021-30185"
identifiers:
- "CVE-2021-30185"
- "GHSA-wgpj-7c2j-vfjm"
package_slug: "pypi/indico"
title: "Indico Tampering with links (e.g. password reset) in sent emails"
description: "An external audit of the Indico codebase has discovered a vulnerability
  in Indico's URL generation logic which could have allowed an attacker to make Indico
  send a password reset link with a valid token pointing to an attacker-controlled
  domain by sending that domain in the `Host` header. Had a user clicked such a link
  without realizing it does not point to Indico (and that they never requested it),
  it would have revealed their password reset token to the attacker, allowing them
  to reset the password for that user and thus take over their Indico account.\n\n-
  If the web server already enforces a canonical host name, this cannot be exploited
  (this was not part of the default config from the Indico setup guide)\n- If only
  SSO is used ([`LOCAL_IDENTITIES`](https://docs.getindico.io/en/stable/config/settings/#LOCAL_IDENTITIES)
  set to `False`), the vulnerability cannot be exploited for password reset links,
  but other links in emails set by Indico could be tampered with in the same way (with
  less problematic impact though)"
date: "2024-09-23"
pubdate: "2021-04-08"
affected_range: "<2.3.4"
fixed_versions:
- "2.3.4"
affected_versions: "All versions before 2.3.4"
not_impacted: "All versions starting from 2.3.4"
solution: "Upgrade to version 2.3.4 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-30185"
- "https://github.com/advisories/GHSA-wgpj-7c2j-vfjm"
- "https://github.com/indico/indico/security/advisories/GHSA-wgpj-7c2j-vfjm"
- "https://github.com/indico/indico/releases/tag/v2.3.4"
- "https://github.com/pypa/advisory-database/tree/main/vulns/indico/PYSEC-2021-18.yaml"
- "https://www.shorebreaksecurity.com/blog"
cvss_v2: "AV:N/AC:L/Au:N/C:N/I:P/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N"
uuid: "9de167e0-ebcc-4044-9708-1d61d1700782"
cwe_ids:
- "CWE-640"
- "CWE-937"
- "CWE-1035"
