---
identifier: "CVE-2023-49082"
identifiers:
- "GHSA-qvrw-v9rv-5rjx"
- "CVE-2023-49082"
package_slug: "pypi/aiohttp"
title: "aiohttp's ClientSession is vulnerable to CRLF injection via method"
description: "### Summary\nImproper validation makes it possible for an attacker to
  modify the HTTP request (e.g. insert a new header) or even create a new HTTP request
  if the attacker controls the HTTP method.\n\n### Details\nThe vulnerability occurs
  only if the attacker can control the HTTP method (GET, POST etc.) of the request.\n\nPrevious
  releases performed no validation on the provided value. If an attacker controls
  the HTTP method it will be used as is and can lead to HTTP request smuggling.\n\n###
  PoC\nA minimal example can be found here:\nhttps://gist.github.com/jnovikov/7f411ae9fe6a9a7804cf162a3bdbb44b\n\n###
  Impact\nIf the attacker can control the HTTP version of the request it will be able
  to modify the request (request smuggling).\n\n### Workaround\nIf unable to upgrade
  and using user-provided values for the request method, perform manual validation
  of the user value (e.g. by restricting it to a few known values like GET, POST etc.)."
date: "2023-11-27"
pubdate: "2023-11-27"
affected_range: "<3.9.0"
fixed_versions:
- "3.9.0"
affected_versions: "All versions before 3.9.0"
not_impacted: "All versions starting from 3.9.0"
solution: "Upgrade to version 3.9.0 or above."
urls:
- "https://github.com/aio-libs/aiohttp/security/advisories/GHSA-qvrw-v9rv-5rjx"
- "https://gist.github.com/jnovikov/7f411ae9fe6a9a7804cf162a3bdbb44b"
- "https://github.com/advisories/GHSA-qvrw-v9rv-5rjx"
uuid: "e1abb491-b7b2-4355-9bd0-709e47ed002f"
cwe_ids:
- "CWE-1035"
- "CWE-937"
