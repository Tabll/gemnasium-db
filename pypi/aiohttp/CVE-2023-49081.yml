---
identifier: "CVE-2023-49081"
identifiers:
- "GHSA-q3qx-c6g2-7pw2"
- "CVE-2023-49081"
package_slug: "pypi/aiohttp"
title: "aiohttp's ClientSession is vulnerable to CRLF injection via version"
description: "### Summary\nImproper validation make it possible for an attacker to
  modify the HTTP request (e.g. to insert a new header) or even create a new HTTP
  request if the attacker controls the HTTP version.\n\n### Details\nThe vulnerability
  only occurs if the attacker can control the HTTP version of the request (including
  its type).\nFor example if an unvalidated JSON value is used as a version and the
  attacker is then able to pass an array as the `version` parameter.\nFurthermore,
  the vulnerability only occurs when the `Connection` header is passed to the `headers`
  parameter.\n\nAt this point, the library will use the parsed value to create the
  request. If a list is passed, then it bypasses validation and it is possible to
  perform CRLF injection.\n\n### PoC\nThe POC below shows an example of providing
  an unvalidated array as a version:\nhttps://gist.github.com/jnovikov/184afb593d9c2114d77f508e0ccd508e\n\n###
  Impact\nCRLF injection leading to Request Smuggling.\n\n### Workaround\nIf these
  specific conditions are met and you are unable to upgrade, then validate the user
  input to the `version` parameter to ensure it is a `str`."
date: "2023-11-27"
pubdate: "2023-11-27"
affected_range: "<3.9.0"
fixed_versions:
- "3.9.0"
affected_versions: "All versions before 3.9.0"
not_impacted: "All versions starting from 3.9.0"
solution: "Upgrade to version 3.9.0 or above."
urls:
- "https://github.com/aio-libs/aiohttp/security/advisories/GHSA-q3qx-c6g2-7pw2"
- "https://gist.github.com/jnovikov/184afb593d9c2114d77f508e0ccd508e"
- "https://github.com/advisories/GHSA-q3qx-c6g2-7pw2"
uuid: "bc579d75-4607-4926-8591-a7bafc576196"
cwe_ids:
- "CWE-1035"
- "CWE-937"
