---
identifier: "CVE-2026-21892"
identifiers:
- "CVE-2026-21892"
- "GHSA-f2mf-q878-gh58"
package_slug: "pypi/parsl"
title: "Parsl Monitoring Visualization Vulnerable to SQL Injection"
description: "**Affected Product:** Parsl (Python Parallel Scripting Library)\n\n**Component:**
  parsl.monitoring.visualization\n\n**Vulnerability Type:** SQL Injection (CWE-89)\n\n**Severity:**
  High (CVSS Rating Recommended: 7.5 - 8.6)\n\n**URL:** [https://github.com/Parsl/parsl/blob/master/parsl/monitoring/visualization/views.py](
  https://github.com/Parsl/parsl/blob/master/parsl/monitoring/visualization/views.py)\n\n**Summary**\n\nA
  SQL Injection vulnerability exists in the parsl-visualize component of the Parsl
  library. The application constructs SQL queries using unsafe string formatting (Python
  % operator) with user-supplied input (workflow_id) directly from URL routes. This
  allows an unauthenticated attacker with access to the visualization dashboard to
  inject arbitrary SQL commands, potentially leading to data exfiltration or denial
  of service against the monitoring database.\n\n**Root Cause Analysis**\n\nThe vulnerability
  is located in parsl/monitoring/visualization/views.py. Multiple route handlers take
  the workflow_id parameter from the URL and inject it directly into a raw SQL query
  string without sanitization or parameterization.\n\nVulnerable Code Snippet 1\n\n```\nquery
  = \"\"\"SELECT task.task_id, task.task_func_name, task.task_depends, status.task_status_name\nFROM
  task LEFT JOIN status\nON task.task_id = status.task_id\nAND task.run_id = status.run_id\nAND
  status.timestamp = (SELECT MAX(status.timestamp)\nFROM status\nWHERE status.task_id
  = task.task_id and status.run_id = task.run_id\n)\nWHERE task.run_id='%s'\"\"\"
  % (workflow_id)\n```\n\nVulnerable Code Snippet 2\n```\ndf_task_tries = pd.read_sql_query(\"\"\"SELECT
  ...\nWHERE task.task_id = try.task_id AND task.run_id='%s' and try.run_id='%s'\"\"\"\n%
  (workflow_id, workflow_id), db.engine) # <--- Vulnerable\n```\n\n**Impact**\n\n**Data
  Exfiltration:** An attacker can use UNION based injection to dump the entire contents
  of the monitoring database, including potentially sensitive environment variables,
  task parameters, or host information logged by the monitoring system.\n\n**Access
  Control Bypass:** By injecting boolean logic (e.g., ' OR '1'='1), an attacker could
  bypass specific workflow filters to view data they are not authorized to see.\n\n**Denial
  of Service:** Time-based attacks or resource-intensive queries (e.g., randomblob)
  could crash the visualization server or the database.\n\n**Proof of Concept (PoC)**\n\n**Prerequisites:**\n\nParsl
  installed with monitoring enabled (pip install 'parsl[monitoring,visualization]').\n\nA
  running parsl-visualize server serving a database with at least one recorded workflow.\n\n**Reproduction
  Steps:**\n\nIdentify a valid workflow ID (or use a known ID like default-run or
  a UUID).\n\nNavigate to the dag_group_by_states endpoint using the following manipulated
  URLs to confirm SQL logic control (Boolean-based Blind SQLi).\n\nTest 1: Boolean
  FALSE (Graph Disappears)\nInjecting a false condition (1=0) causes the query to
  return zero rows, resulting in an empty visualization.\n\n`http://<server>:8080/workflow/<VALID_ID>'%20AND%20'1'='0/dag_group_by_states\n`\n\nTest
  2: Boolean TRUE (Graph Reappears)\nInjecting a true condition (1=1) restores the
  query logic, causing the graph to render correctly.\n\n`http://<server>:8080/workflow/<VALID_ID>'%20AND%20'1'='1/dag_group_by_states\n`"
date: "2026-01-07"
pubdate: "2026-01-06"
affected_range: "<2026.01.05"
fixed_versions:
- "2026.01.05"
affected_versions: "All versions before 2026.01.05"
not_impacted: "All versions starting from 2026.01.05"
solution: "Upgrade to version 2026.01.05 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2026-21892"
- "https://github.com/advisories/GHSA-f2mf-q878-gh58"
- "https://github.com/Parsl/parsl/security/advisories/GHSA-f2mf-q878-gh58"
- "https://github.com/Parsl/parsl/commit/013a928461e70f38a33258bd525a351ed828e974"
- "https://github.com/Parsl/parsl"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L"
uuid: "ceb1a1f9-428c-45bd-8088-d2904fd031aa"
cwe_ids:
- "CWE-89"
- "CWE-937"
- "CWE-1035"
