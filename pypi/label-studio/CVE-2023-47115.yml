---
identifier: "CVE-2023-47115"
identifiers:
- "GHSA-q68h-xwq5-mm7x"
- "CVE-2023-47115"
package_slug: "pypi/label-studio"
title: "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
description: "Label Studio is an a popular open source data labeling tool. Versions
  prior to 1.9.2 have a cross-site scripting (XSS) vulnerability that could be exploited
  when an authenticated user uploads a crafted image file for their avatar that gets
  rendered as a HTML file on the website. Executing arbitrary JavaScript could result
  in an attacker performing malicious actions on Label Studio users if they visit
  the crafted avatar image. For an example, an attacker can craft a JavaScript payload
  that adds a new Django Super Administrator user if a Django administrator visits
  the image.\n\nThe file `users/functions.py` lines 18-49 show that the only verification
  check is that the file is an image by extracting the dimensions from the file. Label
  Studio serves avatar images using Django's built-in `serve` view, which is not secure
  for production use according to Django's documentation. The issue with the Django
  `serve` view is that it determines the `Content-Type` of the response by the file
  extension in the URL path. Therefore, an attacker can upload an image that contains
  malicious HTML code and name the file with a `.html` extension to be rendered as
  a HTML page. The only file extension validation is performed on the client-side,
  which can be easily bypassed.\n\nVersion 1.9.2 fixes this issue. Other remediation
  strategies include validating the file extension on the server side, not in client-side
  code; removing the use of Django's `serve` view and implement a secure controller
  for viewing uploaded avatar images; saving file content in the database rather than
  on the filesystem to mitigate against other file related vulnerabilities; and avoiding
  trusting user controlled inputs."
date: "2024-01-24"
pubdate: "2024-01-24"
affected_range: "<1.9.2"
fixed_versions:
- "1.9.2"
affected_versions: "All versions before 1.9.2"
not_impacted: "All versions starting from 1.9.2"
solution: "Upgrade to version 1.9.2 or above."
urls:
- "https://github.com/HumanSignal/label-studio/security/advisories/GHSA-q68h-xwq5-mm7x"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-47115"
- "https://github.com/HumanSignal/label-studio/commit/a7a71e594f32ec4af8f3f800d5ccb8662e275da3"
- "https://docs.djangoproject.com/en/4.2/ref/views/#serving-files-in-development"
- "https://github.com/HumanSignal/label-studio/blob/1.8.2/label_studio/users/functions.py#L18-L49"
- "https://github.com/HumanSignal/label-studio/blob/1.8.2/label_studio/users/urls.py#L25-L26"
- "https://github.com/advisories/GHSA-q68h-xwq5-mm7x"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:L"
uuid: "d268c7e8-5ebd-4852-86c8-4d7a03c232bc"
cwe_ids:
- "CWE-1035"
- "CWE-79"
- "CWE-937"
