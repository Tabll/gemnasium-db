---
identifier: "CVE-2025-25295"
identifiers:
- "CVE-2025-25295"
- "GHSA-rgv9-w7jp-m23g"
package_slug: "pypi/label-studio-sdk"
title: "Label Studio has a Path Traversal Vulnerability via image Field"
description: "A path traversal vulnerability in Label Studio SDK versions prior to
  1.0.10 allows unauthorized file access outside the intended directory structure.
  Label Studio versions before 1.16.0 specified SDK versions prior to 1.0.10 as dependencies,
  and the issue was confirmed in Label Studio version 1.13.2.dev0; therefore, Label
  Studio users should upgrade to 1.16.0 or newer to mitigate it. The flaw exists in
  the VOC, COCO and YOLO export functionalites. These functions invoke a `download`
  function on the `label-studio-sdk` python package, which fails to validate file
  paths when processing image references during task exports:\n\n```python\ndef download(\nurl,\noutput_dir,\nfilename=None,\nproject_dir=None,\nreturn_relative_path=False,\nupload_dir=None,\ndownload_resources=True,\n):\nis_local_file
  = url.startswith(\"/data/\") and \"?d=\" in url\nis_uploaded_file = url.startswith(\"/data/upload\")\n\nif
  is_uploaded_file:\nupload_dir = _get_upload_dir(project_dir, upload_dir)\nfilename
  = urllib.parse.unquote(url.replace(\"/data/upload/\", \"\"))\nfilepath = os.path.join(upload_dir,
  filename)\nlogger.debug(\nf\"Copy {filepath} to {output_dir}\".format(\nfilepath=filepath,
  output_dir=output_dir\n)\n)\nif download_resources:\nshutil.copy(filepath, output_dir)\nif
  return_relative_path:\nreturn os.path.join(\nos.path.basename(output_dir), os.path.basename(filename)\n)\nreturn
  filepath\n\nif is_local_file:\nfilename, dir_path = url.split(\"/data/\", 1)[-1].split(\"?d=\")\ndir_path
  = str(urllib.parse.unquote(dir_path))\nfilepath = os.path.join(LOCAL_FILES_DOCUMENT_ROOT,
  dir_path)\nif not os.path.exists(filepath):\nraise FileNotFoundError(filepath)\nif
  download_resources:\nshutil.copy(filepath, output_dir)\nreturn filepath\n```\n\nBy
  creating tasks with path traversal sequences in the image field, an attacker can
  force the application to read files from arbitrary server filesystem locations when
  exporting projects in any of the mentioned formats.\n\nNote that there are two different
  possible code paths leading to this result, one for the `is_uploaded_file` and another
  one for the `is_local_file`."
date: "2025-02-14"
pubdate: "2025-02-14"
affected_range: "<1.0.10"
fixed_versions:
- "1.0.10"
affected_versions: "All versions before 1.0.10"
not_impacted: "All versions starting from 1.0.10"
solution: "Upgrade to version 1.0.10 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2025-25295"
- "https://github.com/advisories/GHSA-rgv9-w7jp-m23g"
- "https://github.com/HumanSignal/label-studio/security/advisories/GHSA-rgv9-w7jp-m23g"
- "https://github.com/HumanSignal/label-studio-sdk/commit/4a9715c6b0b619371e89c09ea8d1c86ce5c880df"
- "https://github.com/HumanSignal/label-studio-sdk"
uuid: "e0ee387f-6edb-4dc7-8feb-0ccf265a342a"
cwe_ids:
- "CWE-22"
- "CWE-26"
- "CWE-937"
- "CWE-1035"
