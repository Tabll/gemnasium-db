---
identifier: "CVE-2022-39327"
identifiers:
- "CVE-2022-39327"
- "GHSA-47xc-9rr2-q7p4"
package_slug: "pypi/azure-cli"
title: "Improper Control of Generation of Code ('Code Injection') in Azure CLI"
description: "In versions previous to 2.40.0, Azure CLI contains a vulnerability for
  potential code injection. Critical scenarios are where a hosting machine runs an
  Azure CLI command where parameter values have been provided by an external source.\n\nFor
  example: Application X is a web application with a feature that allows users to
  create Secrets in an Azure KeyVault. Instead of constructing API calls based on
  user input, Application X uses Azure CLI commands to create the secrets. Application
  X has input fields presented to the user and the Azure CLI command parameter values
  are filled based on the user input fields. This input, when formed correctly, could
  potentially be run as system commands. Below is an example of the resulting Azure
  CLI command run on the web app's hosting machine.\n\n```bash\naz keyvault secret
  set --vault-name SomeVault --name foobar --value \"abc123|whoami\"\n```\n\nThe above
  command could potentially run the `whoami` command on the hosting machine.\n\nInteractive,
  in-terminal use and automation/pipeline scenarios have not been identified as critical
  risk scenarios."
date: "2025-04-09"
pubdate: "2022-10-25"
affected_range: "<2.40.0"
fixed_versions:
- "2.40.0"
affected_versions: "All versions before 2.40.0"
not_impacted: "All versions starting from 2.40.0"
solution: "Upgrade to version 2.40.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-39327"
- "https://github.com/advisories/GHSA-47xc-9rr2-q7p4"
- "https://github.com/Azure/azure-cli/security/advisories/GHSA-47xc-9rr2-q7p4"
- "https://github.com/Azure/azure-cli/pull/23514"
- "https://github.com/Azure/azure-cli/pull/24015"
- "https://github.com/Azure/azure-cli"
- "https://github.com/pypa/advisory-database/tree/main/vulns/azure-cli/PYSEC-2022-43177.yaml"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "77e11907-930c-4ebb-a29d-7b06aa95a15f"
cwe_ids:
- "CWE-78"
- "CWE-94"
- "CWE-937"
- "CWE-1035"
