---
identifier: "CVE-2018-1000159"
identifiers:
- "CVE-2018-1000159"
- "GHSA-cwh5-3cw7-4286"
package_slug: "pypi/tlslite-ng"
title: "tlslite-ng off-by-one error on mac checking"
description: "tlslite-ng version 0.7.3 and earlier, since commit [d7b288316bca7bcdd082e6ccff5491e241305233](https://github.com/tlsfuzzer/tlslite-ng/commit/d7b288316bca7bcdd082e6ccff5491e241305233)
  contains a CWE-354: Improper Validation of Integrity Check Value vulnerability in
  TLS implementation, `tlslite/utils/constanttime.py`: `ct_check_cbc_mac_and_pad()`;
  line `end_pos = data_len - 1 - mac.digest_size` that can result in an attacker manipulating
  the TLS ciphertext which will not be detected by receiving tlslite-ng. This attack
  appears to be exploitable via man in the middle on a network connection. This vulnerability
  appears to have been fixed after commit [3674815d1b0f7484454995e2737a352e0a6a93d8](https://github.com/tlsfuzzer/tlslite-ng/pull/234/commits/3674815d1b0f7484454995e2737a352e0a6a93d8)."
date: "2024-11-13"
pubdate: "2018-07-12"
affected_range: "<0.7.4"
fixed_versions:
- "0.7.4"
affected_versions: "All versions before 0.7.4"
not_impacted: "All versions starting from 0.7.4"
solution: "Upgrade to version 0.7.4 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2018-1000159"
- "https://github.com/advisories/GHSA-cwh5-3cw7-4286"
- "https://github.com/tlsfuzzer/tlslite-ng/pull/234/commits/3674815d1b0f7484454995e2737a352e0a6a93d8"
- "https://github.com/tomato42/tlslite-ng/pull/234"
- "https://github.com/pypa/advisory-database/tree/main/vulns/tlslite-ng/PYSEC-2018-31.yaml"
- "https://github.com/tomato42/tlslite-ng"
cvss_v2: "AV:N/AC:M/Au:N/C:N/I:P/A:N"
cvss_v3: "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N"
uuid: "bc7b3432-e40e-4cbc-afc8-cd8a2a76fd27"
cwe_ids:
- "CWE-354"
- "CWE-937"
- "CWE-1035"
