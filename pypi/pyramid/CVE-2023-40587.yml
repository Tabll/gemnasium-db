---
identifier: "CVE-2023-40587"
identifiers:
- "GHSA-j8g2-6fc7-q8f8"
- "CVE-2023-40587"
package_slug: "pypi/pyramid"
title: "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
description: "Pyramid is an open source Python web framework. A path traversal vulnerability
  in Pyramid versions 2.0.0 and 2.0.1 impacts users of Python 3.11 that are using
  a Pyramid static view with a full filesystem path and have a `index.html` file that
  is located exactly one directory above the location of the static view's file system
  path. No further path traversal exists, and the only file that could be disclosed
  accidentally is `index.html`. Pyramid version 2.0.2 rejects any path that contains
  a null-byte out of caution. While valid in directory/file names, we would strongly
  consider it a mistake to use null-bytes in naming files/directories. Secondly, Python
  3.11, and 3.12 has fixed the underlying issue in `os.path.normpath` to no longer
  truncate on the first `0x00` found, returning the behavior to pre-3.11 Python, un
  an as of yet unreleased version. Fixes will be available in:Python 3.12.0rc2 and
  3.11.5. Some workarounds are available. Use a version of Python 3 that is not affected,
  downgrade to Python 3.10 series temporarily, or wait until Python 3.11.5 is released
  and upgrade to the latest version of Python 3.11 series."
date: "2024-02-16"
pubdate: "2023-08-25"
affected_range: ">=2.0,<2.0.2"
fixed_versions:
- "2.0.2"
affected_versions: "All versions starting from 2.0 before 2.0.2"
not_impacted: "All versions before 2.0, all versions starting from 2.0.2"
solution: "Upgrade to version 2.0.2 or above."
urls:
- "https://github.com/Pylons/pyramid/security/advisories/GHSA-j8g2-6fc7-q8f8"
- "https://github.com/python/cpython/issues/106242"
- "https://github.com/python/cpython/pull/106816"
- "https://github.com/Pylons/pyramid/commit/347d7750da6f45c7436dd0c31468885cc9343c85"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-40587"
- "https://github.com/advisories/GHSA-j8g2-6fc7-q8f8"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N"
uuid: "357c7090-8c82-442e-8dd2-56aef97b6e22"
cwe_ids:
- "CWE-1035"
- "CWE-22"
- "CWE-937"
