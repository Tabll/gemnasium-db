---
identifier: "CVE-2023-43804"
identifiers:
- "CVE-2023-43804"
- "GHSA-v845-jxx5-vc9f"
package_slug: "pypi/urllib3"
title: "`Cookie` HTTP header isn't stripped on cross-origin redirects"
description: "urllib3 doesn't treat the `Cookie` HTTP header special or provide any
  helpers for managing cookies over HTTP, that is the responsibility of the user.
  However, it is possible for a user to specify a `Cookie` header and unknowingly
  leak information via HTTP redirects to a different origin if that user doesn't disable
  redirects explicitly.\n\nUsers **must** handle redirects themselves instead of relying
  on urllib3's automatic redirects to achieve safe processing of the `Cookie` header,
  thus we decided to strip the header by default in order to further protect users
  who aren't using the correct approach."
date: "2024-11-18"
pubdate: "2023-10-02"
affected_range: ">=2.0.0,<2.0.6||<1.26.17"
fixed_versions:
- "2.0.6"
- "1.26.17"
affected_versions: "All versions before 1.26.17, all versions starting from 2.0.0
  before 2.0.6"
not_impacted: "All versions starting from 1.26.17 before 2.0.0, all versions starting
  from 2.0.6"
solution: "Upgrade to versions 1.26.17, 2.0.6 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-43804"
- "https://github.com/advisories/GHSA-v845-jxx5-vc9f"
- "https://github.com/urllib3/urllib3/security/advisories/GHSA-v845-jxx5-vc9f"
- "https://github.com/urllib3/urllib3/commit/01220354d389cd05474713f8c982d05c9b17aafb"
- "https://github.com/urllib3/urllib3/commit/644124ecd0b6e417c527191f866daa05a5a2056d"
- "https://github.com/pypa/advisory-database/tree/main/vulns/urllib3/PYSEC-2023-192.yaml"
- "https://github.com/urllib3/urllib3"
- "https://lists.debian.org/debian-lts-announce/2023/10/msg00012.html"
- "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/5F5CUBAN5XMEBVBZPHFITBLMJV5FIJJ5"
- "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/I3PR7C6RJ6JUBQKIJ644DMIJSUP36VDY"
- "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/NDAGZXYJ7H2G3SB47M453VQVNAWKAEJJ"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N"
uuid: "d636f01f-accc-4622-824c-8b31b894a280"
cwe_ids:
- "CWE-200"
- "CWE-937"
- "CWE-1035"
