---
identifier: "CVE-2024-37891"
identifiers:
- "CVE-2024-37891"
- "GHSA-34jh-p97f-mpxf"
package_slug: "pypi/urllib3"
title: "urllib3's Proxy-Authorization request header isn't stripped during cross-origin
  redirects "
description: "When using urllib3's proxy support with `ProxyManager`, the `Proxy-Authorization`
  header is only sent to the configured proxy, as expected.\n\nHowever, when sending
  HTTP requests *without* using urllib3's proxy support, it's possible to accidentally
  configure the `Proxy-Authorization` header even though it won't have any effect
  as the request is not using a forwarding proxy or a tunneling proxy. In those cases,
  urllib3 doesn't treat the `Proxy-Authorization` HTTP header as one carrying authentication
  material and thus doesn't strip the header on cross-origin redirects.\n\nBecause
  this is a highly unlikely scenario, we believe the severity of this vulnerability
  is low for almost all users. Out of an abundance of caution urllib3 will automatically
  strip the `Proxy-Authorization` header during cross-origin redirects to avoid the
  small chance that users are doing this on accident.\n\nUsers should use urllib3's
  proxy support or disable automatic redirects to achieve safe processing of the `Proxy-Authorization`
  header, but we still decided to strip the header by default in order to further
  protect users who aren't using the correct approach."
date: "2024-06-17"
pubdate: "2024-06-17"
affected_range: "<1.26.19||>=2.0.0,<2.2.2"
fixed_versions:
- "1.26.19"
- "2.2.2"
affected_versions: "All versions before 1.26.19, all versions starting from 2.0.0
  before 2.2.2"
not_impacted: "All versions starting from 1.26.19 before 2.0.0, all versions starting
  from 2.2.2"
solution: "Upgrade to versions 1.26.19, 2.2.2 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-37891"
- "https://github.com/advisories/GHSA-34jh-p97f-mpxf"
- "https://github.com/urllib3/urllib3/security/advisories/GHSA-34jh-p97f-mpxf"
- "https://github.com/urllib3/urllib3/commit/40b6d1605814dd1db0a46e202d6e56f2e4c9a468"
- "https://github.com/urllib3/urllib3/commit/accff72ecc2f6cf5a76d9570198a93ac7c90270e"
- "https://github.com/urllib3/urllib3"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:N/A:N"
uuid: "021e191e-ce29-479c-9402-31794dcd0855"
cwe_ids:
- "CWE-669"
- "CWE-937"
- "CWE-1035"
