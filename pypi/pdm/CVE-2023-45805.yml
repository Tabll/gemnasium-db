---
identifier: "CVE-2023-45805"
identifiers:
- "CVE-2023-45805"
- "GHSA-j44v-mmf2-xvm9"
package_slug: "pypi/pdm"
title: "Improper Neutralization of Special Elements used in an OS Command ('OS Command
  Injection')"
description: "pdm is a Python package and dependency manager supporting the latest
  PEP standards. It's possible to craft a malicious `pdm.lock` file that could allow
  e.g. an insider or a malicious open source project to appear to depend on a trusted
  PyPI project, but actually install another project. A project `foo` can be targeted
  by creating the project `foo-2` and uploading the file `foo-2-2.tar.gz` to pypi.org.
  PyPI will see this as project `foo-2` version `2`, while PDM will see this as project
  `foo` version `2-2`. The version must only be `parseable as a version` and the filename
  must be a prefix of the project name, but it's not verified to match the version
  being installed. Version `2-2` is also not a valid normalized version per PEP 440.
  Matching the project name exactly (not just prefix) would fix the issue. When installing
  dependencies with PDM, what's actually installed could differ from what's listed
  in `pyproject.toml` (including arbitrary code execution on install). It could also
  be used for downgrade attacks by only changing the version. This issue has been
  addressed in commit `6853e2642df` which is included in release version `2.9.4`.
  Users are advised to upgrade. There are no known workarounds for this vulnerability."
date: "2023-10-28"
pubdate: "2023-10-20"
affected_range: ">=2.0.0,<2.10.0"
fixed_versions:
- "2.10.0"
affected_versions: "All versions starting from 2.0.0 before 2.10.0"
not_impacted: "All versions before 2.0.0, all versions starting from 2.10.0"
solution: "Upgrade to version 2.10.0 or above."
urls:
- "https://github.com/pdm-project/pdm/security/advisories/GHSA-j44v-mmf2-xvm9"
- "https://github.com/pdm-project/pdm/commit/6853e2642dfa281d4a9958fbc6c95b7e32d84831"
- "https://github.com/frostming/unearth/blob/eca170d9370ac5032f2e497ee9b1b63823d3fe0f/src/unearth/evaluator.py#L215-L229"
- "https://github.com/pdm-project/pdm/blob/45d1dfa47d4900c14a31b9bb761e4c46eb5c9442/src/pdm/models/candidates.py#L98-L99"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-45805"
- "https://peps.python.org/pep-0440/#post-release-spelling"
- "https://github.com/advisories/GHSA-j44v-mmf2-xvm9"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H"
uuid: "3e9fffd3-bba3-4036-b5d8-4357d9ea6e0d"
cwe_ids:
- "CWE-1035"
- "CWE-937"
