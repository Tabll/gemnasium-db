---
identifier: "CVE-2022-39254"
identifiers:
- "CVE-2022-39254"
- "GHSA-w4pr-4vjg-hffh"
package_slug: "pypi/matrix-nio"
title: "Key Exchange without Entity Authentication"
description: "matrix-nio is a Python Matrix client library, designed according to
  sans I/O principles. Prior to version 0.20, when a users requests a room key from
  their devices, the software correctly remember the request. Once they receive a
  forwarded room key, they accept it without checking who the room key came from.
  This allows homeservers to try to insert room keys of questionable validity, potentially
  mounting an impersonation attack. Version 0.20 fixes the issue."
date: "2023-07-13"
pubdate: "2022-09-29"
affected_range: "<0.20"
fixed_versions:
- "0.20.0"
affected_versions: "All versions before 0.20"
not_impacted: "All versions starting from 0.20"
solution: "Upgrade to version 0.20.0 or above."
urls:
- "https://github.com/poljar/matrix-nio/security/advisories/GHSA-w4pr-4vjg-hffh"
- "https://nvd.nist.gov/vuln/detail/CVE-2022-39254"
- "https://github.com/poljar/matrix-nio/commit/b1cbf234a831daa160673defd596e6450e9c29f0"
- "https://github.com/advisories/GHSA-w4pr-4vjg-hffh"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N"
uuid: "c58e047b-1743-4b04-9c4c-f3d7267ad537"
cwe_ids:
- "CWE-1035"
- "CWE-937"
