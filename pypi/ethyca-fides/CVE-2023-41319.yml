---
identifier: "CVE-2023-41319"
identifiers:
- "CVE-2023-41319"
- "GHSA-p6p2-qq95-vq5h"
package_slug: "pypi/ethyca-fides"
title: "Protection Mechanism Failure"
description: "Fides is an open-source privacy engineering platform for managing the
  fulfillment of data privacy requests in a runtime environment, and the enforcement
  of privacy regulations in code. The Fides webserver API allows custom integrations
  to be uploaded as a ZIP file. This ZIP file must contain YAML files, but Fides can
  be configured to also accept the inclusion of custom Python code in it. The custom
  code is executed in a restricted, sandboxed environment, but the sandbox can be
  bypassed to execute any arbitrary code. The vulnerability allows the execution of
  arbitrary code on the target system within the context of the webserver python process
  owner on the webserver container, which by default is `root`, and leverage that
  access to attack underlying infrastructure and integrated systems. This vulnerability
  affects Fides versions `2.11.0` through `2.19.0`. Exploitation is limited to API
  clients with the `CONNECTOR_TEMPLATE_REGISTER` authorization scope. In the Fides
  Admin UI this scope is restricted to highly privileged users, specifically root
  users and users with the owner role. Exploitation is only possible if the security
  configuration parameter `allow_custom_connector_functions` is enabled by the user
  deploying the Fides webserver container, either in `fides.toml` or by setting the
  env var `FIDES__SECURITY__ALLOW_CUSTOM_CONNECTOR_FUNCTIONS=True`. By default this
  configuration parameter is disabled. The vulnerability has been patched in Fides
  version `2.19.0`. Users are advised to upgrade to this version or later to secure
  their systems against this threat. Users unable to upgrade should ensure that `allow_custom_connector_functions`
  in `fides.toml` and the `FIDES__SECURITY__ALLOW_CUSTOM_CONNECTOR_FUNCTIONS` are
  both either unset or explicit set to `False`."
date: "2023-09-13"
pubdate: "2023-09-06"
affected_range: ">=2.11.0,<2.19.0"
fixed_versions:
- "2.19.0"
affected_versions: "All versions starting from 2.11.0 before 2.19.0"
not_impacted: "All versions before 2.11.0, all versions starting from 2.19.0"
solution: "Upgrade to version 2.19.0 or above."
urls:
- "https://github.com/ethyca/fides/security/advisories/GHSA-p6p2-qq95-vq5h"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-41319"
- "https://github.com/ethyca/fides/commit/5989b5fa744c8d8c340963b895a054883549358a"
- "https://github.com/advisories/GHSA-p6p2-qq95-vq5h"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H"
uuid: "6d3e9176-0537-4952-a658-b1ed40a11ac0"
cwe_ids:
- "CWE-1035"
- "CWE-937"
- "CWE-94"
