---
identifier: "CVE-2021-21392"
identifiers:
- "CVE-2021-21392"
- "GHSA-5wrh-4jwv-5w78"
package_slug: "pypi/matrix-synapse"
title: "Open redirect via transitional IPv6 addresses on dual-stack networks"
description: "Requests to user provided domains were not restricted to external IP
  addresses when transitional IPv6 addresses were used. Outbound requests to federation,
  identity servers, when calculating the key validity for third-party invite events,
  sending push notifications, and generating URL previews are affected. This could
  cause Synapse to make requests to internal infrastructure on dual-stack networks."
date: "2024-09-30"
pubdate: "2021-04-13"
affected_range: "<1.28.0rc1"
fixed_versions:
- "1.28.0rc1"
affected_versions: "All versions before 1.28.0rc1"
not_impacted: "All versions starting from 1.28.0rc1"
solution: "Upgrade to version 1.28.0rc1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-21392"
- "https://github.com/advisories/GHSA-5wrh-4jwv-5w78"
- "https://github.com/matrix-org/synapse/security/advisories/GHSA-5wrh-4jwv-5w78"
- "https://github.com/matrix-org/synapse/pull/9240"
- "https://github.com/matrix-org/synapse/commit/4ca054a4eaa714d0befb4fc30b19a1131e52c9cc"
- "https://github.com/matrix-org/synapse"
- "https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2021-25.yaml"
- "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/TNNAJOZNMVMXM6AS7RFFKB4QLUJ4IFEY"
- "https://pypi.org/project/matrix-synapse"
cvss_v2: "AV:N/AC:M/Au:S/C:P/I:P/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:H/A:N"
uuid: "b0a0b330-b796-4295-99ce-2309057c0f7c"
cwe_ids:
- "CWE-601"
- "CWE-937"
- "CWE-1035"
