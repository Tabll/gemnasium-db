---
identifier: "CVE-2021-21392"
identifiers:
- "CVE-2021-21392"
- "GHSA-5wrh-4jwv-5w78"
package_slug: "pypi/matrix-synapse"
title: "URL Redirection to Untrusted Site (Open Redirect)"
description: "Synapse is a Matrix reference homeserver written in python (pypi package
  matrix-synapse). Matrix is an ecosystem for open federated Instant Messaging and
  VoIP. In Synapse requests to user provided domains were not restricted to external
  IP addresses when transitional IPv6 addresses were used. Outbound requests to federation,
  identity servers, when calculating the key validity for third-party invite events,
  sending push notifications, and generating URL previews are affected. This could
  cause Synapse to make requests to internal infrastructure on dual-stack networks.
  See referenced GitHub security advisory for details and workarounds."
date: "2023-11-07"
pubdate: "2021-04-12"
affected_range: "<1.28.0"
fixed_versions:
- "1.28.0"
affected_versions: "All versions before 1.28.0"
not_impacted: "All versions starting from 1.28.0"
solution: "Upgrade to version 1.28.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-21392"
cvss_v2: "AV:N/AC:M/Au:S/C:P/I:P/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:H/A:N"
uuid: "b0a0b330-b796-4295-99ce-2309057c0f7c"
cwe_ids:
- "CWE-1035"
- "CWE-601"
- "CWE-937"
