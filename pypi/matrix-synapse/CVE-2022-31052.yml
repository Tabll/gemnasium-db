---
identifier: "CVE-2022-31052"
identifiers:
- "CVE-2022-31052"
- "GHSA-22p3-qrh9-cx32"
package_slug: "pypi/matrix-synapse"
title: "Uncontrolled Recursion"
description: "Synapse is an open source home server implementation for the Matrix
  chat network. In versions prior to 1.61.1 URL previews of some web pages can exhaust
  the available stack space for the Synapse process due to unbounded recursion. This
  is sometimes recoverable and leads to an error for the request causing the problem,
  but in other cases the Synapse process may crash altogether. It is possible to exploit
  this maliciously, either by malicious users on the homeserver, or by remote users
  sending URLs that a local user's client may automatically request a URL preview
  for. Remote users are not able to exploit this directly, because the URL preview
  endpoint is authenticated. Deployments with `url_preview_enabled: false` set in
  configuration are not affected. Deployments with `url_preview_enabled: true` set
  in configuration **are** affected. Deployments with no configuration value set for
  `url_preview_enabled` are not affected, because the default is `false`. Administrators
  of homeservers with URL previews enabled are advised to upgrade to v1.61.1 or higher.
  Users unable to upgrade should set `url_preview_enabled` to false."
date: "2023-11-07"
pubdate: "2022-06-28"
affected_range: "<1.61.1"
fixed_versions:
- "1.61.1"
affected_versions: "All versions before 1.61.1"
not_impacted: "All versions starting from 1.61.1"
solution: "Upgrade to version 1.61.1 or above."
urls:
- "https://github.com/matrix-org/synapse/security/advisories/GHSA-22p3-qrh9-cx32"
- "https://nvd.nist.gov/vuln/detail/CVE-2022-31052"
- "https://github.com/matrix-org/synapse/commit/fa1308061802ac7b7d20e954ba7372c5ac292333"
- "https://spec.matrix.org/v1.2/client-server-api/#get_matrixmediav3preview_url"
- "https://github.com/advisories/GHSA-22p3-qrh9-cx32"
cvss_v2: "AV:N/AC:M/Au:S/C:N/I:N/A:P"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
uuid: "40b8d1a0-1e70-4740-a209-1f3b9e5e3934"
cwe_ids:
- "CWE-1035"
- "CWE-674"
- "CWE-937"
