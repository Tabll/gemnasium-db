---
identifier: "CVE-2022-39374"
identifiers:
- "CVE-2022-39374"
- "GHSA-p9qp-c452-f9r7"
package_slug: "pypi/matrix-synapse"
title: "Synapse Denial of service due to incorrect application of event authorization
  rules during state resolution"
description: "If Synapse and a malicious homeserver are both joined to the same room,
  the malicious homeserver can trick Synapse into accepting previously rejected events
  into its view of the current state of that room. This can be exploited in a way
  that causes all further messages and state changes sent in that room from the vulnerable
  homeserver to be rejected.\n\nSynapse homeservers are affected by this issue if
  and only if they are joined to rooms which members of untrusted homeservers are
  joined or invited to.\n\n- Synapse homeservers in rooms available over public federation
  **are** affected.\n- Synapse homeservers with federation disabled are not affected.\n-
  Synapse homeservers in a closed federation containing only trusted servers are not
  affected.\n- Synapse homeservers which are only joined to rooms with federation
  disabled[^1] are not affected."
date: "2024-09-30"
pubdate: "2023-05-24"
affected_range: ">=1.62.0,<1.68.0rc1"
fixed_versions:
- "1.68.0rc1"
affected_versions: "All versions starting from 1.62.0 before 1.68.0rc1"
not_impacted: "All versions before 1.62.0, all versions starting from 1.68.0rc1"
solution: "Upgrade to version 1.68.0rc1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-39374"
- "https://github.com/advisories/GHSA-p9qp-c452-f9r7"
- "https://github.com/matrix-org/synapse/security/advisories/GHSA-p9qp-c452-f9r7"
- "https://github.com/matrix-org/synapse/pull/13723"
- "https://github.com/matrix-org/synapse/commit/b73cbb82157d9666e8d667733afebc0d09ed858c"
- "https://github.com/matrix-org/synapse"
- "https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2023-66.yaml"
- "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/UJIJRP5ZH6B3KGFLHCAKR2IX2Y4Z25QD"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
uuid: "2df52be7-343b-4c83-8e9a-3087fa726960"
cwe_ids:
- "CWE-400"
- "CWE-937"
- "CWE-1035"
