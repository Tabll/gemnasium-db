---
identifier: "CVE-2021-21333"
identifiers:
- "CVE-2021-21333"
- "GHSA-c5f8-35qr-q4fm"
package_slug: "pypi/matrix-synapse"
title: "HTML injection in email and account expiry notifications"
description: "The notification emails sent for notifications for missed messages or
  for an expiring account are subject to HTML injection. In the case of the notification
  for missed messages, this could allow an attacker to insert forged content into
  the email.\n\nThe account expiry feature is not enabled by default and the HTML
  injection is not controllable by an attacker."
date: "2024-09-30"
pubdate: "2021-03-26"
affected_range: "<1.27.0"
fixed_versions:
- "1.27.0"
affected_versions: "All versions before 1.27.0"
not_impacted: "All versions starting from 1.27.0"
solution: "Upgrade to version 1.27.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-21333"
- "https://github.com/advisories/GHSA-c5f8-35qr-q4fm"
- "https://github.com/matrix-org/synapse/security/advisories/GHSA-c5f8-35qr-q4fm"
- "https://github.com/matrix-org/synapse/pull/9200"
- "https://github.com/matrix-org/synapse/commit/e54746bdf7d5c831eabe4dcea76a7626f1de73df"
- "https://github.com/matrix-org/synapse"
- "https://github.com/matrix-org/synapse/releases/tag/v1.27.0"
- "https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2021-134.yaml"
- "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/TNNAJOZNMVMXM6AS7RFFKB4QLUJ4IFEY"
cvss_v2: "AV:N/AC:H/Au:N/C:N/I:P/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:N/I:H/A:N"
uuid: "66a58fb8-8782-4859-aaae-4ed1eeec5316"
cwe_ids:
- "CWE-74"
- "CWE-79"
- "CWE-937"
- "CWE-1035"
