---
identifier: "CVE-2021-41281"
identifiers:
- "CVE-2021-41281"
- "GHSA-3hfw-x7gx-437c"
package_slug: "pypi/matrix-synapse"
title: "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
description: "Synapse is a package for Matrix homeservers written in Python 3/Twisted.
  The last 2 directories and file name of the path are chosen randomly by Synapse
  and cannot be controlled by an attacker, which limits the impact. Homeservers with
  the media repository disabled are unaffected. Homeservers with a federation allowlist
  are also unaffected, since Synapse will check the remote hostname, including the
  trailing `../`s, against the allowlist. Server administrators using a reverse proxy
  could, at the expense of losing media functionality, may block the certain endpoints
  as a workaround. Alternatively, non-containerized deployments can be adapted to
  use the hardened systemd config."
date: "2023-11-07"
pubdate: "2021-11-23"
affected_range: "<1.47.1"
fixed_versions:
- "1.47.1"
affected_versions: "All versions before 1.47.1"
not_impacted: "All versions starting from 1.47.1"
solution: "Upgrade to version 1.47.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-41281"
- "https://github.com/matrix-org/synapse/releases/tag/v1.47.1"
- "https://github.com/matrix-org/synapse/security/advisories/GHSA-3hfw-x7gx-437c"
- "https://github.com/matrix-org/synapse/commit/91f2bd090"
cvss_v2: "AV:N/AC:M/Au:N/C:N/I:P/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N"
uuid: "5e3dcd25-3255-472c-8dd7-bd4250082924"
cwe_ids:
- "CWE-1035"
- "CWE-22"
- "CWE-937"
