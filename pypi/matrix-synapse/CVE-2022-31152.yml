---
identifier: "CVE-2022-31152"
identifiers:
- "CVE-2022-31152"
- "GHSA-jhjh-776m-4765"
package_slug: "pypi/matrix-synapse"
title: "Denial of service due to incorrect application of event authorization rules"
description: "The Matrix specification specifies a list of [event authorization rules](https://spec.matrix.org/v1.3/rooms/v10/#authorization-rules)
  which must be checked when determining if an event should be accepted into a room.\n\nIn
  versions of Synapse up to and including v1.61, some of these rules are not correctly
  applied. An attacker could craft events which would be accepted by Synapse but not
  a spec-conformant server, potentially causing divergence in the room state between
  servers."
date: "2024-09-30"
pubdate: "2022-08-31"
affected_range: "<1.62.0rc1"
fixed_versions:
- "1.62.0rc1"
affected_versions: "All versions before 1.62.0rc1"
not_impacted: "All versions starting from 1.62.0rc1"
solution: "Upgrade to version 1.62.0rc1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-31152"
- "https://github.com/advisories/GHSA-jhjh-776m-4765"
- "https://github.com/matrix-org/synapse/security/advisories/GHSA-jhjh-776m-4765"
- "https://github.com/matrix-org/synapse/pull/13087"
- "https://github.com/matrix-org/synapse/pull/13088"
- "https://github.com/matrix-org/synapse/commit/d4b1c0d800eaa83c4d56a9cf17881ad362b9194b"
- "https://github.com/matrix-org/synapse/commit/e16ea87d0f8c4c30cad36f85488eb1f647e640b0"
- "https://github.com/matrix-org/synapse"
- "https://github.com/matrix-org/synapse/releases/tag/v1.62.0"
- "https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2022-262.yaml"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
uuid: "98aca2db-ac1c-4e14-a428-2333600e7b4a"
cwe_ids:
- "CWE-703"
- "CWE-755"
- "CWE-937"
- "CWE-1035"
