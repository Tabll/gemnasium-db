---
identifier: "CVE-2022-39335"
identifiers:
- "CVE-2022-39335"
- "GHSA-45cj-f97f-ggwv"
package_slug: "pypi/matrix-synapse"
title: "Synapse does not apply enough checks to servers requesting auth events of
  events in a room"
description: "Synapse is an open-source Matrix homeserver written and maintained by
  the Matrix.org Foundation. The Matrix Federation API allows remote homeservers to
  request the *authorisation events* of events in a room. This is necessary so that
  a homeserver receiving some events can validate that those events are legitimate
  and permitted in their room.\nHowever, in versions of Synapse up to and including
  1.68.0, a Synapse homeserver answering a query for authorisation events does not
  sufficiently check that the requesting server should be able to access them.\n\nAuthorisation
  events include power level events (the list of user IDs and their power levels at
  the time) and relevant membership events (including the display name of the sender
  of that event), as well as events like `m.room.create`, `m.room.third_party_invite`
  and `m.room.join_rules`. Non-authorisation events are unaffected, so it isn't possible
  to e.g. extract message contents this way.\n\nThis issue is only exploitable when
  a malicious actor knows the ID of a target room and the ID of an event from that
  room. In most cases, this makes exploitation infeasible. This issue is of negligible
  consequence for public rooms given that any server can easily join the room in order
  to be allowed to view authorisation events. Further, deployments in a closed federation
  where all homeservers are trustworthy are not affected."
date: "2024-09-24"
pubdate: "2023-05-24"
affected_range: "<1.69.0"
fixed_versions:
- "1.69.0"
affected_versions: "All versions before 1.69.0"
not_impacted: "All versions starting from 1.69.0"
solution: "Upgrade to version 1.69.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-39335"
- "https://github.com/advisories/GHSA-45cj-f97f-ggwv"
- "https://github.com/matrix-org/synapse/security/advisories/GHSA-45cj-f97f-ggwv"
- "https://github.com/matrix-org/synapse/issues/13288"
- "https://github.com/matrix-org/synapse/pull/13823"
- "https://github.com/matrix-org/synapse"
- "https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2023-65.yaml"
- "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/T2MBNMZAFY4RCZL2VGBGAPKGB4JUPZVS"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L"
uuid: "f8b26e63-d6e5-4f53-b57e-8faf897d8bd8"
cwe_ids:
- "CWE-200"
- "CWE-862"
- "CWE-937"
- "CWE-1035"
