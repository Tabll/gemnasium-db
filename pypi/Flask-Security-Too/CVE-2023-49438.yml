---
identifier: "CVE-2023-49438"
identifiers:
- "CVE-2023-49438"
- "GHSA-672h-6x89-76m5"
package_slug: "pypi/Flask-Security-Too"
title: "Open redirect vulnerability in Flask-Security-Too"
description: "An open redirect vulnerability in the python package Flask-Security-Too
  <=5.3.2 allows attackers to redirect unsuspecting users to malicious sites via a
  crafted URL by abusing the ?next parameter on the /login and /register routes.\n\nFlask-Security-Too
  contains logic to validate that the URL specified within the next parameter is either
  relative or has the same network location as the requesting URL in an attempt to
  prevent open redirections. Previously known examples that bypassed the validation
  logic such as `https://example/login?next=\\\\\\\\\\\\github.com` were patched in
  version 4.1.0\n\nHowever, examples such as `https://example/login?next=/\\\\github.com`
  and `https://example/login?next=\\\\/github.com` were discovered due to how web
  browsers normalize slashes in URLs, which makes the package vulnerable through version
  <=5.3.2\n\nAdditionally, with Werkzeug >=2.1.0 the autocorrect_location_header configuration
  was changed to False - which means that location headers in redirects are relative
  by default. Thus, this issue may impact applications that were previously not impacted,
  if they are using Werkzeug >=2.1.0 as the WSGI layer."
date: "2024-09-20"
pubdate: "2023-12-27"
affected_range: "<5.3.3"
fixed_versions:
- "5.3.3"
affected_versions: "All versions before 5.3.3"
not_impacted: "All versions starting from 5.3.3"
solution: "Upgrade to version 5.3.3 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-49438"
- "https://github.com/advisories/GHSA-672h-6x89-76m5"
- "https://github.com/Flask-Middleware/flask-security/commit/8b5abc4d4db9926a3d76b34b8b03255effb5e712"
- "https://github.com/Flask-Middleware/flask-security"
- "https://github.com/brandon-t-elliott/CVE-2023-49438"
- "https://github.com/pypa/advisory-database/tree/main/vulns/flask-security-too/PYSEC-2023-248.yaml"
- "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/6HCYH377TPUMUHELPI36PDS2ZM4VFIXM"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N"
uuid: "b2b06298-3f1c-48ad-acb7-9b83f655ea26"
cwe_ids:
- "CWE-601"
- "CWE-937"
- "CWE-1035"
