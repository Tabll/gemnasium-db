---
identifier: "CVE-2021-32618"
identifiers:
- "GHSA-6qmf-fj6m-686c"
- "CVE-2021-32618"
package_slug: "pypi/Flask-Security-Too"
title: "URL Redirection to Untrusted Site "
description: "The Python \"Flask-Security-Too\" package is used for adding security
  features to your Flask application. It is an is an independently maintained version
  of Flask-Security based on the 3.0.0 version of Flask-Security. All versions of
  Flask-Security-Too allow redirects after many successful views  by
  honoring the ?next query param. There is code in FS to validate that the url specified
  in the next parameter is either relative OR has the same netloc 
  as the requesting URL. This check utilizes Pythons urlsplit library. However many
  browsers are very lenient on the kind of URL they accept and 'fill in the blanks'
  when presented with a possibly incomplete URL. As a concrete example - setting http://login?next=\\\\\\github.com
  will pass FS's relative URL check however many browsers will gladly convert this
  to http://github.com. Thus an attacker could send such a link to an unwitting user,
  using a legitimate site and have it redirect to whatever site they want. This is
  considered a low severity due to the fact that if Werkzeug is used (which is very
  common with Flask applications) as the WSGI layer, it by default ALWAYS ensures
  that the Location header is absolute - thus making this attack vector mute. It is
  possible for application writers to modify this default behavior by setting the
  'autocorrect_location_header=False`."
date: "2022-01-10"
pubdate: "2021-05-17"
affected_range: "<=4.0.1"
fixed_versions: []
affected_versions: "All versions up to 4.0.1"
not_impacted: ""
solution: "Unfortunately, there is no solution available yet."
urls:
- "https://github.com/Flask-Middleware/flask-security/security/advisories/GHSA-6qmf-fj6m-686c"
- "https://nvd.nist.gov/vuln/detail/CVE-2021-32618"
- "https://github.com/Flask-Middleware/flask-security/issues/486"
- "https://github.com/advisories/GHSA-6qmf-fj6m-686c"
cvss_v2: "AV:N/AC:M/Au:N/C:P/I:P/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N"
uuid: "b0a76021-e728-47b4-aba0-2fbe19e8ce01"
cwe_ids:
- "CWE-1035"
- "CWE-601"
- "CWE-937"
