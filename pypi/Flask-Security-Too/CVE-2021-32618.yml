---
identifier: "CVE-2021-32618"
identifiers:
- "CVE-2021-32618"
- "GHSA-6qmf-fj6m-686c"
package_slug: "pypi/Flask-Security-Too"
title: "Open Redirect in Flask-Security-Too"
description: "Flask-Security allows redirects after many successful views (e.g. /login)
  by honoring the ?next query param. There is code in FS to validate that the url
  specified in the next parameter is either relative OR has the same netloc (network
  location) as the requesting  URL.\n\nThis check utilizes Pythons urlsplit library.
  However many browsers are very lenient on the kind of URL they accept and 'fill
  in the blanks' when presented with a possibly incomplete URL. As a concrete example
  - setting http://login?next=\\\\\\github.com\nwill pass FS's relative URL check
  however many browsers will gladly convert this to http://github.com. Thus an attacker
  could send such a link to an unwitting user, using a legitimate site and have it
  redirect to whatever site they want.\n\nThis is considered a low severity due to
  the fact that if Werkzeug by default ALWAYS ensures that the Location header is
  absolute - thus making this attack vector mute. It is possible for application writers
  to modify this default behavior by setting the 'autocorrect_location_header=False`
  which would then open up their application to this attack."
date: "2024-09-20"
pubdate: "2021-05-17"
affected_range: "<4.1.0"
fixed_versions:
- "4.1.0"
affected_versions: "All versions before 4.1.0"
not_impacted: "All versions starting from 4.1.0"
solution: "Upgrade to version 4.1.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-32618"
- "https://github.com/advisories/GHSA-6qmf-fj6m-686c"
- "https://github.com/Flask-Middleware/flask-security/commit/e39bb04615050448c1b8ba4caa7dacc0edd3e405"
- "https://github.com/Flask-Middleware/flask-security"
- "https://github.com/pypa/advisory-database/tree/main/vulns/flask-security-too/PYSEC-2021-123.yaml"
- "https://web.archive.org/web/20210517211717/https://github.com/Flask-Middleware/flask-security/issues/486"
- "https://web.archive.org/web/20211207121851/https://github.com/Flask-Middleware/flask-security/security/advisories/GHSA-6qmf-fj6m-686c"
- "https://web.archive.org/web/20220410062740/https://github.com/Flask-Middleware/flask-security/pull/489"
cvss_v2: "AV:N/AC:M/Au:N/C:P/I:P/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N"
uuid: "b0a76021-e728-47b4-aba0-2fbe19e8ce01"
cwe_ids:
- "CWE-601"
- "CWE-937"
- "CWE-1035"
