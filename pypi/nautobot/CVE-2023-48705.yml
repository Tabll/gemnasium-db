---
identifier: "CVE-2023-48705"
identifiers:
- "GHSA-cf9f-wmhp-v4pr"
- "CVE-2023-48705"
package_slug: "pypi/nautobot"
title: "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
description: "Nautobot is a Network Source of Truth and Network Automation Platform
  built as a web application All users of Nautobot versions earlier than 1.6.6 or
  2.0.5 are potentially affected by a cross-site scripting vulnerability. Due to incorrect
  usage of Django's `mark_safe()` API when rendering certain types of user-authored
  content; including custom links, job buttons, and computed fields; it is possible
  that users with permission to create or edit these types of content could craft
  a malicious payload (such as JavaScript code) that would be executed when rendering
  pages containing this content. The maintainers have fixed the incorrect uses of
  `mark_safe()` (generally by replacing them with appropriate use of `format_html()`
  instead) to prevent such malicious data from being executed. Users on Nautobot 1.6.x
  LTM should upgrade to v1.6.6 and users on Nautobot 2.0.x should upgrade to v2.0.5.
  Appropriate object permissions can and should be applied to restrict which users
  are permitted to create or edit the aforementioned types of user-authored content.
  Other than that, there is no direct workaround available."
date: "2023-11-29"
pubdate: "2023-11-22"
affected_range: "<1.6.6||>=2.0.0,<2.0.5"
fixed_versions:
- "1.6.6"
- "2.0.5"
affected_versions: "All versions before 1.6.6, all versions starting from 2.0.0 before
  2.0.5"
not_impacted: "All versions starting from 1.6.6 before 2.0.0, all versions starting
  from 2.0.5"
solution: "Upgrade to versions 1.6.6, 2.0.5 or above."
urls:
- "https://github.com/nautobot/nautobot/security/advisories/GHSA-cf9f-wmhp-v4pr"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-48705"
- "https://github.com/nautobot/nautobot/pull/4832"
- "https://github.com/nautobot/nautobot/pull/4833"
- "https://github.com/nautobot/nautobot/commit/362850f5a94689a4c75e3188bf6de826c3b012b2"
- "https://github.com/nautobot/nautobot/commit/54abe23331b6c3d0d82bf1b028c679b1d200920d"
- "https://docs.djangoproject.com/en/3.2/ref/utils/#django.utils.html.format_html"
- "https://docs.djangoproject.com/en/3.2/ref/utils/#django.utils.safestring.mark_safe"
- "https://github.com/advisories/GHSA-cf9f-wmhp-v4pr"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N"
uuid: "5fab358c-5f6b-4f1c-a4f0-eea462acee63"
cwe_ids:
- "CWE-1035"
- "CWE-79"
- "CWE-937"
