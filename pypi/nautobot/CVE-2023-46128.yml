---
identifier: "CVE-2023-46128"
identifiers:
- "CVE-2023-46128"
- "GHSA-r2hw-74xv-4gqp"
package_slug: "pypi/nautobot"
title: "Nautobot vulnerable to exposure of hashed user passwords via REST API"
description: "### Impact\n\nIn Nautobot 2.0.x, certain REST API endpoints, in combination\n
  with the `?depth=<N>` query parameter, can expose hashed user passwords \nas stored
  in the database to any authenticated user with access to these endpoints. \n\nThe
  passwords are *not* exposed in plaintext. \n\nNautobot 1.x is *not* affected by
  this vulnerability. \n\nThis information is not exposed during direct access to
  the `/api/users/users/` \nendpoint, but can be exposed through any endpoint which
  contains a nested \nreference to User object(s) when an appropriate `?depth=<N>`
  query parameter \nis specified. Known impacted endpoints include:\n\n- `/api/dcim/rack-reservations/?depth=1`(or\n
  any greater `depth` value)\n- `/api/extras/job-results/?depth=1` (or any greater\n
  `depth` value)\n- `/api/extras/notes/?depth=1` (or any greater `depth` value)\n-\n
  `/api/extras/object-changes/?depth=1` (or any greater `depth` value)\n- `/api/extras/scheduled-jobs/?depth=1`\n
  (or any greater `depth` value)\n- `/api/users/permissions/?depth=1` (or any greater\n
  `depth` value)\n\nbut this is not necessarily an exhaustive list. \n\nPlugin REST
  API endpoints for any models with a foreign key to the User \nmodel may also be
  impacted by this issue.\n\nThe patch identified below mitigates the issue for both
  Nautobot core \nREST APIs and plugin REST APIs; no code change in plugins is required
  to \naddress this issue.\n\n ### Patches\n\nRefer to https://github.com/nautobot/nautobot/pull/4692
  for the patch \nthat resolved this issue.\n\n### Workarounds\n\nUpgrading to v2.0.3
  or later, or applying the above patch, is the preferred \nworkaround for this issue;
  while it could also be partially mitigated by \nupdating permissions to deny user
  access to the above list of impacted \nREST API endpoints, that is not recommended
  as other endpoints may also \nexpose this issue until patched.\n\n ### References\n\nhttps://github.com/nautobot/nautobot/pull/4692\n"
date: "2023-11-01"
pubdate: "2023-10-25"
affected_range: ">=2.0.0,<2.0.3"
fixed_versions:
- "2.0.3"
affected_versions: "All versions starting from 2.0.0 before 2.0.3"
not_impacted: "All versions before 2.0.0, all versions starting from 2.0.3"
solution: "Upgrade to version 2.0.3 or above."
urls:
- "https://github.com/nautobot/nautobot/security/advisories/GHSA-r2hw-74xv-4gqp"
- "https://github.com/nautobot/nautobot/pull/4692"
- "https://github.com/nautobot/nautobot/commit/1ce8e5c658a075c29554d517cd453675e5d40d71"
- "https://github.com/advisories/GHSA-r2hw-74xv-4gqp"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"
uuid: "0a285c75-c4ea-4bd2-b27c-35a6928aeba7"
cwe_ids:
- "CWE-1035"
- "CWE-312"
- "CWE-937"
