---
identifier: "CVE-2023-40590"
identifiers:
- "GHSA-wfm5-v35h-vwf4"
- "CVE-2023-40590"
package_slug: "pypi/GitPython"
title: "Untrusted Search Path"
description: " GitPython is a python library used to interact with Git repositories.
  When resolving a program, Python/Windows look for the current working directory,
  and after that the PATH environment. GitPython defaults to use the `git` command,
  if a user runs GitPython from a repo has a `git.exe` or `git` executable, that program
  will be run instead of the one in the user's `PATH`. This is more of a problem on
  how Python interacts with Windows systems, Linux and any other OS aren't affected
  by this. But probably people using GitPython usually run it from the CWD of a repo.
  An attacker can trick a user to download a repository with a malicious `git` executable,
  if the user runs/imports GitPython from that directory, it allows the attacker to
  run any arbitrary commands. There is no fix currently available for windows users,
  however there are a few mitigations. 1: Default to an absolute path for the git
  program on Windows, like `C:\\\\Program Files\\\\Git\\\\cmd\\\\git.EXE` (default
  git path installation). 2: Require users to set the `GIT_PYTHON_GIT_EXECUTABLE`
  environment variable on Windows systems. 3: Make this problem prominent in the documentation
  and advise users to never run GitPython from an untrusted repo, or set the `GIT_PYTHON_GIT_EXECUTABLE`
  env var to an absolute path. 4: Resolve the executable manually by only looking
  into the `PATH` environment variable."
date: "2023-08-29"
pubdate: "2023-08-29"
affected_range: "<=3.1.32"
fixed_versions: []
affected_versions: "All versions up to 3.1.32"
not_impacted: ""
solution: "Unfortunately, there is no solution available yet."
urls:
- "https://github.com/gitpython-developers/GitPython/security/advisories/GHSA-wfm5-v35h-vwf4"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-40590"
- "https://docs.python.org/3/library/subprocess.html#popen-constructor"
- "https://github.com/advisories/GHSA-wfm5-v35h-vwf4"
uuid: "f7f96998-fde2-477c-bdb9-fb76b0ef75e8"
cwe_ids:
- "CWE-1035"
- "CWE-426"
- "CWE-78"
- "CWE-937"
