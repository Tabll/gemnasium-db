---
identifier: "GHSA-97f8-7cmv-76j2"
identifiers:
- "GHSA-97f8-7cmv-76j2"
package_slug: "pypi/picklescan"
title: "Picklescan (scan_pytorch) Bypass via dynamic eval MAGIC_NUMBER"
description: "This is a scanning bypass to `scan_pytorch` function in `picklescan`.
  As we can see in the implementation of [get_magic_number()](https://github.com/mmaitre314/picklescan/blob/2a8383cfeb4158567f9770d86597300c9e508d0f/src/picklescan/torch.py#L76C5-L84)
  that uses `pickletools.genops(data)` to get the `magic_number` with the condition
  `opcode.name` includes `INT` or `LONG`, but the PyTorch's implemtation simply uses
  [pickle_module.load()](https://github.com/pytorch/pytorch/blob/134179474539648ba7dee1317959529fbd0e7f89/torch/serialization.py#L1797)
  to get this `magic_number`. For this implementation difference, we then can embed
  the `magic_code` into the `PyTorch` file via dynamic `eval` on the `\\_\\_reduce\\_\\_`
  trick, which can make the `pickletools.genops(data)` cannot get the `magic_code`
  in `INT` or `LONG` type, but the `pickle_module.load()` can still return the same
  `magic_code`, eading to a bypass."
date: "2026-02-18"
pubdate: "2026-02-18"
affected_range: "<1.0.3"
fixed_versions:
- "1.0.3"
affected_versions: "All versions before 1.0.3"
not_impacted: "All versions starting from 1.0.3"
solution: "Upgrade to version 1.0.3 or above."
urls:
- "https://github.com/advisories/GHSA-97f8-7cmv-76j2"
- "https://github.com/mmaitre314/picklescan/security/advisories/GHSA-97f8-7cmv-76j2"
- "https://github.com/mmaitre314/picklescan/commit/b9997634683a4f4bd0c7e3701e7ce7e90fe70e8c"
- "https://github.com/mmaitre314/picklescan"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N"
cvss_v4: "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:P/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N"
uuid: "72d612a3-5766-4547-99fc-375ab6af70d8"
cwe_ids:
- "CWE-184"
- "CWE-937"
- "CWE-1035"
