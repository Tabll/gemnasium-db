---
identifier: "CVE-2024-0727"
identifiers:
- "GHSA-9v9h-cgj8-h64p"
- "CVE-2024-0727"
package_slug: "pypi/cryptography"
title: "Null pointer dereference in PKCS12 parsing"
description: "Issue summary: Processing a maliciously formatted PKCS12 file may lead
  OpenSSL\nto crash leading to a potential Denial of Service attack\n\nImpact summary:
  Applications loading files in the PKCS12 format from untrusted\nsources might terminate
  abruptly.\n\nA file in PKCS12 format can contain certificates and keys and may come
  from an\nuntrusted source. The PKCS12 specification allows certain fields to be
  NULL, but\nOpenSSL does not correctly check for this case. This can lead to a NULL
  pointer\ndereference that results in OpenSSL crashing. If an application processes
  PKCS12\nfiles from an untrusted source using the OpenSSL APIs then that application
  will\nbe vulnerable to this issue.\n\nOpenSSL APIs that is vulnerable to this are:
  PKCS12_parse(),\nPKCS12_unpack_p7data(), PKCS12_unpack_p7encdata(), PKCS12_unpack_authsafes()\nand
  PKCS12_newpass().\n\nWe have also fixed a similar issue in SMIME_write_PKCS7().
  However since this\nfunction is related to writing data we do not consider it security
  significant.\n\nThe FIPS modules in 3.2, 3.1 and 3.0 are not affected by this issue."
date: "2024-02-16"
pubdate: "2024-01-26"
affected_range: "<42.0.2"
fixed_versions:
- "42.0.2"
affected_versions: "All versions before 42.0.2"
not_impacted: "All versions starting from 42.0.2"
solution: "Upgrade to version 42.0.2 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-0727"
- "https://github.com/openssl/openssl/commit/09df4395b5071217b76dc7d3d2e630eb8c5a79c2"
- "https://github.com/openssl/openssl/commit/775acfdbd0c6af9ac855f34969cdab0c0c90844a"
- "https://github.com/openssl/openssl/commit/d135eeab8a5dbf72b3da5240bab9ddb7678dbd2c"
- "https://github.openssl.org/openssl/extended-releases/commit/03b3941d60c4bce58fab69a0c22377ab439bc0e8"
- "https://github.openssl.org/openssl/extended-releases/commit/aebaa5883e31122b404e450732dc833dc9dee539"
- "https://www.openssl.org/news/secadv/20240125.txt"
- "https://github.com/github/advisory-database/pull/3472"
- "https://github.com/openssl/openssl/pull/23362"
- "https://github.com/alexcrichton/openssl-src-rs/commit/add20f73b6b42be7451af2e1044d4e0e778992b2"
- "https://github.com/pyca/cryptography/commit/3519591d255d4506fbcd0d04037d45271903c64d"
- "https://security.netapp.com/advisory/ntap-20240208-0006"
- "https://github.com/advisories/GHSA-9v9h-cgj8-h64p"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H"
uuid: "984f2ab9-f655-4370-848f-597b96fd0c79"
cwe_ids:
- "CWE-1035"
- "CWE-937"
