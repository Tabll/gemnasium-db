---
identifier: "CVE-2021-41228"
identifiers:
- "CVE-2021-41228"
- "GHSA-3rcw-9p9x-582v"
package_slug: "pypi/tensorflow-cpu"
title: "Code injection in `saved_model_cli`"
description: "TensorFlow's `saved_model_cli` tool is vulnerable to a code injection
  as it [calls `eval` on user supplied strings](https://github.com/tensorflow/tensorflow/blob/87462bfac761435a46641ff2f10ad0b6e5414a4b/tensorflow/python/tools/saved_model_cli.py#L524-L550)\n\n```python\ndef
  preprocess_input_exprs_arg_string(input_exprs_str):\n...\nfor input_raw in filter(bool,
  input_exprs_str.split(';')):\n...\ninput_key, expr = input_raw.split('=', 1)\ninput_dict[input_key]
  = eval(expr)\n...\n```\n\nThis can be used by attackers to run arbitrary code on
  the plaform where the CLI tool runs.\nHowever, given that the tool is always run
  manually, the impact of this is not severe. We have patched this by adding a `safe`
  flag which defaults to `True` and an explicit warning for users."
date: "2024-11-13"
pubdate: "2021-11-10"
affected_range: ">=2.5.0,<2.5.2||<2.4.4||>=2.6.0,<2.6.1"
fixed_versions:
- "2.5.2"
- "2.4.4"
- "2.6.1"
affected_versions: "All versions before 2.4.4, all versions starting from 2.5.0 before
  2.5.2, all versions starting from 2.6.0 before 2.6.1"
not_impacted: "All versions starting from 2.4.4 before 2.5.0, all versions starting
  from 2.5.2 before 2.6.0, all versions starting from 2.6.1"
solution: "Upgrade to versions 2.4.4, 2.5.2, 2.6.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-41228"
- "https://github.com/advisories/GHSA-3rcw-9p9x-582v"
- "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-3rcw-9p9x-582v"
- "https://github.com/tensorflow/tensorflow/commit/8b202f08d52e8206af2bdb2112a62fafbc546ec7"
- "https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2021-637.yaml"
- "https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2021-835.yaml"
- "https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow/PYSEC-2021-420.yaml"
- "https://github.com/tensorflow/tensorflow"
cvss_v2: "AV:L/AC:L/Au:N/C:P/I:P/A:P"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
uuid: "3efb6d19-60ec-4c89-ac8a-a0f3e6b654f9"
cwe_ids:
- "CWE-78"
- "CWE-94"
- "CWE-937"
- "CWE-1035"
