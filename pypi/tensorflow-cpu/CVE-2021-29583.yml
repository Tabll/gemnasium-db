---
identifier: "CVE-2021-29583"
identifiers:
- "GHSA-9xh4-23q4-v6wr"
- "CVE-2021-29583"
package_slug: "pypi/tensorflow-cpu"
title: "NULL Pointer Dereference"
description: "TensorFlow is an end-to-end open source platform for machine learning.
  The implementation of `tf.raw_ops.FusedBatchNorm` is vulnerable to a heap buffer
  overflow. If the tensors are empty, the same implementation can trigger undefined
  behavior by dereferencing null pointers. The implementation
  fails to validate that `scale`, `offset`, `mean` and `variance` (the last two only
  when required) all have the same number of elements as the number of channels of
  `x`. This results in heap out of bounds reads when the buffers backing these tensors
  are indexed past their boundary. If the tensors are empty, the validation mentioned
  in the above paragraph would also trigger and prevent the undefined behavior. The
  fix will be included in TensorFlow 2.5.0. We will also cherrypick this commit on
  TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow 2.2.3 and TensorFlow 2.1.4, as these
  are also affected and still in supported range."
date: "2021-05-21"
pubdate: "2021-05-21"
affected_range: "<2.1.4||>=2.2.0,<2.2.3||>=2.3.0,<2.3.3||>=2.4.0,<2.4.2"
fixed_versions:
- "2.1.4"
- "2.2.3"
- "2.3.3"
- "2.4.2"
affected_versions: "All versions before 2.1.4, all versions starting from 2.2.0 before
  2.2.3, all versions starting from 2.3.0 before 2.3.3, all versions starting from
  2.4.0 before 2.4.2"
not_impacted: "All versions starting from 2.1.4 before 2.2.0, all versions starting
  from 2.2.3 before 2.3.0, all versions starting from 2.3.3 before 2.4.0, all versions
  starting from 2.4.2"
solution: "Upgrade to versions 2.1.4, 2.2.3, 2.3.3, 2.4.2 or above."
urls:
- "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-9xh4-23q4-v6wr"
- "https://nvd.nist.gov/vuln/detail/CVE-2021-29583"
- "https://github.com/tensorflow/tensorflow/commit/6972f9dfe325636b3db4e0bc517ee22a159365c0"
- "https://github.com/advisories/GHSA-9xh4-23q4-v6wr"
cvss_v2: "AV:L/AC:L/Au:N/C:P/I:P/A:P"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
uuid: "148ca97b-7075-420c-a4d2-e724d544b8e4"
cwe_ids:
- "CWE-1035"
- "CWE-476"
- "CWE-787"
- "CWE-937"
