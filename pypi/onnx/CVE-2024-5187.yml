---
identifier: "CVE-2024-5187"
identifiers:
- "CVE-2024-5187"
- "GHSA-6rq9-53c3-f7vj"
package_slug: "pypi/onnx"
title: "onnx allows Arbitrary File Overwrite in download_model_with_test_data"
description: "A vulnerability in the `download_model_with_test_data` function of the
  onnx/onnx framework, versions before 1.16.2, allow for arbitrary file overwrite
  due to inadequate prevention of path traversal attacks in malicious tar files. This
  vulnerability enables attackers to overwrite any file on the system, potentially
  leading to remote code execution, deletion of system, personal, or application files,
  thus impacting the integrity and availability of the system. The issue arises from
  the function's handling of tar file extraction without performing security checks
  on the paths within the tar file, as demonstrated by the ability to overwrite the
  `/home/kali/.ssh/authorized_keys` file by specifying an absolute path in the malicious
  tar file."
date: "2025-01-27"
pubdate: "2024-06-06"
affected_range: "<1.16.2"
fixed_versions:
- "1.16.2"
affected_versions: "All versions before 1.16.2"
not_impacted: "All versions starting from 1.16.2"
solution: "Upgrade to version 1.16.2 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-5187"
- "https://github.com/advisories/GHSA-6rq9-53c3-f7vj"
- "https://github.com/onnx/onnx/issues/6215"
- "https://github.com/onnx/onnx/pull/6145"
- "https://github.com/onnx/onnx/pull/6222"
- "https://github.com/onnx/onnx/commit/1b70f9b673259360b6a2339c4bd97db9ea6e552f"
- "https://github.com/onnx/onnx/commit/3fc3845edb048df559aa2a839e39e95503a0ee34"
- "https://github.com/onnx/onnx"
- "https://github.com/onnx/onnx/releases/tag/v1.16.2"
- "https://huntr.com/bounties/50235ebd-3410-4ada-b064-1a648e11237e"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H"
uuid: "e8e95aed-2143-4564-a6f4-f63957489584"
cwe_ids:
- "CWE-22"
- "CWE-937"
- "CWE-1035"
