---
identifier: "CVE-2024-10940"
identifiers:
- "CVE-2024-10940"
- "GHSA-5chr-fjjv-38qv"
package_slug: "pypi/langchain-core"
title: "langchain-core allows unauthorized users to read arbitrary files from the
  host file system"
description: "A vulnerability in langchain-core versions >=0.1.17,<0.1.53, >=0.2.0,<0.2.43,
  and >=0.3.0,<0.3.15 allows unauthorized users to read arbitrary files from the host
  file system. The issue arises from the ability to create langchain_core.prompts.ImagePromptTemplate's
  (and by extension langchain_core.prompts.ChatPromptTemplate's) with input variables
  that can read any user-specified path from the server file system. If the outputs
  of these prompt templates are exposed to the user, either directly or through downstream
  model outputs, it can lead to the exposure of sensitive information."
date: "2025-05-20"
pubdate: "2025-03-20"
affected_range: ">=0.1.17,<0.1.53||>=0.2.0,<0.2.43||>=0.3.0,<0.3.15"
fixed_versions:
- "0.1.53"
- "0.2.43"
- "0.3.15"
affected_versions: "All versions starting from 0.1.17 before 0.1.53, all versions
  starting from 0.2.0 before 0.2.43, all versions starting from 0.3.0 before 0.3.15"
not_impacted: "All versions before 0.1.17, all versions starting from 0.1.53 before
  0.2.0, all versions starting from 0.2.43 before 0.3.0, all versions starting from
  0.3.15"
solution: "Upgrade to versions 0.1.53, 0.2.43, 0.3.15 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-10940"
- "https://github.com/advisories/GHSA-5chr-fjjv-38qv"
- "https://github.com/langchain-ai/langchain/commit/7d481f10102f43559cc57bcad7eba291067939ee"
- "https://github.com/langchain-ai/langchain/commit/c1e742347f9701aadba8920e4d1f79a636e50b68"
- "https://github.com/langchain-ai/langchain/commit/e711034713259ae448981bc0fd1d7a5671499c31"
- "https://github.com/langchain-ai/langchain"
- "https://huntr.com/bounties/be1ee1cb-2147-4ff4-a57b-b6045271cf27"
cvss_v3: "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N"
uuid: "1269e8de-7c4a-436a-b4a4-c23b6b71994e"
cwe_ids:
- "CWE-497"
- "CWE-937"
- "CWE-1035"
