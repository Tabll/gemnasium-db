---
identifier: "CVE-2024-11958"
identifiers:
- "CVE-2024-11958"
- "GHSA-339r-cjv9-x78g"
package_slug: "pypi/llama-index-retrievers-duckdb-retriever"
title: " LlamaIndex Retrievers Integration: DuckDBRetriever SQL Injection"
description: "A SQL injection vulnerability exists in the `duckdb_retriever` component
  of the run-llama/llama_index repository, specifically in llama-index-retrievers-duckdb-retriever
  prior to v0.4.0. The vulnerability arises from the construction of SQL queries without
  using prepared statements, allowing an attacker to inject arbitrary SQL code. This
  can lead to remote code execution (RCE) by installing the shellfs extension and
  executing malicious commands."
date: "2025-05-28"
pubdate: "2025-03-20"
affected_range: "<0.4.0"
fixed_versions:
- "0.4.0"
affected_versions: "All versions before 0.4.0"
not_impacted: "All versions starting from 0.4.0"
solution: "Upgrade to version 0.4.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-11958"
- "https://github.com/advisories/GHSA-339r-cjv9-x78g"
- "https://github.com/run-llama/llama_index/commit/35bd221e948e40458052d30c6ef2779bc965b6d0"
- "https://github.com/run-llama/llama_index"
- "https://huntr.com/bounties/8ddf66e1-f74c-4d53-992b-76bc45cacac1"
cvss_v3: "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "e6b1aee2-2364-4454-8519-8294f63c1ae1"
cwe_ids:
- "CWE-89"
- "CWE-937"
- "CWE-1035"
