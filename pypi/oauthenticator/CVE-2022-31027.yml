---
identifier: "CVE-2022-31027"
identifiers:
- "CVE-2022-31027"
- "GHSA-r7v4-jwx9-wx43"
- "GMS-2022-1894"
package_slug: "pypi/oauthenticator"
title: "Authorization Bypass Through User-Controlled Key"
description: "OAuthenticator is an OAuth token library for the JupyerHub login handler.
  CILogonOAuthenticator is provided by the OAuthenticator package, and lets users
  log in to a JupyterHub via CILogon. This is primarily used to restrict a JupyterHub
  only to users of a given institute. The allowed_idps configuration trait of CILogonOAuthenticator
  is documented to be a list of domains that indicate the institutions whose users
  are authorized to access this JupyterHub. This authorization is validated by ensuring
  that the *email* field provided to us by CILogon has a *domain* that matches one
  of the domains listed in `allowed_idps`.If `allowed_idps` contains `berkeley.edu`,
  you might expect only users with valid current credentials provided by University
  of California, Berkeley to be able to access the JupyterHub. However, CILogonOAuthenticator
  does *not* verify which provider is used by the user to login, only the email address
  provided. So a user can login with a GitHub account that has email set to `<something>@berkeley.edu`,
  and that will be treated exactly the same as someone logging in using the UC Berkeley
  official Identity Provider. The patch fixing this issue makes a *breaking change*
  in how `allowed_idps` is interpreted. It's no longer a list of domains, but configuration
  representing the `EntityID` of the IdPs that are allowed, picked from the [list
  maintained by CILogon](https://cilogon.org/idplist/). Users are advised to upgrade."
date: "2022-06-16"
pubdate: "2022-06-09"
affected_range: "<15.0.0"
fixed_versions:
- "15.0.0"
affected_versions: "All versions before 15.0.0"
not_impacted: "All versions starting from 15.0.0"
solution: "Upgrade to version 15.0.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-31027"
- "https://github.com/jupyterhub/oauthenticator/security/advisories/GHSA-r7v4-jwx9-wx43"
- "https://github.com/jupyterhub/oauthenticator/commit/5cd2d1816f90dc5c946e6e38fd2d0ba535624c5c"
- "https://github.com/advisories/GHSA-r7v4-jwx9-wx43"
cvss_v2: "AV:N/AC:L/Au:S/C:P/I:N/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"
uuid: "5cc20a78-1c97-4ddf-9af8-d733931358ed"
cwe_ids:
- "CWE-1035"
- "CWE-639"
- "CWE-937"
