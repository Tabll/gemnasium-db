---
identifier: "CVE-2026-22702"
identifiers:
- "CVE-2026-22702"
- "GHSA-597g-3phw-6986"
package_slug: "pypi/virtualenv"
title: "virtualenv Has TOCTOU Vulnerabilities in Directory Creation"
description: "TOCTOU (Time-of-Check-Time-of-Use) vulnerabilities in `virtualenv` allow
  local attackers to perform symlink-based attacks on directory creation operations.
  An attacker with local access can exploit a race condition between directory existence
  checks and creation to redirect virtualenv's app_data and lock file operations to
  attacker-controlled locations.\n\n**Affected versions:** All versions up to and
  including 20.36.1\n\n**Affected users:** Any user running `virtualenv` on multi-user
  systems where untrusted local users have filesystem access to shared temporary directories
  or where `VIRTUALENV_OVERRIDE_APP_DATA` points to a user-writable location.\n\n**Attack
  scenarios:**\n- Cache poisoning: Attacker corrupts wheels or Python metadata in
  the cache\n- Information disclosure: Attacker reads sensitive cached data or metadata\n-
  Lock bypass: Attacker controls lock file semantics to cause concurrent access violations\n-
  Denial of service: Lock starvation preventing virtualenv operations"
date: "2026-01-13"
pubdate: "2026-01-13"
affected_range: "<20.36.1"
fixed_versions:
- "20.36.1"
affected_versions: "All versions before 20.36.1"
not_impacted: "All versions starting from 20.36.1"
solution: "Upgrade to version 20.36.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2026-22702"
- "https://github.com/advisories/GHSA-597g-3phw-6986"
- "https://github.com/pypa/virtualenv/security/advisories/GHSA-597g-3phw-6986"
- "https://github.com/pypa/virtualenv/pull/3013"
- "https://github.com/pypa/virtualenv/commit/dec4cec5d16edaf83a00a658f32d1e032661cebc"
- "https://github.com/pypa/virtualenv"
cvss_v3: "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L"
uuid: "b8af2c9e-57ad-47dc-9395-49f757299d11"
cwe_ids:
- "CWE-362"
- "CWE-59"
- "CWE-937"
- "CWE-1035"
