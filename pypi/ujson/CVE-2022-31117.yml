---
identifier: "CVE-2022-31117"
identifiers:
- "CVE-2022-31117"
- "GHSA-fm67-cv37-96ff"
package_slug: "pypi/ujson"
title: "Double Free"
description: "UltraJSON is a fast JSON encoder and decoder written in pure C with
  bindings for Python 3.7+. In versions prior to 5.4.0 an error occurring while reallocating
  a buffer for string decoding can cause the buffer to get freed twice. Due to how
  UltraJSON uses the internal decoder, this double free is impossible to trigger from
  Python. This issue has been resolved in version 5.4.0 and all users should upgrade
  to UltraJSON 5.4.0. There are no known workarounds for this issue."
date: "2023-11-07"
pubdate: "2022-07-05"
affected_range: "<5.4.0"
fixed_versions:
- "5.4.0"
affected_versions: "All versions before 5.4.0"
not_impacted: "All versions starting from 5.4.0"
solution: "Upgrade to version 5.4.0 or above."
urls:
- "https://github.com/ultrajson/ultrajson/security/advisories/GHSA-fm67-cv37-96ff"
- "https://nvd.nist.gov/vuln/detail/CVE-2022-31117"
- "https://github.com/ultrajson/ultrajson/commit/9c20de0f77b391093967e25d01fb48671104b15b"
- "https://github.com/advisories/GHSA-fm67-cv37-96ff"
cvss_v2: "AV:N/AC:M/Au:N/C:N/I:N/A:P"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H"
uuid: "b6592e97-6563-4d5b-a946-945b8c51ede4"
cwe_ids:
- "CWE-1035"
- "CWE-415"
- "CWE-937"
