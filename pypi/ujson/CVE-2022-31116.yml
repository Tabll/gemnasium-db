---
identifier: "CVE-2022-31116"
identifiers:
- "CVE-2022-31116"
- "GHSA-wpqr-jcpx-745r"
package_slug: "pypi/ujson"
title: "Always-Incorrect Control Flow Implementation"
description: "UltraJSON is a fast JSON encoder and decoder written in pure C with
  bindings for Python 3.7+. Affected versions were found to improperly decode certain
  characters. JSON strings that contain escaped surrogate characters not part of a
  proper surrogate pair were decoded incorrectly. Besides corrupting strings, this
  allowed for potential key confusion and value overwriting in dictionaries. All users
  parsing JSON from untrusted sources is vulnerable. From version 5.4.0, UltraJSON
  decodes lone surrogates in the same way as the standard library's `json` module
  does, preserving them in the parsed output. Users are advised to upgrade. There
  are no known workarounds for this issue."
date: "2023-11-07"
pubdate: "2022-07-05"
affected_range: "<5.4.0"
fixed_versions:
- "5.4.0"
affected_versions: "All versions before 5.4.0"
not_impacted: "All versions starting from 5.4.0"
solution: "Upgrade to version 5.4.0 or above."
urls:
- "https://github.com/ultrajson/ultrajson/security/advisories/GHSA-wpqr-jcpx-745r"
- "https://nvd.nist.gov/vuln/detail/CVE-2022-31116"
- "https://github.com/ultrajson/ultrajson/commit/67ec07183342589d602e0fcf7bb1ff3e19272687"
- "https://github.com/advisories/GHSA-wpqr-jcpx-745r"
cvss_v2: "AV:N/AC:L/Au:N/C:N/I:N/A:P"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
uuid: "c5476d51-cd49-45d3-b231-588815f99ff8"
cwe_ids:
- "CWE-1035"
- "CWE-670"
- "CWE-937"
