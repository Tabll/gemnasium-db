---
identifier: "CVE-2023-41893"
identifiers:
- "CVE-2023-41893"
- "GHSA-qhhj-7hrc-gqj5"
package_slug: "pypi/homeassistant"
title: "Home Assistant vulnerable to account takeover via auth_callback login"
description: "[_Part of the Cure53 security audit of Home Assistant._](https://www.home-assistant.io/blog/2023/10/19/security-audits-of-home-assistant/)\n\nThe
  audit team’s analyses confirmed that the `redirect_uri` and `client_id` are alterable
  when logging in. Consequently, the code parameter utilized to fetch the `access_token`
  post-authentication will be sent to the URL specified in the aforementioned parameters.\n\nSince
  an arbitrary URL is permitted and `homeassistant.local` represents the preferred,
  default domain likely used and trusted by many users, an attacker could leverage
  this weakness to manipulate a user and retrieve account access. Notably, this attack
  strategy is plausible if the victim has exposed their Home Assistant to the Internet,
  since after acquiring the victim’s `access_token`, the adversary would need to utilize
  it directly towards the instance to achieve any pertinent malicious actions.\n\nTo
  achieve this compromise attempt, the attacker must send a link with a `redirect_uri`
  that they control to the victim’s own Home Assistant instance. In the eventuality
  the victim authenticates via the said link, the attacker would obtain code sent
  to the specified URL in `redirect_uri`, which can then be leveraged to fetch an
  `access_token`.\n\nAn attacker could increase the efficacy of this strategy by registering
  a nearly identical domain to `homeassistant.local`, which at first glance may appear
  legitimate and thereby obfuscate any malicious intentions.\n\nNonetheless, owing
  to the requirements for victim interaction and Home Assistant instance exposure
  to the Internet, this severity rating was consequently downgraded to Low."
date: "2024-09-20"
pubdate: "2023-10-26"
affected_range: "<2023.9.0"
fixed_versions:
- "2023.9.0"
affected_versions: "All versions before 2023.9.0"
not_impacted: "All versions starting from 2023.9.0"
solution: "Upgrade to version 2023.9.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-41893"
- "https://github.com/advisories/GHSA-qhhj-7hrc-gqj5"
- "https://github.com/home-assistant/core/security/advisories/GHSA-qhhj-7hrc-gqj5"
- "https://github.com/home-assistant/core"
- "https://github.com/pypa/advisory-database/tree/main/vulns/homeassistant/PYSEC-2023-214.yaml"
- "https://www.home-assistant.io/blog/2023/10/19/security-audits-of-home-assistant"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N"
uuid: "f8fc20fe-19f3-4bf4-872e-927b35ee9608"
cwe_ids:
- "CWE-200"
- "CWE-937"
- "CWE-1035"
