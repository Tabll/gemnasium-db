---
identifier: "CVE-2020-15105"
identifiers:
- "CVE-2020-15105"
- "GHSA-vhr6-pvjm-9qwf"
package_slug: "pypi/django-two-factor-auth"
title: "User passwords are stored in clear text in the Django session"
description: "django-two-factor-auth versions 1.11 and before store the user's password
  in clear text in the user session (base64-encoded). The password is stored in the
  session when the user submits their username and password, and is removed once they
  complete authentication by entering a two-factor authentication code. This means
  that the password is stored in clear text in the session for an arbitrary amount
  of time, and potentially forever if the user begins the login process by entering
  their username and password, and then leaves before entering their two-factor authentication
  code.\n\nThe severity of this issue depends on which type of session storage you
  have configured: in the worst case, if you're using Django's default database session
  storage, then users' password are stored in clear text in your database. In the
  best case, if you're using Django's signed cookie session, then users' passwords
  are only stored in clear text within their browser's cookie store. In the common
  case of using Django's cache session store, the users' password are stored in clear
  text in whatever cache storage you have configured (typically Memcached or Redis)."
date: "2024-09-16"
pubdate: "2020-07-10"
affected_range: "<1.12"
fixed_versions:
- "1.12"
affected_versions: "All versions before 1.12"
not_impacted: "All versions starting from 1.12"
solution: "Upgrade to version 1.12 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2020-15105"
- "https://github.com/advisories/GHSA-vhr6-pvjm-9qwf"
- "https://github.com/Bouke/django-two-factor-auth/security/advisories/GHSA-vhr6-pvjm-9qwf"
- "https://github.com/Bouke/django-two-factor-auth/commit/454fd9842fa6e8bb772dbf0943976bc8e3335359"
- "https://github.com/Bouke/django-two-factor-auth"
- "https://github.com/Bouke/django-two-factor-auth/blob/master/CHANGELOG.md#112---2020-07-08"
- "https://github.com/pypa/advisory-database/tree/main/vulns/django-two-factor-auth/PYSEC-2020-39.yaml"
cvss_v2: "AV:N/AC:H/Au:S/C:P/I:P/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:L/A:N"
uuid: "5b88aff8-d9ed-4923-ba6e-3d92b6666bde"
cwe_ids:
- "CWE-312"
- "CWE-937"
- "CWE-1035"
