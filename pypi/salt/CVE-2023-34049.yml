---
identifier: "CVE-2023-34049"
identifiers:
- "CVE-2023-34049"
- "GHSA-4277-m35q-7c9w"
package_slug: "pypi/salt"
title: "Salt preflight script could be attacker controlled"
description: "The Salt-SSH pre-flight option copies the script to the target at a
  predictable path, which allows an attacker to force Salt-SSH to run their script.
  If an attacker has access to the target VM and knows the path to the pre-flight
  script before it runs they can ensure Salt-SSH runs their script with the privileges
  of the user running Salt-SSH.Â Do not make the copy path on the target predictable
  and ensure we check return codes of the scp command if the copy fails."
date: "2024-11-14"
pubdate: "2024-11-14"
affected_range: "<3005.4||>=3006.0rc1,<3006.4"
fixed_versions:
- "3005.4"
- "3006.4"
affected_versions: "All versions starting from 3006.0rc1 before 3006.4, all versions
  before 3005.4"
not_impacted: "All versions before 3006.0rc1, all versions starting from 3006.4 before
  0, all versions starting from 3005.4"
solution: "Upgrade to versions 3005.4, 3006.4 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-34049"
- "https://github.com/advisories/GHSA-4277-m35q-7c9w"
- "https://github.com/saltstack/salt/commit/286d55eb5a6e6bf9428405bdf5632b419bdf8444"
- "https://github.com/saltstack/salt/commit/7a14112f2a16ce70e3c3e1862c92e37af5f2c7a4"
- "https://github.com/saltstack/salt"
- "https://saltproject.io/security-announcements/2023-10-27-advisory"
cvss_v3: "CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:H"
uuid: "fad9d56f-d096-49cc-bdf7-28b8f0fdd13b"
cwe_ids:
- "CWE-340"
- "CWE-937"
- "CWE-1035"
