---
identifier: "CVE-2022-22967"
identifiers:
- "CVE-2022-22967"
- "GHSA-fpxm-fprw-6hxj"
package_slug: "pypi/salt"
title: "Salt's PAM auth fails to reject locked accounts"
description: "An issue was discovered in SaltStack Salt in versions before 3002.9,
  3003.5, 3004.2. PAM auth fails to reject locked accounts, which allows a previously
  authorized user whose account is locked still run Salt commands when their account
  is locked. This affects both local shell accounts with an active session and salt-api
  users that authenticate via PAM eauth."
date: "2023-12-21"
pubdate: "2022-06-23"
affected_range: "<3002.9||>=3003,<3003.5||>=3004,<3004.2"
fixed_versions:
- "3002.9"
- "3003.5"
- "3004.2"
affected_versions: "All versions before 3002.9, all versions starting from 3003 before
  3003.5, all versions starting from 3004 before 3004.2"
not_impacted: "All versions starting from 3002.9 before 3003, all versions starting
  from 3003.5 before 3004, all versions starting from 3004.2"
solution: "Upgrade to versions 3002.9, 3003.5, 3004.2 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-22967"
- "https://github.com/pypa/advisory-database/tree/main/vulns/salt/PYSEC-2022-210.yaml"
- "https://repo.saltproject.io/"
- "https://saltproject.io/security_announcements/salt-security-advisory-release-june-21st-2022/,"
- "https://github.com/advisories/GHSA-fpxm-fprw-6hxj"
cvss_v2: "AV:N/AC:L/Au:S/C:P/I:P/A:P"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
uuid: "6d40f64f-68a8-4d7a-9068-b6261e9b251a"
cwe_ids:
- "CWE-1035"
- "CWE-863"
- "CWE-937"
