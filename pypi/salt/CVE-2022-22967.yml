---
identifier: "CVE-2022-22967"
identifiers:
- "GHSA-fpxm-fprw-6hxj"
- "CVE-2022-22967"
package_slug: "pypi/salt"
title: "Salt's PAM auth fails to reject locked accounts"
description: "An issue was discovered in SaltStack Salt in versions before 3002.9,
  3003.5, 3004.2. PAM auth fails to reject locked accounts, which allows a previously
  authorized user whose account is locked still run Salt commands when their account
  is locked. This affects both local shell accounts with an active session and salt-api
  users that authenticate via PAM eauth."
date: "2022-06-25"
pubdate: "2022-06-25"
affected_range: "<3002.9||>=3003.0,<3003.5||>=3004.0,<3004.2"
fixed_versions:
- "3002.9"
- "3003.5"
- "3004.2"
affected_versions: "All versions before 3002.9, all versions starting from 3003.0
  before 3003.5, all versions starting from 3004.0 before 3004.2"
not_impacted: "All versions starting from 3002.9 before 3003.0, all versions starting
  from 3003.5 before 3004.0, all versions starting from 3004.2"
solution: "Upgrade to versions 3002.9, 3003.5, 3004.2 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-22967"
- "https://github.com/pypa/advisory-database/tree/main/vulns/salt/PYSEC-2022-210.yaml"
- "https://repo.saltproject.io/"
- "https://saltproject.io/security_announcements/salt-security-advisory-release-june-21st-2022/,"
- "https://github.com/advisories/GHSA-fpxm-fprw-6hxj"
uuid: "6d40f64f-68a8-4d7a-9068-b6261e9b251a"
cwe_ids:
- "CWE-1035"
- "CWE-937"
