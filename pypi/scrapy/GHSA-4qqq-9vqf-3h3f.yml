---
identifier: "GHSA-4qqq-9vqf-3h3f"
identifiers:
- "GHSA-4qqq-9vqf-3h3f"
package_slug: "pypi/scrapy"
title: "Scrapy leaks the authorization header on same-domain but cross-origin redirects"
description: "Since version 2.11.1, Scrapy drops the `Authorization` header when a
  request is redirected to a different domain. However, it keeps the header if the
  domain remains the same but the scheme (http/https) or the port change, all scenarios
  where the header should also be dropped.\n\nIn the context of a man-in-the-middle
  attack, this could be used to get access to the value of that `Authorization` header"
date: "2024-05-14"
pubdate: "2024-05-14"
affected_range: "<2.11.2"
fixed_versions:
- "2.11.2"
affected_versions: "All versions before 2.11.2"
not_impacted: "All versions starting from 2.11.2"
solution: "Upgrade to version 2.11.2 or above."
urls:
- "https://github.com/advisories/GHSA-4qqq-9vqf-3h3f"
- "https://github.com/scrapy/scrapy/security/advisories/GHSA-4qqq-9vqf-3h3f"
- "https://github.com/scrapy/scrapy/commit/1d0502f25bbe55a22899af915623fda1aaeb9dd8"
- "https://github.com/scrapy/scrapy"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N"
uuid: "9548558d-081f-4ed1-8736-4c0f82e930da"
cwe_ids:
- "CWE-200"
- "CWE-937"
- "CWE-1035"
