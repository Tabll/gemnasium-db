---
identifier: "CVE-2023-5043"
identifiers:
- "CVE-2023-5043"
- "GHSA-5wj4-wffq-3378"
package_slug: "go/k8s.io/ingress-nginx"
title: "Ingress nginx annotation injection causes arbitrary command execution"
description: "### Issue Details\nA security issue was identified in ingress-nginx
  where the nginx.ingress.kubernetes.io/configuration-snippet annotation on an Ingress
  object (in the networking.k8s.io or extensions API group) can be used to inject
  arbitrary commands, and obtain the credentials of the ingress-nginx controller.
  In the default configuration, that credential has access to all secrets in the cluster.\n\nThis
  issue has been rated High (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:L), and assigned
  CVE-2023-5043.\n\n### Affected Components and Configurations\nThis bug affects ingress-nginx.
  If you do not have ingress-nginx installed on your cluster, you are not affected.
  You can check this by running kubectl get po -n ingress-nginx.\n\nIf you are running
  the “chrooted” ingress-nginx controller introduced in v1.2.0 (gcr.io/k8s-staging-ingress-nginx/controller-chroot),
  command execution is possible but credential extraction is not, so the High severity
  does not apply.\n\nMulti-tenant environments where non-admin users have permissions
  to create Ingress objects are most affected by this issue.\n\n#### Affected Versions\n<v1.9.0\n####
  Versions allowing mitigation\nv1.9.0\n### Mitigation\nIngress Administrators should
  set the --enable-annotation-validation flag to enforce restrictions on the contents
  of ingress-nginx annotation fields.\n\n### Detection\nIf you find evidence that
  this vulnerability has been exploited, please contact security@kubernetes.io\n\n###
  Additional Details\nSee ingress-nginx Issue [#10571](https://github.com/kubernetes/ingress-nginx/issues/10571)
  for more details.\n\n### Acknowledgements\nThis vulnerability was reported by suanve\n\nThank
  You,\nCJ Cullen on behalf of the Kubernetes Security Response Committee"
date: "2025-02-13"
pubdate: "2023-10-25"
affected_range: "<1.9.0"
fixed_versions:
- "1.9.0"
affected_versions: "All versions before 1.9.0"
not_impacted: "All versions starting from 1.9.0"
solution: "Upgrade to version 1.9.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-5043"
- "https://github.com/advisories/GHSA-5wj4-wffq-3378"
- "https://github.com/kubernetes/ingress-nginx/issues/10571"
- "https://groups.google.com/g/kubernetes-security-announce/c/pVsXsOpxYZo"
- "https://security.netapp.com/advisory/ntap-20240307-0012"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:L"
uuid: "7d1eb971-d9b5-4e65-bed7-9017edb53e87"
cwe_ids:
- "CWE-20"
- "CWE-74"
- "CWE-937"
- "CWE-1035"
