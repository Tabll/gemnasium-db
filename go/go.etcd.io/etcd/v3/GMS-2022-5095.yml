---
identifier: "GMS-2022-5095"
identifiers:
- "GHSA-h8g9-6gvh-5mrc"
- "GMS-2022-5095"
package_slug: "go/go.etcd.io/etcd/v3"
title: "etcd vulnerable to TOCTOU of gateway endpoint authentication"
description: "The vulnerability was spotted due to unclear documentation of how the gateway handles
  endpoints validation. \n\n### Detail\nThe gateway only authenticates endpoints detected
  from DNS SRV records, and it only authenticates the detected endpoints once."
date: "2022-10-06"
pubdate: "2022-10-06"
affected_range: "<3.3.23||>=3.4.0 <3.4.10"
fixed_versions:
- "3.3.23"
- "3.4.10"
affected_versions: "All versions before 3.3.23, all versions starting from 3.4.0 before
  3.4.10"
not_impacted: "All versions starting from 3.3.23 before 3.4.0, all versions starting
  from 3.4.10"
solution: "Upgrade to versions 3.3.23, 3.4.10 or above."
urls:
- "https://github.com/etcd-io/etcd/security/advisories/GHSA-h8g9-6gvh-5mrc"
- "https://github.com/advisories/GHSA-h8g9-6gvh-5mrc"
uuid: "dcc2abf5-a419-47f8-80ae-ac2c27b5c30b"
cwe_ids:
- "CWE-1035"
- "CWE-937"
