---
identifier: "CVE-2024-3744"
identifiers:
- "CVE-2024-3744"
- "GHSA-qjqg-4wg7-957h"
package_slug: "go/sigs.k8s.io/azurefile-csi-driver"
title: "azure-file-csi-driver leaks service account tokens in the logs"
description: "A security issue was discovered in azure-file-csi-driver where an actor
  with access to the driver logs could observe service account tokens. These tokens
  could then potentially be exchanged with external cloud providers to access secrets
  stored in cloud vault solutions. Tokens are only logged when TokenRequests is configured
  in the CSIDriver object and the driver is set to run at log level 2 or greater via
  the -v flag."
date: "2024-05-15"
pubdate: "2024-05-15"
affected_range: "<1.29.4||>=1.30.0 <1.30.1||=1.30.0"
fixed_versions:
- "1.29.4"
- "1.30.1"
affected_versions: "All versions before 1.29.4, all versions starting from 1.30.0
  before 1.30.1, version 1.30.0"
not_impacted: ""
solution: "Upgrade to versions 1.29.4, 1.30.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-3744"
- "https://github.com/advisories/GHSA-qjqg-4wg7-957h"
- "https://github.com/kubernetes/kubernetes/issues/124759"
- "https://github.com/kubernetes-sigs/azurefile-csi-driver/commit/a1b7446de942136419f07394efeef804523f87ae"
- "https://github.com/kubernetes-sigs/azurefile-csi-driver/commit/e11ff3dc2c03894cde692213308f9991e7bbd5bf"
- "https://github.com/kubernetes-sigs/azurefile-csi-driver"
- "https://groups.google.com/g/kubernetes-security-announce/c/hcgZE2MQo1A/m/Y4C6q-CYAgAJ"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N"
uuid: "3618d8d5-0d70-4ea5-988a-6ad5eef150df"
cwe_ids:
- "CWE-532"
- "CWE-937"
- "CWE-1035"
