---
identifier: "CVE-2023-0290"
identifiers:
- "GHSA-7jf5-fvgf-48c6"
- "CVE-2023-0290"
package_slug: "go/www.velocidex.com/golang/velociraptor"
title: "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
description: "Rapid7 Velociraptor does not properly sanitize the client ID parameter
  to the CreateCollection API, allowing a directory traversal in where the collection
  task could be written. It was possible to provide a client id of \"../clients/server\"
  to schedule the collection for the server (as a server artifact), but only require
  privileges to schedule collections on the client. Normally, to schedule an artifact
  on the server, the COLLECT_SERVER permission is required. This permission is normally
  only granted to \"administrator\" role. Due to this issue, it is sufficient to have
  the COLLECT_CLIENT privilege, which is normally granted to the \"investigator\"
  role. To exploit this vulnerability, the attacker must already have a Velociraptor
  user account at least \"investigator\" level, and be able to authenticate to the
  GUI and issue an API call to the backend. Typically, most users deploy Velociraptor
  with limited access to a trusted group, and most users will already be administrators
  within the GUI. This issue affects Velociraptor versions before 0.6.7-5. Version
  0.6.7-5, released January 16, 2023, fixes the issue."
date: "2023-02-01"
pubdate: "2023-01-19"
affected_range: "<0.6.7-5"
fixed_versions:
- "0.6.7-5"
affected_versions: "All versions before 0.6.7-5"
not_impacted: "All versions starting from 0.6.7-5"
solution: "Upgrade to version 0.6.7-5 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-0290"
- "https://github.com/Velocidex/velociraptor"
- "https://github.com/advisories/GHSA-7jf5-fvgf-48c6"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N"
uuid: "3b00a60b-d4eb-445e-97e1-69c549b4206a"
cwe_ids:
- "CWE-1035"
- "CWE-22"
- "CWE-937"
