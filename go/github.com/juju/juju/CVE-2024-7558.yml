---
identifier: "CVE-2024-7558"
identifiers:
- "CVE-2024-7558"
- "GHSA-mh98-763h-m9v4"
package_slug: "go/github.com/juju/juju"
title: "JUJU_CONTEXT_ID is a predictable authentication secret"
description: "`JUJU_CONTEXT_ID` is the authentication measure on the unit hook tool
  abstract domain socket. It looks like `JUJU_CONTEXT_ID=appname/0-update-status-6073989428498739633`.\n\nThis
  value looks fairly unpredictable, but due to the random source used, it is highly
  predictable.\n\n`JUJU_CONTEXT_ID` has the following components:\n- the application
  name\n- the unit number\n- the hook being currently run\n- a uint63 decimal number\n\nOn
  a system the application name and unit number can be deduced by reading the structure
  of the filesystem.\nThe current hook being run is not easily deduce-able, but is
  a limited set of possible values, so one could try them all.\nFinally the random
  number, this is generated from a non cryptographically secure random source. Specifically
  the random number generator built into the go standard library, using the current
  unix time in seconds (at startup) as the seed.\n\nThere is no rate limiting on the
  abstract domain socket, the only limiting factor is time (window of time the hook
  is run) and memory (how much memory is available to facilitate all the connections)."
date: "2024-10-09"
pubdate: "2024-10-03"
affected_range: "<0.0.0-20240826044107-ecd7e2d0e986"
fixed_versions:
- "0.0.0-20240826044107-ecd7e2d0e986"
affected_versions: "All versions before 0.0.0-20240826044107-ecd7e2d0e986"
not_impacted: "All versions starting from 0.0.0-20240826044107-ecd7e2d0e986"
solution: "Upgrade to version 0.0.0-20240826044107-ecd7e2d0e986 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-7558"
- "https://github.com/advisories/GHSA-mh98-763h-m9v4"
- "https://github.com/juju/juju/security/advisories/GHSA-mh98-763h-m9v4"
- "https://github.com/juju/juju/commit/ecd7e2d0e9867576b9da04871e22232f06fa0cc7"
- "https://github.com/juju/juju"
- "https://pkg.go.dev/vuln/GO-2024-3173"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:L/I:H/A:H"
uuid: "7381cb79-5285-440a-96b7-c0dd90e6b0a0"
cwe_ids:
- "CWE-1391"
- "CWE-337"
- "CWE-340"
- "CWE-937"
- "CWE-1035"
