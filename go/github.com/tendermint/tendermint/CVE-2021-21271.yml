---
identifier: "CVE-2021-21271"
identifiers:
- "GHSA-p658-8693-mhvg"
- "CVE-2021-21271"
package_slug: "go/github.com/tendermint/tendermint"
title: "Uncontrolled Resource Consumption"
description: "Tendermint Core is an open source Byzantine Fault Tolerant (BFT) middleware
  that takes a state transition machine - written in any programming language - and
  securely replicates it on many machines. Tendermint Core v0.34.0 introduced a new
  way of handling evidence of misbehavior. As part of this, we added a new Timestamp
  field to Evidence structs. This timestamp would be calculated using the same algorithm
  that is used when a block is created and proposed. (This algorithm relies on the
  timestamp of the last commit from this specific block.) In Tendermint Core v0.34.0-v0.34.2,
  the consensus reactor is responsible for forming DuplicateVoteEvidence whenever
  double signs are observed. However, the current block is still “in flight” when
  it is being formed by the consensus reactor. It hasn’t been finalized through network
  consensus yet. This means that different nodes in the network may observe different
  “last commits” when assigning a timestamp to DuplicateVoteEvidence. In turn, different
  nodes could form DuplicateVoteEvidence objects at the same height but with different
  timestamps. One DuplicateVoteEvidence object (with one timestamp) will then eventually
  get finalized in the block, but this means that any DuplicateVoteEvidence with a
  different timestamp is considered invalid. Any node that formed invalid DuplicateVoteEvidence
  will continue to propose invalid evidence; its peers may see this, and choose to
  disconnect from this node. This bug means that double signs are DoS vectors in Tendermint
  Core v0.34.0-v0.34.2. Tendermint Core v0.34.3 is a security release which fixes
  this bug. As of v0.34.3, DuplicateVoteEvidence is no longer formed by the consensus
  reactor; rather, the consensus reactor passes the Votes themselves into the EvidencePool,
  which is now responsible for forming DuplicateVoteEvidence. The EvidencePool has
  timestamp info that should be consistent across the network, which means that DuplicateVoteEvidence
  formed in this reactor should have consistent timestamps. This release changes the
  API between the consensus and evidence reactors."
date: "2023-02-15"
pubdate: "2022-10-07"
affected_range: ">=0.34.0 <0.34.3"
fixed_versions:
- "0.34.3"
affected_versions: "All versions starting from 0.34.0 before 0.34.3"
not_impacted: "All versions before 0.34.0, all versions starting from 0.34.3"
solution: "Upgrade to version 0.34.3 or above."
urls:
- "https://github.com/tendermint/tendermint/security/advisories/GHSA-p658-8693-mhvg"
- "https://nvd.nist.gov/vuln/detail/CVE-2021-21271"
- "https://github.com/tendermint/tendermint/commit/a2a6852ab99e4a0f9e79f0ea8c1726e262e25c76"
- "https://github.com/tendermint/tendermint/blob/v0.34.3/CHANGELOG.md#v0.34.3"
- "https://pkg.go.dev/vuln/GO-2022-1052"
- "https://github.com/advisories/GHSA-p658-8693-mhvg"
cvss_v2: "AV:N/AC:L/Au:S/C:N/I:N/A:P"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
uuid: "5defcca7-d417-413c-a096-6c55b074f08f"
cwe_ids:
- "CWE-1035"
- "CWE-400"
- "CWE-937"
