---
identifier: "CVE-2025-49011"
identifiers:
- "CVE-2025-49011"
- "GHSA-cwwm-hr97-qfxm"
package_slug: "go/github.com/authzed/spicedb"
title: "SpiceDB checks involving relations with caveats can result in no permission
  when permission is expected"
description: "On schemas involving arrows with caveats on the arrowâ€™ed relation, when
  the path to resolve a CheckPermission request involves the evaluation of multiple
  caveated branches, requests may return a negative response when a positive response
  is expected.\n\nFor example, given this schema:\n\n```\ndefinition user {}\n\ndefinition
  office {\nrelation parent: office\nrelation manager: user\npermission read = manager
  + parent->read\n}\n\ndefinition group {\nrelation parent: office\npermission read
  = parent->read\n}\n\ndefinition document {\nrelation owner: group with equals\npermission
  read = owner->read\n}\n\ncaveat equals(actual string, required string) {\nactual
  == required\n}\n```\n\nand these relationships:\n\n```
  \noffice:headoffice#manager@user:maria\noffice:branch1#parent@office:headoffice
  \ngroup:admins#parent@office:branch1\ngroup:managers#parent@office:headoffice
  \ndocument:budget#owner@group:admins[equals:{\"required\":\"admin\"}]
  \ndocument:budget#owner@group:managers[equals:{\"required\":\"manager\"}]\n```\n\nPermission
  for `'document:budget#read@user:maria with {\"actual\" : \"admin\"}'` is returned
  as NO_PERMISSION when HAS_PERMISSION is the correct answer."
date: "2025-06-10"
pubdate: "2025-06-06"
affected_range: "<1.44.2"
fixed_versions:
- "1.44.2"
affected_versions: "All versions before 1.44.2"
not_impacted: "All versions starting from 1.44.2"
solution: "Upgrade to version 1.44.2 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2025-49011"
- "https://github.com/advisories/GHSA-cwwm-hr97-qfxm"
- "https://github.com/authzed/spicedb/security/advisories/GHSA-cwwm-hr97-qfxm"
- "https://github.com/authzed/spicedb/commit/fe8dd9f491f6975b3408c401e413a530eb181a67"
- "https://github.com/authzed/spicedb"
- "https://github.com/authzed/spicedb/releases/tag/v1.44.2"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N"
uuid: "d1054d4c-37ec-4f69-914e-ce15c789747a"
cwe_ids:
- "CWE-358"
- "CWE-937"
- "CWE-1035"
