---
identifier: "CVE-2025-65111"
identifiers:
- "CVE-2025-65111"
- "GHSA-9m7r-g8hg-x3vr"
package_slug: "go/github.com/authzed/spicedb"
title: "SpiceDB: LookupResources with Multiple Entrypoints across Different Definitions
  Can Return Incomplete Results"
description: "If a schema includes the following characteristics:\n\n1. Permission
  defined in terms of a union (`+`)\n1. That union references the same relation on
  both sides, but one side arrows to a different permission\n\nThen you might have
  missing `LookupResources` results when checking the permission. This only affects
  `LookupResources`; other APIs calculate permissionship correctly.\n\nA small concrete
  example:\n\n```\nrelation doer_of_things: user | group#member\npermission do_the_thing
  = doer_of_things + doer_of_things->admin\n```\n\nA CheckPermission on `do_the_thing`
  will return the correct permissionship, but a LookupResources on `do_the_thing`
  may miss resources."
date: "2025-11-27"
pubdate: "2025-11-21"
affected_range: "<1.47.1"
fixed_versions:
- "1.47.1"
affected_versions: "All versions before 1.47.1"
not_impacted: "All versions starting from 1.47.1"
solution: "Upgrade to version 1.47.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2025-65111"
- "https://github.com/advisories/GHSA-9m7r-g8hg-x3vr"
- "https://github.com/authzed/spicedb/security/advisories/GHSA-9m7r-g8hg-x3vr"
- "https://github.com/authzed/spicedb/commit/8c2edbe1e7bd3851fa2138f4cc344bfde986dcf2"
- "https://github.com/authzed/spicedb"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N"
cvss_v4: "CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:N/VI:L/VA:N/SC:N/SI:N/SA:N"
uuid: "674ba2c8-6381-44f6-b803-f104bd8e2935"
cwe_ids:
- "CWE-277"
- "CWE-937"
- "CWE-1035"
