---
identifier: "CVE-2023-32188"
identifiers:
- "GHSA-622h-h2p8-743x"
- "CVE-2023-32188"
package_slug: "go/github.com/neuvector/neuvector"
title: "JWT token compromise can allow malicious actions including Remote Code Execution
  (RCE) "
description: "### Impact \n\nA user can reverse engineer the JWT token (JSON Web Token)
  used in authentication for Manager and API access, forging a valid NeuVector Token
  to perform malicious activity in NeuVector. This can lead to an RCE. \n\n### Patches
  \n\nUpgrade to NeuVector [version 5.2.2](https://open-docs.neuvector.com/releasenotes/5x)
  or later and latest Helm chart (2.6.3+). \n+ In 5.2.2 the certificate for JWT-signing
  is created automatically by controller with validity of 90days and rotated automatically.\n+
  Use Helm-based deployment/upgrade to 5.2.2 to generate a unique certificate for
  Manager, REST API, ahd registry adapter. Helm based installation/upgrade is required
  in order to automatically generate certificates upon initial installation and each
  subsequent upgrade. \n+ See [release notes](https://open-docs.neuvector.com/releasenotes/5x)
  for manual/yaml based deployment advice.\n+ 5.2.2 also implements additional protections
  against possible RCE for the feature of custom compliance scripts. \n\n### Workarounds
  \n\nUsers can replace the Manager & Controller certificate manually by following
  the instructions in documented [here](https://open-docs.neuvector.com/configuration/console/replacecert).
  However, upgrading to 5.2.2 and replacing Manager/REST API certificate is recommended
  to provide additional security enhancements to prevent possible attempted exploit
  and resulting RCE. See [release notes](https://open-docs.neuvector.com/releasenotes/5x)
  for additional details.\n\n### For More Information \n\nView the NeuVector [Security
  Policy](https://github.com/neuvector/neuvector/security) \n\nGeneral NeuVector [documentation](https://open-docs.neuvector.com/) "
date: "2023-10-06"
pubdate: "2023-10-06"
affected_range: "<v5.2.2"
fixed_versions:
- "v5.2.2"
affected_versions: "All versions before 5.2.2"
not_impacted: "All versions starting from 5.2.2"
solution: "Upgrade to version 5.2.2 or above."
urls:
- "https://github.com/neuvector/neuvector/security/advisories/GHSA-622h-h2p8-743x"
- "https://open-docs.neuvector.com/releasenotes/5x"
- "https://github.com/advisories/GHSA-622h-h2p8-743x"
uuid: "5b5f0e53-50a7-4a72-a5cb-4b429ac90a49"
cwe_ids:
- "CWE-1035"
- "CWE-937"
versions:
- number: "v5.2.2"
  commit:
    tags:
    - "v5.2.2"
    sha: "be746957ee7c4e343b4e2ed261f767a43c184327"
    timestamp: "20231003121714"
