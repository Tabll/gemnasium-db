---
identifier: "CVE-2022-36071"
identifiers:
- "CVE-2022-36071"
- "GHSA-54qx-8p8w-xhg8"
package_slug: "go/github.com/drakkan/sftpgo"
title: "Use of Password Hash With Insufficient Computational Effort"
description: "SFTPGo is configurable SFTP server with optional HTTP/S, FTP/S and WebDAV
  support. SFTPGo WebAdmin and WebClient support login using TOTP (Time-based One
  Time Passwords) as a secondary authentication factor. Because TOTPs are often configured
  on mobile devices that can be lost, stolen or damaged, SFTPGo also supports recovery
  codes. These are a set of one time use codes that can be used instead of the TOTP.
  In SFTPGo versions from version 2.2.0 to 2.3.3 recovery codes can be generated before
  enabling two-factor authentication. An attacker who knows the user's password could
  potentially generate some recovery codes and then bypass two-factor authentication
  after it is enabled on the account at a later time. This issue has been fixed in
  version 2.3.4. Recovery codes can now only be generated after enabling two-factor
  authentication and are deleted after disabling it."
date: "2022-09-09"
pubdate: "2022-09-02"
affected_range: ">=v2.2.0 <v2.3.4"
fixed_versions:
- "v2.3.4"
affected_versions: "All versions starting from 2.2.0 before 2.3.4"
not_impacted: ""
solution: "Upgrade to version 2.3.4 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-36071"
- "https://github.com/drakkan/sftpgo/issues/965"
- "https://github.com/drakkan/sftpgo/security/advisories/GHSA-54qx-8p8w-xhg8"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N"
uuid: "ed9a8b0d-d73f-4a5a-b3df-14d5e23b9b25"
cwe_ids:
- "CWE-1035"
- "CWE-916"
- "CWE-937"
versions:
- number: "v2.2.0"
  commit:
    tags:
    - "v2.2.0"
    sha: "b6bcf0cd94fa7e87000f358350e99756f86d6418"
    timestamp: "20211127104605"
- number: "v2.3.4"
  commit:
    tags:
    - "v2.3.4"
    sha: "df84c42e7e8a1675769fa9065b2781a6abc8ab1b"
    timestamp: "20220901102813"
