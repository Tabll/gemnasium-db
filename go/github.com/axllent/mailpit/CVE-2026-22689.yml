---
identifier: "CVE-2026-22689"
identifiers:
- "CVE-2026-22689"
- "GHSA-524m-q5m7-79mm"
package_slug: "go/github.com/axllent/mailpit"
title: "Mailpit is vulnerable to Cross-Site WebSocket Hijacking (CSWSH) allowing unauthenticated
  access to emails"
description: "**Summary**\nThe Mailpit WebSocket server is configured to accept connections
  from any origin. This lack of Origin header validation introduces a Cross-Site WebSocket
  Hijacking (CSWSH) vulnerability.\n\nAn attacker can host a malicious website that,
  when visited by a developer running Mailpit locally, establishes a WebSocket connection
  to the victim's Mailpit instance (default ws://localhost:8025). This allows the
  attacker to intercept sensitive data such as email contents, headers, and server
  statistics in real-time.\n\n**Vulnerable Code**\nThe vulnerability exists in server/websockets/client.go
  where the CheckOrigin function is explicitly set to return true for all requests,
  bypassing standard Same-Origin Policy (SOP) protections provided by the gorilla/websocket
  library.\n\nhttps://github.com/axllent/mailpit/blob/877a9159ceeaf380d5bb0e1d84017b24d2e7b361/server/websockets/client.go#L34-L39\n\n**Impact**\nThis
  vulnerability impacts the Confidentiality of the data stored in or processed by
  Mailpit.\nAlthough Mailpit is often used as a local development tool, this vulnerability
  allows remote exploitation via a web browser.\n\n- **Scenario**: A developer has
  Mailpit running at localhost:8025.\n- **Trigger**: The developer visits a malicious
  website (or a compromised legitimate site) in the same browser.\n- **Exploitation**:
  The malicious site's JavaScript initiates a WebSocket connection to ws://localhost:8025/api/events.
  Since the origin check is disabled, the browser allows this cross-origin connection.\n-
  **Data Leak**: The attacker receives all broadcasted events, including full email
  details (subjects, sender/receiver info) and server metrics.\n\n**Attack Impact**\n-
  Real-time notification of new emails\n- Email metadata (sender, subject, recipients)\n-
  Mailbox statistics\n- All WebSocket broadcast data\n\n**Recommended Fix**\nThe `CheckOrigin`
  function should be removed to allow gorilla/websocket to enforce its default safe
  behavior (checking that the Origin matches the Host). Alternatively, strict validation
  logic should be implemented.\n\n**Proposed Change (Remove unsafe check):**\n\n```go\nvar
  upgrader = websocket.Upgrader{\nReadBufferSize:    1024,\nWriteBufferSize:   1024,\n//
  CheckOrigin: func(r *http.Request) bool { return true }, // REMOVED\nEnableCompression:
  true,\n}\n```\n\n**Proof of Concept (PoC)**: To reproduce this vulnerability:"
date: "2026-01-13"
pubdate: "2026-01-13"
affected_range: ">=1.2.6 <1.28.2||<0.0.0-20260110031614"
fixed_versions:
- "1.28.2"
- "0.0.0-20260110031614"
affected_versions: "All versions before 0.0.0-20260110031614, all versions starting
  from 1.2.6 before 1.28.2"
not_impacted: "All versions starting from 0.0.0-20260110031614 before 1.2.6, all versions
  starting from 1.28.2"
solution: "Upgrade to versions 0.0.0-20260110031614, 1.28.2 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2026-22689"
- "https://github.com/advisories/GHSA-524m-q5m7-79mm"
- "https://github.com/axllent/mailpit/security/advisories/GHSA-524m-q5m7-79mm"
- "https://github.com/axllent/mailpit/commit/6f1f4f34c98989fd873261018fb73830b30aec3f"
- "https://github.com/axllent/mailpit"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N"
uuid: "1afe1cd1-533b-47f9-9733-ad3e006eae12"
cwe_ids:
- "CWE-1385"
- "CWE-937"
- "CWE-1035"
