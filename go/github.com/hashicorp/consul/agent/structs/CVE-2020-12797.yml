---
identifier: "CVE-2020-12797"
identifiers:
- "GHSA-hwqm-x785-qh8p"
- "CVE-2020-12797"
package_slug: "go/github.com/hashicorp/consul/agent/structs"
title: "Incorrect Permission Assignment for Critical Resource\tin Hashicorp Consul"
description: "HashiCorp Consul and Consul Enterprise failed to enforce changes to
  legacy ACL token rules due to non-propagation to secondary data centers. Introduced
  in 1.4.0, fixed in 1.6.6 and 1.7.4."
date: "2021-06-23"
pubdate: "2021-06-23"
affected_range: ">=1.7.0 <1.7.4||>=1.6.0 <1.6.6"
fixed_versions:
- "1.7.4"
- "1.7.4"
affected_versions: "All versions starting from 1.7.0 before 1.7.4, all versions starting
  from 1.6.0 before 1.6.6"
not_impacted: "All versions before 1.7.0, all versions starting from 1.7.4, all versions
  before 1.6.0, all versions starting from 1.6.6"
solution: "Upgrade to versions 1.7.4, 1.7.4 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2020-12797"
- "https://github.com/hashicorp/consul/issues/5606"
- "https://github.com/hashicorp/consul/pull/8047"
- "https://github.com/hashicorp/consul/commit/98eea08d3ba1b220a14cf6eedf3b6b07ae2795d7"
- "https://github.com/hashicorp/consul/blob/v1.6.6/CHANGELOG.md"
- "https://github.com/hashicorp/consul/blob/v1.7.4/CHANGELOG.md"
- "https://github.com/advisories/GHSA-hwqm-x785-qh8p"
cvss_v2: "AV:N/AC:L/Au:N/C:N/I:P/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N"
uuid: "0efd50bf-9325-4643-b9ac-9b3c5e95634e"
cwe_ids:
- "CWE-1035"
- "CWE-937"
