---
identifier: "CVE-2024-6468"
identifiers:
- "CVE-2024-6468"
- "GHSA-2qmw-pvf7-4mw6"
package_slug: "go/github.com/hashicorp/vault"
title: "Hashicorp Vault vulnerable to Improper Check or Handling of Exceptional Conditions "
description: "Vault and Vault Enterprise did not properly handle requests originating
  from unauthorized IP addresses when the TCP listener option, proxy_protocol_behavior,
  was set to deny_unauthorized. When receiving a request from a source IP address
  that was not listed in proxy_protocol_authorized_addrs, the Vault API server would
  shut down and no longer respond to any HTTP requests, potentially resulting in denial
  of service.\n\nWhile this bug also affected versions of Vault up to 1.17.1 and 1.16.5,
  a separate regression in those release series did not allow Vault operators to configure
  the deny_unauthorized option, thus not allowing the conditions for the denial of
  service to occur.\n\nFixed in Vault and Vault Enterprise 1.17.2, 1.16.6, and 1.15.12."
date: "2024-07-12"
pubdate: "2024-07-11"
affected_range: "<1.15.12||>=1.16.0-rc1 <1.16.3||>=1.17.0-rc1 <1.17.2"
fixed_versions:
- "1.15.12"
- "1.16.3"
- "1.17.2"
affected_versions: "All versions before 1.15.12, all versions starting from 1.16.0-rc1
  before 1.16.3, all versions starting from 1.17.0-rc1 before 1.17.2"
not_impacted: "All versions starting from 1.15.12 before 1.16.0-rc1, all versions
  starting from 1.16.3 before 1.17.0-rc1, all versions starting from 1.17.2"
solution: "Upgrade to versions 1.15.12, 1.16.3, 1.17.2 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-6468"
- "https://github.com/advisories/GHSA-2qmw-pvf7-4mw6"
- "https://discuss.hashicorp.com/t/hcsec-2024-14-vault-vulnerable-to-denial-of-service-when-setting-a-proxy-protocol-behavior/68518"
- "https://github.com/hashicorp/vault"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
uuid: "c78bd670-085f-49b7-af36-a19a0d7799a2"
cwe_ids:
- "CWE-703"
- "CWE-937"
- "CWE-1035"
