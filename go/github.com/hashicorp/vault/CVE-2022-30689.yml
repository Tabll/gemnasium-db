---
identifier: "CVE-2022-30689"
identifiers:
- "GHSA-c5wc-v287-82pc"
- "CVE-2022-30689"
package_slug: "go/github.com/hashicorp/vault"
title: "Improper configuration of multi factor authentication in hashicorp vault"
description: "HashiCorp Vault and Vault Enterprise from 1.10.0 to 1.10.2 does not
  correctly configure and enforce MFA on login after server restarts. This affects
  the Login MFA feature introduced in Vault and Vault Enterprise 1.10.0 and does not
  affect the separate Enterprise MFA feature set. Fixed in 1.10.3."
date: "2022-05-25"
pubdate: "2022-05-18"
affected_range: ">=v1.10.0 <v1.10.3"
fixed_versions:
- "v1.10.3"
affected_versions: "All versions starting from 1.10.0 before 1.10.3"
not_impacted: "All versions before 1.10.0, all versions starting from 1.10.3"
solution: "Upgrade to version 1.10.3 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-30689"
- "https://github.com/hashicorp/vault/commit/15baea5fa3e71c837c33b8bcbd8f06e0fbbc110d"
- "https://github.com/advisories/GHSA-c5wc-v287-82pc"
cvss_v2: "AV:N/AC:L/Au:N/C:N/I:P/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N"
uuid: "88a60bd6-c58a-4d2f-9f20-7172c021ffc8"
cwe_ids:
- "CWE-1035"
- "CWE-937"
versions:
- number: "v1.10.0"
  commit:
    tags:
    - "v1.10.0"
    sha: "7738ec5d0d6f5bf94a809ee0f6ff0142cfa525a6"
    timestamp: "20220321213908"
- number: "v1.10.3"
  commit:
    tags:
    - "v1.10.3"
    sha: "af866591ee60485f05d6e32dd63dde93df686dfb"
    timestamp: "20220506213215"
