---
identifier: "CVE-2024-7594"
identifiers:
- "CVE-2024-7594"
- "GHSA-jg74-mwgw-v6x3"
package_slug: "go/github.com/hashicorp/vault"
title: "Vault SSH Secrets Engine Configuration Did Not Restrict Valid Principals By
  Default"
description: "Vault’s SSH secrets engine did not require the valid_principals list
  to contain a value by default. If the valid_principals and default_user fields of
  the SSH secrets engine configuration are not set, an SSH certificate requested by
  an authorized user to Vault’s SSH secrets engine could be used to authenticate as
  any user on the host. Fixed in Vault Community Edition 1.17.6, and in Vault Enterprise
  1.17.6, 1.16.10, and 1.15.15."
date: "2024-10-09"
pubdate: "2024-09-26"
affected_range: ">=1.7.7 <1.17.6"
fixed_versions:
- "1.17.6"
affected_versions: "All versions starting from 1.7.7 before 1.17.6"
not_impacted: "All versions before 1.7.7, all versions starting from 1.17.6"
solution: "Upgrade to version 1.17.6 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-7594"
- "https://github.com/advisories/GHSA-jg74-mwgw-v6x3"
- "https://discuss.hashicorp.com/t/hcsec-2024-20-vault-ssh-secrets-engine-configuration-did-not-restrict-valid-principals-by-default/70251"
- "https://github.com/hashicorp/vault"
- "https://pkg.go.dev/vuln/GO-2024-3162"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H"
uuid: "3eac4e2c-cba4-4e8f-ad99-16c7afccfbc5"
cwe_ids:
- "CWE-732"
- "CWE-937"
- "CWE-1035"
