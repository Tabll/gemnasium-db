---
identifier: "CVE-2023-4680"
identifiers:
- "GHSA-v84f-6r39-cpfc"
- "CVE-2023-4680"
package_slug: "go/github.com/hashicorp/vault"
title: "HashiCorp Vault Improper Input Validation vulnerability"
description: "HashiCorp Vault and Vault Enterprise transit secrets engine allowed
  authorized users to specify arbitrary nonces, even with convergent encryption disabled.
  The encrypt endpoint, in combination with an offline attack, could be used to decrypt
  arbitrary ciphertext and potentially derive the authentication subkey when using
  transit secrets engine without convergent encryption. Introduced in 1.6.0 and fixed
  in 1.14.3, 1.13.7, and 1.12.11."
date: "2023-09-15"
pubdate: "2023-09-15"
affected_range: ">=1.6.0 <1.12.11||>=1.13.0 <1.13.7||>=1.14.0 <1.14.3"
fixed_versions:
- "1.12.11"
- "1.13.7"
- "1.14.3"
affected_versions: "All versions starting from 1.6.0 before 1.12.11, all versions
  starting from 1.13.0 before 1.13.7, all versions starting from 1.14.0 before 1.14.3"
not_impacted: "All versions before 1.6.0, all versions starting from 1.12.11 before
  1.13.0, all versions starting from 1.13.7 before 1.14.0, all versions starting from
  1.14.3"
solution: "Upgrade to versions 1.12.11, 1.13.7, 1.14.3 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-4680"
- "https://discuss.hashicorp.com/t/hcsec-2023-28-vault-s-transit-secrets-engine-allowed-nonce-specified-without-convergent-encryption/58249"
- "https://github.com/advisories/GHSA-v84f-6r39-cpfc"
uuid: "4ac1054f-05be-4c11-a823-fe42499aba51"
cwe_ids:
- "CWE-1035"
- "CWE-937"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N"
