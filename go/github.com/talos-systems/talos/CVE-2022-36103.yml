---
identifier: "CVE-2022-36103"
identifiers:
- "GHSA-7hgc-php5-77qq"
- "CVE-2022-36103"
package_slug: "go/github.com/talos-systems/talos"
title: "Incorrect Permission Assignment for Critical Resource"
description: "Talos Linux is a Linux distribution built for Kubernetes deployments.
  Talos worker nodes use a join token to get accepted into the Talos cluster. Due
  to improper validation of the request while signing a worker node CSR (certificate
  signing request) Talos control plane node might issue Talos API certificate which
  allows full access to Talos API on a control plane node. Accessing Talos API with
  full level access on a control plane node might reveal sensitive information which
  allows full level access to the cluster (Kubernetes and Talos PKI, etc.). Talos
  API join token is stored in the machine configuration on the worker node. When configured
  correctly, Kubernetes workloads don't have access to the machine configuration,
  but due to a misconfiguration workload might access the machine configuration and
  reveal the join token. This problem has been fixed in Talos 1.2.2. Enabling the
  Pod Security Standards mitigates the vulnerability by denying hostPath mounts and
  host networking by default in the baseline policy. Clusters that don't run untrusted
  workloads are not affected. Clusters with correct Pod Security configurations which
  don't allow hostPath mounts, and secure access to cloud metadata server (or machine
  configuration is not supplied via cloud metadata server) are not affected."
date: "2022-09-16"
pubdate: "2022-09-16"
affected_range: "<v1.2.2"
fixed_versions:
- "v1.2.2"
affected_versions: "All versions before 1.2.2"
not_impacted: "All versions starting from 1.2.2"
solution: "Upgrade to version 1.2.2 or above."
urls:
- "https://github.com/siderolabs/talos/security/advisories/GHSA-7hgc-php5-77qq"
- "https://nvd.nist.gov/vuln/detail/CVE-2022-36103"
- "https://github.com/siderolabs/talos/commit/9eaf33f3f274e746ca1b442c0a1a0dae0cec088f"
- "https://github.com/siderolabs/talos/releases/tag/v1.2.2"
- "https://github.com/advisories/GHSA-7hgc-php5-77qq"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
uuid: "0fa74397-3fdc-475a-a37d-2b0eddec4826"
cwe_ids:
- "CWE-1035"
- "CWE-732"
- "CWE-937"
versions:
- number: "v1.2.2"
  commit:
    tags:
    - "v1.2.2"
    sha: "44a75865888eccaa7cdd3e45d150f9c21f6e1fbb"
    timestamp: "20220913120251"
