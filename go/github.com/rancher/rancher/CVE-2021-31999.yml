---
identifier: "CVE-2021-31999"
identifiers:
- "CVE-2021-31999"
- "GHSA-pvxj-25m6-7vqr"
package_slug: "go/github.com/rancher/rancher"
title: "Rancher Privilege escalation vulnerability via malicious \"Connection\" header"
description: "A vulnerability was discovered in Rancher 2.0.0 through the aforementioned
  patched versions, where a malicious Rancher user could craft an API request directed
  at the proxy for the Kubernetes API of a managed cluster to gain access to information
  they do not have access to. This is done by passing the \"Impersonate-User\" or
  \"Impersonate-Group\" header in the Connection header, which is then correctly removed
  by the proxy. At this point, instead of impersonating the user and their permissions,
  the request will act as if it was from the Rancher management server and incorrectly
  return the information. The vulnerability is limited to valid Rancher users with
  some level of permissions on the cluster. There is not a direct mitigation besides
  upgrading to the patched Rancher versions."
date: "2024-04-24"
pubdate: "2024-04-24"
affected_range: ">=2.0.0 <2.4.16||>=2.5.0 <2.5.9"
fixed_versions:
- "2.4.16"
- "2.5.9"
affected_versions: "All versions starting from 2.0.0 before 2.4.16, all versions starting
  from 2.5.0 before 2.5.9"
not_impacted: "All versions before 2.0.0, all versions starting from 2.4.16 before
  2.5.0, all versions starting from 2.5.9"
solution: "Upgrade to versions 2.4.16, 2.5.9 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-31999"
- "https://github.com/advisories/GHSA-pvxj-25m6-7vqr"
- "https://bugzilla.suse.com/show_bug.cgi?id=1187084"
- "https://github.com/rancher/rancher"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
uuid: "ad4fb72b-5edb-4efe-b4b2-02805a13624d"
cwe_ids:
- "CWE-807"
- "CWE-937"
- "CWE-1035"
