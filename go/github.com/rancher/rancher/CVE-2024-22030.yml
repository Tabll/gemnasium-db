---
identifier: "CVE-2024-22030"
identifiers:
- "CVE-2024-22030"
- "GHSA-h4h5-9833-v2p4"
package_slug: "go/github.com/rancher/rancher"
title: "Rancher agents can be hijacked by taking over the Rancher Server URL"
description: "A vulnerability has been identified within Rancher that can be exploited
  in narrow circumstances through a man-in-the-middle (MITM) attack. An attacker would
  need to have control of an expired domain or execute a DNS spoofing/hijacking attack
  against the domain to exploit this vulnerability. The targeted domain is the one
  used as the Rancher URL.\n\nSUSE is unaware of any successful exploitation of this
  vulnerability, which has a high complexity bar.\n\nPlease consult the associated
  \ [MITRE ATT&CK - Technique - Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557/)
  for further information about this attack category."
date: "2024-10-16"
pubdate: "2024-09-26"
affected_range: ">=2.7.0 <2.7.15||>=2.8.0 <2.8.8||>=2.9.0 <2.9.2"
fixed_versions:
- "2.7.15"
- "2.8.8"
- "2.9.2"
affected_versions: "All versions starting from 2.7.0 before 2.7.15, all versions starting
  from 2.8.0 before 2.8.8, all versions starting from 2.9.0 before 2.9.2"
not_impacted: "All versions before 2.7.0, all versions starting from 2.7.15 before
  2.8.0, all versions starting from 2.8.8 before 2.9.0, all versions starting from
  2.9.2"
solution: "Upgrade to versions 2.7.15, 2.8.8, 2.9.2 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-22030"
- "https://github.com/advisories/GHSA-h4h5-9833-v2p4"
- "https://github.com/rancher/rancher/security/advisories/GHSA-h4h5-9833-v2p4"
- "https://bugzilla.suse.com/show_bug.cgi?id=CVE-2024-22030"
- "https://github.com/rancher/rancher"
- "https://github.com/rancherlabs/support-tools/tree/master/windows-agent-strict-verify"
- "https://pkg.go.dev/vuln/GO-2024-3161"
- "https://ranchermanager.docs.rancher.com/getting-started/installation-and-upgrade/installation-references/tls-settings"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H"
uuid: "1857e7ed-bda5-4af2-b1e7-d603e38e41a6"
cwe_ids:
- "CWE-295"
- "CWE-937"
- "CWE-1035"
