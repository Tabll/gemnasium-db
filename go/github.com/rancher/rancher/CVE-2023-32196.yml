---
identifier: "CVE-2023-32196"
identifiers:
- "CVE-2023-32196"
- "GHSA-64jq-m7rq-768h"
package_slug: "go/github.com/rancher/rancher"
title: "Rancher's External RoleTemplates can lead to privilege escalation"
description: "A vulnerability has been identified whereby privilege escalation checks
  are not properly enforced for `RoleTemplate`objects when external=true, which in
  specific scenarios can lead to privilege escalation.\n\nThe bug in the webhook rule
  resolver ignores rules from a `ClusterRole` for external `RoleTemplates` when its
  context is set to either `project` or is left empty. The fix introduces a new field
  to the `RoleTemplate` CRD named `ExternalRules`. The new field will be used to resolve
  rules directly from the `RoleTemplate`. Additionally, rules from the backing `ClusterRole`
  will be used if `ExternalRules` is not provided. The new field will always take
  precedence when it is set, and serve as the source of truth for rules used when
  creating Rancher resources on the local cluster.\n\nPlease note that this is a breaking
  change for external `RoleTemplates`, when context is set to `project` or empty and
  the backing `ClusterRole` does not exist, as this was not previously required."
date: "2024-06-17"
pubdate: "2024-06-17"
affected_range: ">=2.7.0 <2.7.14||>=2.8.0 <2.8.5"
fixed_versions:
- "2.7.14"
- "2.8.5"
affected_versions: "All versions starting from 2.7.0 before 2.7.14, all versions starting
  from 2.8.0 before 2.8.5"
not_impacted: "All versions before 2.7.0, all versions starting from 2.7.14 before
  2.8.0, all versions starting from 2.8.5"
solution: "Upgrade to versions 2.7.14, 2.8.5 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-32196"
- "https://github.com/advisories/GHSA-64jq-m7rq-768h"
- "https://github.com/rancher/rancher/security/advisories/GHSA-64jq-m7rq-768h"
- "https://github.com/rancher/rancher"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H"
uuid: "84c2c115-528a-43bd-a15e-043bbed1078c"
cwe_ids:
- "CWE-269"
- "CWE-937"
- "CWE-1035"
