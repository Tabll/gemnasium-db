---
identifier: "GMS-2023-143"
identifiers:
- "GHSA-g25r-gvq3-wrq7"
- "GMS-2023-143"
- "CVE-2022-21953"
package_slug: "go/github.com/rancher/rancher"
title: "Authenticated user can gain unauthorized shell pod and kubectl access in the
  local cluster"
description: "An issue was discovered in Rancher where an authorization
  logic flaw allows an authenticated user on any downstream cluster to (1) open a
  shell pod in the Rancher `local` cluster and (2) have limited `kubectl` access to
  it."
date: "2023-01-25"
pubdate: "2023-01-25"
affected_range: ">=v2.5.0 <v2.5.17 || >=v2.6.0 <v2.6.10 || >=v2.7.0 <v2.7.1"
fixed_versions:
- "v2.5.17"
- "v2.6.10"
- "v2.7.1"
affected_versions: "All versions starting from 2.5.0 before 2.5.17, all versions starting
  from 2.6.0 before 2.6.10, all versions starting from 2.7.0 before 2.7.1"
not_impacted: "All versions before 2.5.0, all versions starting from 2.5.17 before
  2.6.0, all versions starting from 2.6.10 before 2.7.0, all versions starting from
  2.7.1"
solution: "Upgrade to versions 2.5.17, 2.6.10, 2.7.1 or above."
urls:
- "https://github.com/rancher/rancher/security/advisories/GHSA-g25r-gvq3-wrq7"
- "https://github.com/advisories/GHSA-g25r-gvq3-wrq7"
uuid: "af786d32-1184-4080-ad9a-2e4fb77195ab"
cwe_ids:
- "CWE-1035"
- "CWE-937"
versions:
- number: "v2.5.0"
  commit:
    tags:
    - "v2.5.0"
    - "v2.5.0-rc9"
    sha: "65f3525cdc1167872af4140d45f3153698450c52"
    timestamp: "20201006004413"
- number: "v2.6.0"
  commit:
    tags:
    - "v2.6.0"
    - "v2.6.0-rc10"
    sha: "df2432ad895c9d6be0e47e0d6d62a4c3dc8f08e5"
    timestamp: "20210830223634"
- number: "v2.7.0"
  commit:
    tags:
    - "v2.7.0"
    - "v2.7.0-novkdm"
    sha: "ce9a7aea4b13fed7acd02cc32667b2ae72f98f5a"
    timestamp: "20221116161032"
- number: "v2.5.17"
  commit:
    tags:
    - "v2.5.17"
    - "v2.5.17-rc4"
    sha: "8bcacfeafe7c8b7696318c1eb739247258e83238"
    timestamp: "20230124044749"
- number: "v2.6.10"
  commit:
    tags:
    - "v2.6.10"
    - "v2.6.10-rc7"
    sha: "2207cfed180315c015223c07ba4462888b8acf9f"
    timestamp: "20230124173128"
- number: "v2.7.1"
  commit:
    tags:
    - "v2.7.1"
    - "v2.7.1-rc5"
    sha: "bb1c35fc4258ada8829c187ca17fe28a6e61da4d"
    timestamp: "20230124173332"
