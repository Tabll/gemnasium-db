---
identifier: "CVE-2022-45157"
identifiers:
- "CVE-2022-45157"
- "GHSA-xj7w-r753-vj8v"
package_slug: "go/github.com/rancher/rancher"
title: "Exposure of vSphere's CPI and CSI credentials in Rancher"
description: "A vulnerability has been identified in the way that Rancher stores vSphere's
  CPI (Cloud Provider Interface) and CSI (Container Storage Interface) credentials
  used to deploy clusters through the vSphere cloud provider. This issue leads to
  the vSphere CPI and CSI passwords being stored in a plaintext object inside Rancher.
  This vulnerability is only applicable to users that deploy clusters in vSphere environments.\n\nThe
  exposed passwords were accessible in the following objects:\n\n- Can be accessed
  by users that are cluster members of the provisioned clusters:\n- When provisioning
  a new cluster with the vSphere cloud provider through Rancher's UI (user interface),
  Cluster Templates and Terraform on the object `provisioning.cattle.io` in `spec.rkeConfig.chartValues.rancher-vsphere-cpi`
  and `spec.rkeConfig.chartValues.rancher-vsphere-csi`.\n- On the object `rke.cattle.io.rkecontrolplane`
  in `spec.chartValues.rancher-vsphere-cpi` and `spec.chartValues.rancher-vsphere-csi`.\n-
  Can be accessed by users with privileged access to the clusters' infrastructure
  (host OS):\n- Inside the `plan` files in the provisioned downstream clusters' filesystems.\n\n**Note:**
  if you believe that the vSphere credentials might have been accessed by unauthorized
  users, it's highly recommended to change them, after updating Rancher to a patched
  version.\n\nPlease consult the associated  [MITRE ATT&CK - Technique -  Credential
  Access](https://attack.mitre.org/tactics/TA0006/) for further information about
  this category of attack."
date: "2024-11-13"
pubdate: "2024-10-25"
affected_range: ">=2.9.0 <2.9.3||>=2.7.0 <2.8.9"
fixed_versions:
- "2.9.3"
- "2.8.9"
affected_versions: "All versions starting from 2.7.0 before 2.8.9, all versions starting
  from 2.9.0 before 2.9.3"
not_impacted: "All versions before 2.7.0, all versions starting from 2.8.9 before
  2.9.0, all versions starting from 2.9.3"
solution: "Upgrade to versions 2.8.9, 2.9.3 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-45157"
- "https://github.com/advisories/GHSA-xj7w-r753-vj8v"
- "https://github.com/rancher/rancher/security/advisories/GHSA-xj7w-r753-vj8v"
- "https://bugzilla.suse.com/show_bug.cgi?id=CVE-2022-45157"
- "https://github.com/rancher/rancher"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:L"
uuid: "48477e7f-3567-40e2-bcc2-a6b662373b4a"
cwe_ids:
- "CWE-522"
- "CWE-937"
- "CWE-1035"
