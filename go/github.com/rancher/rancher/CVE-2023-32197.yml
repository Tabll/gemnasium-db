---
identifier: "CVE-2023-32197"
identifiers:
- "CVE-2023-32197"
- "GHSA-7h8m-pvw3-5gh4"
package_slug: "go/github.com/rancher/rancher"
title: "Rancher allows privilege escalation in Windows nodes due to Insecure Access
  Control Lists"
description: "A vulnerability has been identified whereby Rancher Manager deployments
  containing Windows nodes have weak Access Control Lists (ACL), allowing `BUILTIN\\Users`
  or `NT AUTHORITY\\Authenticated Users` to view or edit sensitive files which could
  lead to privilege escalation.\n\nThe affected files include binaries, scripts, configuration
  and log files:\n\n```\nC:\\etc\\rancher\\wins\\config\nC:\\var\\lib\\rancher\\agent\\rancher2_connection_info.json\n
  C:\\etc\\rancher\\rke2\\config.yaml.d\\50-rancher.yaml\nC:\\var\\lib\\rancher\\agent\\applied\\*-*-applied.plan\n
  C:\\usr\\local\\bin\\rke2\nC:\\var\\lib\\rancher\\capr\\idempotence\\idempotent.sh\n```\n\nRKE2
  nodes expand the list to include the files below:\n\n```\nC:\\etc\\rancher\\node\\password\n
  C:\\var\\lib\\rancher\\rke2\\agent\\logs\\kubelet.log\nC:\\var\\lib\\rancher\\rke2\\data\\v1.**.**-rke2r*-windows-amd64-*\\bin\\*\n
  C:\\var\\lib\\rancher\\rke2\\bin\\*\n```\n\n**This
  vulnerability is exclusive to deployments that contain Windows nodes. Linux-only
  environments are not affected by it.**\n\nPlease consult the associated [MITRE ATT&CK
  - Technique - Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068/)
  for further information about this category of attack."
date: "2025-04-16"
pubdate: "2024-10-25"
affected_range: ">=2.7.0 <2.8.9||>=2.9.0 <2.9.3"
fixed_versions:
- "2.8.9"
- "2.9.3"
affected_versions: "All versions starting from 2.7.0 before 2.8.9, all versions starting
  from 2.9.0 before 2.9.3"
not_impacted: "All versions before 2.7.0, all versions starting from 2.8.9 before
  2.9.0, all versions starting from 2.9.3"
solution: "Upgrade to versions 2.8.9, 2.9.3 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-32197"
- "https://github.com/advisories/GHSA-7h8m-pvw3-5gh4"
- "https://github.com/rancher/rancher/security/advisories/GHSA-64jq-m7rq-768h"
- "https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4"
- "https://bugzilla.suse.com/show_bug.cgi?id=CVE-2023-32197"
- "https://github.com/rancher/rancher"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H"
uuid: "ac712a91-a2dd-4ac3-bd4a-7ad2099c950b"
cwe_ids:
- "CWE-269"
- "CWE-732"
- "CWE-937"
- "CWE-1035"
