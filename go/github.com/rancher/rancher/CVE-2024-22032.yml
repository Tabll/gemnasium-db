---
identifier: "CVE-2024-22032"
identifiers:
- "CVE-2024-22032"
- "GHSA-q6c7-56cq-g2wm"
package_slug: "go/github.com/rancher/rancher"
title: "Rancher's RKE1 Encryption Config kept in plain-text within cluster AppliedSpec"
description: "This issue is only relevant to clusters provisioned using RKE1 with
  secrets encryption configuration enabled.\n\nA vulnerability has been identified
  in which an RKE1 cluster keeps constantly reconciling when secrets encryption configuration
  is enabled (please see the [RKE documentation](https://rke.docs.rancher.com/config-options/secrets-encryption)).
  When reconciling, the Kube API secret values are written in plaintext on the AppliedSpec.
  Cluster owners, Cluster members, and Project members (for projects within the cluster),
  all have RBAC permissions to view the cluster object from the apiserver.\n\nThis
  could lead to an unauthorized user gaining access to the entire secrets encryption
  config specific for the cluster, only on the applied spec.\n\nSince this affects
  only custom encryption configurations, users need to manually rotate the keys by
  editing the cluster. For more information, please refer to the [RKE secrets encryption
  documentation](https://rke.docs.rancher.com/config-options/secrets-encryption#key-rotation).\n\nThe
  full custom configuration example:\n\n```yaml\nservices:\nkube-api:\nsecrets_encryption_config:\nenabled:
  true\ncustom_config:\napiVersion: apiserver.config.k8s.io/v1\nkind: EncryptionConfiguration\nresources:\n-
  resources:\n- secrets\nproviders:\n- aescbc:\nkeys:\n- name: k-fw5hn\nsecret: RTczRjFDODMwQzAyMDVBREU4NDJBMUZFNDhCNzM5N0I=
  #<--- needs to be changed\n- identity: {}\n```\n\nPlease consult the associated
  \ [MITRE ATT&CK - Technique - Unsecured Credentials](https://attack.mitre.org/techniques/T1552/)
  for further information about this category of attack."
date: "2024-06-17"
pubdate: "2024-06-17"
affected_range: ">=2.7.0 <2.7.14||>=2.8.0 <2.8.5"
fixed_versions:
- "2.7.14"
- "2.8.5"
affected_versions: "All versions starting from 2.7.0 before 2.7.14, all versions starting
  from 2.8.0 before 2.8.5"
not_impacted: "All versions before 2.7.0, all versions starting from 2.7.14 before
  2.8.0, all versions starting from 2.8.5"
solution: "Upgrade to versions 2.7.14, 2.8.5 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-22032"
- "https://github.com/advisories/GHSA-q6c7-56cq-g2wm"
- "https://github.com/rancher/rancher/security/advisories/GHSA-q6c7-56cq-g2wm"
- "https://github.com/rancher/rancher"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"
uuid: "4f9f2752-54bb-4228-a546-cde9828162e1"
cwe_ids:
- "CWE-200"
- "CWE-256"
- "CWE-937"
- "CWE-1035"
