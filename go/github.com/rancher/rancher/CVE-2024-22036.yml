---
identifier: "CVE-2024-22036"
identifiers:
- "CVE-2024-22036"
- "GHSA-h99m-6755-rgwc"
package_slug: "go/github.com/rancher/rancher"
title: "Rancher Remote Code Execution via Cluster/Node Drivers"
description: "A vulnerability has been identified within Rancher where a cluster or
  node driver can be used to escape the `chroot` jail and gain root access to the
  Rancher container itself. In production environments, further privilege escalation
  is possible based on living off the land within the Rancher container itself. For
  the test and development environments, based on a â€“privileged Docker container,
  it is possible to escape the Docker container and gain execution access on the host
  system.\n\nThis happens because:\n- During startup, Rancher appends the `/opt/drivers/management-state/bin`
  directory to the `PATH` environment variable.\n- In Rancher, the binaries `/usr/bin/rancher-machine`,
  `/usr/bin/helm_v3`, and `/usr/bin/kustomize` are assigned a UID of 1001 and a GID
  of 127 instead of being owned by the root user.\n- Rancher employs a jail mechanism
  to isolate the execution of node drivers from the main process. However, the drivers
  are executed with excessive permissions.\n- During the registration of new node
  drivers, its binary is executed with the same user as the parent process, which
  could enable an attacker to gain elevated privileges by registering a malicious
  driver.\n- Lack of validation on the driver file type, which allows symbolic links
  to be used.\n\n\nPlease consult the associated  [MITRE ATT&CK - Technique - Privilege
  Escalation](https://attack.mitre.org/tactics/TA0004/) and [MITRE ATT&CK - Technique
  - Execution](https://attack.mitre.org/tactics/TA0002/) for further information about
  this category of attack.\n\n**Since they run at a privileged level, it is recommended
  to use trusted drivers only.**"
date: "2025-04-16"
pubdate: "2024-10-25"
affected_range: ">=2.7.0 <2.7.16||>=2.8.0 <2.8.9||>=2.9.0 <2.9.3"
fixed_versions:
- "2.7.16"
- "2.8.9"
- "2.9.3"
affected_versions: "All versions starting from 2.7.0 before 2.7.16, all versions starting
  from 2.8.0 before 2.8.9, all versions starting from 2.9.0 before 2.9.3"
not_impacted: "All versions before 2.7.0, all versions starting from 2.7.16 before
  2.8.0, all versions starting from 2.8.9 before 2.9.0, all versions starting from
  2.9.3"
solution: "Upgrade to versions 2.7.16, 2.8.9, 2.9.3 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-22036"
- "https://github.com/advisories/GHSA-h99m-6755-rgwc"
- "https://github.com/rancher/rancher/security/advisories/GHSA-h99m-6755-rgwc"
- "https://bugzilla.suse.com/show_bug.cgi?id=CVE-2024-22036"
- "https://github.com/rancher/rancher"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H"
uuid: "1124dfbf-8439-4bd0-a50c-9aed7096c629"
cwe_ids:
- "CWE-269"
- "CWE-937"
- "CWE-1035"
