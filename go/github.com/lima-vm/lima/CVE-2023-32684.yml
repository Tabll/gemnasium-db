---
identifier: "CVE-2023-32684"
identifiers:
- "GHSA-f7qw-jj9c-rpq9"
- "CVE-2023-32684"
package_slug: "go/github.com/lima-vm/lima"
title: "In Lima, a malicious disk image could read a single file on the host filesystem
  as a qcow2/vmdk backing file"
description: "Lima launches Linux virtual machines, typically on macOS, for running
  containerd. Prior to version 0.16.0, a virtual machine instance with a malicious
  disk image could read a single file on the host filesystem, even when no filesystem
  is mounted from the host. The official templates of Lima and the well-known third
  party products (Colima, Rancher Desktop, and Finch) are unlikely to be affected
  by this issue. To exploit this issue, the attacker has to embed the target file
  path (an absolute or a relative path from the instance directory) in a malicious
  disk image, as the qcow2 (or vmdk) backing file path string. As Lima refuses to
  run as the root, it is practically impossible for the attacker to read the entire
  host disk via `/dev/rdiskN`. Also, practically, the attacker cannot read at least
  the first 512 bytes (MBR) of the target file. The issue has been patched in Lima
  in version 0.16.0 by prohibiting using a backing file path in the VM base image."
date: "2023-05-31"
pubdate: "2023-05-31"
affected_range: "<v0.16.0"
fixed_versions:
- "v0.16.0"
affected_versions: "All versions before 0.16.0"
not_impacted: "All versions starting from 0.16.0"
solution: "Upgrade to version 0.16.0 or above."
urls:
- "https://github.com/lima-vm/lima/security/advisories/GHSA-f7qw-jj9c-rpq9"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-32684"
- "https://github.com/lima-vm/lima/commit/01dbd4d9cabe692afa4517be3995771f0ebb38a5"
- "https://github.com/lima-vm/lima/releases/tag/v0.16.0"
- "https://github.com/advisories/GHSA-f7qw-jj9c-rpq9"
uuid: "5c733060-7398-40f3-8376-dd21fb17ac98"
cwe_ids:
- "CWE-1035"
- "CWE-937"
versions:
- number: "v0.16.0"
  commit:
    tags:
    - "v0.16.0"
    sha: "0b0df072172310dde28ff2a6c5cb54d8e72c9676"
    timestamp: "20230530042352"
cvss_v3: "CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:U/C:L/I:N/A:N"
