---
identifier: "CVE-2024-42473"
identifiers:
- "CVE-2024-42473"
- "GHSA-3f6g-m4hr-59h8"
package_slug: "go/github.com/openfga/openfga"
title: "OpenFGA Authorization Bypass"
description: "## Overview\n\nOpenFGA v1.5.7 and v1.5.8 are vulnerable to authorization
  bypass when calling Check API with a model that uses `but not` and `from` expressions
  and a userset. \n\nFor example, with a model like the following\n\n```\n model\n
  \   schema 1.1\n\n  type user\n\n  type role\n    relations\n      define assignee:
  [user]\n\n  type permission\n    relations\n      define assignee: assignee from
  role\n      define role: [role]\n\n  type job\n    relations\n      define can_read:
  [permission#assignee]\n      define problem: [user] but not can_read\n```\n\nand
  these tuples:\n\n```\nuser:1, problem, job:1\nuser:1, assignee, role:admin\nrole:admin,
  role, permission:readJobs\npermission:readJobs#assignee, can_read, job:1\n```\n\nA
  query such as `Check(object=job:1, relation=problem, user=user:1)` will return `allowed=true`
  when the correct response is `allowed=false`.\n\n## Fix\n\nDowngrade to v1.5.6 as
  soon as possible. This downgrade is backward compatible.\n\nWe are currently working
  on a fix which will be included in the next release."
date: "2024-08-09"
pubdate: "2024-08-09"
affected_range: ">=1.5.7 <=1.5.8"
fixed_versions: []
affected_versions: "All versions starting from 1.5.7 up to 1.5.8"
not_impacted: ""
solution: "Unfortunately, there is no solution available yet."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-42473"
- "https://github.com/advisories/GHSA-3f6g-m4hr-59h8"
- "https://github.com/openfga/openfga/security/advisories/GHSA-3f6g-m4hr-59h8"
- "https://github.com/openfga/openfga"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N"
uuid: "d71dd694-a3b6-4cca-b072-88747f8f38d5"
cwe_ids:
- "CWE-285"
- "CWE-937"
- "CWE-1035"
