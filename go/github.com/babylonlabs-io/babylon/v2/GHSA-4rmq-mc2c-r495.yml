---
identifier: "GHSA-4rmq-mc2c-r495"
identifiers:
- "GHSA-4rmq-mc2c-r495"
package_slug: "go/github.com/babylonlabs-io/babylon/v2"
title: "Babylon Incorrect FP inactive accounting in costaking creates “phantom stake”
  that earns rewards after BTC unbond"
description: "A state consistency bug in `x/costaking` can leave a BTC delegator with
  non-zero `ActiveSatoshis` (Phatom Stake) even after they have fully unbonded their
  BTC delegation, if their Finality Provider (FP) drops out of the active set in the
  exact same babylon block height. This creates a “phantom stake”: the delegator’s
  BTC capital is withdrawn, the FP is inactive, but costaking continues to treat the
  delegation as active BTC stake allowing ongoing rewards accrual without backing
  BTC."
date: "2025-12-09"
pubdate: "2025-12-09"
affected_range: "<=2.3.2"
fixed_versions: []
affected_versions: "All versions up to 2.3.2"
not_impacted: ""
solution: "Unfortunately, there is no solution available yet."
urls:
- "https://github.com/advisories/GHSA-4rmq-mc2c-r495"
- "https://github.com/babylonlabs-io/babylon/security/advisories/GHSA-4rmq-mc2c-r495"
- "https://github.com/babylonlabs-io/babylon/commit/e65c3a55a398a403103f1b089cf76f0d4befc7a0"
- "https://github.com/babylonlabs-io/babylon"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N"
cvss_v4: "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:L/VA:N/SC:N/SI:N/SA:N"
uuid: "e72137c8-6473-48bf-910d-21bed2266672"
cwe_ids:
- "CWE-459"
- "CWE-937"
- "CWE-1035"
