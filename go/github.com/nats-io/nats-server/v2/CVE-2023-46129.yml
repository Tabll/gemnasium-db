---
identifier: "CVE-2023-46129"
identifiers:
- "GHSA-mr45-rx8q-wcm9"
- "CVE-2023-46129"
package_slug: "go/github.com/nats-io/nats-server/v2"
title: "Missing Cryptographic Step"
description: "NATS.io is a high performance open source pub-sub distributed communication
  technology, built for the cloud, on-premise, IoT, and edge computing. The cryptographic
  key handling library, nkeys, recently gained support for encryption, not just for
  signing/authentication. This is used in nats-server 2.10 (Sep 2023) and newer for
  authentication callouts. In nkeys versions 0.4.0 through 0.4.5, corresponding with
  NATS server versions 2.10.0 through 2.10.3, the nkeys library's `xkeys` encryption
  handling logic mistakenly passed an array by value into an internal function, where
  the function mutated that buffer to populate the encryption key to use. As a result,
  all encryption was actually to an all-zeros key. This affects encryption only, not
  signing. \nFIXME: FILL IN IMPACT ON NATS-SERVER AUTH CALLOUT SECURITY. nkeys Go
  library 0.4.6, corresponding with NATS Server 2.10.4, has a patch for this issue.
  No known workarounds are available. For any application handling auth callouts in
  Go, if using the nkeys library, update the dependency, recompile and deploy that
  in lockstep."
date: "2023-10-31"
pubdate: "2023-10-31"
affected_range: ">=2.10.0 <=2.10.3"
fixed_versions:
- "2.10.4"
affected_versions: "All versions starting from 2.10.0 up to 2.10.3"
not_impacted: "All versions before 2.10.0, all versions after 2.10.3"
solution: "Upgrade to version 2.10.4 or above."
urls:
- "https://github.com/nats-io/nkeys/security/advisories/GHSA-mr45-rx8q-wcm9"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-46129"
- "http://www.openwall.com/lists/oss-security/2023/10/31/1"
- "https://github.com/advisories/GHSA-mr45-rx8q-wcm9"
uuid: "d6244c04-ef48-4774-a078-2ec2ae14342b"
cwe_ids:
- "CWE-1035"
- "CWE-321"
- "CWE-325"
- "CWE-937"
