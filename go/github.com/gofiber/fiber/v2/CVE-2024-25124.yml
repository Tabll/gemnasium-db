---
identifier: "CVE-2024-25124"
identifiers:
- "GHSA-fmg4-x8pw-hjhg"
- "CVE-2024-25124"
package_slug: "go/github.com/gofiber/fiber/v2"
title: "Permissive Cross-domain Policy with Untrusted Domains"
description: "Fiber is a web framework written in go. Prior to version 2.52.1, the
  CORS middleware allows for insecure configurations that could potentially expose
  the application to multiple CORS-related vulnerabilities. Specifically, it allows
  setting the Access-Control-Allow-Origin header to a wildcard (`*`) while also having
  the Access-Control-Allow-Credentials set to true, which goes against recommended
  security best practices. The impact of this misconfiguration is high as it can lead
  to unauthorized access to sensitive user data and expose the system to various types
  of attacks listed in the PortSwigger article linked in the references. Version 2.52.1
  contains a patch for this issue. As a workaround, users may manually validate the
  CORS configurations in their implementation to ensure that they do not allow a wildcard
  origin when credentials are enabled. The browser fetch api, as well as browsers
  and utilities that enforce CORS policies, are not affected by this."
date: "2024-02-22"
pubdate: "2024-02-22"
affected_range: "<v2.52.1"
fixed_versions:
- "v2.52.1"
affected_versions: "All versions before 2.52.1"
not_impacted: "All versions starting from 2.52.1"
solution: "Upgrade to version 2.52.1 or above."
urls:
- "https://github.com/gofiber/fiber/security/advisories/GHSA-fmg4-x8pw-hjhg"
- "https://nvd.nist.gov/vuln/detail/CVE-2024-25124"
- "https://github.com/gofiber/fiber/commit/f0cd3b44b086544a37886232d0530601f2406c23"
- "https://codeql.github.com/codeql-query-help/javascript/js-cors-misconfiguration-for-credentials"
- "https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS/Errors/CORSNotSupportingCredentials"
- "https://fetch.spec.whatwg.org/#cors-protocol-and-credentials"
- "https://github.com/gofiber/fiber/releases/tag/v2.52.1"
- "https://saturncloud.io/blog/cors-cannot-use-wildcard-in-accesscontrolalloworigin-when-credentials-flag-is-true"
- "http://blog.portswigger.net/2016/10/exploiting-cors-misconfigurations-for.html"
- "https://github.com/advisories/GHSA-fmg4-x8pw-hjhg"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:L"
uuid: "a9309ab8-4c3f-4c75-886e-5601ec42009f"
cwe_ids:
- "CWE-1035"
- "CWE-346"
- "CWE-937"
- "CWE-942"
versions:
- number: "v2.52.1"
  commit:
    tags:
    - "v2.52.1"
    sha: "70f21d5f7eb486875d6f6f07c858c7d20e9b3f0a"
    timestamp: "20240221201856"
