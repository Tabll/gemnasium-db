---
identifier: "CVE-2022-39324"
identifiers:
- "CVE-2022-39324"
- "GHSA-4724-7jwc-3fpw"
package_slug: "go/github.com/grafana/grafana"
title: "Grafana Spoofing originalUrl of snapshots"
description: "To create a snapshot (and insert an arbitrary URL) the built-in role
  Viewer is sufficient.\nWhen a dashboard is shared as a local snapshot, the following
  three fields are offered in the web UI for a user to fill out:\n• Snapshotname\n•
  Expire\n• Timeout(seconds)\nAfter the user confirms creation of the snapshot (i.e.
  clicks the ”Local Snapshot” button) an HTTP POST request is sent to the Grafana
  server. The HTTP request contains additional parameters that are not visible in
  the web UI. The parameter originalUrl is not visible in the web UI, but sent in
  the HTTP POST request.\n\nThe value of the originalUrl parameter is automatically
  generated. The purpose of the presented originalUrl parameter is to provide a user
  that views the snapshot the possibility to click on the button in the Grafana web
  UI and be presented with the dashboard that the snapshot was made out of.\n\nThe
  value of the originalUrl parameter can be arbitrarily chosen by a malicious user
  that creates the snapshot (Note: by editing the query thanks to a web proxy like
  Burp)\nWhen another user opens the URL of the snapshot, they will be presented with
  the regular web interface delivered by the trusted Grafana server. The issue here
  is that the ”Open original dashboard” button no longer points to the to the real
  original dashboard but to the attacker’s (injected) URL."
date: "2024-05-20"
pubdate: "2024-05-14"
affected_range: ">=9.0.0 <9.2.8||<8.5.16"
fixed_versions:
- "9.2.8"
- "8.5.16"
affected_versions: "All versions before 8.5.16, all versions starting from 9.0.0 before
  9.2.8"
not_impacted: "All versions starting from 8.5.16 before 9.0.0, all versions starting
  from 9.2.8"
solution: "Upgrade to versions 8.5.16, 9.2.8 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-39324"
- "https://github.com/advisories/GHSA-4724-7jwc-3fpw"
- "https://github.com/grafana/grafana/security/advisories/GHSA-4724-7jwc-3fpw"
- "https://github.com/grafana/grafana/pull/60232"
- "https://github.com/grafana/grafana/pull/60256"
- "https://github.com/grafana/grafana/commit/239888f22983010576bb3a9135a7294e88c0c74a"
- "https://github.com/grafana/grafana/commit/d7dcea71ea763780dc286792a0afd560bff2985c"
- "https://github.com/grafana/grafana"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:L"
uuid: "129496ba-7abc-477e-8790-aaefe3722f17"
cwe_ids:
- "CWE-79"
- "CWE-937"
- "CWE-1035"
