---
identifier: "CVE-2023-3128"
identifiers:
- "GHSA-mpv3-g8m3-3fjc"
- "CVE-2023-3128"
package_slug: "go/github.com/grafana/grafana"
title: "Authentication Bypass by Spoofing"
description: "Grafana is validating Azure AD accounts based on the email claim. \n\nOn
  Azure AD, the profile email field is not unique and can be easily modified. \n\nThis
  leads to account takeover and authentication bypass when Azure AD OAuth is configured
  with a multi-tenant app. \n\n"
date: "2023-07-19"
pubdate: "2023-06-22"
affected_range: "<8.5.27||>=9.0.0 <9.2.20||>=9.3.0 <9.3.16||>=9.4.0 <9.4.13"
fixed_versions:
- "9.3.16"
- "9.4.13"
- "8.5.27"
- "9.2.20"
affected_versions: "All versions before 8.5.27, all versions starting from 9.0.0 before
  9.2.20, all versions starting from 9.3.0 before 9.3.16, all versions starting from
  9.4.0 before 9.4.13"
not_impacted: "All versions starting from 8.5.27 before 9.0.0, all versions starting
  from 9.2.20 before 9.3.0, all versions starting from 9.3.16 before 9.4.0, all versions
  starting from 9.4.13"
solution: "Upgrade to versions 9.3.16, 9.4.13, 8.5.27, 9.2.20 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-3128"
- "https://grafana.com/security/security-advisories/cve-2023-3128/"
- "https://github.com/grafana/grafana/blob/69fc4e6bc0be2a82085ab3885c2262a4d49e97d8/CHANGELOG.md"
- "https://github.com/grafana/bugbounty/security/advisories/GHSA-gxh2-6vvc-rrgp"
- "https://security.netapp.com/advisory/ntap-20230714-0004/"
- "https://github.com/advisories/GHSA-mpv3-g8m3-3fjc"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "618ca222-f1df-4c4b-a762-7752ed429705"
cwe_ids:
- "CWE-1035"
- "CWE-290"
- "CWE-937"
