---
identifier: "CVE-2023-22462"
identifiers:
- "GHSA-7rqg-hjwc-6mjf"
- "CVE-2023-22462"
package_slug: "go/github.com/grafana/grafana"
title: "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
description: "Grafana is an open-source platform for monitoring and observability.
  On 2023-01-01 during an internal audit of Grafana, a member of the security team
  found a stored XSS vulnerability affecting the core plugin \"Text\". The stored
  XSS vulnerability requires several user interactions in order to be fully exploited.
  The vulnerability was possible due to React's render cycle that will pass though
  the unsanitized HTML code, but in the next cycle the HTML is cleaned up and saved
  in Grafana's database. An attacker needs to have the Editor role in order to change
  a Text panel to include JavaScript. Another user needs to edit the same Text panel,
  and click on \"Markdown\" or \"HTML\" for the code to be executed. This means that
  vertical privilege escalation is possible, where a user with Editor role can change
  to a known password for a user having Admin role if the user with Admin role executes
  malicious JavaScript viewing a dashboard. This issue has been patched in versions
  9.2.10 and 9.3.4."
date: "2023-03-01"
pubdate: "2023-03-01"
affected_range: ">=9.2 <9.2.10||>=9.3 <9.3.4"
fixed_versions:
- "9.2.10"
- "9.3.4"
affected_versions: "All versions starting from 9.2 before 9.2.10, all versions starting
  from 9.3 before 9.3.4"
not_impacted: "All versions before 9.2, all versions starting from 9.2.10 before 9.3,
  all versions starting from 9.3.4"
solution: "Upgrade to versions 9.2.10, 9.3.4 or above."
urls:
- "https://github.com/grafana/grafana/security/advisories/GHSA-7rqg-hjwc-6mjf"
- "https://github.com/grafana/grafana/commit/db83d5f398caffe35c5846cfa7727d1a2a414165"
- "https://grafana.com/blog/2023/02/28/grafana-security-release-new-versions-with-security-fixes-for-cve-2023-0594-cve-2023-0507-and-cve-2023-22462/"
- "https://github.com/advisories/GHSA-7rqg-hjwc-6mjf"
uuid: "bcd66f33-1a20-4d8f-893d-d90675361d89"
cwe_ids:
- "CWE-1035"
- "CWE-79"
- "CWE-937"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N"
