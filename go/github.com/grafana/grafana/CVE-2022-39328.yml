---
identifier: "CVE-2022-39328"
identifiers:
- "CVE-2022-39328"
- "GHSA-vqc4-mpj8-jxch"
package_slug: "go/github.com/grafana/grafana"
title: "Grafana Race condition allowing privilege escalation"
description: "Internal security audit identified a race condition in the Grafana codebase,
  which allowed an unauthenticated user to query an arbitrary endpoint in Grafana.\nA
  race condition in the [HTTP context creation](https://github.com/grafana/grafana/blob/main/pkg/web/router.go#L153)
  could make a HTTP request being assigned the authentication/authorization middlewares
  of another call. Under heavy load it is possible that a call protected by a privileged
  middleware receives instead the middleware of a public query.\nAs a result, an unauthenticated
  user can successfully query protected endpoints."
date: "2024-05-14"
pubdate: "2024-05-14"
affected_range: ">=9.2.0 <9.2.4"
fixed_versions:
- "9.2.4"
affected_versions: "All versions starting from 9.2.0 before 9.2.4"
not_impacted: "All versions before 9.2.0, all versions starting from 9.2.4"
solution: "Upgrade to version 9.2.4 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-39328"
- "https://github.com/advisories/GHSA-vqc4-mpj8-jxch"
- "https://github.com/grafana/grafana/security/advisories/GHSA-vqc4-mpj8-jxch"
- "https://github.com/grafana/grafana"
- "https://security.netapp.com/advisory/ntap-20221215-0003"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "42a13026-bedd-4185-96f3-21fb138db97f"
cwe_ids:
- "CWE-362"
- "CWE-937"
- "CWE-1035"
