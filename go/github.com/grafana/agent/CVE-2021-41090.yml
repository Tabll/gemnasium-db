---
identifier: "CVE-2021-41090"
identifiers:
- "CVE-2021-41090"
- "GHSA-9c4x-5hgq-q3wh"
package_slug: "go/github.com/grafana/agent"
title: "Exposure of Sensitive Information to an Unauthorized Actor"
description: "Grafana Agent is a telemetry collector for sending metrics, logs, and
  trace data to the opinionated Grafana observability stack., inline secrets defined
  within a metrics instance config are exposed in plaintext over two endpoints: metrics
  instance configs defined in the base YAML file are exposed at `/-/config` and metrics
  instance configs defined for the scraping service are exposed at `/agent/api/v1/configs/:key`.
  Inline secrets will be exposed to anyone being able to reach these endpoints. If
  HTTPS with client authentication is not configured, these endpoints are accessible
  to unauthenticated users. Secrets found in these sections are used for delivering
  metrics to a Prometheus Remote Write system, authenticating against a system for
  discovering Prometheus targets, and authenticating against a system for collecting
  metrics. This does not apply for non-inlined secrets, such as `*_file` based secrets.
  This issue is patched in Grafana Agent A few workarounds are available. Users who
  cannot upgrade should use non-inline secrets where possible. Users may also desire
  to restrict API access to Grafana Agent with some combination of restricting the
  network interfaces Grafana Agent listens on through `http_listen_address` in the
  `server` block, configuring Grafana Agent to use HTTPS with client authentication,
  and/or using firewall rules to restrict external access to Grafana Agent's API."
date: "2022-03-31"
pubdate: "2021-12-08"
affected_range: ">=v0.14.0 <v0.20.1 || >=v0.21.0 <v0.21.2"
fixed_versions:
- "v0.20.1"
- "v0.21.2"
affected_versions: "All versions starting from 0.14.0 before 0.20.1, all versions
  starting from 0.21.0 before 0.21.2"
not_impacted: ""
solution: "Upgrade to versions 0.20.1, 0.21.2 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-41090"
- "https://github.com/grafana/agent/commit/af7fb01e31fe2d389e5f1c36b399ddc46b412b21"
- "https://github.com/grafana/agent/pull/1152"
- "https://github.com/grafana/agent/releases/tag/v0.21.2"
- "https://github.com/grafana/agent/security/advisories/GHSA-9c4x-5hgq-q3wh"
- "https://github.com/grafana/agent/releases/tag/v0.20.1"
cvss_v2: "AV:N/AC:M/Au:N/C:P/I:N/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"
uuid: "91c10eb6-e2e3-457b-920a-c6a90b48f8f0"
cwe_ids:
- "CWE-1035"
- "CWE-312"
- "CWE-937"
versions:
- number: "v0.14.0"
  commit:
    tags:
    - "v0.14.0"
    sha: "57621f00be02cfce5daabc8d3c9790ce34e07038"
    timestamp: "20210524144801"
- number: "v0.21.0"
  commit:
    tags:
    - "v0.21.0"
    sha: "1933a1b1a8a40b3c4c54d6a630e5c3068be84e81"
    timestamp: "20211117203602"
- number: "v0.20.1"
  commit:
    tags:
    - "v0.20.1"
    sha: "34e75049e5afc9696b4b155304adc79fa182b7c9"
    timestamp: "20211208130244"
- number: "v0.21.2"
  commit:
    tags:
    - "v0.21.2"
    sha: "9c5bf7bd3d5a44725881b61dbbe516ab7afb844a"
    timestamp: "20211208130508"
