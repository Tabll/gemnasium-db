---
identifier: "CVE-2023-45821"
identifiers:
- "GHSA-g6pq-x539-7w4j"
- "CVE-2023-45821"
package_slug: "go/github.com/artifacthub/hub"
title: "Artifact Hub has Incorrect Docker Hub registry check"
description: "Artifact Hub is a web-based application that enables finding, installing,
  and publishing packages and configurations for CNCF projects. During a security
  audit of Artifact Hub's code base a security researcher identified a bug in which
  the `registryIsDockerHub` function was only checking that the registry domain had
  the `docker.io` suffix. Artifact Hub allows providing some Docker credentials that
  are used to increase the rate limit applied when interacting with the Docker Hub
  registry API to read publicly available content. Due to the incorrect check described
  above, it'd be possible to hijack those credentials by purchasing a domain which
  ends with `docker.io` and deploying a fake OCI registry on it. <https://artifacthub.io/>
  uses some credentials that only have permissions to read public content available
  in the Docker Hub. However, even though credentials for private repositories (disabled
  on `artifacthub.io`) are handled in a different way, other Artifact Hub deployments
  could have been using them for a different purpose. This issue has been resolved
  in version `1.16.0`. Users are advised to upgrade. There are no known workarounds
  for this vulnerability."
date: "2023-10-19"
pubdate: "2023-10-19"
affected_range: "<v1.16.0"
fixed_versions:
- "v1.16.0"
affected_versions: "All versions before 1.16.0"
not_impacted: "All versions starting from 1.16.0"
solution: "Upgrade to version 1.16.0 or above."
urls:
- "https://github.com/artifacthub/hub/security/advisories/GHSA-g6pq-x539-7w4j"
- "https://artifacthub.io/packages/helm/artifact-hub/artifact-hub?modal=changelog&version=1.16.0"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-45821"
- "https://github.com/advisories/GHSA-g6pq-x539-7w4j"
uuid: "01bbf8ee-712c-4de8-a1ee-66c1bfe588ea"
cwe_ids:
- "CWE-1035"
- "CWE-937"
versions:
- number: "v1.16.0"
  commit:
    tags:
    - "v1.16.0"
    sha: "14dffa84b9974c787ecd550e570fe7807946e4dc"
    timestamp: "20230913161243"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L"
