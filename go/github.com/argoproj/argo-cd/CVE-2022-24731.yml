---
identifier: "CVE-2022-24731"
identifiers:
- "GHSA-h6h5-6fmq-rh28"
- "CVE-2022-24731"
package_slug: "go/github.com/argoproj/argo-cd"
title: "Improper Access Control"
description: "Argo CD is a declarative, GitOps continuous delivery tool for Kubernetes.
  Argo CD starting with version 1.5.0 but before versions 2.1.11, 2.2.6, and 2.3.0
  is vulnerable to a path traversal vulnerability, allowing a malicious user with
  read/write access to leak sensitive files from Argo CD's repo-server. A malicious
  Argo CD user who has been granted `create` or `update` access to Applications can
  leak the contents of any text file on the repo-server. By crafting a malicious Helm
  chart and using it in an Application, the attacker can retrieve the sensitive file's
  contents either as part of the generated manifests or in an error message. The attacker
  would have to know or guess the location of the target file. Sensitive files which
  could be leaked include files from another Application's source repositories or
  any secrets which have been mounted as files on the repo-server. This vulnerability
  is patched in Argo CD versions 2.1.11, 2.2.6, and 2.3.0. The problem can be mitigated
  by avoiding storing secrets in git, avoiding mounting secrets as files on the repo-server,
  avoiding decrypting secrets into files on the repo-server, and carefully limiting
  who can `create` or `update` Applications."
date: "2022-03-29"
pubdate: "2022-03-24"
affected_range: ">=v1.5.0 <v2.1.11 || >=v2.2.0 <v2.2.6 || >=v2.3.0-rc1 <v2.3.0"
fixed_versions:
- "v2.1.11"
- "v2.2.6"
- "v2.3.0"
affected_versions: "All versions starting from 1.5.0 before 2.1.11, all versions starting
  from 2.2.0 before 2.2.6, all versions starting from 2.3.0-rc1 before 2.3.0"
not_impacted: "All versions before 1.5.0, all versions starting from 2.1.11 before
  2.2.0, all versions starting from 2.2.6 before 2.3.0-rc1, all versions starting
  from 2.3.0"
solution: "Upgrade to versions 2.1.11, 2.2.6, 2.3.0 or above."
urls:
- "https://github.com/argoproj/argo-cd/security/advisories/GHSA-h6h5-6fmq-rh28"
- "https://nvd.nist.gov/vuln/detail/CVE-2022-24731"
- "https://github.com/advisories/GHSA-h6h5-6fmq-rh28"
uuid: "5a40c5f9-7cca-4794-b604-8d80f17cc909"
cwe_ids:
- "CWE-1035"
- "CWE-22"
- "CWE-284"
- "CWE-352"
- "CWE-937"
versions:
- number: "v1.5.0"
  commit:
    tags:
    - "v1.5.0"
    sha: "bdda41046378a855e289b5f1602d5c923a3f914a"
    timestamp: "20200402163443"
- number: "v2.2.0"
  commit:
    tags:
    - "v2.2.0"
    sha: "6da92a8e8103ce4145bb0fe2b7e952be79c9ff0a"
    timestamp: "20211214180104"
- number: "v2.3.0-rc1"
  commit:
    tags:
    - "v2.3.0-rc1"
    sha: "7d7eed49329197207e5b86420780696bfc8c9ca9"
    timestamp: "20220130214254"
- number: "v2.1.11"
  commit:
    tags:
    - "v2.1.11"
    sha: "e25d3b54354dc529a11a1ccbb19f6338aa027525"
    timestamp: "20220306053033"
- number: "v2.2.6"
  commit:
    tags:
    - "v2.2.6"
    sha: "2e550c3f0723daf94df7343b7c40f459aafd6fff"
    timestamp: "20220306055051"
- number: "v2.3.0"
  commit:
    tags:
    - "v2.3.0"
    sha: "fe427802293b090f43f91f5839393174df6c3b3a"
    timestamp: "20220306061859"
