---
identifier: "CVE-2022-29165"
identifiers:
- "GHSA-r642-gv9p-2wjj"
- "CVE-2022-29165"
package_slug: "go/github.com/argoproj/argo-cd/v2"
title: "Authentication Bypass by Spoofing"
description: "Argo CD is a declarative, GitOps continuous delivery tool for Kubernetes.
  A critical vulnerability has been discovered in Argo CD starting with version 1.4.0
  and prior to versions 2.1.15, 2.2.9, and 2.3.4 which would allow unauthenticated
  users to impersonate as any Argo CD user or role, including the `admin` user, by
  sending a specifically crafted JSON Web Token (JWT) along with the request. In order
  for this vulnerability to be exploited, anonymous access to the Argo CD instance
  must have been enabled. In a default Argo CD installation, anonymous access is disabled.
  The vulnerability can be exploited to impersonate as any user or role, including
  the built-in `admin` account regardless of whether it is enabled or disabled. Also,
  the attacker does not need an account on the Argo CD instance in order to exploit
  this. If anonymous access to the instance is enabled, an attacker can escalate their
  privileges, effectively allowing them to gain the same privileges on the cluster
  as the Argo CD instance, which is cluster admin in a default installation. This
  will allow the attacker to create, manipulate and delete any resource on the cluster.
  They may also exfiltrate data by deploying malicious workloads with elevated privileges,
  thus bypassing any redaction of sensitive data otherwise enforced by the Argo CD
  API. A patch for this vulnerability has been released in Argo CD versions 2.3.4,
  2.2.9, and 2.1.15. As a workaround, one may disable anonymous access, but upgrading
  to a patched version is preferable."
date: "2022-05-24"
pubdate: "2022-05-24"
affected_range: "<v2.1.15 || >=v2.2.0 <v2.2.9 || >=v2.3.0 <v2.3.4"
fixed_versions:
- "v2.2.9"
- "v2.3.4"
affected_versions: "All versions starting from 2.2.0 before 2.2.9, all versions starting
  from 2.3.0 before 2.3.4, all versions before 2.1.15"
not_impacted: "All versions before 2.2.0, all versions starting from 2.2.9 before
  2.3.0"
solution: "Upgrade to versions 2.2.9, 2.3.4 or above."
urls:
- "https://github.com/argoproj/argo-cd/security/advisories/GHSA-r642-gv9p-2wjj"
- "https://nvd.nist.gov/vuln/detail/CVE-2022-29165"
- "https://github.com/argoproj/argo-cd/releases/tag/v2.1.15"
- "https://github.com/argoproj/argo-cd/releases/tag/v2.2.9"
- "https://github.com/argoproj/argo-cd/releases/tag/v2.3.4"
- "https://github.com/advisories/GHSA-r642-gv9p-2wjj"
uuid: "1c111556-4aca-4e55-a844-19d31fcc0d56"
cwe_ids:
- "CWE-1035"
- "CWE-200"
- "CWE-287"
- "CWE-290"
- "CWE-937"
versions:
- number: "v2.2.0"
  commit:
    tags:
    - "v2.2.0"
    sha: "6da92a8e8103ce4145bb0fe2b7e952be79c9ff0a"
    timestamp: "20211214180104"
- number: "v2.3.0"
  commit:
    tags:
    - "v2.3.0"
    sha: "fe427802293b090f43f91f5839393174df6c3b3a"
    timestamp: "20220306061859"
- number: "v2.3.4"
  commit:
    tags:
    - "stable"
    - "v2.3.4"
    sha: "ac8b7df9467ffcc0920b826c62c4b603a7bfed24"
    timestamp: "20220518113227"
- number: "v2.2.9"
  commit:
    tags:
    - "v2.2.9"
    sha: "38755a4c1e5232aa2e6f80c062593c9f07da0757"
    timestamp: "20220518115529"
- number: "v2.1.15"
  commit:
    tags:
    - "v2.1.15"
    sha: "52f917a18165416baa418822daae36c5f011e91f"
    timestamp: "20220518123422"
cvss_v2: "AV:N/AC:M/Au:N/C:C/I:C/A:C"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H"
