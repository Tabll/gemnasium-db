---
identifier: "CVE-2022-24730"
identifiers:
- "GHSA-r9cr-hvjj-496v"
- "CVE-2022-24730"
package_slug: "go/github.com/argoproj/argo-cd"
title: "Improper Access Control"
description: "Argo CD is a declarative, GitOps continuous delivery tool for Kubernetes.
  Argo CD starting with version 1.3.0 but before versions 2.1.11, 2.2.6, and 2.3.0
  is vulnerable to a path traversal bug, compounded by an improper access control
  bug, allowing a malicious user with read-only repository access to leak sensitive
  files from Argo CD's repo-server. A malicious Argo CD user who has been granted
  `get` access for a repository containing a Helm chart can craft an API request to
  the `/api/v1/repositories/{repo_url}/appdetails` endpoint to leak the contents of
  out-of-bounds files from the repo-server. The malicious payload would reference
  an out-of-bounds file, and the contents of that file would be returned as part of
  the response. Contents from a non-YAML file may be returned as part of an error
  message. The attacker would have to know or guess the location of the target file.
  Sensitive files which could be leaked include files from other Applications' source
  repositories or any secrets which have been mounted as files on the repo-server.
  This vulnerability is patched in Argo CD versions 2.1.11, 2.2.6, and 2.3.0. The
  patches prevent path traversal and limit access to users who either A) have been
  granted Application `create` privileges or B) have been granted Application `get`
  privileges and are requesting details for a `repo_url` that has already been used
  for the given Application. There are currently no known workarounds."
date: "2022-03-29"
pubdate: "2022-03-24"
affected_range: ">=v1.3.0 <v2.1.11 || >=v2.2.0 <v2.2.6 || >=v2.3.0-rc1 <v2.3.0"
fixed_versions:
- "v2.1.11"
- "v2.2.6"
- "v2.3.0"
affected_versions: "All versions starting from 1.3.0 before 2.1.11, all versions starting
  from 2.2.0 before 2.2.6, all versions starting from 2.3.0-rc1 before 2.3.0"
not_impacted: "All versions before 1.3.0, all versions starting from 2.1.11 before
  2.2.0, all versions starting from 2.2.6 before 2.3.0-rc1, all versions starting
  from 2.3.0"
solution: "Upgrade to versions 2.1.11, 2.2.6, 2.3.0 or above."
urls:
- "https://github.com/argoproj/argo-cd/security/advisories/GHSA-r9cr-hvjj-496v"
- "https://nvd.nist.gov/vuln/detail/CVE-2022-24730"
- "https://github.com/advisories/GHSA-r9cr-hvjj-496v"
uuid: "ea3482fb-a919-4d1f-96b5-6d27a796187d"
cwe_ids:
- "CWE-1035"
- "CWE-22"
- "CWE-284"
- "CWE-352"
- "CWE-937"
versions:
- number: "v1.3.0"
  commit:
    tags:
    - "v1.3.0"
    sha: "9f8608c9fcb2a1d8dcc06eeadd57e5c0334c5800"
    timestamp: "20191113010324"
- number: "v2.2.0"
  commit:
    tags:
    - "v2.2.0"
    sha: "6da92a8e8103ce4145bb0fe2b7e952be79c9ff0a"
    timestamp: "20211214180104"
- number: "v2.3.0-rc1"
  commit:
    tags:
    - "v2.3.0-rc1"
    sha: "7d7eed49329197207e5b86420780696bfc8c9ca9"
    timestamp: "20220130214254"
- number: "v2.1.11"
  commit:
    tags:
    - "v2.1.11"
    sha: "e25d3b54354dc529a11a1ccbb19f6338aa027525"
    timestamp: "20220306053033"
- number: "v2.2.6"
  commit:
    tags:
    - "v2.2.6"
    sha: "2e550c3f0723daf94df7343b7c40f459aafd6fff"
    timestamp: "20220306055051"
- number: "v2.3.0"
  commit:
    tags:
    - "v2.3.0"
    sha: "fe427802293b090f43f91f5839393174df6c3b3a"
    timestamp: "20220306061859"
