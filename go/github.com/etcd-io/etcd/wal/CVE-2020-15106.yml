---
identifier: "CVE-2020-15106"
identifiers:
- "GHSA-p4g4-wgrh-qrg2"
- "CVE-2020-15106"
package_slug: "go/github.com/etcd-io/etcd/wal"
title: "Improper Input Validation in etcd"
description: "In etcd before versions 3.3.23 and 3.4.10, a large slice causes panic
  in decodeRecord method. The size of a record is stored in the length field of a
  WAL file and no additional validation is done on this data. Therefore, it is possible
  to forge an extremely large frame size that can unintentionally panic at the expense
  of any RAFT participant trying to decode the WAL."
date: "2023-02-07"
pubdate: "2023-02-07"
affected_range: "<v3.4.10"
fixed_versions:
- "v3.4.10"
affected_versions: "All versions before 3.4.10"
not_impacted: "All versions starting from 3.4.10"
solution: "Upgrade to version 3.4.10 or above."
urls:
- "https://github.com/etcd-io/etcd/security/advisories/GHSA-p4g4-wgrh-qrg2"
- "https://nvd.nist.gov/vuln/detail/CVE-2020-15106"
- "https://github.com/etcd-io/etcd/pull/11793"
- "https://github.com/etcd-io/etcd/commit/4571e528f49625d3de3170f219a45c3b3d38c675"
- "https://github.com/etcd-io/etcd/commit/f4b650b51dc4a53a8700700dc12e1242ac56ba07"
- "https://github.com/etcd-io/etcd/blob/master/security/SECURITY_AUDIT.pdf"
- "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/L6B6R43Y7M3DCHWK3L3UVGE2K6WWECMP/"
- "https://pkg.go.dev/vuln/GO-2020-0005"
- "https://github.com/advisories/GHSA-p4g4-wgrh-qrg2"
cvss_v2: "AV:N/AC:L/Au:S/C:N/I:N/A:P"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
uuid: "7f0c3b97-f847-452e-bfbd-2d7cd9ab2b32"
cwe_ids:
- "CWE-1035"
- "CWE-937"
versions:
- number: "v3.4.10"
  commit:
    tags:
    - "v3.4.10"
    sha: "33abd526eb9d5a0114ccfdda0d9033a7cab54018"
    timestamp: "20200716221620"
