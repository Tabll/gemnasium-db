---
identifier: "CVE-2024-29891"
identifiers:
- "CVE-2024-29891"
- "GHSA-hr5w-cwwq-2v4m"
package_slug: "go/github.com/zitadel/zitadel"
title: "ZITADEL's Improper Content-Type Validation Leads to Account Takeover via Stored
  XSS + CSP Bypass"
description: "ZITADEL users can upload their own avatar image and various image types
  are allowed.\n\nDue to a missing check, an attacker could upload HTML and pretend
  it is an image to gain access to the victim's account in certain scenarios.\nA possible
  victim would need to directly open the supposed image in the browser, where a session
  in ZITADEL needs to be active for this exploit to work.\n\nThe exploit could only
  be reproduced if the victim was using Firefox. Chrome, Safari as well as Edge did
  not execute the code."
date: "2024-03-28"
pubdate: "2024-03-28"
affected_range: "<2.42.17||>=2.43.0 <2.43.11||>=2.44.0 <2.44.7||>=2.45.0 <2.45.5||>=2.46.0
  <2.46.5||>=2.47.0 <2.47.8||>=2.48.0 <2.48.3"
fixed_versions:
- "2.42.17"
- "2.43.11"
- "2.44.7"
- "2.45.5"
- "2.46.5"
- "2.47.8"
- "2.48.3"
affected_versions: "All versions before 2.42.17, all versions starting from 2.43.0
  before 2.43.11, all versions starting from 2.44.0 before 2.44.7, all versions starting
  from 2.45.0 before 2.45.5, all versions starting from 2.46.0 before 2.46.5, all
  versions starting from 2.47.0 before 2.47.8, all versions starting from 2.48.0 before
  2.48.3"
not_impacted: "All versions starting from 2.42.17 before 2.43.0, all versions starting
  from 2.43.11 before 2.44.0, all versions starting from 2.44.7 before 2.45.0, all
  versions starting from 2.45.5 before 2.46.0, all versions starting from 2.46.5 before
  2.47.0, all versions starting from 2.47.8 before 2.48.0, all versions starting from
  2.48.3"
solution: "Upgrade to versions 2.42.17, 2.43.11, 2.44.7, 2.45.5, 2.46.5, 2.47.8, 2.48.3
  or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-29891"
- "https://github.com/advisories/GHSA-hr5w-cwwq-2v4m"
- "https://github.com/zitadel/zitadel/security/advisories/GHSA-hr5w-cwwq-2v4m"
- "https://github.com/zitadel/zitadel"
- "https://github.com/zitadel/zitadel/releases/tag/v2.42.17"
- "https://github.com/zitadel/zitadel/releases/tag/v2.43.11"
- "https://github.com/zitadel/zitadel/releases/tag/v2.44.7"
- "https://github.com/zitadel/zitadel/releases/tag/v2.45.5"
- "https://github.com/zitadel/zitadel/releases/tag/v2.46.5"
- "https://github.com/zitadel/zitadel/releases/tag/v2.47.8"
- "https://github.com/zitadel/zitadel/releases/tag/v2.48.3"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N"
uuid: "e86ee005-38aa-45b3-83d2-59cdbfed1796"
cwe_ids:
- "CWE-434"
- "CWE-937"
- "CWE-1035"
