---
identifier: "CVE-2025-46569"
identifiers:
- "CVE-2025-46569"
- "GHSA-6m8w-jc87-6cr7"
package_slug: "go/github.com/open-policy-agent/opa/v1/server"
title: "OPA server Data API HTTP path injection of Rego"
description: "When run as a server, OPA exposes an HTTP[ Data API](https://www.openpolicyagent.org/docs/latest/rest-api/#data-api)
  for reading and writing documents. Requesting a virtual document through the Data
  API entails policy evaluation, where a Rego query containing a single data document
  [reference](https://www.openpolicyagent.org/docs/latest/policy-language/#references)
  is constructed from the requested path. This query is then used for policy evaluation.\n\nA
  HTTP request path can be crafted in a way that injects Rego code into the constructed
  query. The evaluation result cannot be made to return any other data than what is
  generated by the requested path, but this path can be misdirected, and the injected
  Rego code can be crafted to make the query succeed or fail; opening up for oracle
  attacks or, given the right circumstances, erroneous policy decision results. Furthermore,
  the injected code can be crafted to be computationally expensive, resulting in a
  Denial Of Service (DoS) attack.\n\n**Users are only impacted if all of the following
  apply:**\n\n* OPA is deployed as a standalone server (rather than being used as
  a Go library)\n* The OPA server is exposed outside of the local host in an untrusted
  environment.\n* The configured [authorization policy](https://www.openpolicyagent.org/docs/latest/security/#authentication-and-authorization)
  does not do exact matching of the `input.path` attribute when deciding if the request
  should be allowed.\n\n**or, if all of the following apply:**\n\n* OPA is deployed
  as a standalone server.\n* The service connecting to OPA allows 3rd parties to insert
  unsanitised text into the path of the HTTP request to OPAâ€™s Data API.\n\n**Note:**
  With **no** Authorization Policy configured for restricting API access (the default
  configuration), the RESTful Data API provides access for managing Rego policies;
  and the RESTful Query API facilitates advanced queries. Full access to these APIs
  provides both simpler, and broader access than what the security issue describes
  here can facilitate. As such, OPA servers exposed to a network are **not** considered
  affected by the attack described here if they are knowingly not restricting access
  through an Authorization Policy."
date: "2025-05-01"
pubdate: "2025-05-01"
affected_range: "<1.4.0"
fixed_versions:
- "1.4.0"
affected_versions: "All versions before 1.4.0"
not_impacted: "All versions starting from 1.4.0"
solution: "Upgrade to version 1.4.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2025-46569"
- "https://github.com/advisories/GHSA-6m8w-jc87-6cr7"
- "https://github.com/open-policy-agent/opa/security/advisories/GHSA-6m8w-jc87-6cr7"
- "https://github.com/open-policy-agent/opa/commit/ad2063247a14711882f18c387a511fc8094aa79c"
- "https://github.com/open-policy-agent/opa"
uuid: "5d22d655-572a-4d17-a2db-5172d20c186a"
cwe_ids:
- "CWE-770"
- "CWE-78"
- "CWE-937"
- "CWE-1035"
