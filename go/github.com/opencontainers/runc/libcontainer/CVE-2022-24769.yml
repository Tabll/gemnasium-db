---
identifier: "CVE-2022-24769"
identifiers:
- "GHSA-2mm7-x5h6-5pvq"
- "CVE-2022-24769"
package_slug: "go/github.com/opencontainers/runc/libcontainer"
title: "Incorrect Permission Assignment for Critical Resource"
description: "Moby is an open-source project created by Docker to enable and accelerate
  software containerization. A bug was found in Moby (Docker Engine) prior to version
  20.10.14 where containers were incorrectly started with non-empty inheritable Linux
  process capabilities, creating an atypical Linux environment and enabling programs
  with inheritable file capabilities to elevate those capabilities to the permitted
  set during `execve(2)`. Normally, when executable programs have specified permitted
  file capabilities, otherwise unprivileged users and processes can execute those
  programs and gain the specified file capabilities up to the bounding set. Due to
  this bug, containers which included executable programs with inheritable file capabilities
  allowed otherwise unprivileged users and processes to additionally gain these inheritable
  file capabilities up to the container's bounding set. Containers which use Linux
  users and groups to perform privilege separation inside the container are most directly
  impacted. This bug does not affect the container security sandbox as the inheritable
  set never contained more capabilities than were included in the container's bounding
  set. This bug has been fixed in Moby (Docker Engine) 20.10.14. Running containers
  should be stopped, deleted, and recreated for the inheritable capabilities to be
  reset. This fix changes Moby (Docker Engine) behavior such that containers are started
  with a more typical Linux environment. As a workaround, the entry point of a container
  can be modified to use a utility like `capsh(1)` to drop inheritable capabilities
  prior to the primary process starting."
date: "2024-01-31"
pubdate: "2022-03-24"
affected_range: "<v1.1.2"
fixed_versions:
- "v1.1.2"
affected_versions: "All versions before 1.1.2"
not_impacted: ""
solution: "Upgrade to version 1.1.2 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-24769"
- "https://github.com/moby/moby/commit/2bbc786e4c59761d722d2d1518cd0a32829bc07f"
- "https://github.com/moby/moby/security/advisories/GHSA-2mm7-x5h6-5pvq"
- "https://github.com/moby/moby/releases/tag/v20.10.14"
- "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/FPOJUJZXGMIVKRS4QR75F6OIXNQ6LDBL/"
- "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/6PMQKCAPK2AR3DCYITJYMMNBEGQBGLCC/"
- "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/A5FQJ3MLFSEKQYCFPFZIKYGBXPZUJFVY/"
- "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/A5AFKOQ5CE3CEIULWW4FLQKHFFU6FSYG/"
- "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/HIMAHZ6AUIKN7AX26KHZYBXVECIOVWBH/"
- "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/HQCVS7WBFSTKJFNX5PGDRARMTOFWV2O7/"
- "http://www.openwall.com/lists/oss-security/2022/05/12/1"
cvss_v2: "AV:L/AC:L/Au:N/C:P/I:P/A:P"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L"
uuid: "cb024a06-5c6c-4f12-80b4-25330135c129"
cwe_ids:
- "CWE-1035"
- "CWE-732"
- "CWE-937"
versions:
- number: "v1.1.2"
  commit:
    tags:
    - "v1.1.2"
    sha: "c2cce1c71eab3a82702189ac59888dcc2f15601a"
    timestamp: "20220505194949"
