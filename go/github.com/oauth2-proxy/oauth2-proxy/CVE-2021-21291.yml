---
identifier: "CVE-2021-21291"
identifiers:
- "GHSA-4mf2-f3wh-gvf2"
- "CVE-2021-21291"
package_slug: "go/github.com/oauth2-proxy/oauth2-proxy"
title: "URL Redirection to Untrusted Site ('Open Redirect')"
description: "OAuth2 Proxy is an open-source reverse proxy and static file server
  that provides authentication using Providers (Google, GitHub, and others) to validate
  accounts by email, domain or group. In OAuth2 Proxy before version 7.0.0, for users
  that use the allowlist domain feature, a domain that ended in a similar way to the
  intended domain could have been allowed as a redirect. For example, if a allowlist
  domain was configured for \".example.com\", the intention is that subdomains of
  example.com are allowed. Instead, \"example.com\" and \"badexample.com\" could also
  match. This is fixed in version 7.0.0 onwards. As a workaround, one can disable
  the allowlist domain feature and run separate OAuth2 Proxy instances for each subdomain."
date: "2021-05-25"
pubdate: "2021-05-25"
affected_range: "<=3.2.0"
fixed_versions: []
affected_versions: "All versions up to 3.2.0"
not_impacted: ""
solution: "Unfortunately, there is no solution available yet."
urls:
- "https://github.com/oauth2-proxy/oauth2-proxy/security/advisories/GHSA-4mf2-f3wh-gvf2"
- "https://nvd.nist.gov/vuln/detail/CVE-2021-21291"
- "https://github.com/oauth2-proxy/oauth2-proxy/commit/780ae4f3c99b579cb2ea9845121caebb6192f725"
- "https://github.com/oauth2-proxy/oauth2-proxy/releases/tag/v7.0.0"
- "https://pkg.go.dev/github.com/oauth2-proxy/oauth2-proxy/v7"
- "https://github.com/advisories/GHSA-4mf2-f3wh-gvf2"
cvss_v2: "AV:N/AC:M/Au:N/C:P/I:P/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N"
uuid: "a24e667c-29bb-48d8-9c2b-86636d3e4e04"
cwe_ids:
- "CWE-1035"
- "CWE-601"
- "CWE-937"
