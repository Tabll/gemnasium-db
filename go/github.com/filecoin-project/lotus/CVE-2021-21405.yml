---
identifier: "CVE-2021-21405"
identifiers:
- "GHSA-4g52-pqcj-phvh"
- "CVE-2021-21405"
package_slug: "go/github.com/filecoin-project/lotus"
title: "Improper Verification of Cryptographic Signature"
description: "Lotus is an Implementation of the Filecoin protocol written in Go. BLS
  signature validation in lotus uses blst library method VerifyCompressed. This method
  accepts signatures in 2 forms: \"serialized\", and \"compressed\", meaning that
  BLS signatures can be provided as either of 2 unique byte arrays. Lotus block validation
  functions perform a uniqueness check on provided blocks. Two blocks are considered
  distinct if the CIDs of their blockheader do not match. The CID method for blockheader
  includes the BlockSig of the block. The result of these issues is that it would
  be possible to punish miners for valid blocks, as there are two different valid
  block CIDs available for each block, even though this must be unique. By switching
  from the go based `blst` bindings over to the bindings in `filecoin-ffi`, the code
  paths now ensure that all signatures are compressed by size and the way they are
  deserialized. This happened in https://github.com/filecoin-project/lotus/pull/5393."
date: "2021-05-21"
pubdate: "2021-05-21"
affected_range: "<1.5.0"
fixed_versions:
- "1.5.0"
affected_versions: "All versions before 1.5.0"
not_impacted: "All versions starting from 1.5.0"
solution: "Upgrade to version 1.5.0 or above."
urls:
- "https://github.com/filecoin-project/lotus/security/advisories/GHSA-4g52-pqcj-phvh"
- "https://nvd.nist.gov/vuln/detail/CVE-2021-21405"
- "https://github.com/filecoin-project/lotus/pull/5393"
- "https://gist.github.com/wadeAlexC/2490d522e81a796af9efcad1686e6754"
- "https://github.com/advisories/GHSA-4g52-pqcj-phvh"
cvss_v2: "AV:N/AC:L/Au:N/C:N/I:P/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N"
uuid: "d0c00b26-637d-495a-adea-5d3146c8cc20"
cwe_ids:
- "CWE-1035"
- "CWE-347"
- "CWE-937"
