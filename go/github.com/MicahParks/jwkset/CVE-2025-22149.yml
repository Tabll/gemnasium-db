---
identifier: "CVE-2025-22149"
identifiers:
- "CVE-2025-22149"
- "GHSA-675f-rq2r-jw82"
package_slug: "go/github.com/MicahParks/jwkset"
title: "JWK Set's HTTP client only overwrites and appends JWK to local cache during
  refresh"
description: "The project's provided HTTP client's local JWK Set cache should do a
  full replacement when the goroutine refreshes the remote JWK Set. The current behavior
  is to overwrite or append. This is a security issue for use cases that utilize the
  provided auto-caching HTTP client and where key removal from a JWK Set is equivalent
  to revocation.\n\nExample attack scenario:\n1. An attacker has stolen the private
  key for a key published in JWK Set.\n2. The publishers of that JWK Set remove that
  key from the JWK Set.\n3. Enough time has passed that the program using the auto-caching
  HTTP client found in `github.com/MicahParks/jwkset` v0.5.0-v0.5.21 has elapsed its
  `HTTPClientStorageOptions.RefreshInterval` duration, causing a refresh of the remote
  JWK Set.\n4. The attacker is signing content (such as JWTs) with the stolen private
  key and the system has no other forms of revocation."
date: "2025-01-09"
pubdate: "2025-01-09"
affected_range: ">=0.5.0 <0.6.0"
fixed_versions:
- "0.6.0"
affected_versions: "All versions starting from 0.5.0 before 0.6.0"
not_impacted: "All versions before 0.5.0, all versions starting from 0.6.0"
solution: "Upgrade to version 0.6.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2025-22149"
- "https://github.com/advisories/GHSA-675f-rq2r-jw82"
- "https://github.com/MicahParks/jwkset/security/advisories/GHSA-675f-rq2r-jw82"
- "https://github.com/MicahParks/jwkset/issues/40"
- "https://github.com/MicahParks/jwkset/pull/41"
- "https://github.com/MicahParks/jwkset"
uuid: "83aa5eae-27b8-40dd-99eb-e2dfb10c7405"
cwe_ids:
- "CWE-937"
- "CWE-1035"
