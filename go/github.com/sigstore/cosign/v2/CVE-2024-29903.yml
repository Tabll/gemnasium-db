---
identifier: "CVE-2024-29903"
identifiers:
- "CVE-2024-29903"
- "GHSA-95pr-fxf5-86gv"
package_slug: "go/github.com/sigstore/cosign/v2"
title: "Cosign malicious artifacts can cause machine-wide DoS"
description: "Maliciously-crafted software artifacts can cause denial of service of
  the machine running Cosign, thereby impacting all services on the machine. The root
  cause is that Cosign creates slices based on the number of signatures, manifests
  or attestations in untrusted artifacts. As such, the untrusted artifact can control
  the amount of memory that Cosign allocates.\n\nAs an example, these lines demonstrate
  the problem:\n\nhttps://github.com/sigstore/cosign/blob/286a98a4a99c1b2f32f84b0d560e324100312280/pkg/oci/remote/signatures.go#L56-L70\n\nThis
  `Get()` method gets the manifest of the image, allocates a slice equal to the length
  of the layers in the manifest, loops through the layers and adds a new signature
  to the slice.\n\nThe exact issue is Cosign allocates excessive memory on the lines
  that creates a slice of the same length as the manifests."
date: "2024-04-11"
pubdate: "2024-04-11"
affected_range: "<2.2.4"
fixed_versions:
- "2.2.4"
affected_versions: "All versions before 2.2.4"
not_impacted: "All versions starting from 2.2.4"
solution: "Upgrade to version 2.2.4 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-29903"
- "https://github.com/advisories/GHSA-95pr-fxf5-86gv"
- "https://github.com/sigstore/cosign/security/advisories/GHSA-95pr-fxf5-86gv"
- "https://github.com/sigstore/cosign/commit/629f5f8fa672973503edde75f84dcd984637629e"
- "https://github.com/sigstore/cosign"
- "https://github.com/sigstore/cosign/blob/14795db16417579fac0c00c11e166868d7976b61/pkg/cosign/verify.go#L948-L955"
- "https://github.com/sigstore/cosign/blob/286a98a4a99c1b2f32f84b0d560e324100312280/pkg/oci/remote/signatures.go#L56-L70"
- "https://github.com/sigstore/cosign/releases/tag/v2.2.4"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:N/I:N/A:H"
uuid: "e08fb50d-26a6-4be1-971e-8e01b4b674f5"
cwe_ids:
- "CWE-770"
- "CWE-937"
- "CWE-1035"
