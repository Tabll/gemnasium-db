---
identifier: "CVE-2023-48312"
identifiers:
- "GHSA-fpvw-6m5v-hqfp"
- "CVE-2023-48312"
package_slug: "go/github.com/clastix/capsule-proxy"
title: "Improper Authentication"
description: "capsule-proxy is a reverse proxy for the capsule operator project. Affected
  versions are subject to a privilege escalation vulnerability which is based on a
  missing check if the user is authenticated based on the `TokenReview` result. All
  the clusters running with the `anonymous-auth` Kubernetes API Server setting disable
  (set to `false`) are affected since it would be possible to bypass the token review
  mechanism, interacting with the upper Kubernetes API Server. This privilege escalation
  cannot be exploited if you're relying only on client certificates (SSL/TLS). This
  vulnerability has been addressed in version 0.4.6. Users are advised to upgrade."
date: "2023-11-24"
pubdate: "2023-11-24"
affected_range: "<=v0.4.5"
fixed_versions:
- "v0.4.6"
affected_versions: "All versions up to 0.4.5"
not_impacted: "All versions after 0.4.5"
solution: "Upgrade to version 0.4.6 or above."
urls:
- "https://github.com/projectcapsule/capsule-proxy/security/advisories/GHSA-fpvw-6m5v-hqfp"
- "https://github.com/advisories/GHSA-fpvw-6m5v-hqfp"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "b2172057-21fd-46d6-8562-e6b1ba254986"
cwe_ids:
- "CWE-1035"
- "CWE-287"
- "CWE-937"
versions:
- number: "v0.4.5"
  commit:
    tags:
    - "v0.4.5"
    sha: "f7bf2ca6221fac08663fe602129bf2c136f3c57d"
    timestamp: "20231106084946"
- number: "v0.4.6"
  commit:
    tags:
    - "v0.4.6"
    sha: "404433d3f6d371e0635dc7fd834f5fd4be76a57c"
    timestamp: "20231123113705"
