---
identifier: "CVE-2023-46254"
identifiers:
- "CVE-2023-46254"
- "GHSA-6758-979h-249x"
package_slug: "go/github.com/clastix/capsule"
title: "Improper Access Control"
description: "capsule-proxy is a reverse proxy for Capsule kubernetes multi-tenancy
  framework. A bug in the RoleBinding reflector used by `capsule-proxy` gives ServiceAccount
  tenant owners the right to list Namespaces of other tenants backed by the same owner
  kind and name. For example consider two tenants `solar` and `wind`. Tenant `solar`,
  owned by a ServiceAccount named `tenant-owner` in the Namespace `solar`. Tenant
  `wind`, owned by a ServiceAccount named `tenant-owner` in the Namespace `wind`.
  The Tenant owner `solar` would be able to list the namespaces of the Tenant `wind`
  and vice-versa, although this is not correct. The bug introduces an exfiltration
  vulnerability since allows the listing of Namespace resources of other Tenants,
  although just in some specific conditions: 1. `capsule-proxy` runs with the `--disable-caching=false`
  (default value: `false`) and 2. Tenant owners are ServiceAccount, with the same
  resource name, but in different Namespaces. This vulnerability does not allow any
  privilege escalation on the outer tenant Namespace-scoped resources, since the Kubernetes
  RBAC is enforcing this. This issue has been addressed in version 0.4.5. Users are
  advised to upgrade. There are no known workarounds for this vulnerability."
date: "2023-11-14"
pubdate: "2023-11-06"
affected_range: "<v0.4.5"
fixed_versions:
- "v0.4.5"
affected_versions: "All versions before 0.4.5"
not_impacted: ""
solution: "Upgrade to version 0.4.5 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-46254"
- "https://github.com/projectcapsule/capsule-proxy/commit/615202f7b02eaec7681336bd63daed1f39ae00c5"
- "https://github.com/projectcapsule/capsule-proxy/security/advisories/GHSA-6758-979h-249x"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N"
uuid: "c6d8efd6-ce88-42c3-bff1-8f910067cee1"
cwe_ids:
- "CWE-1035"
- "CWE-937"
versions: []
