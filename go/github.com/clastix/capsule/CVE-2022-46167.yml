---
identifier: "CVE-2022-46167"
identifiers:
- "CVE-2022-46167"
- "GHSA-x45c-cvp8-q4fm"
package_slug: "go/github.com/clastix/capsule"
title: "Incorrect Authorization"
description: "Capsule is a multi-tenancy and policy-based framework for Kubernetes.
  Prior to version 0.1.3, a ServiceAccount deployed in a Tenant Namespace, when granted
  with `PATCH` capabilities on its own Namespace, is able to edit it and remove the
  Owner Reference, breaking the reconciliation of the Capsule Operator and removing
  all the enforcement like Pod Security annotations, Network Policies, Limit Range
  and Resource Quota items. An attacker could detach the Namespace from a Tenant that
  is forbidding starting privileged Pods using the Pod Security labels by removing
  the OwnerReference, removing the enforcement labels, and being able to start privileged
  containers that would be able to start a generic Kubernetes privilege escalation.
  Patches have been released for version 0.1.3. No known workarounds are available."
date: "2023-11-09"
pubdate: "2022-12-02"
affected_range: "<v0.1.3"
fixed_versions:
- "v0.1.3"
affected_versions: "All versions before 0.1.3"
not_impacted: "All versions starting from 0.1.3"
solution: "Upgrade to version 0.1.3 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-46167"
- "https://github.com/clastix/capsule/security/advisories/GHSA-x45c-cvp8-q4fm"
- "https://github.com/clastix/capsule/commit/1df430e71be8c4778c82eca3459978ad7d0b4b7b"
- "https://github.com/clastix/capsule/commit/75525ac19254b0c5111e34d7985e2be7bc8b1ac1"
- "https://github.com/clastix/capsule/releases/tag/v0.1.3"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
uuid: "e920dce2-8f08-4278-98dd-fd476fb6dbdf"
cwe_ids:
- "CWE-1035"
- "CWE-863"
- "CWE-937"
versions:
- number: "v0.1.3"
  commit:
    tags:
    - "helm-v0.1.12"
    - "v0.1.3"
    sha: "eba072c88dfcff9348d870d03b74ad3737a528b1"
    timestamp: "20221202144341"
