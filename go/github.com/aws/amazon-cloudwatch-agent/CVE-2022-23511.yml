---
identifier: "CVE-2022-23511"
identifiers:
- "CVE-2022-23511"
- "GHSA-j8x2-2m5w-j939"
package_slug: "go/github.com/aws/amazon-cloudwatch-agent"
title: "Improper Handling of Insufficient Privileges"
description: "A privilege escalation issue exists within the Amazon CloudWatch Agent
  for Windows, software for collecting metrics and logs from Amazon EC2 instances
  and on-premises servers, in versions up to and including v1.247354. When users trigger
  a repair of the Agent, a pop-up window opens with SYSTEM permissions. Users with
  administrative access to affected hosts may use this to create a new command prompt
  as NT AUTHORITY\\SYSTEM. To trigger this issue, the third party must be able to
  access the affected host and elevate their privileges such that they're able to
  trigger the agent repair process. They must also be able to install the tools required
  to trigger the issue. This issue does not affect the CloudWatch Agent for macOS
  or Linux. Agent users should upgrade to version 1.247355 of the CloudWatch Agent
  to address this issue. There is no recommended work around. Affected users must
  update the installed version of the CloudWatch Agent to address this issue."
date: "2023-01-25"
pubdate: "2022-12-12"
affected_range: "<v1.247355"
fixed_versions:
- "v1.247355"
affected_versions: "All versions before 1.247355"
not_impacted: ""
solution: "Upgrade to version 1.247355 or above."
urls:
- "https://github.com/aws/amazon-cloudwatch-agent/security/advisories/GHSA-j8x2-2m5w-j939"
- "https://github.com/aws/amazon-cloudwatch-agent/commit/6119858864c317ff26f41f576c169148d1250837"
- "https://nvd.nist.gov/vuln/detail/CVE-2022-23511"
- "https://github.com/aws/amazon-cloudwatch-agent/commit/6119858864c317ff26f41f576c169148d1250837#diff-76ed074a9305c04054cdebb9e9aad2d818052b07091de1f20cad0bbac34ffb52"
- "https://github.com/advisories/GHSA-j8x2-2m5w-j939"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:H/I:H/A:H"
uuid: "cf47ce9e-f92b-4396-9493-47e64d257ca5"
cwe_ids:
- "CWE-1035"
- "CWE-274"
- "CWE-937"
versions:
- number: "v1.247355"
  commit:
    tags:
    - "v1.247355.0"
    sha: "6119858864c317ff26f41f576c169148d1250837"
    timestamp: "20220808170055"
