---
identifier: "CVE-2024-27920"
identifiers:
- "CVE-2024-27920"
- "GHSA-w5wx-6g2r-r78q"
package_slug: "go/github.com/projectdiscovery/nuclei/v3"
title: "Nuclei allows unsigned code template execution through workflows"
description: "### Overview\nA significant security oversight was identified in Nuclei
  v3, involving the execution of unsigned code templates through workflows. This vulnerability
  specifically affects users utilizing custom workflows, potentially allowing the
  execution of malicious code on the user's system. This advisory outlines the impacted
  users, provides details on the security patch, and suggests mitigation strategies.\n\n###
  Affected Users\n1. **CLI Users:** Those executing custom workflows from untrusted
  sources. This includes workflows authored by third parties or obtained from unverified
  repositories.\n2. **SDK Users:** Developers integrating Nuclei into their platforms,
  particularly if they permit the execution of custom workflows by end-users.\n\n###
  Security Patch\nThe vulnerability is addressed in Nuclei v3.2.0. Users are strongly
  recommended to update to this version to mitigate the security risk.\n\n### Mitigation\n-
  **Immediate Upgrade:** The primary recommendation is to upgrade to Nuclei v3.2.0,
  where the vulnerability has been patched.\n- **Avoid Untrusted Workflows:** As an
  interim measure, users should refrain from using custom workflows if unable to upgrade
  immediately. Only trusted, verified workflows should be executed.\n\n### Details\nThe
  vulnerability stems from an oversight in the workflow execution mechanism, where
  unsigned code templates could be executed, bypassing the security measures intended
  to authenticate the integrity and source of the templates. This issue is isolated
  to workflow executions and does not affect direct template executions.\n\n### Workarounds\nThe
  only effective workaround, aside from upgrading, is to avoid the use of custom workflows
  altogether. This approach limits functionality but ensures security until the upgrade
  can be performed.\n\n### Acknowledgements\nWe extend our sincere gratitude to @gpc1996
  for their diligence in identifying and reporting this vulnerability.\n\n### References\n-
  Security Patch Pull Request: [GitHub PR #4822](https://github.com/projectdiscovery/nuclei/pull/4822)\n-
  Workflows Overview: [Nuclei Workflows Documentation](https://docs.projectdiscovery.io/templates/workflows/overview)\n-
  Code Template Reference: [Nuclei Code Protocols Documentation](https://docs.projectdiscovery.io/templates/protocols/code)\n-
  Template Signing Reference: [Nuclei Template Signing Documentation](https://docs.projectdiscovery.io/templates/reference/template-signing)"
date: "2024-03-15"
pubdate: "2024-03-15"
affected_range: ">=3.0.0 <3.2.0"
fixed_versions:
- "3.2.0"
affected_versions: "All versions starting from 3.0.0 before 3.2.0"
not_impacted: "All versions before 3.0.0, all versions starting from 3.2.0"
solution: "Upgrade to version 3.2.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-27920"
- "https://github.com/advisories/GHSA-w5wx-6g2r-r78q"
- "https://github.com/projectdiscovery/nuclei/security/advisories/GHSA-w5wx-6g2r-r78q"
- "https://github.com/projectdiscovery/nuclei/pull/4822"
- "https://github.com/projectdiscovery/nuclei/commit/e86f38299765b82ad724fdb701557e0eaff3884d"
- "https://github.com/projectdiscovery/nuclei"
cvss_v3: "CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:N"
uuid: "37e5c9e6-99ce-46b4-a328-92177fe16d4d"
cwe_ids:
- "CWE-78"
- "CWE-937"
- "CWE-1035"
