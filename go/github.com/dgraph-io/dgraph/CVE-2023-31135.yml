---
identifier: "CVE-2023-31135"
identifiers:
- "CVE-2023-31135"
- "GHSA-92wq-q9pq-gw47"
package_slug: "go/github.com/dgraph-io/dgraph"
title: "Inadequate Encryption Strength"
description: "Dgraph is an open source distributed GraphQL database. Existing Dgraph
  audit logs is vulnerable to brute force attacks due to nonce collisions. The first
  12 bytes come from a baseIv which is initialized when an audit log is created. The
  last 4 bytes come from the length of the log line being encrypted. This is problematic
  because two log lines will often have the same length, so due to these collisions
  we are reusing the same nonce many times. All audit logs generated by versions of
  Dgraph <v23.0.0 are affected. Attackers must have access to the system the logs
  are stored on. Dgraph users should upgrade to v23.0.0. Users unable to upgrade should
  store existing audit logs in a secure location and for extra security, encrypt using
  an external tool like `gpg`."
date: "2023-05-25"
pubdate: "2023-05-17"
affected_range: "<v23.0.0"
fixed_versions:
- "v23.0.0"
affected_versions: "All versions before 23.0.0"
not_impacted: "All versions starting from 23.0.0"
solution: "Upgrade to version 23.0.0 or above."
urls:
- "https://github.com/dgraph-io/dgraph/security/advisories/GHSA-92wq-q9pq-gw47"
- "https://github.com/dgraph-io/dgraph/pull/8323"
- "https://github.com/dgraph-io/dgraph/releases/tag/v23.0.0"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-31135"
- "https://en.wikipedia.org/wiki/Cryptographic_nonce"
- "https://github.com/advisories/GHSA-92wq-q9pq-gw47"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"
uuid: "3404153f-c94b-4455-b9e6-7b650f134d6b"
cwe_ids:
- "CWE-1035"
- "CWE-326"
- "CWE-937"
versions:
- number: "v23.0.0"
  commit:
    tags:
    - "v23.0.0"
    sha: "38980bc4a44352094c15ddfe4b606a8f05b48e81"
    timestamp: "20230508215612"
