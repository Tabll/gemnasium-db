---
identifier: "CVE-2024-24557"
identifiers:
- "GHSA-xw73-rw38-6vjc"
- "CVE-2024-24557"
package_slug: "go/github.com/moby/moby"
title: "Origin Validation Error"
description: "Moby is an open-source project created by Docker to enable software
  containerization. The classic builder cache system is prone to cache poisoning if
  the image is built FROM scratch. Also, changes to some instructions (most important
  being HEALTHCHECK and ONBUILD) would not cause a cache miss. An attacker with the
  knowledge of the Dockerfile someone is using could poison their cache by making
  them pull a specially crafted image that would be considered as a valid cache candidate
  for some build steps. 23.0+ users are only affected if they explicitly opted out
  of Buildkit (DOCKER_BUILDKIT=0 environment variable) or are using the /build API
  endpoint. All users on versions older than 23.0 could be impacted. Image build API
  endpoint (/build) and ImageBuild function from github.com/docker/docker/client is
  also affected as it the uses classic builder by default. Patches are included in
  24.0.9 and 25.0.2 releases."
date: "2024-02-01"
pubdate: "2024-02-01"
affected_range: "<24.0.9||>=25.0.0 <25.0.2"
fixed_versions:
- "24.0.9"
- "25.0.2"
affected_versions: "All versions before 24.0.9, all versions starting from 25.0.0
  before 25.0.2"
not_impacted: "All versions starting from 24.0.9 before 25.0.0, all versions starting
  from 25.0.2"
solution: "Upgrade to versions 24.0.9, 25.0.2 or above."
urls:
- "https://github.com/moby/moby/security/advisories/GHSA-xw73-rw38-6vjc"
- "https://nvd.nist.gov/vuln/detail/CVE-2024-24557"
- "https://github.com/moby/moby/commit/3e230cfdcc989dc524882f6579f9e0dac77400ae"
- "https://github.com/moby/moby/commit/fca702de7f71362c8d103073c7e4a1d0a467fadd"
- "https://github.com/moby/moby/commit/fce6e0ca9bc000888de3daa157af14fa41fcd0ff"
- "https://github.com/advisories/GHSA-xw73-rw38-6vjc"
cvss_v3: "CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:C/C:L/I:H/A:L"
uuid: "cddd9630-e771-44f2-b497-3de46a8ce133"
cwe_ids:
- "CWE-1035"
- "CWE-345"
- "CWE-346"
- "CWE-937"
