---
identifier: "CVE-2021-41091"
identifiers:
- "GHSA-3fwx-pjgw-3558"
- "CVE-2021-41091"
package_slug: "go/github.com/moby/moby"
title: "Improper Preservation of Permissions"
description: "Moby is an open-source project created by Docker to enable software
  containerization. A bug was found in Moby (Docker Engine) where the data directory
  (typically `/var/lib/docker`) contained subdirectories with insufficiently restricted
  permissions, allowing otherwise unprivileged Linux users to traverse directory contents
  and execute programs. When containers included executable programs with extended
  permission bits (such as `setuid`), unprivileged Linux users could discover and
  execute those programs. When the UID of an unprivileged Linux user on the host collided
  with the file owner or group inside a container, the unprivileged Linux user on
  the host could discover, read, and modify those files. This bug has been fixed in
  Moby (Docker Engine) 20.10.9. Users should update to this version as soon as possible.
  Running containers should be stopped and restarted for the permissions to be fixed.
  For users unable to upgrade limit access to the host to trusted users. Limit access
  to host volumes to trusted containers."
date: "2024-01-31"
pubdate: "2024-01-31"
affected_range: "<20.10.9"
fixed_versions:
- "20.10.9"
affected_versions: "All versions before 20.10.9"
not_impacted: "All versions starting from 20.10.9"
solution: "Upgrade to version 20.10.9 or above."
urls:
- "https://github.com/moby/moby/security/advisories/GHSA-3fwx-pjgw-3558"
- "https://nvd.nist.gov/vuln/detail/CVE-2021-41091"
- "https://github.com/moby/moby/commit/f0ab919f518c47240ea0e72d0999576bb8008e64"
- "https://cert-portal.siemens.com/productcert/pdf/ssa-222547.pdf"
- "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/B5Q6G6I4W5COQE25QMC7FJY3I3PAYFBB/"
- "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZNFADTCHHYWVM6W4NJ6CB4FNFM2VMBIB/"
- "https://github.com/advisories/GHSA-3fwx-pjgw-3558"
cvss_v2: "AV:L/AC:L/Au:N/C:P/I:P/A:P"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L"
uuid: "064e72fa-063d-461b-9cfc-0e9818e8b0b0"
cwe_ids:
- "CWE-1035"
- "CWE-281"
- "CWE-937"
