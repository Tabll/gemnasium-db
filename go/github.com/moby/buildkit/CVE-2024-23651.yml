---
identifier: "CVE-2024-23651"
identifiers:
- "GHSA-m3r6-h7wv-7xxv"
- "CVE-2024-23651"
package_slug: "go/github.com/moby/buildkit"
title: "Concurrent Execution using Shared Resource with Improper Synchronization ('Race
  Condition')"
description: "BuildKit is a toolkit for converting source code to build artifacts
  in an efficient, expressive and repeatable manner. Two malicious build steps running
  in parallel sharing the same cache mounts with subpaths could cause a race condition
  that can lead to files from the host system being accessible to the build container.
  The issue has been fixed in v0.12.5. Workarounds include, avoiding using BuildKit
  frontend from an untrusted source or building an untrusted Dockerfile containing
  cache mounts with --mount=type=cache,source=... options.\n"
date: "2024-01-31"
pubdate: "2024-01-31"
affected_range: "<v0.12.5"
fixed_versions:
- "v0.12.5"
affected_versions: "All versions before 0.12.5"
not_impacted: "All versions starting from 0.12.5"
solution: "Upgrade to version 0.12.5 or above."
urls:
- "https://github.com/moby/buildkit/security/advisories/GHSA-m3r6-h7wv-7xxv"
- "https://github.com/moby/buildkit/pull/4604"
- "https://github.com/advisories/GHSA-m3r6-h7wv-7xxv"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:N"
uuid: "ee41dcdb-ee4b-4b58-af9c-e7529fa16853"
cwe_ids:
- "CWE-1035"
- "CWE-362"
- "CWE-937"
versions:
- number: "v0.12.5"
  commit:
    tags:
    - "v0.12.5"
    sha: "bac3f2b673f3f9d33e79046008e7a38e856b3dc6"
    timestamp: "20240131194315"
