---
identifier: "CVE-2024-23652"
identifiers:
- "GHSA-4v98-7qmw-rqr8"
- "CVE-2024-23652"
package_slug: "go/github.com/moby/buildkit"
title: "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
description: "BuildKit is a toolkit for converting source code to build artifacts
  in an efficient, expressive and repeatable manner. A malicious BuildKit frontend
  or Dockerfile using RUN --mount could trick the feature that removes empty files
  created for the mountpoints into removing a file outside the container, from the
  host system. The issue has been fixed in v0.12.5. Workarounds include avoiding using
  BuildKit frontends from an untrusted source or building an untrusted Dockerfile
  containing RUN --mount feature."
date: "2024-01-31"
pubdate: "2024-01-31"
affected_range: "<v0.12.5"
fixed_versions:
- "v0.12.5"
affected_versions: "All versions before 0.12.5"
not_impacted: "All versions starting from 0.12.5"
solution: "Upgrade to version 0.12.5 or above."
urls:
- "https://github.com/moby/buildkit/security/advisories/GHSA-4v98-7qmw-rqr8"
- "https://github.com/moby/buildkit/pull/4603"
- "https://github.com/advisories/GHSA-4v98-7qmw-rqr8"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:H"
uuid: "1a1ab50d-c294-49fb-88bb-ace572177e4a"
cwe_ids:
- "CWE-1035"
- "CWE-22"
- "CWE-937"
versions:
- number: "v0.12.5"
  commit:
    tags:
    - "v0.12.5"
    sha: "bac3f2b673f3f9d33e79046008e7a38e856b3dc6"
    timestamp: "20240131194315"
