---
identifier: "CVE-2023-43651"
identifiers:
- "GHSA-4r5x-x283-wm96"
- "CVE-2023-43651"
package_slug: "go/github.com/jumpserver/koko"
title: "Improper Control of Generation of Code ('Code Injection')"
description: "JumpServer is an open source bastion host. An authenticated user can
  exploit a vulnerability in MongoDB sessions to execute arbitrary commands, leading
  to remote code execution. This vulnerability may further be leveraged to gain root
  privileges on the system. Through the WEB CLI interface provided by the koko component,
  a user logs into the authorized mongoDB database and exploits the MongoDB session
  to execute arbitrary commands. This vulnerability has been addressed in versions
  2.28.20 and 3.7.1. Users are advised to upgrade. There are no known workarounds
  for this vulnerability."
date: "2023-10-24"
pubdate: "2023-10-24"
affected_range: ">=v2.0.0 <v2.28.20 || >=v3.0.0 <v3.7.1"
fixed_versions:
- "v2.28.20"
- "v3.7.1"
affected_versions: "All versions starting from 2.0.0 before 2.28.20, all versions
  starting from 3.0.0 before 3.7.1"
not_impacted: "All versions before 2.0.0, all versions starting from 2.28.20 before
  3.0.0, all versions starting from 3.7.1"
solution: "Upgrade to versions 2.28.20, 3.7.1 or above."
urls:
- "https://github.com/jumpserver/jumpserver/security/advisories/GHSA-4r5x-x283-wm96"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-43651"
- "https://github.com/jumpserver/koko/commit/7d80db95d17c8f42bdf50260dfc21dc2bd0452c2"
- "https://github.com/jumpserver/koko/commit/857f8b9e41f0930dc6190a35d8601fffa5e884e7"
- "https://github.com/advisories/GHSA-4r5x-x283-wm96"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H"
uuid: "68c99817-17fd-4f07-8237-6fb3c093aa5b"
cwe_ids:
- "CWE-1035"
- "CWE-78"
- "CWE-937"
- "CWE-94"
versions:
- number: "v2.0.0"
  commit:
    tags:
    - "2.0.0"
    - "2.0.1"
    sha: "2ca831dc4aa8673841d5eb8cc65c9a24f338d716"
    timestamp: "20200618023830"
- number: "v3.0.0"
  commit:
    tags:
    - "v3.0.0"
    sha: "65db7dcb45d39654c1e59d6e39edc0298b2e24d9"
    timestamp: "20230223131327"
- number: "v3.7.1"
  commit:
    tags:
    - "v3.7.1"
    sha: "eaa153199b003175d1a194db6629c13381bb5e05"
    timestamp: "20230926050130"
- number: "v2.28.20"
  commit:
    tags:
    - "v2.28.20"
    sha: "e3c4a19467c6192638e6228a7dc1b5379029b223"
    timestamp: "20230926064143"
