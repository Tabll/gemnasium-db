---
identifier: "CVE-2023-22726"
identifiers:
- "CVE-2023-22726"
- "GHSA-pc99-qmg4-rcff"
package_slug: "go/github.com/nektos/act"
title: "Unrestricted Upload of File with Dangerous Type"
description: "act is a project which allows for local running of github actions. The
  artifact server that stores artifacts from Github Action runs does not sanitize
  path inputs. This allows an attacker to download and overwrite arbitrary files on
  the host from a Github Action. This issue may lead to privilege escalation. The
  /upload endpoint is vulnerable to path traversal as filepath is user controlled,
  and ultimately flows into os.Mkdir and os.Open. The /artifact endpoint is vulnerable
  to path traversal as the path is variable is user controlled, and the specified
  file is ultimately returned by the server. This has been addressed in version 0.2.40.
  Users are advised to upgrade. Users unable to upgrade may, during implementation
  of Open and OpenAtEnd for FS, ensure to use ValidPath() to check against path traversal
  or clean the user-provided paths manually."
date: "2023-02-03"
pubdate: "2023-01-20"
affected_range: "<v0.2.40"
fixed_versions:
- "v0.2.40"
affected_versions: "All versions before 0.2.40"
not_impacted: ""
solution: "Upgrade to version 0.2.40 or above."
urls:
- "https://github.com/nektos/act/security/advisories/GHSA-pc99-qmg4-rcff"
- "https://github.com/nektos/act/commit/63ae215071f94569d910964bdee866d91d6e3a10"
- "https://github.com/nektos/act/blob/v0.2.35/pkg/artifacts/server.go#LL103C2-L103C2"
- "https://github.com/nektos/act/releases/tag/v0.2.40"
- "https://github.com/advisories/GHSA-pc99-qmg4-rcff"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
uuid: "787d7599-63a7-419b-b4c5-080f6a81ca53"
cwe_ids:
- "CWE-1035"
- "CWE-22"
- "CWE-937"
versions:
- number: "v0.2.40"
  commit:
    tags:
    - "v0.2.40"
    sha: "9e5ecdd56cfb2e3567298f8ffce4f41aecd2f6bc"
    timestamp: "20230116213504"
