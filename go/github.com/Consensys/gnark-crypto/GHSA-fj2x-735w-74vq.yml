---
identifier: "GHSA-fj2x-735w-74vq"
identifiers:
- "GHSA-fj2x-735w-74vq"
package_slug: "go/github.com/Consensys/gnark-crypto"
title: "gnark-crypto allows unchecked memory allocation during vector deserialization"
description: "The issue has been reported by @raefko from @fuzzinglabs. Excerpts from
  the report:\n> A critical vulnerability exists in the gnark-crypto library's `Vector.ReadFrom()` function
  that allows an attacker to trigger arbitrary memory allocation by crafting malicious
  input data. An attacker can cause the verifier to attempt allocating up to 128 GB
  of memory with a minimal malicious input, leading to out-of-memory crashes and denial
  of service.\n> ### **Root Cause**\n>\n>\n> The vulnerability stems from **unchecked
  deserialization** of attacker-controlled length fields in the gnark-crypto library's `Vector.ReadFrom()` function.
  The function reads a 4-byte unsigned integer from untrusted input and directly uses
  it to allocate memory without any validation or bounds checking.\n>\n> ### **Vulnerable
  Code Path**\n>\n> ```\n> User Input (Malicious Proof/Data)\n>          ↓\n> gnark
  Proof/Data Deserialization\n>          ↓\n> Vector.ReadFrom() (ecc/bn254/fr/vector.go:136-144)\n>
  \  → sliceLen := binary.BigEndian.Uint32(buf[:4])   // ← ATTACKER-CONTROLLED\n>
  \  → (*vector) = make(Vector, sliceLen)             // ← UNCHECKED ALLOCATION\n>
  \         ↓\n> runtime.makeslice attempts 100+ GB allocation\n>          ↓\n> fatal
  error: runtime: out of memory → SIGABRT\n>\n> ```\n>\n> ### **Vulnerable Code**\n>\n>
  **File**: [`gnark-crypto@v0.14.0+/ecc/bn254/fr/vector.go:136-144`](https://github.com/Consensys/gnark-crypto/blob/8310aae2de6104d3fe3610e3370b2bed10c63111/ecc/bn254/fr/vector.go#L136)\n>\n>
  The code reads a 4-byte big-endian unsigned integer (`sliceLen`) directly from the
  input stream and uses it to allocate a slice without any bounds checking or validation.
  Each element is 32 bytes (fr.Element for BN254 curve), so an attacker can request
  up to:\n>\n> **Maximum Allocation**: `2^32 elements × 32 bytes = 137,438,953,472
  bytes ≈ 128 GB`\n>\n> ## **Root Cause Analysis**\n>\n> The gnark-crypto library
  implements a generic serialization format for field element vectors. The format
  is:\n>\n> ```\n> [4 bytes: length (n)] [n × 32 bytes: elements]\n> ```\n>\n> The
  deserialization code **trusts** the length field implicitly without any validation.
  This is a classic **integer-to-allocation vulnerability** pattern, similar to issues
  that have affected many serialization libraries over the years."
date: "2025-10-30"
pubdate: "2025-10-30"
affected_range: ">=0.9.1 <0.18.1||>=0.19.0 <0.19.2||=0.19.0"
fixed_versions:
- "0.18.1"
- "0.19.2"
affected_versions: "All versions starting from 0.9.1 before 0.18.1, all versions starting
  from 0.19.0 before 0.19.2, version 0.19.0"
not_impacted: ""
solution: "Upgrade to versions 0.18.1, 0.19.2 or above."
urls:
- "https://github.com/advisories/GHSA-fj2x-735w-74vq"
- "https://github.com/Consensys/gnark-crypto/security/advisories/GHSA-fj2x-735w-74vq"
- "https://github.com/Consensys/gnark-crypto/pull/759"
- "https://github.com/Consensys/gnark-crypto/commit/2e7bf9190a0aac896eeec3876c87c77a35661be7"
- "https://github.com/Consensys/gnark-crypto"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
uuid: "05ddff5a-4e93-4923-bf20-d68b4018ca10"
cwe_ids:
- "CWE-400"
- "CWE-937"
- "CWE-1035"
