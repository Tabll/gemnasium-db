---
identifier: "CVE-2022-39395"
identifiers:
- "CVE-2022-39395"
- "GHSA-5m7g-pj8w-7593"
- "GHSA-xf39-98m2-889v"
- "GHSA-2w78-ffv6-p46w"
- "GMS-2022-6556"
package_slug: "go/github.com/go-vela/server"
title: "Improper Privilege Management"
description: "Vela is a Pipeline Automation (CI/CD) framework built on Linux container
  technology written in Golang. In Vela Server and Vela Worker prior to version 0.16.0
  and Vela UI prior to version 0.17.0, some default configurations for Vela allow
  exploitation and container breakouts. Users should upgrade to Server 0.16.0, Worker
  0.16.0, and UI 0.17.0 to fix the issue. After upgrading, Vela administrators will
  need to explicitly change the default settings to configure Vela as desired. Some
  of the fixes will interrupt existing workflows and will require Vela administrators
  to modify default settings. However, not applying the patch (or workarounds) will
  continue existing risk exposure. Some workarounds are available. Vela administrators
  can adjust the worker's `VELA_RUNTIME_PRIVILEGED_IMAGES` setting to be explicitly
  empty, leverage the `VELA_REPO_ALLOWLIST` setting on the server component to restrict
  access to a list of repositories that are allowed to be enabled, and/or audit enabled
  repositories and disable pull_requests if they are not needed."
date: "2022-11-17"
pubdate: "2022-11-10"
affected_range: "<v0.16.0"
fixed_versions:
- "v0.16.0"
affected_versions: "All versions before 0.16.0"
not_impacted: ""
solution: "Upgrade to version 0.16.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-39395"
- "https://go-vela.github.io/docs/installation/server/reference/#vela_repo_allowlist"
- "https://github.com/go-vela/worker/releases/tag/v0.16.0"
- "https://github.com/go-vela/server/commit/05558ee99d70f7d6f83bed7c8f78ac0b35fa26f4"
- "https://docs.docker.com/engine/security/#docker-daemon-attack-surface"
- "https://github.com/go-vela/ui/releases/tag/v0.17.0"
- "https://github.com/go-vela/server/security/advisories/GHSA-5m7g-pj8w-7593"
- "https://go-vela.github.io/docs/installation/worker/reference/#vela_runtime_privileged_images"
- "https://github.com/go-vela/ui/security/advisories/GHSA-xf39-98m2-889v"
- "https://github.com/go-vela/worker/security/advisories/GHSA-2w78-ffv6-p46w"
- "https://github.com/go-vela/server/releases/tag/v0.16.0"
- "https://advisory-inbox.githubapp.com/advisory_reviews/GHSA-xf39-98m2-889v"
- "https://github.com/advisories/GHSA-5m7g-pj8w-7593"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H"
uuid: "f2fd47fa-40c6-4fee-8352-2234b297c723"
cwe_ids:
- "CWE-1035"
- "CWE-269"
- "CWE-937"
versions:
- number: "v0.16.0"
  commit:
    tags:
    - "v0.16.0"
    sha: "e972584299eb9989525aa62df9438d9bd60429f1"
    timestamp: "20221109161535"
