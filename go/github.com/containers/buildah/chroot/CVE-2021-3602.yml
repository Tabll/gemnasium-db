---
identifier: "CVE-2021-3602"
identifiers:
- "GHSA-7638-r9r3-rmjj"
- "CVE-2021-3602"
package_slug: "go/github.com/containers/buildah/chroot"
title: "Improper Removal of Sensitive Information Before Storage or Transfer"
description: "An information disclosure flaw was found in Buildah, when building containers
  using chroot isolation. Running processes in container builds (e.g. Dockerfile RUN
  commands) can access environment variables from parent and grandparent processes.
  When run in a container in a CI/CD environment, environment variables may include
  sensitive information that was shared with the container in order to be used only
  by Buildah itself (e.g. container registry credentials)."
date: "2023-02-07"
pubdate: "2021-07-19"
affected_range: "<=v1.16.7 || >=v1.17.0 <=v1.17.1 || >=v1.18.0 <=v1.19.8 || >=v1.20.0
  <=v1.21.2"
fixed_versions:
- "v1.16.8"
- "v1.17.2"
- "v1.19.9"
- "v1.21.3"
affected_versions: "All versions up to 1.16.7, all versions starting from 1.17.0 up
  to 1.17.1, all versions starting from 1.18.0 up to 1.19.8, all versions starting
  from 1.20.0 up to 1.21.2"
not_impacted: "All versions after 1.16.7 before 1.17.0, all versions after 1.17.1
  before 1.18.0, all versions after 1.19.8 before 1.20.0, all versions after 1.21.2"
solution: "Upgrade to versions 1.16.8, 1.17.2, 1.19.9, 1.21.3 or above."
urls:
- "https://github.com/containers/buildah/security/advisories/GHSA-7638-r9r3-rmjj"
- "https://nvd.nist.gov/vuln/detail/CVE-2021-3602"
- "https://github.com/containers/buildah/commit/a468ce0ffd347035d53ee0e26c205ef604097fb0"
- "https://bugzilla.redhat.com/show_bug.cgi?id=1969264"
- "https://ubuntu.com/security/CVE-2021-3602"
- "https://pkg.go.dev/vuln/GO-2022-0345"
- "https://github.com/advisories/GHSA-7638-r9r3-rmjj"
cvss_v2: "AV:L/AC:M/Au:N/C:P/I:N/A:N"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"
uuid: "6b7d036f-c564-451f-885e-be898c76fbbe"
cwe_ids:
- "CWE-1035"
- "CWE-212"
- "CWE-937"
versions:
- number: "v1.17.0"
  commit:
    tags:
    - "v1.17.0"
    sha: "8891d05dbaffc0b6013a48a68177b4ccec281f8c"
    timestamp: "20201029223313"
- number: "v1.18.0"
  commit:
    tags:
    - "v1.18.0"
    sha: "d3a01d0041789ab5967acd04f5c4501a0ba78f64"
    timestamp: "20201116142522"
- number: "v1.17.1"
  commit:
    tags:
    - "v1.17.1"
    sha: "d43312c273bd496449622cd81c58a953b3bb3ca0"
    timestamp: "20201117111805"
- number: "v1.16.7"
  commit:
    tags:
    - "v1.16.7"
    sha: "56ed75b4b8266affb45f5ffa971f5c83f1b96eaa"
    timestamp: "20201130202401"
- number: "v1.19.8"
  commit:
    tags:
    - "v1.19.8"
    sha: "d1c9523dcfb96a286c78da317fb3844ddd5b6476"
    timestamp: "20210308150108"
- number: "v1.20.0"
  commit:
    tags:
    - "v1.20.0"
    sha: "293e02ac068513a08c38dbe434dea73560f90c25"
    timestamp: "20210325172806"
- number: "v1.21.2"
  commit:
    tags:
    - "v1.21.2"
    sha: "af2a1d4d762a627e01a87f4aab4dd0c1876df6b6"
    timestamp: "20210629140807"
- number: "v1.21.3"
  commit:
    tags:
    - "v1.21.3"
    sha: "7f9540d2ab9037b7e175a4d1b36e85fc6541aeb5"
    timestamp: "20210715140926"
- number: "v1.17.2"
  commit:
    tags:
    - "v1.17.2"
    sha: "7219dd09b6f8077f647ec8add765224dc247b2f6"
    timestamp: "20210715140926"
- number: "v1.16.8"
  commit:
    tags:
    - "v1.16.8"
    sha: "a4caa7bd7436cb4ff607abc4cb27eb076c9442f5"
    timestamp: "20210715140926"
- number: "v1.19.9"
  commit:
    tags:
    - "v1.19.9"
    sha: "c1d6200be31286ea3cd4752ed1464b0f85ea388a"
    timestamp: "20210715140926"
