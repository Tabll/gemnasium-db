---
identifier: "CVE-2024-35192"
identifiers:
- "CVE-2024-35192"
- "GHSA-xcq4-m2r3-cmrj"
package_slug: "go/github.com/aquasecurity/trivy"
title: "Trivy possibly leaks registry credential when scanning images from malicious
  registries"
description: "If a malicious actor is able to trigger Trivy to scan container images
  from a crafted malicious registry, it could result in the leakage of credentials
  for legitimate registries such as AWS Elastic Container Registry (ECR), Google Cloud
  Artifact/Container Registry, or Azure Container Registry (ACR). These tokens can
  then be used to push/pull images from those registries to which the identity/user
  running Trivy has access.\n\nTaking AWS as an example, the leakage only occurs when
  Trivy is able to transparently obtain registry credentials from the default [credential
  provider chain](https://aws.github.io/aws-sdk-go-v2/docs/configuring-sdk/#specifying-credentials).
  You are affected if Trivy is executed in any of the following situations:\n\n- The
  environment variables contain static AWS credentials (AWS_ACCESS_KEY_ID, AWS_SECRET_ACCESS_KEY,
  AWS_SESSION_TOKEN) that have access to ECR.\n- Within a Pod running on an EKS cluster
  that has been assigned a role with access to ECR using an [IAM Roles for Service
  Accounts](https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html)
  (IRSA) annotation.\n- etc.\n\nYou are not affected if the default credential provider
  chain is unable to obtain valid credentials. The same applies to GCP and Azure."
date: "2024-05-20"
pubdate: "2024-05-20"
affected_range: "<0.51.2"
fixed_versions:
- "0.51.2"
affected_versions: "All versions before 0.51.2"
not_impacted: "All versions starting from 0.51.2"
solution: "Upgrade to version 0.51.2 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-35192"
- "https://github.com/advisories/GHSA-xcq4-m2r3-cmrj"
- "https://github.com/aquasecurity/trivy/security/advisories/GHSA-xcq4-m2r3-cmrj"
- "https://github.com/aquasecurity/trivy/commit/e7f14f729de259551203f313e57d2d9d3aa2ff87"
- "https://github.com/aquasecurity/trivy"
cvss_v3: "CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:C/C:H/I:N/A:N"
uuid: "5a876ef8-73d3-4bd2-9305-b7069fca3117"
cwe_ids:
- "CWE-522"
- "CWE-937"
- "CWE-1035"
