---
identifier: "CVE-2020-15229"
identifiers:
- "GHSA-7gcp-w6ww-2xv9"
- "CVE-2020-15229"
package_slug: "go/github.com/sylabs/singularity"
title: "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
description: "Singularity (an open source container platform) from version 3.1.1 through
  3.6.3 has a vulnerability. Due to insecure handling of path traversal and the lack
  of path sanitization within `unsquashfs`, it is possible to overwrite/create any
  files on the host filesystem during the extraction with a crafted squashfs filesystem.
  The extraction occurs automatically for unprivileged (either installation or with
  `allow setuid = no`) run of Singularity when a user attempt to run an image which
  is a local SIF image or a single file containing a squashfs filesystem and is coming
  from remote sources `library://` or `shub://`. Image build is also impacted in a
  more serious way as it can be used by a root user, allowing an attacker to overwrite/create
  files leading to a system compromise, so far bootstrap methods `library`, `shub`
  and `localimage` are triggering the squashfs extraction. This issue is addressed
  in Singularity 3.6.4. All users are advised to upgrade to 3.6.4 especially if they
  use Singularity mainly for building image as root user. There is no solid workaround
  except to temporary avoid to use unprivileged mode with single file images in favor
  of sandbox images instead. Regarding image build, temporary avoid to build from
  `library` and `shub` sources and as much as possible use `--fakeroot` or a VM for
  that."
date: "2021-05-24"
pubdate: "2021-05-24"
affected_range: ">=3.1.1 <3.6.4"
fixed_versions:
- "3.6.4"
affected_versions: "All versions starting from 3.1.1 before 3.6.4"
not_impacted: "All versions before 3.1.1, all versions starting from 3.6.4"
solution: "Upgrade to version 3.6.4 or above."
urls:
- "https://github.com/hpcng/singularity/security/advisories/GHSA-7gcp-w6ww-2xv9"
- "https://nvd.nist.gov/vuln/detail/CVE-2020-15229"
- "https://github.com/hpcng/singularity/pull/5611"
- "https://github.com/hpcng/singularity/commit/eba3dea260b117198fdb6faf41f2482ab2f8d53e"
- "https://github.com/hpcng/singularity/blob/v3.6.4/CHANGELOG.md#security-related-fixes"
- "http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00070.html"
- "http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00071.html"
- "http://lists.opensuse.org/opensuse-security-announce/2020-11/msg00009.html"
- "https://github.com/advisories/GHSA-7gcp-w6ww-2xv9"
cvss_v2: "AV:N/AC:M/Au:N/C:P/I:P/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N"
uuid: "224532ad-62da-40e9-9268-6051bb56c6b1"
cwe_ids:
- "CWE-1035"
- "CWE-22"
- "CWE-352"
- "CWE-937"
