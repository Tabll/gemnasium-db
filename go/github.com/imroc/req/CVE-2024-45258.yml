---
identifier: "CVE-2024-45258"
identifiers:
- "CVE-2024-45258"
- "GHSA-cj55-gc7m-wvcq"
package_slug: "go/github.com/imroc/req"
title: "req may send an unintended request when a malformed URL is provided"
description: "The `req` library is a widely used HTTP library in Go. However, it does
  not handle malformed URLs effectively. As a result, after parsing a malformed URL,
  the library may send HTTP requests to unexpected destinations, potentially leading
  to security vulnerabilities or unintended behavior in applications relying on this
  library for handling HTTP requests.\n\nDespite developers potentially utilizing
  the `net/url` library to parse malformed URLs and implement blocklists to prevent
  HTTP requests to listed URLs, inconsistencies exist between how the `net/url` and
  `req` libraries parse URLs. These discrepancies can lead to the failure of defensive
  strategies, resulting in potential security threats such as Server-Side Request
  Forgery (SSRF) and Remote Code Execution (RCE)."
date: "2024-09-16"
pubdate: "2024-08-26"
affected_range: "<3.43.4"
fixed_versions:
- "3.43.4"
affected_versions: "All versions before 3.43.4"
not_impacted: "All versions starting from 3.43.4"
solution: "Upgrade to version 3.43.4 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-45258"
- "https://github.com/advisories/GHSA-cj55-gc7m-wvcq"
- "https://github.com/imroc/req/commit/04e3ece5b380ecad9da3551c449f1b8a9aa76d3d"
- "https://github.com/imroc/req"
- "https://github.com/imroc/req/compare/v3.43.3...v3.43.4"
- "https://pkg.go.dev/vuln/GO-2024-3098"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "d79787ff-37bf-4519-a988-93f732cd8ca4"
cwe_ids:
- "CWE-20"
- "CWE-918"
- "CWE-94"
- "CWE-937"
- "CWE-1035"
