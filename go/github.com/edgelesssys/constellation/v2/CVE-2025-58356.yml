---
identifier: "CVE-2025-58356"
identifiers:
- "CVE-2025-58356"
- "GHSA-hq76-6gh2-5g4q"
package_slug: "go/github.com/edgelesssys/constellation/v2"
title: "Constellation has insecure LUKS2 persistent storage partitions which may be
  opened and used"
description: "A malicious host may provide a crafted LUKS2 volume to a confidential
  computing guest that is using the [OpenCryptDevice](https://github.com/edgelesssys/constellation/blob/6eff250f16f8ae48221d412550e4a64a4bf0d77b/csi/cryptmapper/cryptmapper.go#L89)
  feature. The guest will open the volume and write secret data using a volume key
  known to the attacker. The attacker can also pre-load data on the device, which
  could potentially compromise guest execution.\n\n\nLUKS2 volume metadata is not
  authenticated and supports null key-encryption algorithms, allowing an attacker
  to create a volume such that the volume:\n- Opens (cryptsetup open) without error
  using any passphrase or token\n- Records all writes in plaintext (or ciphertext
  with an attacker-known key)\n- Contains arbitrary data chosen by the attacker"
date: "2025-11-10"
pubdate: "2025-10-27"
affected_range: "<2.24.0"
fixed_versions:
- "2.24.0"
affected_versions: "All versions before 2.24.0"
not_impacted: "All versions starting from 2.24.0"
solution: "Upgrade to version 2.24.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2025-58356"
- "https://github.com/advisories/GHSA-hq76-6gh2-5g4q"
- "https://github.com/edgelesssys/constellation/security/advisories/GHSA-hq76-6gh2-5g4q"
- "https://github.com/edgelesssys/constellation/pull/3927"
- "https://github.com/edgelesssys/constellation/commit/bb8d2c8a5c0a0a6510d2cc43055be21f4a3ab83c"
- "https://github.com/edgelesssys/constellation"
- "https://github.com/edgelesssys/constellation/releases/tag/v2.24.0"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:N"
cvss_v4: "CVSS:4.0/AV:L/AC:L/AT:N/PR:H/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N"
uuid: "f9acafad-dd5e-4f9e-8179-58922ca93a29"
cwe_ids:
- "CWE-347"
- "CWE-552"
- "CWE-937"
- "CWE-1035"
