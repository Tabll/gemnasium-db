---
identifier: "CVE-2025-59346"
identifiers:
- "CVE-2025-59346"
- "GHSA-g2rq-jv54-wcpr"
package_slug: "go/github.com/dragonflyoss/dragonfly"
title: "Dragonfly vulnerable to server-side request forgery"
description: "There are multiple server-side request forgery (SSRF) vulnerabilities
  in the DragonFly2 system. The vulnerabilities enable users to force DragonFly2’s
  components to make requests to internal services, which otherwise are not accessible
  to the users.\nOne SSRF attack vector is exposed by the Manager’s API. The API allows
  users to create jobs. When creating a Preheat type of a job, users provide a URL
  that the Manager connects to (see figures 2.1–2.3). The URL is weakly validated,
  and so users can trick the Manager into sending HTTP requests to services that are
  in the Manager’s local network.\n\n```golang\nfunc (p *preheat) CreatePreheat(ctx
  context.Context, schedulers []models.Scheduler,\njson types.PreheatArgs) (*internaljob.GroupJobState,
  error) {\n[skipped]\nurl := json.URL\n[skipped]\n// Generate download files\nvar
  files []internaljob.PreheatRequest\nswitch PreheatType(json.Type) {\ncase PreheatImageType:\n//
  Parse image manifest url\nskipped, err := parseAccessURL(url) [skipped]\n[skipped]\ncase
  PreheatFileType: [skipped]\n}\n```\n\nA second attack vector is in peer-to-peer
  communication. A peer can ask another peer to make a request to an arbitrary URL
  by triggering the pieceManager.DownloadSource method (figure 2.4), which calls the
  httpSourceClient.GetMetadata method, which performs the request.\n\nAnother attack
  vector is due to the fact that HTTP clients used by the DragonFly2’s components
  do not disable support for HTTP redirects. This configuration means that an HTTP
  request sent to a malicious server may be redirected by the server to a component’s
  internal service."
date: "2025-09-26"
pubdate: "2025-09-17"
affected_range: "<2.1.0"
fixed_versions:
- "2.1.0"
affected_versions: "All versions before 2.1.0"
not_impacted: "All versions starting from 2.1.0"
solution: "Upgrade to version 2.1.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2025-59346"
- "https://github.com/advisories/GHSA-g2rq-jv54-wcpr"
- "https://github.com/dragonflyoss/dragonfly/security/advisories/GHSA-g2rq-jv54-wcpr"
- "https://github.com/dragonflyoss/dragonfly"
- "https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf"
- "https://pkg.go.dev/vuln/GO-2025-3968"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N"
uuid: "5be11c64-97a4-4546-995f-18ebce010cfa"
cwe_ids:
- "CWE-918"
- "CWE-937"
- "CWE-1035"
