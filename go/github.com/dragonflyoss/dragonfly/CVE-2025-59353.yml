---
identifier: "CVE-2025-59353"
identifiers:
- "CVE-2025-59353"
- "GHSA-255v-qv84-29p5"
package_slug: "go/github.com/dragonflyoss/dragonfly"
title: "DragonFly's manager generates mTLS certificates for arbitrary IP addresses"
description: "A peer can obtain a valid TLS certificate for arbitrary IP addresses,
  effectively rendering the mTLS authentication useless. The issue is that the Manager’s
  Certificate gRPC service does not validate if the requested IP addresses “belong
  to” the peer requesting the certificate—that is, if the peer connects from the same
  IP address as the one provided in the certificate request.\n\n```golang\nif addr,
  ok := p.Addr.(*net.TCPAddr); ok {\nip = addr.IP.String()\n} else {\nip, _, err =
  net.SplitHostPort(p.Addr.String())\nif err != nil {\nreturn nil, err\n}\n}\n// Parse
  csr.\n[skipped]\n// Check csr signature.\n// TODO check csr common name and so on.\nif
  err = csr.CheckSignature(); err != nil {\nreturn nil, err\n}\n[skipped]\n// TODO
  only valid for peer ip\n// BTW we need support both of ipv4 and ipv6.\nips := csr.IPAddresses\nif
  len(ips) == 0 {\n// Add default connected ip.\nips = []net.IP{net.ParseIP(ip)}\n}\n```"
date: "2025-11-10"
pubdate: "2025-09-17"
affected_range: "<2.1.0"
fixed_versions:
- "2.1.0"
affected_versions: "All versions before 2.1.0"
not_impacted: "All versions starting from 2.1.0"
solution: "Upgrade to version 2.1.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2025-59353"
- "https://github.com/advisories/GHSA-255v-qv84-29p5"
- "https://github.com/dragonflyoss/dragonfly/security/advisories/GHSA-255v-qv84-29p5"
- "https://github.com/dragonflyoss/dragonfly"
- "https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf"
- "https://pkg.go.dev/vuln/GO-2025-3969"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N"
cvss_v4: "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N"
uuid: "0dbbd06b-85e6-4772-890b-d16c14f0eb70"
cwe_ids:
- "CWE-295"
- "CWE-937"
- "CWE-1035"
