---
identifier: "CVE-2024-54131"
identifiers:
- "CVE-2024-54131"
- "GHSA-66q9-2rvx-qfj5"
package_slug: "go/github.com/kolide/launcher"
title: "Kolide Agent Privilege Escalation (Windows, Versions >= 1.5.3, < 1.12.3)"
description: "An implementation bug in the Kolide Agent (known as `launcher`) allows
  for local privilege escalation to the SYSTEM user on Windows 10 and 11. Impacted
  versions include versions >= 1.5.3 and the fix has been released in 1.12.3.\n\nThe
  bug was introduced in version 1.5.3 when launcher started storing upgraded binaries
  in the ProgramData directory (#1510). This move to the new directory meant the launcher
  root directory inherited default permissions that are not as strict as the previous
  location. These incorrect default permissions in conjunction with an omitted SystemDrive
  environmental variable (when launcher starts osqueryd), allows a malicious actor
  with access to the local Windows device to successfully place an arbitrary DLL into
  the osqueryd process's search path. Under some circumstances, this DLL will be executed
  when osqueryd performs a WMI query. This combination of events could then allow
  the attacker to escalate their privileges to SYSTEM.\n\nThis issue was found by
  Bryan Alexander of Atredis Partners and responsibly reported through the Kolide
  bug bounty program. Kolide made the appropriate changes and released a fix in version
  1.12.3 of the `launcher` package."
date: "2024-12-03"
pubdate: "2024-12-03"
affected_range: ">=1.5.3 <1.12.3"
fixed_versions:
- "1.12.3"
affected_versions: "All versions starting from 1.5.3 before 1.12.3"
not_impacted: "All versions before 1.5.3, all versions starting from 1.12.3"
solution: "Upgrade to version 1.12.3 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-54131"
- "https://github.com/advisories/GHSA-66q9-2rvx-qfj5"
- "https://github.com/kolide/launcher/security/advisories/GHSA-66q9-2rvx-qfj5"
- "https://github.com/kolide/launcher/pull/1510"
- "https://github.com/kolide/launcher"
uuid: "d17bc849-3928-4a77-91c0-73cfaae69fef"
cwe_ids:
- "CWE-276"
- "CWE-456"
- "CWE-937"
- "CWE-1035"
