---
identifier: "CVE-2021-3978"
identifiers:
- "CVE-2021-3978"
- "GHSA-3pqh-p72c-fj85"
package_slug: "go/github.com/cloudflare/cfrpki"
title: "Improper Preservation of Permissions in github.com/cloudflare/cfrpki/cmd/octorpki"
description: "When copying files with rsync, octorpki uses the \"-a\" flag 0, which
  forces rsync to copy binaries with the suid bit set as root. Since the provided
  service definition defaults to root (https://github.com/cloudflare/cfrpki/blob/master/package/octorpki.service)
  this could allow for a vector, when combined with another vulnerability that causes
  octorpki to process a malicious TAL file, for a local privilege escalation."
date: "2025-01-29"
pubdate: "2021-11-19"
affected_range: "<1.4.2"
fixed_versions:
- "1.4.2"
affected_versions: "All versions before 1.4.2"
not_impacted: "All versions starting from 1.4.2"
solution: "Upgrade to version 1.4.2 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-3978"
- "https://github.com/advisories/GHSA-3pqh-p72c-fj85"
- "https://github.com/cloudflare/cfrpki/security/advisories/GHSA-3pqh-p72c-fj85"
- "https://github.com/cloudflare/cfrpki"
cvss_v3: "CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:H"
uuid: "da6536e7-b210-462f-ac76-07a2f1a36089"
cwe_ids:
- "CWE-269"
- "CWE-281"
- "CWE-937"
- "CWE-1035"
