---
identifier: "CVE-2021-3761"
identifiers:
- "GHSA-c8xp-8mf3-62h9"
- "CVE-2021-3761"
package_slug: "go/github.com/cloudflare/cfrpki/validator/lib"
title: "Out-of-bounds Write"
description: "Any CA issuer in the RPKI can trick OctoRPKI prior to 1.3.0 into emitting
  an invalid VRP \"MaxLength\" value, causing RTR sessions to terminate. An attacker
  can use this to disable RPKI Origin Validation in a victim network (for example
  AS 13335 - Cloudflare) prior to launching a BGP hijack which during normal operations
  would be rejected as \"RPKI invalid\". Additionally, in certain deployments RTR
  session flapping in and of itself also could cause BGP routing churn, causing availability
  issues."
date: "2023-02-07"
pubdate: "2021-09-07"
affected_range: "<v1.3.0"
fixed_versions:
- "v1.3.0"
affected_versions: "All versions before 1.3.0"
not_impacted: "All versions starting from 1.3.0"
solution: "Upgrade to version 1.3.0 or above."
urls:
- "https://github.com/cloudflare/cfrpki/security/advisories/GHSA-c8xp-8mf3-62h9"
- "https://github.com/cloudflare/cfrpki/commit/a8db4e009ef217484598ba1fd1c595b54e0f6422"
- "https://github.com/cloudflare/cfrpki/releases/tag/v1.3.0"
- "https://nvd.nist.gov/vuln/detail/CVE-2021-3761"
- "https://www.debian.org/security/2022/dsa-5041"
- "https://github.com/cloudflare/cfrpki/pull/90"
- "https://pkg.go.dev/vuln/GO-2022-0246"
- "https://github.com/advisories/GHSA-c8xp-8mf3-62h9"
cvss_v2: "AV:N/AC:L/Au:N/C:N/I:N/A:P"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
uuid: "7709fc5c-76ee-480b-ad00-e8e453ba5a34"
cwe_ids:
- "CWE-1035"
- "CWE-787"
- "CWE-937"
versions:
- number: "v1.3.0"
  commit:
    tags:
    - "v1.3.0"
    sha: "a8db4e009ef217484598ba1fd1c595b54e0f6422"
    timestamp: "20210819152514"
