---
identifier: "CVE-2024-22244"
identifiers:
- "CVE-2024-22244"
- "GHSA-5757-v49g-f6r7"
package_slug: "go/github.com/goharbor/harbor"
title: "Open Redirect URL in Harbor"
description: "Under OIDC authentication mode, there is a redirect_url parameter exposed
  in the URL which is used to redirect the current user to the defined location after
  the successful OIDC login, This redirect_url can be an ambiguous URL and can be
  used to embed a phishing URL.\nFor example: if a user clicks the URL with a malicious
  redirect_url:\n```\nhttps://<harbor_hostnmae>/c/oidc/login?redirect_url=https://<redirect_domain>\n```\nIt
  might redirect the current user without their knowledge to a malicious site, posing
  a potential risk.\nTo avoid this issue, the redirect_url should be checked if it
  is a local path when reading it from the original request URL.\n```\n//src/core/controllers/oidc.go\n...\nredirectURL
  := oc.Ctx.Request.URL.Query().Get(\"redirect_url\")\nif !utils.IsLocalPath(redirectURL)
  {\nlog.Errorf(\"invalid redirect url: %v\", redirectURL)\noc.SendBadRequestError(fmt.Errorf(\"cannot
  redirect to other site\"))\nreturn\n}\nif err := oc.SetSession(redirectURLKey, redirectURL);
  err != nil {\n...\n```"
date: "2024-06-02"
pubdate: "2024-06-02"
affected_range: "<2.8.5||>=2.9.0 <2.9.3||>=2.10.0 <2.10.1"
fixed_versions:
- "2.8.5"
- "2.9.3"
- "2.10.1"
affected_versions: "All versions before 2.8.5, all versions starting from 2.9.0 before
  2.9.3, all versions starting from 2.10.0 before 2.10.1"
not_impacted: "All versions starting from 2.8.5 before 2.9.0, all versions starting
  from 2.9.3 before 2.10.0, all versions starting from 2.10.1"
solution: "Upgrade to versions 2.10.1, 2.8.5, 2.9.3 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-22244"
- "https://github.com/advisories/GHSA-5757-v49g-f6r7"
- "https://github.com/goharbor/harbor/security/advisories/GHSA-5757-v49g-f6r7"
- "https://github.com/goharbor/harbor"
uuid: "67f91d8a-9363-4016-930d-422900888dcc"
cwe_ids:
- "CWE-601"
- "CWE-937"
- "CWE-1035"
