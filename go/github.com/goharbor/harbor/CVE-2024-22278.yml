---
identifier: "CVE-2024-22278"
identifiers:
- "CVE-2024-22278"
- "GHSA-hw28-333w-qxp3"
package_slug: "go/github.com/goharbor/harbor"
title: "Harbor fails to validate the user permissions when updating project configurations"
description: "Harbor fails to validate the maintainer role permissions when creating/updating/deleting
  project configurations - API call:\n\n- PUT /projects/{project_name_or_id}/metadatas/{meta_name}\n-
  POST /projects/{project_name_or_id}/metadatas/{meta_name}\n- DELETE /projects/{project_name_or_id}/metadatas/{meta_name}\n\nBy
  sending a request to create/update/delete a metadata with an name that belongs to
  a project that the currently authenticated and granted to the maintainer role user
  doesnâ€™t have access to, the attacker could modify configurations in the current
  project.\n\nBTW: the maintainer role in Harbor was intended for individuals who
  closely support the project admin in maintaining the project but lack configuration
  management permissions. However, the maintainer role can utilize the metadata API
  to circumvent this limitation. It's important to note that any potential attacker
  must be authenticated and granted a specific project maintainer role to modify configurations,
  limiting their scope to only that project."
date: "2024-07-31"
pubdate: "2024-07-31"
affected_range: "<2.9.5||>=2.10.0 <2.10.3"
fixed_versions:
- "2.9.5"
- "2.10.3"
affected_versions: "All versions before 2.9.5, all versions starting from 2.10.0 before
  2.10.3"
not_impacted: "All versions starting from 2.9.5 before 2.10.0, all versions starting
  from 2.10.3"
solution: "Upgrade to versions 2.10.3, 2.9.5 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-22278"
- "https://github.com/advisories/GHSA-hw28-333w-qxp3"
- "https://github.com/goharbor/harbor/security/advisories/GHSA-hw28-333w-qxp3"
- "https://github.com/goharbor/harbor"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N"
uuid: "de6dffed-7fae-4aeb-9b53-385f0b37aa72"
cwe_ids:
- "CWE-269"
- "CWE-937"
- "CWE-1035"
