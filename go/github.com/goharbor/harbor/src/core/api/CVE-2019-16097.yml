---
identifier: "CVE-2019-16097"
identifiers:
- "GHSA-9wvh-ff5f-xjpj"
- "CVE-2019-16097"
package_slug: "go/github.com/goharbor/harbor/src/core/api"
title: "Missing Authorization"
description: "core/api/user.go in Harbor 1.7.0 through 1.8.2 allows non-admin users
  to create admin accounts via the POST /api/users API, when Harbor is setup with
  DB as authentication backend and allow user to do self-registration. Fixed version:
  v1.7.6 v1.8.3. v.1.9.0. Workaround without applying the fix: configure Harbor to
  use non-DB authentication backend such as LDAP."
date: "2022-04-12"
pubdate: "2022-02-15"
affected_range: ">=v1.7.0 <v1.7.6||>=v1.8.0 <v1.8.3"
fixed_versions:
- "v1.7.6"
- "v1.8.3"
affected_versions: "All versions starting from 1.7.0 before 1.7.6, all versions from 1.8.0 before 1.8.3"
not_impacted: "All versions before 1.7.0, all versions after 1.7.6 before 1.8.0, all versions from 1.8.3."
solution: "Upgrade to version 1.7.6, 1.8.3 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2019-16097"
- "https://github.com/goharbor/harbor/commit/b6db8a8a106259ec9a2c48be8a380cb3b37cf517"
- "https://github.com/goharbor/harbor/compare/v1.8.2...v1.9.0-rc1"
- "https://github.com/goharbor/harbor/releases/tag/v1.7.6"
- "https://github.com/goharbor/harbor/releases/tag/v1.8.3"
- "https://github.com/ianxtianxt/CVE-2019-16097"
- "https://unit42.paloaltonetworks.com/critical-vulnerability-in-harbor-enables-privilege-escalation-from-zero-to-admin-cve-2019-16097/"
- "http://www.vmware.com/security/advisories/VMSA-2019-0015.html"
- "https://github.com/advisories/GHSA-9wvh-ff5f-xjpj"
cvss_v2: "AV:N/AC:L/Au:S/C:N/I:P/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N"
uuid: "81023302-52aa-4909-bfe8-eb1c41ed39cb"
cwe_ids:
- "CWE-1035"
- "CWE-862"
- "CWE-937"
versions:
- number: "v1.7.0"
  commit:
    tags:
    - "v1.7.0"
    sha: "8017a20e0c04a66367d71d6a9ea80c8430ee51ef"
    timestamp: "20181219044401"
- number: "v1.9.0-rc1"
  commit:
    tags:
    - "v1.9.0-rc1"
    sha: "3ab5d5f0e55d905f5651ccc6c08ada719c26eb90"
    timestamp: "20190904011855"
