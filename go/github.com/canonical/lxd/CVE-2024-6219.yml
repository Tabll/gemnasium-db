---
identifier: "CVE-2024-6219"
identifiers:
- "CVE-2024-6219"
- "GHSA-jpmc-7p9c-4rxf"
package_slug: "go/github.com/canonical/lxd"
title: "lxd has a restricted TLS certificate privilege escalation when in PKI mode"
description: "If a `server.ca` file is present in `LXD_DIR` at LXD start up, LXD is
  in \"PKI mode\". In this mode, all clients must have certificates that have been
  signed by the CA.\n\nThe LXD configuration option `core.trust_ca_certificates` defaults
  to `false`. This means that although the client certificate has been signed by the
  CA, LXD will additionally add the certificate to the trust store and verify it via
  mTLS.\n\nWhen a restricted certificate is added to the trust store in this mode,
  it's restrictions are not honoured, and the client has full access to LXD."
date: "2025-03-20"
pubdate: "2024-12-09"
affected_range: "<0.0.0-20240403103450-0e7f2b5bf4d2"
fixed_versions:
- "0.0.0-20240403103450-0e7f2b5bf4d2"
affected_versions: "All versions before 0.0.0-20240403103450-0e7f2b5bf4d2"
not_impacted: "All versions starting from 0.0.0-20240403103450-0e7f2b5bf4d2"
solution: "Upgrade to version 0.0.0-20240403103450-0e7f2b5bf4d2 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-6219"
- "https://github.com/advisories/GHSA-jpmc-7p9c-4rxf"
- "https://github.com/canonical/lxd/security/advisories/GHSA-jpmc-7p9c-4rxf"
- "https://github.com/canonical/lxd/pull/12313"
- "https://github.com/canonical/lxd"
- "https://pkg.go.dev/vuln/GO-2024-3313"
- "https://www.cve.org/CVERecord?id=CVE-2024-6219"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:L/I:N/A:N"
uuid: "718c83aa-d8cd-4bd4-b29e-67d9994b4ffd"
cwe_ids:
- "CWE-287"
- "CWE-295"
- "CWE-937"
- "CWE-1035"
