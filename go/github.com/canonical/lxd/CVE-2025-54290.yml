---
identifier: "CVE-2025-54290"
identifiers:
- "CVE-2025-54290"
- "GHSA-p3x5-mvmp-5f35"
package_slug: "go/github.com/canonical/lxd"
title: "Canonical LXD Project Existence Determination Through Error Handling in Image
  Export Function"
description: "In LXD's images export API (`/1.0/images/{fingerprint}/export`), implementation
  differences in error handling allow determining project existence without authentication.\n\nSpecifically,
  in the following code, errors when multiple images match are directly returned to
  users as API responses:\n\nhttps://github.com/canonical/lxd/blob/43d5189564d27f6161b430ed258c8b56603c2759/lxd/db/images.go#L239-L246\n\nWhile
  fingerprints generally don't duplicate, this functionality uses fingerprints with
  LIKE clauses, allowing prefix specification. Therefore, using LIKE wildcards such
  as % will match multiple images if multiple images exist in the project.\n\nhttps://github.com/canonical/lxd/blob/43d5189564d27f6161b430ed258c8b56603c2759/lxd/db/images.go#L277-L286\n\nIn
  the above implementation, multiple matches result in a 500 error, but if the project
  itself doesn't exist, there are 0 matches and a 404 is returned.\n\n1. When project
  exists and multiple images match: HTTP 500 error \"More than one image matches\"\n2.
  When project doesn't exist: HTTP 404 error \"not found\"\n\nThis behavioural difference
  allows attackers to confirm project existence without authentication."
date: "2025-10-02"
pubdate: "2025-10-02"
affected_range: ">=4.0 <5.21.4||>=6.0 <6.5"
fixed_versions:
- "5.21.4"
- "6.5"
affected_versions: "All versions starting from 4.0 before 5.21.4, all versions starting
  from 6.0 before 6.5"
not_impacted: "All versions before 4.0, all versions starting from 5.21.4 before 6.0,
  all versions starting from 6.5"
solution: "Upgrade to versions 5.21.4, 6.5 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2025-54290"
- "https://github.com/advisories/GHSA-p3x5-mvmp-5f35"
- "https://github.com/canonical/lxd/security/advisories/GHSA-p3x5-mvmp-5f35"
- "https://github.com/canonical/lxd"
uuid: "3683d772-b8c7-4f42-9a26-63d31ce95ebe"
cwe_ids:
- "CWE-200"
- "CWE-937"
- "CWE-1035"
