---
identifier: "CVE-2024-3250"
identifiers:
- "CVE-2024-3250"
- "GHSA-4685-2x5r-65pj"
package_slug: "go/github.com/canonical/pebble"
title: "Pebble service manager's file pull API allows access by any user"
description: "Note: \"Pebble\" here refers to [Canonical's service manager](https://github.com/canonical/pebble),
  not the [Let's Encrypt ACME test server](https://github.com/letsencrypt/pebble).\n\nThe
  API behind `pebble pull`, used to read files from the workload container by Juju
  charms, allows access from any user, instead of just admin. In Juju Kubernetes sidecar
  charms, Pebble and the charm run as root, so they have full access. But if another
  restricted unix user gains local access to the container host, they could hit the
  Pebble `GET /v1/files?action=read` API and would be allowed to read any file in
  the workload container, for example an ssh key or database password or other sensitive
  information. If there are ssh keys they could then potentially ssh into the workload,
  or if something like a database password they could log into the database.\n\nNote
  that this requires local user access to the host machine. It seems unlikely that
  an attacker could gain this level of access in a Juju Kubernetes context, but if
  someone did and there's sensitive information in files accessible to Pebble, the
  consequences are bad.\n\nTo reproduce the issue, go back to the Pebble version in
  Juju 2.9 (5842ea68c9c7), do `pebble run` as root in one terminal window, then in
  another terminal window, as a regular user, use the `pebble pull` CLI. You will
  be able to pull any file as a regular user."
date: "2024-04-05"
pubdate: "2024-04-05"
affected_range: ">=1.2.0 <1.4.2||>=1.5.0 <1.7.3||>=1.8.0 <1.10.2||<1.1.1"
fixed_versions:
- "1.4.2"
- "1.7.3"
- "1.10.2"
- "1.1.1"
affected_versions: "All versions before 1.1.1, all versions starting from 1.2.0 before
  1.4.2, all versions starting from 1.5.0 before 1.7.3, all versions starting from
  1.8.0 before 1.10.2"
not_impacted: "All versions starting from 1.1.1 before 1.2.0, all versions starting
  from 1.4.2 before 1.5.0, all versions starting from 1.7.3 before 1.8.0, all versions
  starting from 1.10.2"
solution: "Upgrade to versions 1.1.1, 1.10.2, 1.4.2, 1.7.3 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-3250"
- "https://github.com/advisories/GHSA-4685-2x5r-65pj"
- "https://github.com/canonical/pebble/security/advisories/GHSA-4685-2x5r-65pj"
- "https://github.com/canonical/pebble/pull/406"
- "https://github.com/canonical/pebble/commit/4ca343d3889533143477e21c63867f2f3c3b5645"
- "https://github.com/canonical/pebble/commit/a5f6f062a11ea156697b854264385ff7e1985fd8"
- "https://github.com/canonical/pebble/commit/b8abd1ff0090f3e0749e81eb1fc3ea16ba95f514"
- "https://github.com/canonical/pebble/commit/cd326225b9b0be067da7d8858e2c912078cbbbd5"
- "https://github.com/canonical/pebble"
- "https://www.cve.org/CVERecord?id=CVE-2024-3250"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N"
uuid: "2d2ed18d-b26a-4374-83c5-a1ad0d66d447"
cwe_ids:
- "CWE-862"
- "CWE-937"
- "CWE-1035"
