---
identifier: "CVE-2025-34075"
identifiers:
- "CVE-2025-34075"
- "GHSA-hqp6-mjw3-f586"
package_slug: "gem/vagrant"
title: "HashiCorp Vagrant has code injection vulnerability through default synced
  folders"
description: "An authenticated virtual machine escape vulnerability exists in HashiCorp
  Vagrant versions 2.4.6 and below when using the default synced folder configuration.
  By design, Vagrant automatically mounts the host system’s project directory into
  the guest VM under /vagrant (or C:\\vagrant on Windows). This includes the Vagrantfile
  configuration file, which is a Ruby script evaluated by the host every time a vagrant
  command is executed in the project directory. If a low-privileged attacker obtains
  shell access to the guest VM, they can append arbitrary Ruby code to the mounted
  Vagrantfile. When a user on the host later runs any vagrant command, the injected
  code is executed on the host with that user’s privileges.\n\nWhile this shared-folder
  behavior is well-documented by Vagrant, the security implications of Vagrantfile
  execution from guest-writable storage are not explicitly addressed. This effectively
  enables guest-to-host code execution in multi-tenant or adversarial VM scenarios."
date: "2025-07-05"
pubdate: "2025-07-02"
affected_range: ">=2.2.10 <2.4.7"
fixed_versions:
- "2.4.7"
affected_versions: "All versions starting from 2.2.10 before 2.4.7"
not_impacted: "All versions before 2.2.10, all versions starting from 2.4.7"
solution: "Upgrade to version 2.4.7 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2025-34075"
- "https://github.com/advisories/GHSA-hqp6-mjw3-f586"
- "https://github.com/hashicorp/vagrant/issues/13688"
- "https://github.com/hashicorp/vagrant/commit/abe87b2fdc124ef426c016d44d2f6f4792f0cbe3"
- "https://developer.hashicorp.com/vagrant"
- "https://developer.hashicorp.com/vagrant/docs/synced-folders/basic_usage"
- "https://developer.hashicorp.com/vagrant/docs/vagrantfile"
- "https://github.com/hashicorp/vagrant"
- "https://github.com/rubysec/ruby-advisory-db/blob/master/gems/vagrant/CVE-2025-34075.yml"
- "https://raw.githubusercontent.com/rapid7/metasploit-framework/master/modules/exploits/multi/local/vagrant_synced_folder_vagrantfile_breakout.rb"
- "https://vulncheck.com/advisories/hashicorp-vagrant-synced-folder-vagrantfile-breakout"
uuid: "f790cfc8-d7c5-4239-8244-1dd4ae8baa9f"
cwe_ids:
- "CWE-276"
- "CWE-668"
- "CWE-94"
- "CWE-937"
- "CWE-1035"
