---
identifier: "CVE-2012-5664"
package_slug: "gem/doorkeeper"
title: "access_token Disclosure CSRF"
description: "Doorkeeper contains a flaw as HTTP requests do not require multiple
  steps, explicit confirmation, or a unique token when performing certain sensitive
  actions. By tricking a user into following a specially crafted link, a context-dependent
  attacker can perform a Cross-Site Request Forgery (CSRF / XSRF) attack causing the
  victim to disclose their access_token with an arbitrary scope."
date: "2013-01-08"
pubdate: "2012-12-26"
affected_range: "<1.4.1||>2.0.0a <2.0.0rc3"
fixed_versions:
- "1.4.1"
- "2.0.0.rc3"
affected_versions: "All versions before 1.4.1, all versions after 2.0.0a before 2.0.0rc3"
not_impacted: "All versions starting from 1.4.1 up to 2.0.0a, all versions starting
  from 2.0.0rc3"
solution: "Upgrade to versions 1.4.1, 2.0.0.rc3 or above."
urls:
- "http://homakov.blogspot.nl/2014/12/blatant-csrf-in-doorkeeper-most-popular.html"
- "http://osvdb.org/show/osvdb/116010"
- "https://github.com/doorkeeper-gem/doorkeeper/blob/master/CHANGELOG.md"
credit: "Thanks to Sergey Belov of DigitalOcean for finding the vulnerability,\r\nPhill
  Baker of DigitalOcean for reporting and fixing it, and to Egor\r\nHomakov of Sakurity.com
  for raising awareness."
uuid: "db1f44b5-4e3d-4a2f-8e22-78ba2fcdc483"
cwe_ids:
- "CWE-1035"
- "CWE-937"
identifiers:
- "CVE-2012-5664"
