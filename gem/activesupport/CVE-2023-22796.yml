---
identifier: "CVE-2023-22796"
identifiers:
- "CVE-2023-22796"
- "GHSA-j6gc-792m-qgm2"
package_slug: "gem/activesupport"
title: "ReDoS based DoS vulnerability in Active Support's underscore"
description: "There is a possible regular expression based DoS vulnerability in Active
  Support. This vulnerability has been assigned the CVE identifier CVE-2023-22796.\n\nVersions
  Affected: All Not affected: None Fixed Versions: 5.2.8.15 (Rails LTS, which is a
  paid service and not part of the rubygem), 6.1.7.1, 7.0.4.1\nImpact\n\nA specially
  crafted string passed to the underscore method can cause the regular expression
  engine to enter a state of catastrophic backtracking. This can cause the process
  to use large amounts of CPU and memory, leading to a possible DoS vulnerability.\n\nThis
  affects String#underscore, ActiveSupport::Inflector.underscore, String#titleize,
  and any other methods using these.\n\nAll users running an affected release should
  either upgrade or use one of the workarounds immediately.\nReleases\n\nThe FIXED
  releases are available at the normal locations.\nWorkarounds\n\nThere are no feasible
  workarounds for this issue.\n\nUsers on Ruby 3.2.0 or greater may be able to reduce
  the impact by configuring Regexp.timeout.\nPatches\n\nTo aid users who arenâ€™t able
  to upgrade immediately we have provided patches for the two supported release series.
  They are in git-am format and consist of a single changeset.\n\n6-1-Avoid-regex-backtracking-in-Inflector.underscore.patch
  - Patch for 6.1 series\n7-0-Avoid-regex-backtracking-in-Inflector.underscore.patch
  - Patch for 7.0 series\n\nPlease note that only the 7.0.Z and 6.1.Z series are supported
  at present, and 6.0.Z for severe vulnerabilities. Users of earlier unsupported releases
  are advised to upgrade as soon as possible as we cannot guarantee the continued
  availability of security fixes for unsupported releases."
date: "2025-02-18"
pubdate: "2023-01-18"
affected_range: "<6.1.7.1||>=7.0.0 <7.0.4.1"
fixed_versions:
- "6.1.7.1"
- "7.0.4.1"
affected_versions: "All versions before 6.1.7.1, all versions starting from 7.0.0
  before 7.0.4.1"
not_impacted: "All versions starting from 6.1.7.1 before 7.0.0, all versions starting
  from 7.0.4.1"
solution: "Upgrade to versions 6.1.7.1, 7.0.4.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-22796"
- "https://github.com/advisories/GHSA-j6gc-792m-qgm2"
- "https://github.com/rails/rails/commit/2164d4f6a1bde74b911fe9ba3c8df1b5bf345bf8"
- "https://github.com/rails/rails/commit/a7cda7e6aa5334ab41b1f4b0f671be931be946ef"
- "https://discuss.rubyonrails.org/t/cve-2023-22796-possible-redos-based-dos-vulnerability-in-active-supports-underscore/82116"
- "https://github.com/rails/rails"
- "https://github.com/rails/rails/releases/tag/v6.1.7.1"
- "https://github.com/rails/rails/releases/tag/v7.0.4.1"
- "https://github.com/rubysec/ruby-advisory-db/blob/master/gems/activesupport/CVE-2023-22796.yml"
- "https://rubyonrails.org/2023/1/17/Rails-Versions-6-0-6-1-6-1-7-1-7-0-4-1-have-been-released"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
uuid: "6cfd9d31-af5f-447c-88e4-5dfbab859c0b"
cwe_ids:
- "CWE-1333"
- "CWE-937"
- "CWE-1035"
