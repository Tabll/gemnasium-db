---
identifier: "CVE-2023-23913"
identifiers:
- "CVE-2023-23913"
- "GHSA-xp5h-f8jf-rc8q"
package_slug: "gem/actionview"
title: "rails-ujs vulnerable to DOM Based Cross-site Scripting contenteditable HTML
  Elements"
description: "NOTE: rails-ujs is part of Rails/actionview since 5.1.0.\n\nThere is
  a potential DOM based cross-site scripting issue in rails-ujs\nwhich leverages the
  Clipboard API to target HTML elements that are\nassigned the contenteditable attribute.
  This has the potential to\noccur when pasting malicious HTML content from the clipboard
  that\nincludes a data-method, data-remote or data-disable-with attribute.\n\nThis
  vulnerability has been assigned the CVE identifier CVE-2023-23913.\n\nNot affected:
  < 5.1.0\nVersions Affected: >= 5.1.0\nFixed Versions: 6.1.7.3, 7.0.4.3\n\nImpact\nIf
  the specified malicious HTML clipboard content is provided to a\ncontenteditable
  element, this could result in the arbitrary execution\nof javascript on the origin
  in question.\n\nReleases\nThe FIXED releases are available at the normal locations.\n\nWorkarounds\nWe
  recommend that all users upgrade to one of the FIXED versions.\nIn the meantime,
  users can attempt to mitigate this vulnerability\nby removing the contenteditable
  attribute from elements in pages\nthat rails-ujs will interact with.\n\nPatches\nTo
  aid users who arenâ€™t able to upgrade immediately we have provided\npatches for the
  two supported release series. They are in git-am\nformat and consist of a single
  changeset.\n\n* rails-ujs-data-method-contenteditable-6-1.patch - Patch for 6.1
  series\n* rails-ujs-data-method-contenteditable-7-0.patch - Patch for 7.0 series\n\nPlease
  note that only the 7.0.Z and 6.1.Z series are\nsupported at present, and 6.0.Z for
  severe vulnerabilities.\n\nUsers of earlier unsupported releases are advised to
  upgrade as\nsoon as possible as we cannot guarantee the continued availability\nof
  security fixes for unsupported releases.\n\nCredits\nWe would like to thank ryotak
  15 for reporting this!\n\n* rails-ujs-data-method-contenteditable-6-1.patch (8.5
  KB)\n* rails-ujs-data-method-contenteditable-7-0.patch (8.5 KB)\n* rails-ujs-data-method-contenteditable-main.patch
  (8.9 KB)"
date: "2025-01-09"
pubdate: "2023-06-09"
affected_range: ">=5.1.0 <6.1.7.3||>=7.0.0 <7.0.4.3"
fixed_versions:
- "6.1.7.3"
- "7.0.4.3"
affected_versions: "All versions starting from 5.1.0 before 6.1.7.3, all versions
  starting from 7.0.0 before 7.0.4.3"
not_impacted: "All versions before 5.1.0, all versions starting from 6.1.7.3 before
  7.0.0, all versions starting from 7.0.4.3"
solution: "Upgrade to versions 6.1.7.3, 7.0.4.3 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-23913"
- "https://github.com/advisories/GHSA-xp5h-f8jf-rc8q"
- "https://github.com/rails/rails/commit/5037a13614d71727af8a175063bcf6ba1a74bdbd"
- "https://github.com/rails/rails/commit/73009ea59a811b28e8ec2a9c9bc24635aa891214"
- "https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1033263"
- "https://discuss.rubyonrails.org/t/cve-2023-23913-dom-based-cross-site-scripting-in-rails-ujs-for-contenteditable-html-elements/82468"
- "https://github.com/rails/rails"
- "https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionview/CVE-2023-23913.yml"
- "https://security.netapp.com/advisory/ntap-20240605-0007"
- "https://www.debian.org/security/2023/dsa-5389"
uuid: "12d86927-d6bc-4e86-89b2-c2565c70fb1d"
cwe_ids:
- "CWE-79"
- "CWE-937"
- "CWE-1035"
