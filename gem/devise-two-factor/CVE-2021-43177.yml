---
identifier: "CVE-2021-43177"
identifiers:
- "CVE-2021-43177"
- "GHSA-jm35-h8q2-73mp"
package_slug: "gem/devise-two-factor"
title: "Improper one time password handling in devise-two-factor"
description: "As a result of an incomplete fix for CVE-2015-7225, in versions of devise-two-factor
  prior to 4.0.2 it is possible to reuse a One-Time-Password (OTP) for one (and only
  one) immediately trailing interval. CVSS Vector: (CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N)"
date: "2022-04-18"
pubdate: "2022-04-11"
affected_range: "<4.0.2"
fixed_versions:
- "4.0.2"
affected_versions: "All versions before 4.0.2"
not_impacted: "All versions starting from 4.0.2"
solution: "Upgrade to version 4.0.2 or above."
urls:
- "https://github.com/tinfoil/devise-two-factor/security/advisories/GHSA-jm35-h8q2-73mp"
- "https://github.com/tinfoil/devise-two-factor/issues/106"
- "https://github.com/advisories/GHSA-jm35-h8q2-73mp"
cvss_v2: "AV:N/AC:M/Au:S/C:P/I:N/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N"
uuid: "dc51b148-1b30-454d-8815-d618b58a41c1"
cwe_ids:
- "CWE-1035"
- "CWE-937"
