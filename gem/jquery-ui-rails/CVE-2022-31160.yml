---
identifier: "CVE-2022-31160"
identifiers:
- "CVE-2022-31160"
- "GHSA-h6gj-6jjq-h8g9"
package_slug: "gem/jquery-ui-rails"
title: "jQuery UI vulnerable to XSS when refreshing a checkboxradio with an HTML-like
  initial text label"
description: "Initializing a checkboxradio widget on an input enclosed within a label
  makes that parent label contents considered as the input label. If you call `.checkboxradio(
  \"refresh\" )` on such a widget and the initial HTML contained encoded HTML entities,
  they will erroneously get decoded. This can lead to potentially executing JavaScript
  code.\n\nFor example, starting with the following initial secure HTML:\n```html\n<label>\n<input
  id=\"test-input\">\n&lt;img src=x onerror=\"alert(1)\"&gt;\n</label>\n```\nand calling:\n```js\n$(
  \"#test-input\" ).checkboxradio();\n$( \"#test-input\" ).checkboxradio( \"refresh\"
  );\n```\nwill turn the initial HTML into:\n```html\n<label>\n<!-- some jQuery UI
  elements -->\n<input id=\"test-input\">\n<img src=x onerror=\"alert(1)\">\n</label>\n```\nand
  the alert will get executed."
date: "2025-07-21"
pubdate: "2022-07-18"
affected_range: "<8.0.0"
fixed_versions:
- "8.0.0"
affected_versions: "All versions before 8.0.0"
not_impacted: "All versions starting from 8.0.0"
solution: "Upgrade to version 8.0.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-31160"
- "https://github.com/advisories/GHSA-h6gj-6jjq-h8g9"
- "https://github.com/jquery/jquery-ui/security/advisories/GHSA-h6gj-6jjq-h8g9"
- "https://github.com/jquery/jquery-ui/commit/8cc5bae1caa1fcf96bf5862c5646c787020ba3f9"
- "https://blog.jqueryui.com/2022/07/jquery-ui-1-13-2-released"
- "https://github.com/jquery-ui-rails/jquery-ui-rails/blob/master/VERSIONS.md"
- "https://github.com/jquery-ui-rails/jquery-ui-rails/releases/tag/v8.0.0-release"
- "https://github.com/jquery/jquery-ui"
- "https://github.com/rubysec/ruby-advisory-db/blob/master/gems/jquery-ui-rails/CVE-2022-31160.yml"
- "https://lists.debian.org/debian-lts-announce/2022/12/msg00015.html"
- "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/6XBR3G3JR5ZIOJDO4224M3INXDS2VFDD"
- "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/J5LGNTICB5BRFAG3DHVVELS6H3CZSQMO"
- "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/QB2FJQXCNHO32VGVOC6DY6IPGVE4VDU6"
- "https://security.netapp.com/advisory/ntap-20220909-0007"
- "https://www.drupal.org/sa-contrib-2022-052"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N"
uuid: "a2afc154-6479-48f6-b123-dd4c3b7e5ef9"
cwe_ids:
- "CWE-79"
- "CWE-937"
- "CWE-1035"
