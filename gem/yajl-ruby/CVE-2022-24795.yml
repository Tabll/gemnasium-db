---
identifier: "CVE-2022-24795"
identifiers:
- "CVE-2022-24795"
- "GHSA-jj47-x69x-mxrm"
package_slug: "gem/yajl-ruby"
title: "Heap-based Buffer Overflow"
description: "yajl-ruby is a C binding to the YAJL JSON parsing and generation library.
  The 1.x branch and the 2.x branch of `yajl` contain an integer overflow which leads
  to subsequent heap memory corruption when dealing with large (~2GB) inputs. The
  reallocation logic at `yajl_buf.c#L64` may result in the `need` 32bit integer wrapping
  to 0 when `need` approaches a value of 0x80000000 (i.e. ~2GB of data), which results
  in a reallocation of buf->alloc into a small heap chunk. These integers are declared
  as `size_t` in the 2.x branch of `yajl`, which practically prevents the issue from
  triggering on 64bit platforms, however this does not preclude this issue triggering
  on 32bit builds on which `size_t` is a 32bit integer. Subsequent population of this
  under-allocated heap chunk is based on the original buffer size, leading to heap
  memory corruption. This vulnerability mostly impacts process availability. Maintainers
  believe exploitation for arbitrary code execution is unlikely. A patch is available
  and anticipated to be part of yajl-ruby version 1.4.2. As a workaround, avoid passing
  large inputs to YAJL."
date: "2022-04-18"
pubdate: "2022-04-05"
affected_range: "<1.4.2"
fixed_versions:
- "1.4.2"
affected_versions: "All versions before 1.4.2"
not_impacted: "All versions starting from 1.4.2"
solution: "Upgrade to version 1.4.2 or above."
urls:
- "https://github.com/brianmario/yajl-ruby/security/advisories/GHSA-jj47-x69x-mxrm"
- "https://github.com/advisories/GHSA-jj47-x69x-mxrm"
cvss_v2: "AV:N/AC:L/Au:N/C:P/I:N/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
uuid: "25255b57-91c4-41b0-980c-36a210e90a52"
cwe_ids:
- "CWE-1035"
- "CWE-190"
- "CWE-937"
