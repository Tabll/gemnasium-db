---
identifier: "CVE-2014-0081"
package_slug: "gem/rails"
title: "XSS Vulnerability in number_to_currency, number_to_percentage and number_to_human"
description: "There is an XSS vulnerability in the `number_to_currency`, `number_to_percentage`
  and `number_to_human` helpers in Ruby on Rails. These helpers allow users to nicely
  format a numeric value. Some helper parameters (`format`, `negative_format` and
  `units`) are not escaped correctly. Applications which pass user controlled data
  as one of these parameters are vulnerable to an XSS attack. All users passing user
  controlled data to these parameters of the number helpers should either upgrade
  or use one of the workarounds immediately."
date: "2019-08-08"
pubdate: "2014-02-20"
affected_range: "<3.2.17 || >=4.0.0.beta <4.0.3 || =4.1.0.beta1"
fixed_versions:
- "3.2.17"
- "4.0.3"
- "4.1.0.beta2"
affected_versions: "All versions before 3.2.17, all versions starting from 4.0.0.beta
  before 4.0.3, version 4.1.0.beta1"
solution: "To aid users who aren't able to upgrade immediately patches are available
  for \r\nthe two supported release series. They are in git-am format and consist
  of a \r\nsingle changeset. \r\n\r\n* 4-1-beta-number_helpers_xss.patch - Patch for
  4.1-beta series \r\n* 4-0-number_helpers_xss.patch - Patch for 4.0 series \r\n*
  3-2-number_helpers_xss.patch - Patch for 3.2 series"
urls:
- "https://groups.google.com/forum/#!topic/rubyonrails-security/tfp6gZCtzr4"
credit: "Kevin Reintjes"
cvss_v2: "AV:N/AC:M/Au:N/C:N/I:P/A:N"
uuid: "40bf2e2b-6d5a-44ea-8771-9d7501ece0ac"
cwe_ids:
- "CWE-1035"
- "CWE-79"
- "CWE-937"
