---
identifier: "CVE-2023-22794"
identifiers:
- "CVE-2023-22794"
- "GHSA-hq7p-j377-6v63"
- "GMS-2023-60"
package_slug: "gem/activerecord"
title: "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
description: "A vulnerability in ActiveRecord <6.0.6.1, v6.1.7.1 and v7.0.4.1 related
  to the sanitization of comments. If malicious user input is passed to either the
  `annotate` query method, the `optimizer_hints` query method, or through the QueryLogs
  interface which automatically adds annotations, it may be sent to the database with
  insufficient sanitization and be able to inject SQL outside of the comment."
date: "2024-02-02"
pubdate: "2023-02-09"
affected_range: ">=6.0.0 <6.0.6.1||>=6.1.0 <6.1.7.1||>=7.0.0 <7.0.4.1"
fixed_versions:
- "6.0.6.1"
- "6.1.7.1"
- "7.0.4.1"
affected_versions: "All versions starting from 6.0.0 before 6.0.6.1, all versions
  starting from 6.1.0 before 6.1.7.1, all versions starting from 7.0.0 before 7.0.4.1"
not_impacted: "All versions before 6.0.0, all versions starting from 6.0.6.1 before
  6.1.0, all versions starting from 6.1.7.1 before 7.0.0, all versions starting from
  7.0.4.1"
solution: "Upgrade to versions 6.0.6.1, 6.1.7.1, 7.0.4.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-22794"
- "https://discuss.rubyonrails.org/t/cve-2023-22794-sql-injection-vulnerability-via-activerecord-comments/82117"
- "https://github.com/rails/rails/releases/tag/v7.0.4.1"
- "https://github.com/advisories/GHSA-hq7p-j377-6v63"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
uuid: "2dc2795e-86a7-46b3-89fa-4ace44065796"
cwe_ids:
- "CWE-1035"
- "CWE-89"
- "CWE-937"
