---
identifier: "GHSA-w67g-2h6v-vjgq"
identifiers:
- "GHSA-w67g-2h6v-vjgq"
package_slug: "gem/phlex"
title: "Phlex XSS protection bypass via attribute splatting, dynamic tags, and href
  values"
description: "During a security audit conducted with Claude Opus 4.6 and GPT-5.3-Codex,
  we identified three specific ways to bypass the XSS (cross-site-scripting) protection
  built into Phlex.\n\n1. The first bypass could happen if user-provided attributes
  with string keys were splatted into HTML tag, e.g. `div(**user_attributes)`.\n2.
  The second bypass could happen if user-provided tag names were passed to the `tag`
  method, e.g. `tag(some_tag_name_from_user)`.\n3. The third bypass could happen if
  userâ€™s links were passed to `href` attributes, e.g. `a(href: user_provided_link)`.\n\nAll
  three of these patterns are meant to be safe and all have now been patched."
date: "2026-02-06"
pubdate: "2026-02-06"
affected_range: ">=2.4.0.beta1 <2.4.1||>=2.3.0 <2.3.2||>=2.2.0 <2.2.2||>=2.1.0 <2.1.3||>=2.0.0.beta1
  <2.0.2||<1.11.1"
fixed_versions:
- "2.4.1"
- "2.3.2"
- "2.2.2"
- "2.1.3"
- "2.0.2"
- "1.11.1"
affected_versions: "All versions starting from 2.4.0.beta1 before 2.4.1, all versions
  starting from 2.0.0.beta1 before 2.0.2, all versions before 1.11.1, all versions
  starting from 2.1.0 before 2.1.3, all versions starting from 2.2.0 before 2.2.2,
  all versions starting from 2.3.0 before 2.3.2"
not_impacted: "All versions before 2.4.0.beta1, all versions starting from 2.4.1 before
  2.0.0.beta1, all versions starting from 2.0.2 before 0, all versions starting from
  1.11.1 before 2.1.0, all versions starting from 2.1.3 before 2.2.0, all versions
  starting from 2.2.2 before 2.3.0, all versions starting from 2.3.2"
solution: "Upgrade to versions 1.11.1, 2.0.2, 2.1.3, 2.2.2, 2.3.2, 2.4.1 or above."
urls:
- "https://github.com/advisories/GHSA-w67g-2h6v-vjgq"
- "https://github.com/yippee-fun/phlex/security/advisories/GHSA-w67g-2h6v-vjgq"
- "https://github.com/yippee-fun/phlex/commit/1d85da417cb15eb8cb2f54a68d531c9b35d9d03a"
- "https://github.com/yippee-fun/phlex/commit/556441d5a64ff93f749e8116a05b2d97264468ee"
- "https://github.com/yippee-fun/phlex/commit/74e3d8610ffabc2cf5f241945e9df4b14dceb97d"
- "https://github.com/yippee-fun/phlex/commit/9f56ad13bea9a7d6117fdfd510446c890709eeac"
- "https://github.com/yippee-fun/phlex/commit/fe9ea708672f9fa42526d9b47e1cdc4634860ef1"
- "https://github.com/yippee-fun/phlex"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:N"
uuid: "ad3ab2be-f7d4-49b7-9f8d-4bd4eee2be4d"
cwe_ids:
- "CWE-79"
- "CWE-937"
- "CWE-1035"
