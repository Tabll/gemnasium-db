---
identifier: "CVE-2024-28199"
identifiers:
- "CVE-2024-28199"
- "GHSA-242p-4v39-2v8g"
package_slug: "gem/phlex"
title: "Cross-site Scripting (XSS) possible with maliciously formed HTML attribute
  names and values in Phlex"
description: "There is a potential cross-site scripting (XSS) vulnerability that can
  be exploited via maliciously crafted user data. This was due to improper case-sensitivity
  in the code that was meant to prevent these attacks.\n\n### Impact\n\nIf you render
  an `<a>` tag with an `href` attribute set to a user-provided link, that link could
  potentially execute JavaScript when clicked by another user.\n\n```ruby\na(href:
  user_profile) { \"Profile\" }\n```\n\nIf you splat user-provided attributes when
  rendering any HTML or SVG tag, malicious event attributes could be included in the
  output, executing JavaScript when the events are triggered by another user.\n\n```ruby\nh1(**JSON.parse(user_attributes))\n```\n\n###
  Patches\nPatches are [available on RubyGems](https://rubygems.org/gems/phlex) for
  all `1.x` minor versions. The patched versions are:\n\n- [1.9.1](https://rubygems.org/gems/phlex/versions/1.9.1)\n-
  [1.8.2](https://rubygems.org/gems/phlex/versions/1.8.2)\n- [1.7.1](https://rubygems.org/gems/phlex/versions/1.7.1)\n-
  [1.6.2](https://rubygems.org/gems/phlex/versions/1.6.2)\n- [1.5.2](https://rubygems.org/gems/phlex/versions/1.5.2)\n-
  [1.4.1](https://rubygems.org/gems/phlex/versions/1.4.1)\n- [1.3.3](https://rubygems.org/gems/phlex/versions/1.3.3)\n-
  [1.2.2](https://rubygems.org/gems/phlex/versions/1.2.2)\n- [1.1.1](https://rubygems.org/gems/phlex/versions/1.1.1)\n-
  [1.0.1](https://rubygems.org/gems/phlex/versions/1.0.1)\n\nIf you are on `main`,
  it has been patched since [`aa50c60`](https://github.com/phlex-ruby/phlex/commit/aa50c604cdee1d0ce7ef068a4c66cbd5d43f96a1)\n\n###
  Workarounds\nConfiguring a [Content Security Policy](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy)
  that does not allow [`unsafe-inline`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy#unsafe-inline)
  would effectively prevent this vulnerability from being exploited.\n\n### References\n\nIn
  addition to upgrading to a patched version of Phlex, we strongly recommend configuring
  a Content Security Policy header that does not allow `unsafe-inline`. Hereâ€™s how
  you can configure a Content Security Policy header in Rails. https://guides.rubyonrails.org/security.html#content-security-policy-header"
date: "2024-03-14"
pubdate: "2024-03-12"
affected_range: ">=1.9.0 <1.9.1||=1.9.0||>=1.8.0 <1.8.2||>=1.7.0 <1.7.1||=1.7.0||>=1.6.0
  <1.6.2||>=1.5.0 <1.5.2||>=1.4.0 <1.4.1||=1.4.0||>=1.3.0 <1.3.3||>=1.2.0 <1.2.2||>=1.1.0
  <1.1.1||=1.1.0||<1.0.1"
fixed_versions:
- "1.9.1"
- "1.8.2"
- "1.7.1"
- "1.6.2"
- "1.5.2"
- "1.4.1"
- "1.3.3"
- "1.2.2"
- "1.1.1"
- "1.0.1"
affected_versions: "All versions before 1.0.1, all versions starting from 1.1.0 before
  1.1.1, version 1.1.0, all versions starting from 1.2.0 before 1.2.2, all versions
  starting from 1.3.0 before 1.3.3, all versions starting from 1.4.0 before 1.4.1,
  version 1.4.0, all versions starting from 1.5.0 before 1.5.2, all versions starting
  from 1.6.0 before 1.6.2, all versions starting from 1.7.0 before 1.7.1, version
  1.7.0, all versions starting from 1.8.0 before 1.8.2, all versions starting from
  1.9.0 before 1.9.1, version 1.9.0"
not_impacted: ""
solution: "Upgrade to versions 1.0.1, 1.1.1, 1.2.2, 1.3.3, 1.4.1, 1.5.2, 1.6.2, 1.7.1,
  1.8.2, 1.9.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-28199"
- "https://github.com/advisories/GHSA-242p-4v39-2v8g"
- "https://github.com/phlex-ruby/phlex/security/advisories/GHSA-242p-4v39-2v8g"
- "https://github.com/phlex-ruby/phlex/commit/aa50c604cdee1d0ce7ef068a4c66cbd5d43f96a1"
- "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy"
- "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy#unsafe-inline"
- "https://github.com/phlex-ruby/phlex"
- "https://github.com/rubysec/ruby-advisory-db/blob/master/gems/phlex/CVE-2024-28199.yml"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:N"
uuid: "aeea32ed-b3f7-4efd-963e-29f585cd69fd"
cwe_ids:
- "CWE-79"
- "CWE-937"
- "CWE-1035"
