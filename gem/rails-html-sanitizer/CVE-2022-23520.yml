---
identifier: "CVE-2022-23520"
identifiers:
- "CVE-2022-23520"
- "GHSA-rrfc-7g8p-99q8"
- "GMS-2022-8301"
package_slug: "gem/rails-html-sanitizer"
title: "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
description: "rails-html-sanitizer is responsible for sanitizing HTML fragments in
  Rails applications. Prior to version 1.4.4, there is a possible XSS vulnerability
  with certain configurations of Rails::Html::Sanitizer due to an incomplete fix of
  CVE-2022-32209. Rails::Html::Sanitizer may allow an attacker to inject content if
  the application developer has overridden the sanitizer's allowed tags to allow both
  \"select\" and \"style\" elements. Code is only impacted if allowed tags are being
  overridden. This issue is patched in version 1.4.4. All users overriding the allowed
  tags to include both \"select\" and \"style\" should either upgrade or use this
  workaround: Remove either \"select\" or \"style\" from the overridden allowed tags.
  NOTE: Code is _not_ impacted if allowed tags are overridden using either the :tags
  option to the Action View helper method sanitize or the :tags option to the instance
  method SafeListSanitizer#sanitize."
date: "2023-09-13"
pubdate: "2022-12-14"
affected_range: "<1.4.4"
fixed_versions:
- "1.4.4"
affected_versions: "All versions before 1.4.4"
not_impacted: "All versions starting from 1.4.4"
solution: "Upgrade to version 1.4.4 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-23520"
- "https://github.com/rails/rails-html-sanitizer/security/advisories/GHSA-rrfc-7g8p-99q8"
- "https://hackerone.com/reports/1654310"
- "https://github.com/advisories/GHSA-rrfc-7g8p-99q8"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N"
uuid: "b5395528-c6a1-4df6-9cae-ca71e0e81b01"
cwe_ids:
- "CWE-1035"
- "CWE-79"
- "CWE-937"
