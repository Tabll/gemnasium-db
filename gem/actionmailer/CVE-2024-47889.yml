---
identifier: "CVE-2024-47889"
identifiers:
- "CVE-2024-47889"
- "GHSA-h47h-mwp9-c6q6"
package_slug: "gem/actionmailer"
title: "Possible ReDoS vulnerability in block_format in Action Mailer"
description: "There is a possible ReDoS vulnerability in the block_format helper in
  Action Mailer. This vulnerability has been assigned the CVE identifier CVE-2024-47889.\n\nImpact\n------\n\nCarefully
  crafted text can cause the block_format helper to take an unexpected amount of time,
  possibly resulting in a DoS vulnerability. All users running an affected release
  should either upgrade or apply the relevant patch immediately.\n\nRuby 3.2 has mitigations
  for this problem, so Rails applications using Ruby 3.2 or newer are unaffected.
  Rails 8.0.0.beta1 requires Ruby 3.2 or greater so is unaffected.\n\n\nReleases\n--------\nThe
  fixed releases are available at the normal locations.\n\nWorkarounds\n-----------\nUsers
  can avoid calling the `block_format` helper or upgrade to Ruby 3.2\n\nCredits\n-------\n\nThanks
  to yuki_osaki for the report!"
date: "2025-01-07"
pubdate: "2024-10-15"
affected_range: ">=3.0.0 <6.1.7.9||>=7.0.0 <7.0.8.5||>=7.1.0 <7.1.4.1||>=7.2.0 <7.2.1.1"
fixed_versions:
- "6.1.7.9"
- "7.0.8.5"
- "7.1.4.1"
- "7.2.1.1"
affected_versions: "All versions starting from 3.0.0 before 6.1.7.9, all versions
  starting from 7.0.0 before 7.0.8.5, all versions starting from 7.1.0 before 7.1.4.1,
  all versions starting from 7.2.0 before 7.2.1.1"
not_impacted: "All versions before 3.0.0, all versions starting from 6.1.7.9 before
  7.0.0, all versions starting from 7.0.8.5 before 7.1.0, all versions starting from
  7.1.4.1 before 7.2.0, all versions starting from 7.2.1.1"
solution: "Upgrade to versions 6.1.7.9, 7.0.8.5, 7.1.4.1, 7.2.1.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-47889"
- "https://github.com/advisories/GHSA-h47h-mwp9-c6q6"
- "https://github.com/rails/rails/security/advisories/GHSA-h47h-mwp9-c6q6"
- "https://github.com/rails/rails"
- "https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionmailer/CVE-2024-47889.yml"
uuid: "fdec282f-7997-4e4c-8397-dc6cf2601ffc"
cwe_ids:
- "CWE-1333"
- "CWE-937"
- "CWE-1035"
