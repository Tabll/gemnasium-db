---
identifier: "CVE-2018-3740"
package_slug: "gem/sanitize"
title: "HTML injection/XSS"
description: "When sanitize is used in combination with libxml2, a specially crafted
  HTML fragment can cause libxml2 to generate improperly escaped output, allowing
  attributes that are not specified in the allowlist to be used. This can allow HTML
  and JavaScript injection, which could result in XSS if the output is served to browsers."
date: "2018-12-28"
pubdate: "2018-03-30"
affected_range: ">=1.1.0 <4.6.3"
fixed_versions:
- "4.6.3"
affected_versions: "All versions starting from 1.1.0 before 4.6.3"
not_impacted: "Prior to 1.1.0 or using libxml2 prior to 2.9.2"
solution: "Upgrade to 4.6.3"
urls:
- "https://github.com/rgrove/sanitize/commit/01629a162e448a83d901456d0ba8b65f3b03d46e"
- "https://github.com/rgrove/sanitize/issues/176"
credit: "Shopify Application Security Team"
cvss_v2: "AV:N/AC:L/Au:N/C:N/I:P/A:N"
cvss_v3: "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N"
uuid: "a6c2ee2e-6663-42cb-b49a-431f4ba14a01"
cwe_ids:
- "CWE-1035"
- "CWE-20"
- "CWE-937"
identifiers:
- "CVE-2018-3740"
