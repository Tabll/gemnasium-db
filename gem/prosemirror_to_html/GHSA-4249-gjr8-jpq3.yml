---
identifier: "GHSA-4249-gjr8-jpq3"
identifiers:
- "GHSA-4249-gjr8-jpq3"
package_slug: "gem/prosemirror_to_html"
title: "Duplicate Advisory: ProsemirrorToHtml has a Cross-Site Scripting (XSS) vulnerability
  through unescaped HTML attribute values"
description: "The prosemirror_to_html gem is vulnerable to Cross-Site Scripting (XSS)
  attacks through malicious HTML attribute values. While tag content is properly escaped,
  attribute values are not, allowing attackers to inject arbitrary JavaScript code.\n\n**Who
  is impacted:**\n\n- Any application using prosemirror_to_html to convert ProseMirror
  documents to HTML\n- Applications that process user-generated ProseMirror content
  are at highest risk\n- End users viewing the rendered HTML output could have malicious
  JavaScript executed in their browsers\n\n**Attack vectors include:**\n\n- `href`
  attributes with `javascript:` protocol:\n`<a href=\"javascript:alert(document.cookie)\">`\n-
  Event handlers: `<div onclick=\"maliciousCode()\">`\n- `onerror` attributes on images:
  `<img src=x onerror=\"alert('XSS')\">`\n- Other HTML attributes that can execute
  JavaScript"
date: "2026-01-23"
pubdate: "2025-11-13"
affected_range: "<0.2.1"
fixed_versions:
- "0.2.1"
affected_versions: "All versions before 0.2.1"
not_impacted: "All versions starting from 0.2.1"
solution: "Upgrade to version 0.2.1 or above."
urls:
- "https://github.com/advisories/GHSA-4249-gjr8-jpq3"
- "https://github.com/etaminstudio/prosemirror_to_html/security/advisories/GHSA-52c5-vh7f-26fx"
- "https://github.com/etaminstudio/prosemirror_to_html/commit/4d59f94f550bcabeec30d298791bbdd883298ad8"
- "https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"
- "https://github.com/etaminstudio/prosemirror_to_html"
- "https://github.com/etaminstudio/prosemirror_to_html/blob/ea8beb32f6c37f29f042ba4155ccf18504da716e/lib/prosemirror_to_html.rb#L249"
- "https://github.com/rubysec/ruby-advisory-db/blob/master/gems/prosemirror_to_html/GHSA-vfpf-xmwh-8m65.yml"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:L"
cvss_v4: "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:P/VC:H/VI:H/VA:L/SC:N/SI:N/SA:N"
uuid: "453d5faa-5fe1-4503-8b6b-09c3b2531682"
cwe_ids:
- "CWE-79"
- "CWE-937"
- "CWE-1035"
