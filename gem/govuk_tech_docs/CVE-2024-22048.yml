---
identifier: "CVE-2024-22048"
identifiers:
- "CVE-2024-22048"
- "GHSA-x2xw-hw8g-6773"
package_slug: "gem/govuk_tech_docs"
title: "govuk_tech_docs vulnerable to unescaped HTML on search results page"
description: "Pages that are indexed in search results have their entire contents
  indexed, including any HTML code snippets. These HTML snippets would appear in the
  search results unsanitised, so it was possible to render arbitrary HTML or run arbitrary
  scripts.\n\nThis is a low risk security issue; to exploit it, an attacker would
  need to find a way of committing malicious code to a page indexed by a site that
  uses tech-docs-gem (which are typically not editable by untrusted users). Their
  code would also be limited by the relatively short length that's rendered in the
  corresponding search result. Nevertheless, the XSS would then be triggerable by
  visiting a pre-constructed URL (/search/index.html?q=some+search+term), which users
  could be tricked into clicking on through social engineering."
date: "2025-11-17"
pubdate: "2023-04-11"
affected_range: ">=2.0.2 <3.3.1"
fixed_versions:
- "3.3.1"
affected_versions: "All versions starting from 2.0.2 before 3.3.1"
not_impacted: "All versions before 2.0.2, all versions starting from 3.3.1"
solution: "Upgrade to version 3.3.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-22048"
- "https://github.com/advisories/GHSA-x2xw-hw8g-6773"
- "https://github.com/alphagov/tech-docs-gem/security/advisories/GHSA-x2xw-hw8g-6773"
- "https://github.com/alphagov/tech-docs-gem/pull/323"
- "https://github.com/alphagov/tech-docs-gem/commit/a51c7058cec46bf2a4e25a1da62b14ac3fd46b53"
- "https://github.com/alphagov/tech-docs-gem"
- "https://github.com/alphagov/tech-docs-gem/releases/tag/v3.3.1"
- "https://github.com/rubysec/ruby-advisory-db/blob/master/gems/govuk_tech_docs/CVE-2024-22048.yml"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N"
uuid: "f2a77166-6ee7-40e3-bc35-3d4a8557caca"
cwe_ids:
- "CWE-79"
- "CWE-80"
- "CWE-937"
- "CWE-1035"
