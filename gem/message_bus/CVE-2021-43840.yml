---
identifier: "CVE-2021-43840"
identifiers:
- "CVE-2021-43840"
- "GHSA-xmgj-5fh3-xjmm"
package_slug: "gem/message_bus"
title: "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
description: "message_bus is a messaging bus for Ruby processes and web clients. users
  who deployed message bus with diagnostics features enabled (default off) is vulnerable
  to a path traversal bug, which could lead to disclosure of secret information on
  a machine if an unintended user were to gain access to the diagnostic route. The
  impact is also greater if there is no proxy for your web application as the number
  of steps up the directories is not bounded. For deployments which uses a proxy,
  the impact varies. For example, If a request goes through a proxy like Nginx with
  `merge_slashes` enabled, the number of steps up the directories that can be read
  is limited to 3 levels. This issue has been patched Users unable to upgrade should
  ensure that MessageBus::Diagnostics is disabled."
date: "2021-12-29"
pubdate: "2021-12-17"
affected_range: "<3.3.7"
fixed_versions:
- "3.3.7"
affected_versions: "All versions before 3.3.7"
not_impacted: "All versions starting from 3.3.7"
solution: "Upgrade to version 3.3.7 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-43840"
- "https://github.com/discourse/message_bus/security/advisories/GHSA-xmgj-5fh3-xjmm"
- "https://github.com/discourse/message_bus/commit/9b6deee01ed474c7e9b5ff65a06bb0447b4db2ba"
cvss_v2: "AV:N/AC:M/Au:S/C:P/I:N/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"
uuid: "1a9b5336-afb7-44e4-b3f1-2a43da25ca54"
cwe_ids:
- "CWE-1035"
- "CWE-22"
- "CWE-937"
