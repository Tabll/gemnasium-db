---
identifier: "CVE-2024-47887"
identifiers:
- "CVE-2024-47887"
- "GHSA-vfg9-r3fq-jvx4"
package_slug: "gem/actionpack"
title: "Possible ReDoS vulnerability in HTTP Token authentication in Action Controller"
description: "There is a possible ReDoS vulnerability in Action Controller's HTTP
  Token authentication. This vulnerability has been assigned the CVE identifier CVE-2024-47887.\n\nImpact\n------\n\nFor
  applications using HTTP Token authentication via `authenticate_or_request_with_http_token`
  or similar, a carefully crafted header may cause header parsing to take an unexpected
  amount of time, possibly resulting in a DoS vulnerability. All users running an
  affected release should either upgrade or apply the relevant patch immediately.\n\nRuby
  3.2 has mitigations for this problem, so Rails applications using Ruby 3.2 or newer
  are unaffected. Rails 8.0.0.beta1 depends on Ruby 3.2 or greater so is unaffected.\n\nReleases\n--------\nThe
  fixed releases are available at the normal locations.\n\nWorkarounds\n-----------\nUsers
  on Ruby 3.2 are unaffected by this issue.\n\n\nCredits\n-------\nThanks to [scyoon](https://hackerone.com/scyoon)
  for reporting"
date: "2024-10-31"
pubdate: "2024-10-15"
affected_range: ">=4.0.0 <6.1.7.9||>=7.0.0 <7.0.8.5||>=7.1.0 <7.1.4.1||>=7.2.0 <7.2.1.1"
fixed_versions:
- "6.1.7.9"
- "7.0.8.5"
- "7.1.4.1"
- "7.2.1.1"
affected_versions: "All versions starting from 4.0.0 before 6.1.7.9, all versions
  starting from 7.0.0 before 7.0.8.5, all versions starting from 7.1.0 before 7.1.4.1,
  all versions starting from 7.2.0 before 7.2.1.1"
not_impacted: "All versions before 4.0.0, all versions starting from 6.1.7.9 before
  7.0.0, all versions starting from 7.0.8.5 before 7.1.0, all versions starting from
  7.1.4.1 before 7.2.0, all versions starting from 7.2.1.1"
solution: "Upgrade to versions 6.1.7.9, 7.0.8.5, 7.1.4.1, 7.2.1.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-47887"
- "https://github.com/advisories/GHSA-vfg9-r3fq-jvx4"
- "https://github.com/rails/rails/security/advisories/GHSA-vfg9-r3fq-jvx4"
- "https://github.com/rails/rails"
- "https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2024-47887.yml"
uuid: "6d536029-16f1-4fec-ae19-23621936be5a"
cwe_ids:
- "CWE-1333"
- "CWE-937"
- "CWE-1035"
