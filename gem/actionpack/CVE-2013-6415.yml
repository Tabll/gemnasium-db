---
identifier: "CVE-2013-6415"
package_slug: "gem/actionpack"
title: "XSS Vulnerability in number_to_currency"
description: "The number_to_currency helper allows users to nicely format a numeric
  value. The unit parameter is not escaped correctly. Application which pass user
  controlled data as the unit parameter are vulnerable to an XSS attack."
date: "2019-08-08"
pubdate: "2013-12-06"
affected_range: "<3.2.16||>=4.0.0 <4.0.2"
fixed_versions:
- "3.2.16"
- "4.0.2"
affected_versions: "All versions before 3.2.16, all versions starting from 4.0.0 before
  4.0.2"
not_impacted: "You're not impacted if your application does not pass unescaped user
  controlled data as the unit parameter."
solution: "Upgrade to latest or escape user controlled data passed at the unit parameter
  like this: <%= number_to_currency(1.02, unit: h(params[:currency])) %> "
urls:
- "http://seclists.org/oss-sec/2013/q4/402"
credit: "Ankit Gupta"
cvss_v2: "AV:N/AC:M/Au:N/C:N/I:P/A:N"
uuid: "d645c583-f278-4ba6-909e-9f75800fce1e"
cwe_ids:
- "CWE-1035"
- "CWE-79"
- "CWE-937"
