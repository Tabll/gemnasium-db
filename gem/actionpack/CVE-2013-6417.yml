---
identifier: "CVE-2013-6417"
package_slug: "gem/actionpack"
title: "Incomplete fix to CVE-2013-0155 (Unsafe Query Generation Risk)"
description: "Due to the way that `Rack::Request` and `Rails::Request` interact, it
  is possible for a 3rd party or custom rack middleware to parse the parameters insecurely
  and store them in the same key that Rails uses for its own parameters. In the event
  that happens the application will receive unsafe parameters and could be vulnerable
  to the earlier vulnerability: it would be possible for an attacker to issue unexpected
  database queries with `IS NULL` or empty where clauses."
date: "2019-08-08"
pubdate: "2013-12-06"
affected_range: ">=2.0.0 <3.2.16||>=4.0.0.beta1 <4.0.2"
fixed_versions:
- "3.2.16"
- "4.0.2"
affected_versions: "All versions starting from 2.0.0 before 3.2.16, all versions starting
  from 4.0.0.beta1 before 4.0.2"
not_impacted: "To be sure you're not impacted, you need to audit your middleware chain
  and ensure that each of the libraries in use does not create an instance of Rack::Request."
solution: "Upgrade to latest or use patches (see source)"
urls:
- "http://seclists.org/oss-sec/2013/q4/403"
credit: "Sudhir Rao"
cvss_v2: "AV:N/AC:L/Au:N/C:P/I:P/A:N"
uuid: "e09e1383-e450-4cb7-81c7-296a7ee346bc"
cwe_ids:
- "CWE-1035"
- "CWE-264"
- "CWE-937"
identifiers:
- "CVE-2013-6417"
