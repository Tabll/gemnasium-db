---
identifier: "CVE-2025-24293"
identifiers:
- "CVE-2025-24293"
- "GHSA-r4mg-4433-c7g3"
package_slug: "gem/activestorage"
title: "Active Storage allowed transformation methods that were potentially unsafe"
description: "Active Storage attempts to prevent the use of potentially unsafe image
  transformation methods and parameters by default.\n\nThe default allowed list contains
  three methods allowing for the circumvention of the safe defaults which enables
  potential command injection vulnerabilities in cases where arbitrary user supplied
  input is accepted as valid transformation methods or parameters.\n\nThis has been
  assigned the CVE identifier CVE-2025-24293.\n\n\nVersions Affected:  >= 5.2.0\nNot
  affected:       < 5.2.0\nFixed Versions:     7.1.5.2, 7.2.2.2, 8.0.2.1\n\nImpact\n------\nThis
  vulnerability impacts applications that use Active Storage with the image_processing
  processing gem in addition to mini_magick as the image processor.\n\nVulnerable
  code will look something similar to this:\n\n```\n<%= image_tag blob.variant(params[:t]
  => params[:v]) %>\n```\n\nWhere the transformation method or its arguments are untrusted
  arbitrary input.\n\nAll users running an affected release should either upgrade
  or use one of the workarounds immediately.\n\nReleases\n--------\nThe fixed releases
  are available at the normal locations.\n\nWorkarounds\n-----------\nConsuming user
  supplied input for image transformation methods or their parameters is unsupported
  behavior and should be considered dangerous.\n\nStrict validation of user supplied
  methods and parameters should be performed as well as having a strong [ImageMagick
  security policy](https://imagemagick.org/script/security-policy.php) deployed.\n\nCredits\n-------\n\nThank
  you [lio346](https://hackerone.com/lio346) for reporting this!"
date: "2025-08-14"
pubdate: "2025-08-14"
affected_range: ">=8.0 <8.0.2.1||>=7.2 <7.2.2.2||>=5.20 <7.1.5.2"
fixed_versions:
- "8.0.2.1"
- "7.2.2.2"
- "7.1.5.2"
affected_versions: "All versions starting from 5.20 before 7.1.5.2, all versions starting
  from 7.2 before 7.2.2.2, all versions starting from 8.0 before 8.0.2.1"
not_impacted: "All versions before 5.20, all versions starting from 7.1.5.2 before
  7.2, all versions starting from 7.2.2.2 before 8.0, all versions starting from 8.0.2.1"
solution: "Upgrade to versions 7.1.5.2, 7.2.2.2, 8.0.2.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2025-24293"
- "https://github.com/advisories/GHSA-r4mg-4433-c7g3"
- "https://github.com/rails/rails/security/advisories/GHSA-r4mg-4433-c7g3"
- "https://github.com/rails/rails/commit/1b1adf6ee6ca0f3104fcfce79360b2ec1e06a354"
- "https://github.com/rails/rails/commit/2d612735ac0d9712fdfffaf80afa627e7295f6ce"
- "https://github.com/rails/rails/commit/fb8f3a18c3d97524c0efc29150d1e5f3162fbb13"
- "https://github.com/rails/rails"
uuid: "a774a15c-a59a-4663-9c3b-ccf5252116b7"
cwe_ids:
- "CWE-77"
- "CWE-937"
- "CWE-1035"
