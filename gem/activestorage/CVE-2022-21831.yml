---
identifier: "CVE-2022-21831"
identifiers:
- "CVE-2022-21831"
- "GHSA-w749-p3v6-hccq"
- "GMS-2022-301"
package_slug: "gem/activestorage"
title: "Improper Control of Generation of Code ('Code Injection')"
description: "A code injection vulnerability exists in the Active Storage >= v5.2.0
  that could allow an attacker to execute code via image_processing arguments."
date: "2023-03-14"
pubdate: "2022-05-26"
affected_range: ">=5.2.0 <5.2.6.3||>=6.0.0 <6.0.4.7||>=6.1.0 <6.1.4.7||>=7.0.0 <7.0.2.3"
fixed_versions:
- "5.2.6.3"
- "6.0.4.7"
- "6.1.4.7"
- "7.0.2.3"
affected_versions: "All versions starting from 5.2.0 before 5.2.6.3, all versions
  starting from 6.0.0 before 6.0.4.7, all versions starting from 6.1.0 before 6.1.4.7,
  all versions starting from 7.0.0 before 7.0.2.3"
not_impacted: "All versions before 5.2.0, all versions starting from 5.2.6.3 before
  6.0.0, all versions starting from 6.0.4.7 before 6.1.0, all versions starting from
  6.1.4.7 before 7.0.0, all versions starting from 7.0.2.3"
solution: "Upgrade to versions 5.2.6.3, 6.0.4.7, 6.1.4.7, 7.0.2.3 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-21831"
- "https://github.com/advisories/GHSA-w749-p3v6-hccq"
- "https://github.com/rails/rails/commit/0a72f7d670e9aa77a0bb8584cb1411ddabb7546e"
- "https://groups.google.com/g/rubyonrails-security/c/n-p-W1yxatI"
- "https://rubysec.com/advisories/CVE-2022-21831/"
cvss_v2: "AV:N/AC:M/Au:N/C:P/I:P/A:P"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "b705c97b-1146-4ab0-930d-6607cda20480"
cwe_ids:
- "CWE-1035"
- "CWE-937"
- "CWE-94"
