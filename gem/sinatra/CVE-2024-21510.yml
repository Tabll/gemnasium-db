---
identifier: "CVE-2024-21510"
identifiers:
- "CVE-2024-21510"
- "GHSA-hxx2-7vcw-mqr3"
package_slug: "gem/sinatra"
title: "Sinatra vulnerable to Reliance on Untrusted Inputs in a Security Decision"
description: "Versions of the package sinatra from 0.0.0 are vulnerable to Reliance
  on Untrusted Inputs in a Security Decision via the X-Forwarded-Host (XFH) header.
  When making a request to a method with redirect applied, it is possible to trigger
  an Open Redirect Attack by inserting an arbitrary address into this header. If used
  for caching purposes, such as with servers like Nginx, or as a reverse proxy, without
  handling the X-Forwarded-Host header, attackers can potentially exploit Cache Poisoning
  or Routing-based SSRF."
date: "2024-11-04"
pubdate: "2024-11-01"
affected_range: "<=4.0.0"
fixed_versions: []
affected_versions: "All versions up to 4.0.0"
not_impacted: ""
solution: "Unfortunately, there is no solution available yet."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-21510"
- "https://github.com/advisories/GHSA-hxx2-7vcw-mqr3"
- "https://github.com/sinatra/sinatra/pull/2010"
- "https://github.com/rubysec/ruby-advisory-db/blob/master/gems/sinatra/CVE-2024-21510.yml"
- "https://github.com/sinatra/sinatra"
- "https://github.com/sinatra/sinatra/blob/b626e2d82c23b4fde0b51782fd32ca27ccde1d1a/lib/sinatra/base.rb#L319"
- "https://github.com/sinatra/sinatra/blob/b626e2d82c23b4fde0b51782fd32ca27ccde1d1a/lib/sinatra/base.rb#L323C1-L343C17"
- "https://security.snyk.io/vuln/SNYK-RUBY-SINATRA-6483832"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N"
uuid: "d061b493-f97f-44c8-aa47-f0d9959d7971"
cwe_ids:
- "CWE-807"
- "CWE-937"
- "CWE-1035"
