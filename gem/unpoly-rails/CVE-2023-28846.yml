---
identifier: "CVE-2023-28846"
identifiers:
- "CVE-2023-28846"
- "GHSA-m875-3xf6-mf78"
package_slug: "gem/unpoly-rails"
title: "Uncontrolled Resource Consumption"
description: "Unpoly is a JavaScript framework for server-side web applications. There
  is a possible Denial of Service (DoS) vulnerability in the `unpoly-rails` gem that
  implements the Unpoly server protocol for Rails applications. This issues affects
  Rails applications that operate as an upstream of a load balancer's that uses passive
  health checks. The `unpoly-rails` gem echoes the request URL as an `X-Up-Location`
  response header. By making a request with exceedingly long URLs (paths or query
  string), an attacker can cause unpoly-rails to write a exceedingly large response
  header. If the response header is too large to be parsed by a load balancer downstream
  of the Rails application, it may cause the load balancer to remove the upstream
  from a load balancing group. This causes that application instance to become unavailable
  until a configured timeout is reached or until an active healthcheck succeeds. This
  issue has been fixed and released as version 2.7.2.2 which is available via RubyGems
  and GitHub. Users unable to upgrade may: Configure your load balancer to use active
  health checks, e.g. by periodically requesting a route with a known response that
  indicates healthiness; Configure your load balancer so the maximum size of response
  headers is at least twice the maximum size of a URL; or instead of changing your
  server configuration you may also configure your Rails application to delete redundant
  `X-Up-Location` headers set by unpoly-rails."
date: "2023-11-07"
pubdate: "2023-03-30"
affected_range: "<2.7.2.2"
fixed_versions:
- "2.7.2.2"
affected_versions: "All versions before 2.7.2.2"
not_impacted: "All versions starting from 2.7.2.2"
solution: "Upgrade to version 2.7.2.2 or above."
urls:
- "https://github.com/unpoly/unpoly-rails/security/advisories/GHSA-m875-3xf6-mf78"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-28846"
- "https://github.com/unpoly/unpoly-rails/commit/cd9ad0007daceeb3b2354fdcab4f88350427bf16"
- "https://docs.nginx.com/nginx/admin-guide/load-balancer/http-health-check/#passive-health-checks"
- "https://github.com/unpoly/unpoly-rails/"
- "https://makandracards.com/operations/537537-nginx-proxy-buffer-tuning"
- "https://tryhexadecimal.com/guides/http/414-request-uri-too-long"
- "https://unpoly.com/up.protocol"
- "https://github.com/advisories/GHSA-m875-3xf6-mf78"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
uuid: "e75bcbe4-b1df-4bd1-956a-6e9623f18997"
cwe_ids:
- "CWE-1035"
- "CWE-400"
- "CWE-937"
