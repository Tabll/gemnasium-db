---
identifier: "CVE-2023-26031"
identifiers:
- "CVE-2023-26031"
package_slug: "maven/org.apache.hadoop/hadoop-main"
title: "Untrusted Search Path"
description: "Relative library resolution in linux container-executor binary in Apache
  Hadoop 3.3.1-3.3.4 on Linux allows local user to gain root privileges. If the YARN
  cluster is accepting work from remote (authenticated) users, this MAY permit remote
  users to gain root privileges.\n\nHadoop 3.3.0 updated the \" YARN Secure Containers
  https://hadoop.apache.org/docs/stable/hadoop-yarn/hadoop-yarn-site/SecureContainer.html
  \" to add a feature for executing user-submitted applications in isolated linux
  containers.\n\nThe native binary HADOOP_HOME/bin/container-executor is used to launch
  these containers; it must be owned by root and have the suid bit set in order for
  the YARN processes to run the containers as the specific users submitting the jobs.\n\nThe
  patch \" YARN-10495 https://issues.apache.org/jira/browse/YARN-10495 . make the
  rpath of container-executor configurable\" modified the library loading path for
  loading .so files from \"$ORIGIN/\" to \"\"$ORIGIN/:../lib/native/\". This is the
  a path through which libcrypto.so is located. Thus it is is possible for a user
  with reduced privileges to install a malicious libcrypto library into a path to
  which they have write access, invoke the container-executor command, and have their
  modified library executed as root.\nIf the YARN cluster is accepting work from remote
  (authenticated) users, and these users' submitted job are executed in the physical
  host, rather than a container, then the CVE permits remote users to gain root privileges.\n\nThe
  fix for the vulnerability is to revert the change, which is done in YARN-11441 https://issues.apache.org/jira/browse/YARN-11441,
  \"Revert YARN-10495\". This patch is in hadoop-3.3.5.\n\nTo determine whether a
  version of container-executor is vulnerable, use the readelf command. If the RUNPATH
  or RPATH value contains the relative path \"./lib/native/\" then it is at risk\n\n$
  readelf -d container-executor|grep 'RUNPATH\\|RPATH' \n0x000000000000001d (RUNPATH)
            Library runpath: [$ORIGIN/:../lib/native/]\n\nIf it does not, then it
  is safe:\n\n$ readelf -d container-executor|grep 'RUNPATH\\|RPATH' \n0x000000000000001d
  (RUNPATH)           Library runpath: [$ORIGIN/]\n\nFor an at-risk version of container-executor
  to enable privilege escalation, the owner must be root and the suid bit must be
  set\n\n$ ls -laF /opt/hadoop/bin/container-executor\n---Sr-s---. 1 root hadoop 802968
  May 9 20:21 /opt/hadoop/bin/container-executor\n\nA safe installation lacks the
  suid bit; ideally is also not owned by root.\n\n$ ls -laF /opt/hadoop/bin/container-executor\n-rwxr-xr-x.
  1 yarn hadoop 802968 May 9 20:21 /opt/hadoop/bin/container-executor\n\nThis configuration
  does not support Yarn Secure Containers, but all other hadoop services, including
  YARN job execution outside secure containers continue to work.\n\n"
date: "2023-12-01"
pubdate: "2023-11-16"
affected_range: "[3.3.1,3.3.4]"
fixed_versions:
- "3.3.5"
affected_versions: "All versions starting from 3.3.1 up to 3.3.4"
not_impacted: "All versions before 3.3.1, all versions after 3.3.4"
solution: "Upgrade to version 3.3.5 or above."
urls:
- "https://hadoop.apache.org/cve_list.html"
- "https://issues.apache.org/jira/browse/YARN-11441"
- "https://lists.apache.org/thread/q9qpdlv952gb4kphpndd5phvl7fkh71r"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-26031"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H"
uuid: "a94e5235-48e5-42a6-8f19-33bdb3e883a6"
cwe_ids:
- "CWE-1035"
- "CWE-426"
- "CWE-937"
