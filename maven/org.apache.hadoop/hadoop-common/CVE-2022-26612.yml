---
identifier: "CVE-2022-26612"
identifiers:
- "CVE-2022-26612"
- "GHSA-gx2c-fvhc-ph4j"
package_slug: "maven/org.apache.hadoop/hadoop-common"
title: "Path traversal in Hadoop"
description: "In Apache Hadoop, The unTar function uses unTarUsingJava function on
  Windows and the built-in tar utility on Unix and other OSes. As a result, a TAR
  entry may create a symlink under the expected extraction directory which points
  to an external directory. A subsequent TAR entry may extract an arbitrary file into
  the external directory using the symlink name. This however would be caught by the
  same targetDirPath check on Unix because of the getCanonicalPath call. However on
  Windows, getCanonicalPath does not resolve symbolic links, which bypasses the check.
  unpackEntries during TAR extraction follows symbolic links which allows writing
  outside expected base directory on Windows. This was addressed in Apache Hadoop
  3.2.3"
date: "2023-08-08"
pubdate: "2022-04-07"
affected_range: "(,3.2.3),[3.3.1,3.3.2]"
fixed_versions:
- "3.2.3"
- "3.3.3"
affected_versions: "All versions before 3.2.3, all versions starting from 3.3.1 up
  to 3.3.2"
not_impacted: "All versions starting from 3.2.3 before 3.3.1, all versions after 3.3.2"
solution: "Upgrade to versions 3.2.3, 3.3.3 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-26612"
- "https://lists.apache.org/thread/hslo7wzw2449gv1jyjk8g6ttd7935fyz"
- "https://github.com/advisories/GHSA-gx2c-fvhc-ph4j"
cvss_v2: "AV:N/AC:L/Au:N/C:P/I:P/A:P"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "3f6fe776-a757-4739-b677-c4a158ae65bc"
cwe_ids:
- "CWE-1035"
- "CWE-59"
- "CWE-937"
