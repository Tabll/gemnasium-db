---
identifier: "CVE-2021-38296"
identifiers:
- "GHSA-9rr6-jpg7-9jg6"
- "CVE-2021-38296"
package_slug: "maven/org.apache.spark/spark-core"
title: "Authentication Bypass by Capture-replay"
description: "Apache Spark supports end-to-end encryption of RPC connections via \"spark.authenticate\"
  and \"spark.network.crypto.enabled\". In versions 3.1.2 and earlier, it uses a bespoke
  mutual authentication protocol that allows for full encryption key recovery. After
  an initial interactive attack, this would allow someone to decrypt plaintext traffic
  offline. Note that this does not affect security mechanisms controlled by \"spark.authenticate.enableSaslEncryption\",
  \"spark.io.encryption.enabled\", \"spark.ssl\", \"spark.ui.strictTransportSecurity\".
  Update to Apache Spark 3.1.3 or later"
date: "2022-03-11"
pubdate: "2022-03-11"
affected_range: "(,3.1.3)"
fixed_versions:
- "3.1.3"
affected_versions: "All versions before 3.1.3"
not_impacted: "All versions starting from 3.1.3"
solution: "Upgrade to version 3.1.3 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-38296"
- "https://lists.apache.org/thread/70x8fw2gx3g9ty7yk0f2f1dlpqml2smd"
- "https://github.com/advisories/GHSA-9rr6-jpg7-9jg6"
cvss_v2: "AV:N/AC:L/Au:N/C:P/I:N/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"
uuid: "9f156719-a388-4961-be5a-ea48f5da78c1"
cwe_ids:
- "CWE-1035"
- "CWE-294"
- "CWE-937"
