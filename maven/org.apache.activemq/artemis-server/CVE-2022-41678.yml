---
identifier: "CVE-2022-41678"
identifiers:
- "CVE-2022-41678"
package_slug: "maven/org.apache.activemq/artemis-server"
title: "Deserialization of Untrusted Data"
description: "Once an user is authenticated on Jolokia, he can potentially trigger
  arbitrary code execution.Â \n\nIn details, in ActiveMQ configurations, jetty allows\norg.jolokia.http.AgentServlet
  to handler request to /api/jolokia\n\norg.jolokia.http.HttpRequestHandler#handlePostRequest
  is able to\ncreate JmxRequest through JSONObject. And calls to\norg.jolokia.http.HttpRequestHandler#executeRequest.\n\nInto
  deeper calling stacks,\norg.jolokia.handler.ExecHandler#doHandleRequest is able
  to invoke\nthrough refection.\n\nAnd then, RCE is able to be achieved via\njdk.management.jfr.FlightRecorderMXBeanImpl
  which exists on Java version above 11.\n\n1 Call newRecording.\n\n2 Call setConfiguration.
  And a webshell data hides in it.\n\n3 Call startRecording.\n\n4 Call copyTo method.
  The webshell will be written to a .jsp file.\n\nThe mitigation is to restrict (by
  default) the actions authorized on Jolokia, or disable Jolokia.\nA more restrictive
  Jolokia configuration has been defined in default ActiveMQ distribution. We encourage
  users to upgrade to ActiveMQ distributions version including updated Jolokia configuration:
  5.16.6, 5.17.4, 5.18.0, 6.0.0.\n"
date: "2024-02-16"
pubdate: "2023-11-28"
affected_range: "(,5.16.6),[5.17.0,5.17.4)"
fixed_versions: []
affected_versions: "All versions before 5.16.6, all versions starting from 5.17.0
  before 5.17.4"
not_impacted: ""
solution: "Unfortunately, there is no solution available yet."
urls:
- "http://www.openwall.com/lists/oss-security/2023/11/28/1"
- "https://activemq.apache.org/security-advisories.data/CVE-2022-41678-announcement.txt"
- "https://lists.apache.org/thread/7g17kwbtjl011mm4tr8bn1vnoq9wh4sl"
- "https://nvd.nist.gov/vuln/detail/CVE-2022-41678"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
uuid: "5bea13a1-1a7d-4cfb-a655-aceb16ab7c6f"
cwe_ids:
- "CWE-1035"
- "CWE-502"
- "CWE-937"
