---
identifier: "CVE-2022-31690"
identifiers:
- "GHSA-32vj-v39g-jh23"
- "CVE-2022-31690"
package_slug: "maven/org.springframework.security/spring-security-oauth2-client"
title: "spring-security-oauth2-client vulnerable to Privilege Escalation"
description: "Spring Security, versions 5.7 prior to 5.7.5, and 5.6 prior to 5.6.9,
  and older unsupported versions could be susceptible to a privilege escalation under
  certain conditions. A malicious user or attacker can modify a request initiated
  by the Client (via the browser) to the Authorization Server which can lead to a
  privilege escalation on the subsequent approval. This scenario can happen if the
  Authorization Server responds with an OAuth2 Access Token Response containing an
  empty scope list (per RFC 6749, Section 5.1) on the subsequent request to the token
  endpoint to obtain the access token."
date: "2022-11-01"
pubdate: "2022-11-01"
affected_range: "(,5.6.9),[5.7.0,5.7.5)"
fixed_versions:
- "5.6.9"
- "5.7.5"
affected_versions: "All versions before 5.6.9, all versions starting from 5.7.0 before
  5.7.5"
not_impacted: "All versions starting from 5.6.9 before 5.7.0, all versions starting
  from 5.7.5"
solution: "Upgrade to versions 5.6.9, 5.7.5 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-31690"
- "https://tanzu.vmware.com/security/cve-2022-31690"
- "https://github.com/spring-projects/spring-security-samples/blob/4638e1e428ee2ddab234199eb3b67b9c94dfa08b/servlet/spring-boot/java/oauth2/webclient/src/main/java/example/SecurityConfiguration.java#L48"
- "https://github.com/advisories/GHSA-32vj-v39g-jh23"
uuid: "e28b3f29-e5bf-4200-8ddd-d9a2ea3d23a1"
cwe_ids:
- "CWE-1035"
- "CWE-937"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H"
