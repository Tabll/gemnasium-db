---
identifier: "CVE-2021-22112"
identifiers:
- "GHSA-gq28-h5vg-8prx"
- "CVE-2021-22112"
package_slug: "maven/org.springframework.security/spring-security-bom"
title: "Privilege escalation in spring security"
description: "Spring Security 5.4.x prior to 5.4.4, 5.3.x prior to 5.3.8.RELEASE,
  5.2.x prior to 5.2.9.RELEASE, and older unsupported versions can fail to save the
  SecurityContext if it is changed more than once in a single request.A malicious
  user cannot cause the bug to happen (it must be programmed in). However, if the
  application's intent is to only allow the user to run with elevated privileges in
  a small portion of the application, the bug can be leveraged to extend those privileges
  to the rest of the application."
date: "2021-10-21"
pubdate: "2021-05-10"
affected_range: "[5.4.0,5.4.4),[5.3.0,5.3.8),(,5.2.9)"
fixed_versions:
- "5.4.4"
- "5.2.9"
- "5.2.9"
affected_versions: "All versions starting from 5.4.0 before 5.4.4, all versions starting
  from 5.3.0 before 5.3.8, all versions before 5.2.9"
not_impacted: "All versions before 5.4.0, all versions starting from 5.4.4, all versions
  before 5.3.0, all versions starting from 5.2.9 before 5.3.8"
solution: "Upgrade to versions 5.4.4, 5.2.9, 5.2.9 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-22112"
- "https://github.com/spring-projects/spring-security/releases/tag/5.4.4"
- "https://tanzu.vmware.com/security/cve-2021-22112"
- "https://github.com/advisories/GHSA-gq28-h5vg-8prx"
cvss_v2: "AV:N/AC:L/Au:S/C:C/I:C/A:C"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
uuid: "a7979750-5fba-4e6c-9530-526d318b7ae7"
cwe_ids:
- "CWE-1035"
- "CWE-937"
