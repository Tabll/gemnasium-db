---
identifier: "CVE-2021-20328"
identifiers:
- "GHSA-rghw-6px2-fgwc"
- "CVE-2021-20328"
package_slug: "maven/org.mongodb/mongo-java-driver"
title: "Improper Certificate Validation"
description: "Specific versions of the Java driver that support client-side field
  level encryption (CSFLE) fail to perform correct host name verification on the KMS
  server’s certificate. This vulnerability in combination with a privileged network
  position active MITM attack could result in interception of traffic between the
  Java driver and the KMS service rendering Field Level Encryption ineffective. This
  issue was discovered during internal testing and affects all versions of the Java
  driver that support CSFLE. The Java async, Scala, and reactive streams drivers are
  not impacted. This vulnerability does not impact driver traffic payloads with CSFLE-supported
  key services originating from applications residing inside the AWS, GCP, and Azure
  network fabrics due to compensating controls in these environments. This issue does
  not impact driver workloads that don’t use Field Level Encryption."
date: "2022-06-22"
pubdate: "2022-05-24"
affected_range: "[3.11.0,3.11.2],[3.12.0,3.12.7]"
fixed_versions:
- "3.11.3"
- "3.12.8"
affected_versions: "All versions starting from 3.11.0 up to 3.11.2, all versions starting
  from 3.12.0 up to 3.12.7"
not_impacted: "All versions before 3.11.0, all versions after 3.11.2 before 3.12.0,
  all versions after 3.12.7"
solution: "Upgrade to versions 3.11.3, 3.12.8 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-20328"
- "https://jira.mongodb.org/browse/JAVA-4017"
- "https://github.com/advisories/GHSA-rghw-6px2-fgwc"
cvss_v2: "AV:A/AC:M/Au:N/C:P/I:P/A:N"
cvss_v3: "CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N"
uuid: "1722d652-3fff-4b95-9aa4-694630ba33ec"
cwe_ids:
- "CWE-1035"
- "CWE-295"
- "CWE-937"
