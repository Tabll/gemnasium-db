---
identifier: "CVE-2023-43123"
identifiers:
- "CVE-2023-43123"
- "GHSA-85p4-q357-72h9"
package_slug: "maven/org.apache.storm/storm-core"
title: "Exposure of Sensitive Information to an Unauthorized Actor"
description: "On unix-like systems, the temporary directory is shared between all
  user. As such, writing to this directory using APIs that do not explicitly set the
  file/directory permissions can lead to information disclosure. Of note, this does
  not impact modern MacOS Operating Systems.\n\nThe method File.createTempFile on
  unix-like systems creates a file with predefined name (so easily identifiable) and
  by default will create this file with the permissions -rw-r--r--. Thus, if sensitive
  information is written to this file, other local users can read this information.\n\nFile.createTempFile(String,
  String) will create a temporary file in the system temporary directory if the 'java.io.tmpdir'
  system property is not explicitly set. \n\nThis affects the class  https://github.com/apache/storm/blob/master/storm-core/src/jvm/org/apache/storm/utils/TopologySpoutLag.java#L99
   and was introduced by  https://issues.apache.org/jira/browse/STORM-3123 \n\nIn
  practice, this has a very limited impact as this class is used only if ui.disable.spout.lag.monitoring\n\n
  is set to false, but its value is true by default.\nMoreover, the temporary file
  gets deleted soon after its creation.\n\nThe solution is to use  Files.createTempFile
  https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/nio/file/Files.html#createTempFile(java.lang.String,java.lang.String,java.nio.file.attribute.FileAttribute...)
   instead.\n\nWe recommend that all users upgrade to the latest version of Apache
  Storm.\n\n"
date: "2023-11-30"
pubdate: "2023-11-23"
affected_range: "[2.0.0,2.6.0)"
fixed_versions:
- "2.6.0"
affected_versions: "All versions starting from 2.0.0 before 2.6.0"
not_impacted: "All versions before 2.0.0, all versions starting from 2.6.0"
solution: "Upgrade to version 2.6.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-43123"
- "https://lists.apache.org/thread/88oc1vqfjtr29cz5xts0v2wm5pmhbm0l"
- "http://www.openwall.com/lists/oss-security/2023/11/23/1"
- "https://issues.apache.org/jira/browse/STORM-3123"
- "https://www.openwall.com/lists/oss-security/2023/11/23/1"
- "https://github.com/advisories/GHSA-85p4-q357-72h9"
cvss_v3: "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"
uuid: "c372397d-18b7-430b-a40f-4ad52ebd3160"
cwe_ids:
- "CWE-1035"
- "CWE-937"
