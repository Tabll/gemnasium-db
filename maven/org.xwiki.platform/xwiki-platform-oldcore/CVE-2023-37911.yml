---
identifier: "CVE-2023-37911"
identifiers:
- "GHSA-gh64-qxh5-4m33"
- "CVE-2023-37911"
package_slug: "maven/org.xwiki.platform/xwiki-platform-oldcore"
title: "org.xwiki.platform:xwiki-platform-oldcore may leak data through deleted and
  re-created documents"
description: "XWiki Platform is a generic wiki platform offering runtime services
  for applications built on top of it. Starting in version 9.4-rc-1 and prior to versions
  14.10.8 and 15.3-rc-1, when a document has been deleted and re-created, it is possible
  for users with view right on the re-created document but not on the deleted document
  to view the contents of the deleted document. Such a situation might arise when
  rights were added to the deleted document. This can be exploited through the diff
  feature and, partially, through the REST API by using versions such as `deleted:1`
  (where the number counts the deletions in the wiki and is thus guessable). Given
  sufficient rights, the attacker can also re-create the deleted document, thus extending
  the scope to any deleted document as long as the attacker has edit right in the
  location of the deleted document. This vulnerability has been patched in XWiki 14.10.8
  and 15.3 RC1 by properly checking rights when deleted revisions of a document are
  accessed. The only workaround is to regularly clean deleted documents to minimize
  the potential exposure. Extra care should be taken when deleting sensitive documents
  that are protected individually (and not, e.g., by being placed in a protected space)
  or deleting a protected space as a whole."
date: "2023-10-25"
pubdate: "2023-10-25"
affected_range: "[9.4-rc-1,14.10.8),[15.0-rc-1,15.3-rc-1)"
fixed_versions:
- "14.10.8"
- "15.3-rc-1"
affected_versions: "All versions starting from 9.4-rc-1 before 14.10.8, all versions
  starting from 15.0-rc-1 before 15.3-rc-1"
not_impacted: "All versions before 9.4-rc-1, all versions starting from 14.10.8 before
  15.0-rc-1, all versions starting from 15.3-rc-1"
solution: "Upgrade to versions 14.10.8, 15.3-rc-1 or above. *Note*: 15.3-rc-1 may
  be an unstable version. Use caution."
urls:
- "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-gh64-qxh5-4m33"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-37911"
- "https://github.com/xwiki/xwiki-platform/commit/f471f2a392aeeb9e51d59fdfe1d76fccf532523f"
- "https://extensions.xwiki.org/xwiki/bin/view/Extension/Index%20Application#HPermanentlydeleteallpages"
- "https://jira.xwiki.org/browse/XWIKI-20684"
- "https://jira.xwiki.org/browse/XWIKI-20685"
- "https://jira.xwiki.org/browse/XWIKI-20817"
- "https://github.com/advisories/GHSA-gh64-qxh5-4m33"
uuid: "f0ee669d-d4dd-4ee0-9b03-3f66714d7576"
cwe_ids:
- "CWE-1035"
- "CWE-937"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"
