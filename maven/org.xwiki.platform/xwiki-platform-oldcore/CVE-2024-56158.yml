---
identifier: "CVE-2024-56158"
identifiers:
- "CVE-2024-56158"
- "GHSA-prwh-7838-xf82"
package_slug: "maven/org.xwiki.platform/xwiki-platform-oldcore"
title: "XWiki allows SQL injection in query endpoint of REST API with Oracle"
description: "It's possible to execute any SQL query in Oracle by using the function
  like [DBMS_XMLGEN or DBMS_XMLQUERY](https://docs.oracle.com/en/database/oracle/oracle-database/19/arpls/DBMS_XMLGEN.html).\n\nThe
  XWiki query validator does not sanitize functions that would be used in a simple
  `select` and Hibernate allows using any native function in an HQL query."
date: "2026-01-12"
pubdate: "2025-06-12"
affected_range: "[1.0,15.10.16),[16.0.0-rc-1,16.4.7),[16.5.0-rc-1,16.10.2)"
fixed_versions:
- "15.10.16"
- "16.4.7"
- "16.10.2"
affected_versions: "All versions starting from 1.0 before 15.10.16, all versions starting
  from 16.0.0-rc-1 before 16.4.7, all versions starting from 16.5.0-rc-1 before 16.10.2"
not_impacted: "All versions before 1.0, all versions starting from 15.10.16 before
  16.0.0-rc-1, all versions starting from 16.4.7 before 16.5.0-rc-1, all versions
  starting from 16.10.2"
solution: "Upgrade to versions 15.10.16, 16.10.2, 16.4.7 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-56158"
- "https://github.com/advisories/GHSA-prwh-7838-xf82"
- "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-prwh-7838-xf82"
- "https://github.com/xwiki/xwiki-platform/commit/ce855aae38eefd8ee3fc86353d51ac03d6cb7f8d"
- "https://github.com/xwiki/xwiki-platform"
- "https://jira.xwiki.org/browse/XWIKI-22734"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
cvss_v4: "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N"
uuid: "cbcfc283-fdd2-4795-8ffd-fa5949a45ceb"
cwe_ids:
- "CWE-89"
- "CWE-937"
- "CWE-1035"
