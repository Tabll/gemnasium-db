---
identifier: "CVE-2025-32968"
identifiers:
- "CVE-2025-32968"
- "GHSA-g9jj-75mx-wjcx"
package_slug: "maven/org.xwiki.platform/xwiki-platform-oldcore"
title: "org.xwiki.platform:xwiki-platform-oldcore allows SQL injection in short form
  select requests through the script query API"
description: "It is possible for a user with SCRIPT right to escape from the HQL execution
  context and perform a blind SQL injection to execute arbitrary SQL statements on
  the database backend.\n\nDepending on the used database backend, the attacker may
  be able to not only obtain confidential information such as password hashes from
  the database, but also execute UPDATE/INSERT/DELETE queries.\n\nThe vulnerability
  may be tested in a default installation of XWIki Standard Flavor, including using
  the official Docker containers.\n\nFor example, with a MySQL or MariaDB database,
  you can use the following script (which a user having SCRIPT right but not PROGRAMMING
  right) to get the content of the xwikistrings table (which contain all the short
  string fields stored in objects, including passwords):\n\n```\n{{velocity}}\n$services.query.hql(\"where
  1<>'1\\'' union select concat(XWS_NAME, XWS_VALUE) from xwikistrings #'\").execute()\n{{/velocity}}\n```"
date: "2025-04-23"
pubdate: "2025-04-23"
affected_range: "[1.6-milestone-1,15.10.16),[16.0.0-rc-1,16.4.6),[16.5.0-rc-1,16.10.1)"
fixed_versions:
- "15.10.16"
- "16.4.6"
- "16.10.1"
affected_versions: "All versions starting from 1.6-milestone-1 before 15.10.16, all
  versions starting from 16.0.0-rc-1 before 16.4.6, all versions starting from 16.5.0-rc-1
  before 16.10.1"
not_impacted: "All versions before 1.6-milestone-1, all versions starting from 15.10.16
  before 16.0.0-rc-1, all versions starting from 16.4.6 before 16.5.0-rc-1, all versions
  starting from 16.10.1"
solution: "Upgrade to versions 15.10.16, 16.10.1, 16.4.6 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2025-32968"
- "https://github.com/advisories/GHSA-g9jj-75mx-wjcx"
- "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-g9jj-75mx-wjcx"
- "https://github.com/xwiki/xwiki-platform"
- "https://jira.xwiki.org/browse/XWIKI-22718"
uuid: "5dd3c349-663e-44d8-b078-fe03b92a2705"
cwe_ids:
- "CWE-89"
- "CWE-937"
- "CWE-1035"
