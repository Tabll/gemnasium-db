---
identifier: "CVE-2023-50721"
identifiers:
- "GHSA-7654-vfh6-rw6x"
- "CVE-2023-50721"
package_slug: "maven/org.xwiki.platform/xwiki-platform-search-ui"
title: "Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval
  Injection')"
description: "XWiki Platform is a generic wiki platform. Starting in 4.5-rc-1 and
  prior to versions 14.10.15, 15.5.2, and 15.7-rc-1, the search administration interface
  does not properly escape the id and label of search user interface extensions, allowing
  the injection of XWiki syntax containing script macros including Groovy macros that
  allow remote code execution, impacting the confidentiality, integrity and availability
  of the whole XWiki instance. This attack can be executed by any user who can edit
  some wiki page like the user's profile (editable by default) as user interface extensions
  that will be displayed in the search administration can be added on any document
  by any user. The necessary escaping has been added in XWiki 14.10.15, 15.5.2 and
  15.7RC1. As a workaround, the patch can be applied manually applied to the page
  `XWiki.SearchAdmin`."
date: "2023-12-16"
pubdate: "2023-12-16"
affected_range: "[4.5-rc-1,14.10.15),[15.0-rc-1,15.5.2),[15.6-rc-1,15.7-rc-1)"
fixed_versions:
- "14.10.15"
- "15.5.2"
- "15.7-rc-1"
affected_versions: "All versions starting from 4.5-rc-1 before 14.10.15, all versions
  starting from 15.0-rc-1 before 15.5.2, all versions starting from 15.6-rc-1 before
  15.7-rc-1"
not_impacted: "All versions before 4.5-rc-1, all versions starting from 14.10.15 before
  15.0-rc-1, all versions starting from 15.5.2 before 15.6-rc-1, all versions starting
  from 15.7-rc-1"
solution: "Upgrade to versions 14.10.15, 15.5.2, 15.7-rc-1 or above. *Note*: 15.7-rc-1
  may be an unstable version. Use caution."
urls:
- "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-7654-vfh6-rw6x"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-50721"
- "https://github.com/xwiki/xwiki-platform/commit/62863736d78ffd60d822279c5fb7fb9593042766"
- "https://jira.xwiki.org/browse/XWIKI-21200"
- "https://github.com/advisories/GHSA-7654-vfh6-rw6x"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H"
uuid: "a2377b51-6cb0-41df-aa64-5b53f12a4e88"
cwe_ids:
- "CWE-1035"
- "CWE-78"
- "CWE-937"
- "CWE-94"
- "CWE-95"
