---
identifier: "CVE-2022-36099"
identifiers:
- "GHSA-xr6m-2p4m-jvqf"
- "CVE-2022-36099"
package_slug: "maven/org.xwiki.platform/xwiki-platform-wiki-ui-mainwiki"
title: "Improper Control of Generation of Code ('Code Injection')"
description: "XWiki Platform Wiki UI Main Wiki is software for managing subwikis on
  XWiki Platform, a generic wiki platform. Starting with version 5.3-milestone-2 and
  prior to versions 13.10.6 and 14.4, it's possible to inject arbitrary wiki syntax
  including Groovy, Python and Velocity script macros via the request (URL parameter)
  using the `XWikiServerClassSheet` if the user has view access to this sheet and
  another page that has been saved with programming rights, a standard condition on
  a public read-only XWiki installation or a private XWiki installation where the
  user has an account. This allows arbitrary Groovy/Python/Velocity code execution
  which allows bypassing all rights checks and thus both modification and disclosure
  of all content stored in the XWiki installation. Also, this could be used to impact
  the availability of the wiki. This has been patched in versions 13.10.6 and 14.4.
  As a workaround, edit the affected document `XWiki.XWikiServerClassSheet` or `WikiManager.XWikiServerClassSheet`
  and manually perform the changes from the patch fixing the issue. On XWiki versions
  12.0 and later, it is also possible to import the document `XWiki.XWikiServerClassSheet`
  from the xwiki-platform-wiki-ui-mainwiki package version 14.4 using the import feature
  of the administration application as there have been no other changes to this document
  since XWiki 12.0."
date: "2022-09-16"
pubdate: "2022-09-16"
affected_range: "[5.3-milestone-2,13.10.6),[14.0,14.4)"
fixed_versions:
- "13.10.6"
- "14.4"
affected_versions: "All versions starting from 5.3-milestone-2 before 13.10.6, all
  versions starting from 14.0 before 14.4"
not_impacted: "All versions before 5.3-milestone-2, all versions starting from 13.10.6
  before 14.0, all versions starting from 14.4"
solution: "Upgrade to versions 13.10.6, 14.4 or above."
urls:
- "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-xr6m-2p4m-jvqf"
- "https://nvd.nist.gov/vuln/detail/CVE-2022-36099"
- "https://github.com/xwiki/xwiki-platform/commit/fc77f9f53bc65a4a9bfae3d5686615309c0c76cc"
- "https://jira.xwiki.org/browse/XWIKI-19746"
- "https://github.com/advisories/GHSA-xr6m-2p4m-jvqf"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
uuid: "6ef0acc0-fa40-432c-9a96-f2ce8675e62d"
cwe_ids:
- "CWE-1035"
- "CWE-352"
- "CWE-937"
- "CWE-94"
