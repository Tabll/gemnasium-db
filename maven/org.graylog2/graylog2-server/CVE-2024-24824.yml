---
identifier: "CVE-2024-24824"
identifiers:
- "GHSA-p6gg-5hf4-4rgj"
- "CVE-2024-24824"
package_slug: "maven/org.graylog2/graylog2-server"
title: "Incorrect Authorization"
description: "Graylog is a free and open log management platform. Starting in version
  2.0.0 and prior to versions 5.1.11 and 5.2.4, arbitrary classes can be loaded and
  instantiated using a HTTP PUT request to the `/api/system/cluster_config/` endpoint.
  Graylog's cluster config system uses fully qualified class names as config keys.
  To validate the existence of the requested class before using them, Graylog loads
  the class using the class loader. If a user with the appropriate permissions performs
  the request, arbitrary classes with 1-arg String constructors can be instantiated.
  This will execute arbitrary code that is run during class instantiation. In the
  specific use case of `java.io.File`, the behavior of the internal web-server stack
  will lead to information exposure by including the entire file content in the response
  to the REST request. Versions 5.1.11 and 5.2.4 contain a fix for this issue."
date: "2024-02-08"
pubdate: "2024-02-07"
affected_range: "[2.0.0,5.1.11),[5.2.0-alpha.1,5.2.4)"
fixed_versions:
- "5.1.11"
- "5.2.4"
affected_versions: "All versions starting from 2.0.0 before 5.1.11, all versions starting
  from 5.2.0-alpha.1 before 5.2.4"
not_impacted: "All versions before 2.0.0, all versions starting from 5.1.11 before
  5.2.0-alpha.1, all versions starting from 5.2.4"
solution: "Upgrade to versions 5.1.11, 5.2.4 or above."
urls:
- "https://github.com/Graylog2/graylog2-server/security/advisories/GHSA-p6gg-5hf4-4rgj"
- "https://github.com/Graylog2/graylog2-server/commit/75ef2b8d60e7d67f859b79fe712c8ae7b2e861d8"
- "https://github.com/Graylog2/graylog2-server/commit/7f8ef7fa8edf493106d5ef6f777d4da02c5194d9"
- "https://github.com/Graylog2/graylog2-server/blob/e458db8bf4f789d4d19f1b37f0263f910c8d036c/graylog2-server/src/main/java/org/graylog2/rest/resources/system/ClusterConfigResource.java#L208-L214"
- "https://nvd.nist.gov/vuln/detail/CVE-2024-24824"
- "https://github.com/advisories/GHSA-p6gg-5hf4-4rgj"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
uuid: "dcb4e571-70f9-4e51-ad42-f39077a3b49e"
cwe_ids:
- "CWE-1035"
- "CWE-284"
- "CWE-78"
- "CWE-863"
- "CWE-937"
