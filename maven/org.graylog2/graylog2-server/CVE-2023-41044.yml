---
identifier: "CVE-2023-41044"
identifiers:
- "CVE-2023-41044"
- "GHSA-2q4p-f6gf-mqr5"
package_slug: "maven/org.graylog2/graylog2-server"
title: "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
description: "Graylog is a free and open log management platform. A partial path traversal
  vulnerability exists in Graylog's `Support Bundle` feature. The vulnerability is
  caused by incorrect user input validation in an HTTP API resource. Graylog's Support
  Bundle feature allows an attacker with valid Admin role credentials to download
  or delete files in sibling directories of the support bundle directory. The default
  `data_dir` in operating system packages (DEB, RPM) is set to `/var/lib/graylog-server`.
  The data directory for the Support Bundle feature is always `<data_dir>/support-bundle`.
  Due to the partial path traversal vulnerability, an attacker with valid Admin role
  credentials can read or delete files in directories that start with a `/var/lib/graylog-server/support-bundle`
  directory name. The vulnerability would allow the download or deletion of files
  in the following example directories: `/var/lib/graylog-server/support-bundle-test`
  and `/var/lib/graylog-server/support-bundlesdirectory`. For the Graylog Docker images,
  the `data_dir` is set to `/usr/share/graylog/data` by default. This vulnerability
  is fixed in Graylog version 5.1.3 and later. Users are advised to upgrade. Users
  unable to upgrade should block all HTTP requests to the following HTTP API endpoints
  by using a reverse proxy server in front of Graylog. `GET /api/system/debug/support/bundle/download/{filename}`
  and `DELETE /api/system/debug/support/bundle/{filename}`.\n"
date: "2023-09-06"
pubdate: "2023-08-31"
affected_range: "[5.1.0,5.1.3)"
fixed_versions:
- "5.1.3"
affected_versions: "All versions starting from 5.1.0 before 5.1.3"
not_impacted: "All versions before 5.1.0, all versions starting from 5.1.3"
solution: "Upgrade to version 5.1.3 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-41044"
- "https://github.com/Graylog2/graylog2-server/security/advisories/GHSA-2q4p-f6gf-mqr5"
- "https://go2docs.graylog.org/5-1/making_sense_of_your_log_data/cluster_support_bundle.htm"
- "https://github.com/Graylog2/graylog2-server/commit/02b8792e6f4b829f0c1d87fcbf2d58b73458b938"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:N"
uuid: "cedaf19d-214d-490e-8c19-cb48c1d3857c"
cwe_ids:
- "CWE-1035"
- "CWE-22"
- "CWE-937"
