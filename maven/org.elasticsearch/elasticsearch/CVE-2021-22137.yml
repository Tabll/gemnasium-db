---
identifier: "CVE-2021-22137"
identifiers:
- "GHSA-hr65-qq6p-87r4"
- "CVE-2021-22137"
package_slug: "maven/org.elasticsearch/elasticsearch"
title: "Improper Preservation of Permissions"
description: "In Elasticsearch versions before 7.11.2 and 6.8.15 a document disclosure
  flaw was found when Document or Field Level Security is used. Search queries do
  not properly preserve security permissions when executing certain cross-cluster
  search queries. This could result in the search disclosing the existence of documents
  the attacker should not be able to view. This could result in an attacker gaining
  additional insight into potentially sensitive indices."
date: "2023-08-13"
pubdate: "2022-05-24"
affected_range: "(,6.8.14],[7.11.0,7.11.1]"
fixed_versions:
- "6.8.15"
- "7.11.2"
affected_versions: "All versions up to 6.8.14, all versions starting from 7.11.0 up
  to 7.11.1"
not_impacted: "All versions after 6.8.14 before 7.11.0, all versions after 7.11.1"
solution: "Upgrade to versions 6.8.15, 7.11.2 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-22137"
- "https://discuss.elastic.co/t/elastic-stack-7-12-0-and-6-8-15-security-update/268125"
- "https://security.netapp.com/advisory/ntap-20210625-0003/"
- "https://github.com/advisories/GHSA-hr65-qq6p-87r4"
cvss_v2: "AV:N/AC:M/Au:N/C:P/I:N/A:N"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N"
uuid: "b74e6043-55d0-4d9c-810a-b8a71dd854a6"
cwe_ids:
- "CWE-1035"
- "CWE-281"
- "CWE-937"
