---
identifier: "CVE-2023-49921"
identifiers:
- "CVE-2023-49921"
- "GHSA-2hjr-vmf3-xwvp"
package_slug: "maven/org.elasticsearch/elasticsearch"
title: "Elasticsearch Insertion of Sensitive Information into Log File"
description: "An issue was discovered by Elastic whereby Watcher search input logged
  the search query results on DEBUG log level. This could lead to raw contents of
  documents stored in Elasticsearch to be printed in logs. Elastic has released 8.11.2
  and 7.17.16 that resolves this issue by removing this excessive logging. This issue
  only affects users that use Watcher and have a Watch defined that uses the search
  input and additionally have set the search inputâ€™s logger to DEBUG or finer, for
  example using: org.elasticsearch.xpack.watcher.input.search, org.elasticsearch.xpack.watcher.input,
  org.elasticsearch.xpack.watcher, or wider, since the loggers are hierarchical."
date: "2024-07-26"
pubdate: "2024-07-26"
affected_range: "[,7.17.16),[8.0.0,8.11.2)"
fixed_versions:
- "7.17.16"
- "8.11.2"
affected_versions: "All versions before 7.17.16, all versions starting from 8.0.0
  before 8.11.2"
not_impacted: "All versions starting from 7.17.16 before 8.0.0, all versions starting
  from 8.11.2"
solution: "Upgrade to versions 7.17.16, 8.11.2 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-49921"
- "https://github.com/advisories/GHSA-2hjr-vmf3-xwvp"
- "https://discuss.elastic.co/t/elasticsearch-8-11-2-7-17-16-security-update-esa-2023-29/349179"
- "https://github.com/elastic/elasticsearch"
cvss_v3: "CVSS:3.1/AV:A/AC:L/PR:L/UI:R/S:U/C:H/I:N/A:N"
uuid: "1e7d0039-f6cf-4c63-8eb9-dd90f7ea41a7"
cwe_ids:
- "CWE-532"
- "CWE-937"
- "CWE-1035"
