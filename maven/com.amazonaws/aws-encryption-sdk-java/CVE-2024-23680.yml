---
identifier: "CVE-2024-23680"
identifiers:
- "CVE-2024-23680"
- "GHSA-55xh-53m6-936r"
package_slug: "maven/com.amazonaws/aws-encryption-sdk-java"
title: "Improper Verification of Cryptographic Signature in aws-encryption-sdk-java"
description: "This advisory addresses several LOW severity issues with streaming signed
  messages and restricting processing of certain types of invalid messages.\n\nThis
  update addresses an issue where certain invalid ECDSA signatures incorrectly passed
  validation. These signatures provide defense in depth and there is no impact on
  the integrity of decrypted plaintext.\n\nThis ESDK supports a streaming mode where
  callers may stream the plaintext of signed messages before the ECDSA signature is
  validated. In addition to these signatures, the ESDK uses AES-GCM encryption and
  all plaintext is verified before being released to a caller. There is no impact
  on the integrity of the ciphertext or decrypted plaintext, however some callers
  may rely on the the ECDSA signature for non-repudiation. Without validating the
  ECDSA signature, an actor with trusted KMS permissions to decrypt a message may
  also be able to encrypt messages. This update introduces a new API for callers who
  wish to stream only unsigned messages.\n\nFor customers who process ESDK messages
  from untrusted sources, this update also introduces a new configuration to limit
  the number of Encrypted Data Keys (EDKs) that the ESDK will attempt to process per
  message. This configuration provides customers with a way to limit the number of
  AWS KMS Decrypt API calls that the ESDK will make per message. This setting will
  reject messages with more EDKs than the configured limit.\n\nFinally, this update
  adds early rejection of invalid messages with certain invalid combinations of algorithm
  suite and header data."
date: "2026-01-22"
pubdate: "2021-06-01"
affected_range: "[,1.9.0),[2.0.0,2.2.0)"
fixed_versions:
- "1.9.0"
- "2.2.0"
affected_versions: "All versions before 1.9.0, all versions starting from 2.0.0 before
  2.2.0"
not_impacted: "All versions starting from 1.9.0 before 2.0.0, all versions starting
  from 2.2.0"
solution: "Upgrade to versions 1.9.0, 2.2.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-23680"
- "https://github.com/advisories/GHSA-55xh-53m6-936r"
- "https://github.com/aws/aws-encryption-sdk-java/security/advisories/GHSA-55xh-53m6-936r"
- "https://github.com/aws/aws-encryption-sdk-java"
- "https://vulncheck.com/advisories/vc-advisory-GHSA-55xh-53m6-936r"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N"
cvss_v4: "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:L/VA:N/SC:N/SI:N/SA:N"
uuid: "b37e7383-1d26-4629-99fd-14ec9d58ae46"
cwe_ids:
- "CWE-347"
- "CWE-937"
- "CWE-1035"
