---
identifier: "CVE-2016-6798"
package_slug: "maven/org.apache.sling/org.apache.sling.xss"
title: "Improper Restriction of XML External Entity Reference"
description: "In the XSS Protection API module in Apache Sling, the method `XSS.getValidXML()`
  uses an insecure SAX parser to validate the input string, which allows for XXE attacks
  in all scripts which use this method to validate user input, potentially allowing
  an attacker to read sensitive data on the filesystem, perform same-site-request-forgery
  (SSRF), port-scanning behind the firewall or DoS the application."
date: "2017-07-25"
pubdate: "2017-07-19"
affected_range: "(,1.0.10]"
fixed_versions:
- "2.0"
affected_versions: "All versions up to 1.0.10"
not_impacted: "All versions after 1.0.10"
solution: "Upgrade to version 2.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2016-6798"
- "http://www.securityfocus.com/bid/99873"
cvss_v2: "AV:N/AC:L/Au:N/C:P/I:P/A:P"
cvss_v3: "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "bf968c2c-9858-48f7-82bb-449b58aa78a6"
cwe_ids:
- "CWE-1035"
- "CWE-611"
- "CWE-937"
identifiers:
- "CVE-2016-6798"
