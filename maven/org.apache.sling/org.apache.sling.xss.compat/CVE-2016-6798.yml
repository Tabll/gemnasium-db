---
identifier: "CVE-2016-6798"
identifiers:
- "GHSA-7g54-vgp6-jj5w"
- "CVE-2016-6798"
package_slug: "maven/org.apache.sling/org.apache.sling.xss.compat"
title: "Improper Restriction of XML External Entity Reference"
description: "In the XSS Protection API module before 1.0.12 in Apache Sling, the
  method XSS.getValidXML() uses an insecure SAX parser to validate the input string,
  which allows for XXE attacks in all scripts which use this method to validate user
  input, potentially allowing an attacker to read sensitive data on the filesystem,
  perform same-site-request-forgery (SSRF), port-scanning behind the firewall or DoS
  the application."
date: "2023-10-11"
pubdate: "2022-05-17"
affected_range: "(,1.1.0)"
fixed_versions:
- "1.1.0"
affected_versions: "All versions before 1.1.0"
not_impacted: "All versions starting from 1.1.0"
solution: "Upgrade to version 1.1.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2016-6798"
- "https://lists.apache.org/thread.html/b72c3a511592ec70729b3ec2d29302b6ce87bbeab62d4745617a6bd0@%3Cdev.sling.apache.org%3E"
- "http://www.securityfocus.com/bid/99873"
- "https://github.com/apache/sling-org-apache-sling-xss/commit/de32b144ad2be3367559f6184d560db42a220529"
- "https://github.com/jensdietrich/xshady-release/tree/main/CVE-2016-6798"
- "https://github.com/advisories/GHSA-7g54-vgp6-jj5w"
cvss_v2: "AV:N/AC:L/Au:N/C:P/I:P/A:P"
cvss_v3: "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "7b1af224-fe53-4c84-a26a-fbe0f2318ad0"
cwe_ids:
- "CWE-1035"
- "CWE-611"
- "CWE-79"
- "CWE-937"
