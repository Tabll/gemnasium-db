---
identifier: "CVE-2021-44521"
identifiers:
- "CVE-2021-44521"
package_slug: "maven/org.apache.cassandra/cassandra-all"
title: "Improper Control of Generation of Code ('Code Injection')"
description: "When running Apache Cassandra with the following configuration: enable_user_defined_functions:
  true enable_scripted_user_defined_functions: true enable_user_defined_functions_threads:
  false it is possible for an attacker to execute arbitrary code on the host. The
  attacker would need to have enough permissions to create user defined functions
  in the cluster to be able to exploit this. Note that this configuration is documented
  as unsafe, and will continue to be considered unsafe after this CVE."
date: "2022-02-25"
pubdate: "2022-02-11"
affected_range: "[3.0.0,3.0.26),[3.11.0,3.11.12),[4.0.0,4.0.2)"
fixed_versions:
- "3.0.26"
- "3.11.12"
- "4.0.2"
affected_versions: "All versions starting from 3.0.0 before 3.0.26, all versions starting
  from 3.11.0 before 3.11.12, all versions starting from 4.0.0 before 4.0.2"
not_impacted: "All versions before 3.0.0, all versions starting from 3.0.26 before
  3.11.0, all versions starting from 3.11.12 before 4.0.0, all versions starting from
  4.0.2"
solution: "Upgrade to versions 3.0.26, 3.11.12, 4.0.2 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-44521"
- "https://lists.apache.org/thread/y4nb9s4co34j8hdfmrshyl09lokm7356"
- "http://www.openwall.com/lists/oss-security/2022/02/11/4"
- "https://jfrog.com/blog/cve-2021-44521-exploiting-apache-cassandra-user-defined-functions-for-remote-code-execution/"
cvss_v2: "AV:N/AC:M/Au:S/C:C/I:C/A:C"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H"
uuid: "122f74fd-eb9d-4917-8d0b-06893f6b124e"
cwe_ids:
- "CWE-1035"
- "CWE-937"
- "CWE-94"
