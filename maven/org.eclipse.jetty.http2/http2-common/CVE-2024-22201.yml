---
identifier: "CVE-2024-22201"
identifiers:
- "CVE-2024-22201"
- "GHSA-rggv-cv7r-mw98"
package_slug: "maven/org.eclipse.jetty.http2/http2-common"
title: "Connection leaking on idle timeout when TCP congested"
description: "If an HTTP/2 connection gets TCP congested, when an idle timeout occurs
  the HTTP/2 session is marked as closed, and then a GOAWAY frame is queued to be
  written.\nHowever it is not written because the connection is TCP congested.\nWhen
  another idle timeout period elapses, it is then supposed to hard close the connection,
  but it delegates to the HTTP/2 session which reports that it has already been closed
  so it does not attempt to hard close the connection.\n\nThis leaves the connection
  in ESTABLISHED state (i.e. not closed), TCP congested, and idle.\n\nAn attacker
  can cause many connections to end up in this state, and the server may run out of
  file descriptors, eventually causing the server to stop accepting new connections
  from valid clients.\n\nThe client may also be impacted (if the server does not read
  causing a TCP congestion), but the issue is more severe for servers."
date: "2025-02-07"
pubdate: "2024-02-26"
affected_range: "[9.3.0,9.4.54),[10.0.0,10.0.20),[11.0.0,11.0.20)"
fixed_versions:
- "9.4.54"
- "10.0.20"
- "11.0.20"
affected_versions: "All versions starting from 9.3.0 before 9.4.54, all versions starting
  from 10.0.0 before 10.0.20, all versions starting from 11.0.0 before 11.0.20"
not_impacted: "All versions before 9.3.0, all versions starting from 9.4.54 before
  10.0.0, all versions starting from 10.0.20 before 11.0.0, all versions starting
  from 11.0.20"
solution: "Upgrade to versions 10.0.20, 11.0.20, 9.4.54 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-22201"
- "https://github.com/advisories/GHSA-rggv-cv7r-mw98"
- "https://github.com/jetty/jetty.project/security/advisories/GHSA-rggv-cv7r-mw98"
- "https://github.com/jetty/jetty.project/issues/11256"
- "https://github.com/jetty/jetty.project/issues/11259"
- "https://github.com/jetty/jetty.project/commit/0839a208cdc3fcfe25206a77af59ba9fda260188"
- "https://github.com/jetty/jetty.project/commit/b953871c9a5ff4fbca4a2499848f75182dbd9810"
- "https://github.com/jetty/jetty.project"
- "https://lists.debian.org/debian-lts-announce/2024/04/msg00002.html"
- "https://security.netapp.com/advisory/ntap-20240329-0001"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
uuid: "01c0b582-38b7-415f-9f73-a9d52a8ce3e2"
cwe_ids:
- "CWE-400"
- "CWE-770"
- "CWE-937"
- "CWE-1035"
