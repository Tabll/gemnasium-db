---
identifier: "CVE-2021-45046"
identifiers:
- "CVE-2021-45046"
- "GHSA-7rjr-3q55-vv33"
package_slug: "maven/org.ops4j.pax.logging/pax-logging-log4j2"
title: "Incomplete fix for Apache Log4j vulnerability"
description: "The fix to address [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)
  in Apache Log4j 2.15.0 was incomplete in certain non-default configurations. This
  could allow attackers with control over Thread Context Map (MDC) input data when
  the logging configuration uses a non-default Pattern Layout with either a Context
  Lookup (for example, $${ctx:loginId}) or a Thread Context Map pattern (%X, %mdc,
  or %MDC) to craft malicious input data using a JNDI Lookup pattern resulting in
  a remote code execution (RCE) attack."
date: "2025-05-09"
pubdate: "2021-12-14"
affected_range: "[1.8.0,1.9.2),[1.10.0,1.10.8),[1.11.0,1.11.11),[2.0.0,2.0.12)"
fixed_versions:
- "1.9.2"
- "1.10.8"
- "1.11.11"
- "2.0.12"
affected_versions: "All versions starting from 1.8.0 before 1.9.2, all versions starting
  from 1.10.0 before 1.10.8, all versions starting from 1.11.0 before 1.11.11, all
  versions starting from 2.0.0 before 2.0.12"
not_impacted: "All versions before 1.8.0, all versions starting from 1.9.2 before
  1.10.0, all versions starting from 1.10.8 before 1.11.0, all versions starting from
  1.11.11 before 2.0.0, all versions starting from 2.0.12"
solution: "Upgrade to versions 1.10.8, 1.11.11, 1.9.2, 2.0.12 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2021-45046"
- "https://github.com/advisories/GHSA-7rjr-3q55-vv33"
- "https://www.oracle.com/security-alerts/cpujul2022.html"
- "https://www.oracle.com/security-alerts/cpujan2022.html"
- "https://www.oracle.com/security-alerts/cpuapr2022.html"
- "https://www.oracle.com/security-alerts/alert-cve-2021-44228.html"
- "https://www.openwall.com/lists/oss-security/2021/12/14/4"
- "https://www.kb.cert.org/vuls/id/930724"
- "https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00646.html"
- "https://www.debian.org/security/2021/dsa-5022"
- "https://www.cve.org/CVERecord?id=CVE-2021-44228"
- "https://security.gentoo.org/glsa/202310-16"
- "https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-apache-log4j-qRuKNEbd"
- "https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2021-0032"
- "https://logging.apache.org/log4j/2.x/security.html"
- "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/SIG7FZULMNK2XF6FZRU4VWYDQXNMUGAJ"
- "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/EOKPQGV24RRBBI4TBZUDQMM4MEH7MXCY"
- "https://github.com/advisories/GHSA-jfh8-c2jp-5v3q"
- "https://cert-portal.siemens.com/productcert/pdf/ssa-714170.pdf"
- "https://cert-portal.siemens.com/productcert/pdf/ssa-661247.pdf"
- "https://cert-portal.siemens.com/productcert/pdf/ssa-479842.pdf"
- "https://cert-portal.siemens.com/productcert/pdf/ssa-397453.pdf"
cvss_v2: "AV:N/AC:H/Au:N/C:P/I:P/A:P"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H"
uuid: "e346ca5e-2abc-438c-a1e2-6266d3eb0a8c"
cwe_ids:
- "CWE-502"
- "CWE-917"
- "CWE-937"
- "CWE-1035"
