---
identifier: "CVE-2024-23953"
identifiers:
- "CVE-2024-23953"
- "GHSA-p953-3j66-hg45"
package_slug: "maven/org.apache.hive/hive-llap-common"
title: "Apache Hive vulnerable to Observable Timing Discrepancy and Authentication
  Bypass by Spoofing"
description: "Use of Arrays.equals() in LlapSignerImpl in Apache Hive to compare message
  signatures allows attacker to forge a valid signature for an arbitrary message byte
  by byte. The attacker should be an authorized user of the product to perform this
  attack. Users are recommended to upgrade to version 4.0.0, which fixes this issue.\n\nThe
  problem occurs when an application doesn’t use a constant-time algorithm for validating
  a signature. The method Arrays.equals() returns false right away when it sees that
  one of the input’s bytes are different. It means that the comparison time depends
  on the contents of the arrays. This little thing may allow an attacker to forge
  a valid signature for an arbitrary message byte by byte. So it might allow malicious
  users to submit splits/work with selected signatures to LLAP without running as
  a privileged user, potentially leading to DDoS attack.\n\nMore details in the reference
  section."
date: "2025-01-28"
pubdate: "2025-01-28"
affected_range: "[,4.0.0)"
fixed_versions:
- "4.0.0"
affected_versions: "All versions before 4.0.0"
not_impacted: "All versions starting from 4.0.0"
solution: "Upgrade to version 4.0.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-23953"
- "https://github.com/advisories/GHSA-p953-3j66-hg45"
- "https://github.com/apache/hive/commit/b418e3c9f479ba8e7d31e6470306111002ffa809"
- "https://blog.gypsyengineer.com/en/security/preventing-timing-attacks-with-codeql.html"
- "https://cqr.company/web-vulnerabilities/timing-attacks"
- "https://github.com/apache/hive"
- "https://issues.apache.org/jira/browse/HIVE-28030"
- "https://lists.apache.org/thread/0nloywj49nbtlc6l3c6363qvq7o1ztb7"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N"
uuid: "6d966074-78ea-4229-90c6-658d1d49f6eb"
cwe_ids:
- "CWE-208"
- "CWE-290"
- "CWE-937"
- "CWE-1035"
