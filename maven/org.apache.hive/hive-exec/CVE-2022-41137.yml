---
identifier: "CVE-2022-41137"
identifiers:
- "CVE-2022-41137"
- "GHSA-6hqr-c69m-r76q"
package_slug: "maven/org.apache.hive/hive-exec"
title: "Apache Hive: Deserialization of untrusted data when fetching partitions from
  the Metastore"
description: "Apache Hive Metastore (HMS) uses SerializationUtilities#deserializeObjectWithTypeInformation method
  when filtering and fetching partitions that is unsafe and can lead to Remote Code
  Execution (RCE) since it allows the deserialization of arbitrary data.\n\nIn real
  deployments, the vulnerability can be exploited only by authenticated users/clients
  that were able to successfully establish a connection to the Metastore. From an
  API perspective any code that calls the unsafe method may be vulnerable unless it
  performs additional prerechecks on the input arguments."
date: "2024-12-05"
pubdate: "2024-12-05"
affected_range: "[4.0.0-alpha-1,4.0.0-alpha-2),[4.0.0-alpha-1,4.0.0-alpha-1]"
fixed_versions:
- "4.0.0-alpha-2"
affected_versions: "All versions starting from 4.0.0-alpha-1 before 4.0.0-alpha-2,
  version 4.0.0-alpha-1"
not_impacted: ""
solution: "Upgrade to version 4.0.0-alpha-2 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-41137"
- "https://github.com/advisories/GHSA-6hqr-c69m-r76q"
- "https://github.com/apache/hive/commit/60027bb9c91a93affcfebd9068f064bc1f2a74c9"
- "https://github.com/apache/hive"
- "https://issues.apache.org/jira/browse/HIVE-26539"
- "https://lists.apache.org/thread/jwtr3d9yovf2wo0qlxvkhoxnwxxyzgts"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:H"
uuid: "e0ef1956-a7eb-4f4a-bb8f-ae5c3cc1602b"
cwe_ids:
- "CWE-502"
- "CWE-937"
- "CWE-1035"
