---
identifier: "CVE-2023-36820"
identifiers:
- "CVE-2023-36820"
- "GHSA-qw22-8w9r-864h"
package_slug: "maven/io.micronaut.security/micronaut-security-oauth2"
title: "io.micronaut.security:micronaut-security-oauth2 has invalid IdTokenClaimsValidator
  logic on aud"
description: "IdTokenClaimsValidator skips `aud` claim validation if token is issued
  by same identity issuer/provider."
date: "2023-10-13"
pubdate: "2023-10-09"
affected_range: "(,3.1),[3.1.0,3.1.2),[3.2.0,3.2.4),[3.3.0,3.3.2),[3.4.0,3.4.3),
  [3.5.0,3.5.3),[3.6.0,3.6.6),[3.7.0,3.7.4),[3.8.0,3.8.4),[3.9.0,3.9.6),[3.10.0,3.10.2),
  [3.11.0,3.11.1)"
fixed_versions:
- "3.10.2"
- "3.11.1"
- "3.8.4"
- "3.9.6"
- "3.4.3"
- "3.5.3"
- "3.6.6"
- "3.7.4"
- "3.1.2"
- "3.2.4"
- "3.3.2"
affected_versions: "All versions before 3.1, all versions starting from 3.1.0 before
  3.1.2, all versions starting from 3.2.0 before 3.2.4, all versions starting from
  3.3.0 before 3.3.2, all versions starting from 3.4.0 before 3.4.3, all versions
  starting from 3.5.0 before 3.5.3, all versions starting from 3.6.0 before 3.6.6,
  all versions starting from 3.7.0 before 3.7.4, all versions starting from 3.8.0
  before 3.8.4, all versions starting from 3.9.0 before 3.9.6, all versions starting
  from 3.10.0 before 3.10.2, all versions starting from 3.11.0 before 3.11.1"
not_impacted: "All versions starting from 3.1.0 before 3.1.0, all versions starting
  from 3.1.2 before 3.2.0, all versions starting from 3.2.4 before 3.3.0, all versions
  starting from 3.3.2 before 3.4.0, all versions starting from 3.4.3 before 3.5.0,
  all versions starting from 3.5.3 before 3.6.0, all versions starting from 3.6.6
  before 3.7.0, all versions starting from 3.7.4 before 3.8.0, all versions starting
  from 3.8.4 before 3.9.0, all versions starting from 3.9.6 before 3.10.0, all versions
  starting from 3.10.2 before 3.11.0, all versions starting from 3.11.1"
solution: "Upgrade to versions 3.10.2, 3.11.1, 3.8.4, 3.9.6, 3.4.3, 3.5.3, 3.6.6,
  3.7.4, 3.1.2, 3.2.4, 3.3.2 or above."
urls:
- "https://github.com/micronaut-projects/micronaut-security/security/advisories/GHSA-qw22-8w9r-864h"
- "https://github.com/micronaut-projects/micronaut-security/commit/9728b925221a0d87798ccf250657a3c214b7e980"
- "https://github.com/advisories/GHSA-qw22-8w9r-864h"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N"
uuid: "57026418-304d-4b67-95e3-10897c17737b"
cwe_ids:
- "CWE-1035"
- "CWE-284"
- "CWE-937"
