---
identifier: "CVE-2020-1938"
package_slug: "maven/org.apache.tomcat/tomcat-coyote"
title: "Improper Input Validation"
description: "When using the Apache JServ Protocol (AJP), care must be taken when
  trusting incoming connections to Apache Tomcat. Tomcat treats AJP connections as
  having higher trust than, for example, a similar HTTP connection. If such connections
  are available to an attacker, they can be exploited in ways that may be surprising.
  Tomcat is shipped with an AJP Connector enabled by default that listened on all
  configured IP addresses. It was expected (and recommended in the security guide)
  that this Connector would be disabled if not required. This vulnerability report
  identified a mechanism that allowed: - returning arbitrary files from anywhere in
  the web application - processing any file in the web application as a JSP Further,
  if the web application allowed file upload and stored those files within the web
  application (or the attacker was able to control the content of the web application
  by some other means) then this, along with the ability to process a file as a JSP,
  made remote code execution possible. It is important to note that mitigation is
  only required if an AJP port is accessible to untrusted users."
date: "2020-02-27"
pubdate: "2020-02-24"
affected_range: "[7.0.0,7.0.99],[8.5.0,8.5.50],[9.0.0,9.0.30]"
fixed_versions:
- "7.0.100"
- "8.5.51"
- "9.0.31"
affected_versions: "All versions starting from 7.0.0 up to 7.0.99, all versions starting
  from 8.5.0 up to 8.5.50, all versions starting from 9.0.0 up to 9.0.30"
not_impacted: "All versions before 7.0.0, all versions after 7.0.99 before 8.5.0,
  all versions after 8.5.50 before 9.0.0, all versions after 9.0.30"
solution: "Upgrade to versions 7.0.100, 8.5.51, 9.0.31 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2020-1938"
cvss_v2: "AV:N/AC:L/Au:N/C:P/I:P/A:P"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "b4a3875c-77b8-4467-bbaf-e8a3900a9888"
