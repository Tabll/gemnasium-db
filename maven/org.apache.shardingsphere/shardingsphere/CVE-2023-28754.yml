---
identifier: "CVE-2023-28754"
identifiers:
- "CVE-2023-28754"
package_slug: "maven/org.apache.shardingsphere/shardingsphere"
title: "Deserialization of Untrusted Data"
description: "Deserialization of Untrusted Data vulnerability in Apache ShardingSphere-Agent,
  which allows attackers to execute arbitrary code by constructing a special YAML
  configuration file.\n\nThe attacker needs to have permission to modify the ShardingSphere
  Agent YAML configuration file on the target machine, and the target machine can
  access the URL with the arbitrary code JAR.\nAn attacker can use SnakeYAML to deserialize
  java.net.URLClassLoader and make it load a JAR from a specified URL, and then deserialize
  javax.script.ScriptEngineManager to load code using that ClassLoader. When the ShardingSphere
  JVM process starts and uses the ShardingSphere-Agent, the arbitrary code specified
  by the attacker will be executed during the deserialization of the YAML configuration
  file by the Agent.\n\nThis issue affects ShardingSphere-Agent: through 5.3.2. This
  vulnerability is fixed in Apache ShardingSphere 5.4.0."
date: "2023-07-28"
pubdate: "2023-07-19"
affected_range: "(,5.4.0)"
fixed_versions:
- "5.4.0"
affected_versions: "All versions before 5.4.0"
not_impacted: "All versions starting from 5.4.0"
solution: "Upgrade to version 5.4.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-28754"
- "https://lists.apache.org/thread/p8onhqox5kkwow9lc6gs03z28wtyp1cg"
- "http://www.openwall.com/lists/oss-security/2023/07/19/3"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
uuid: "404c0222-21c6-4c48-bc00-2dc07be935a5"
cwe_ids:
- "CWE-1035"
- "CWE-502"
- "CWE-937"
