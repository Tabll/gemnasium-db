---
identifier: "CVE-2023-50298"
identifiers:
- "CVE-2023-50298"
package_slug: "maven/org.apache.solr/solr-core"
title: "Exposure of Sensitive Information to an Unauthorized Actor"
description: "Exposure of Sensitive Information to an Unauthorized Actor vulnerability
  in Apache Solr.This issue affects Apache Solr: from 6.0.0 through 8.11.2, from 9.0.0
  before 9.4.1.\n\nSolr Streaming Expressions allows users to extract data from other
  Solr Clouds, using a \"zkHost\" parameter.\nWhen original SolrCloud is setup to
  use ZooKeeper credentials and ACLs, they will be sent to whatever \"zkHost\" the
  user provides.\nAn attacker could setup a server to mock ZooKeeper, that accepts
  ZooKeeper requests with credentials and ACLs and extracts the sensitive information,\nthen
  send a streaming expression using the mock server's address in \"zkHost\".\nStreaming
  Expressions are exposed via the \"/streaming\" handler, with \"read\" permissions.\n\nUsers
  are recommended to upgrade to version 8.11.3 or 9.4.1, which fix the issue.\nFrom
  these versions on, only zkHost values that have the same server address (regardless
  of chroot), will use the given ZooKeeper credentials and ACLs when connecting.\n\n"
date: "2024-02-15"
pubdate: "2024-02-09"
affected_range: "[6.0.0,8.11.3),[9.0.0,9.4.1)"
fixed_versions:
- "8.11.3"
- "9.4.1"
affected_versions: "All versions starting from 6.0.0 before 8.11.3, all versions starting
  from 9.0.0 before 9.4.1"
not_impacted: "All versions before 6.0.0, all versions starting from 8.11.3 before
  9.0.0, all versions starting from 9.4.1"
solution: "Upgrade to versions 8.11.3, 9.4.1 or above."
urls:
- "http://www.openwall.com/lists/oss-security/2024/02/09/2"
- "http://www.openwall.com/lists/oss-security/2024/02/09/3"
- "https://solr.apache.org/security.html#cve-2023-50298-apache-solr-can-expose-zookeeper-credentials-via-streaming-expressions"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-50298"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"
uuid: "a090088f-7c8b-400b-822f-49d65a1c8fd5"
cwe_ids:
- "CWE-1035"
- "CWE-937"
...
