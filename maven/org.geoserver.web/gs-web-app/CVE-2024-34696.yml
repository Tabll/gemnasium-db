---
identifier: "CVE-2024-34696"
identifiers:
- "CVE-2024-34696"
- "GHSA-j59v-vgcr-hxvf"
package_slug: "maven/org.geoserver.web/gs-web-app"
title: " GeoServer's Server Status shows sensitive environmental variables and Java
  properties"
description: "GeoServer's Server Status page and REST API (at `/geoserver/rest/about/status`)
  lists *all* environment variables and Java properties to *any* GeoServer user with
  administrative rights as part of those modules' status message.\n\nThese variables/properties
  can also contain sensitive information, such as database passwords or API keys/tokens,
  for example:\n\n* Data stores defined with [parameterized catalog settings][catalog]
  (`-DALLOW_ENV_PARAMETRIZATION=true`) which need a password or access key.\n\n* GeoServer's
  official Docker image [uses environment variables to configure PostgreSQL JNDI resources,
  including credentials][docker-jndi] (`POSTGRES_HOST`, `POSTGRES_USERNAME`, `POSTGRES_PASSWORD`)\n\nAdditionally,
  many community-developed GeoServer container images `export` other credentials from
  their start-up scripts as environment variables to the GeoServer (`java`) process,
  such as:\n\n* GeoServer `admin` and master (`root`) passwords\n\n* Tomcat management
  application password\n\n* HTTPS/TLS certificate key store password\n\n* AWS S3 bucket
  access keys\n\nThe precise scope of the issue depends on which container image is
  used and how it is configured.\n\n> [!NOTE]\n> Some container images allow passing
  secrets as files (eg: `POSTGRES_PASSWORD_FILE`), or randomly generating passwords
  on start-up. While this is promoted as best-practice[^secret-files], if its start-up
  script [`export`s these as environment variables][bash-export] to GeoServer, they
  are **also** impacted by this issue.\n\n[bash-export]: https://www.gnu.org/software/bash/manual/html_node/Bourne-Shell-Builtins.html#index-export\n[catalog]:
  https://docs.geoserver.org/latest/en/user/datadirectory/configtemplate.html\n[docker-jndi]:
  https://github.com/geoserver/docker/blob/master/README.md#how-to-enable-a-postgresql-jndi-resource"
date: "2024-07-01"
pubdate: "2024-07-01"
affected_range: "[2.10.0,2.24.4),[2.25.0,2.25.1)"
fixed_versions:
- "2.24.4"
- "2.25.1"
affected_versions: "All versions starting from 2.10.0 before 2.24.4, all versions
  starting from 2.25.0 before 2.25.1"
not_impacted: "All versions before 2.10.0, all versions starting from 2.24.4 before
  2.25.0, all versions starting from 2.25.1"
solution: "Upgrade to versions 2.24.4, 2.25.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-34696"
- "https://github.com/advisories/GHSA-j59v-vgcr-hxvf"
- "https://github.com/geoserver/geoserver/security/advisories/GHSA-j59v-vgcr-hxvf"
- "https://github.com/geoserver/geoserver"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:H/I:N/A:N"
uuid: "4a9a11d5-c48a-464c-bfb0-20f0c0897ad1"
cwe_ids:
- "CWE-200"
- "CWE-937"
- "CWE-1035"
