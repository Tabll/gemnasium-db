---
identifier: "CVE-2023-44981"
identifiers:
- "CVE-2023-44981"
- "GHSA-7286-pgfv-vxvh"
package_slug: "maven/org.apache.zookeeper/zookeeper"
title: "Authorization Bypass Through User-Controlled Key"
description: "Authorization Bypass Through User-Controlled Key vulnerability in Apache
  ZooKeeper. If SASL Quorum Peer authentication is enabled in ZooKeeper (quorum.auth.enableSasl=true),
  the authorization is done by verifying that the instance part in SASL authentication
  ID is listed in zoo.cfg server list. The instance part in SASL auth ID is optional
  and if it's missing, like 'eve@EXAMPLE.COM', the authorization check will be skipped. As
  a result an arbitrary endpoint could join the cluster and begin propagating counterfeit
  changes to the leader, essentially giving it complete read-write access to the data
  tree. Quorum Peer authentication is not enabled by default.\n\nUsers are recommended
  to upgrade to version 3.9.1, 3.8.3, 3.7.2, which fixes the issue.\n\nAlternately
  ensure the ensemble election/quorum communication is protected by a firewall as
  this will mitigate the issue.\n\nSee the documentation for more details on correct
  cluster administration.\n"
date: "2024-02-21"
pubdate: "2023-10-11"
affected_range: "(,3.7.2),[3.8.0,3.8.3),[3.9.0]"
fixed_versions:
- "3.7.2"
- "3.8.3"
- "3.9.1"
affected_versions: "All versions before 3.7.2, all versions starting from 3.8.0 before
  3.8.3, version 3.9.0"
not_impacted: "All versions starting from 3.7.2 before 3.8.0, all versions starting
  from 3.8.3 before 3.9.0, all versions after 3.9.0"
solution: "Upgrade to versions 3.7.2, 3.8.3, 3.9.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-44981"
- "https://lists.apache.org/thread/wf0yrk84dg1942z1o74kd8nycg6pgm5b"
- "http://www.openwall.com/lists/oss-security/2023/10/11/4"
- "https://github.com/advisories/GHSA-7286-pgfv-vxvh"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N"
uuid: "ed5e042f-a697-4c1d-841a-5750fcb7452a"
cwe_ids:
- "CWE-1035"
- "CWE-639"
- "CWE-937"
