---
identifier: "CVE-2024-23944"
identifiers:
- "CVE-2024-23944"
- "GHSA-r978-9m6m-6gm6"
package_slug: "maven/org.apache.zookeeper/zookeeper"
title: "Apache ZooKeeper vulnerable to information disclosure in persistent watchers
  handling"
description: "Information disclosure in persistent watchers handling in Apache ZooKeeper
  due to missing ACL check. It allows an attacker to monitor child znodes by attaching
  a persistent watcher (addWatch command) to a parent which the attacker has already
  access to. ZooKeeper server doesn't do ACL check when the persistent watcher is
  triggered and as a consequence, the full path of znodes that a watch event gets
  triggered upon is exposed to the owner of the watcher. It's important to note that
  only the path is exposed by this vulnerability, not the data of znode, but since
  znode path can contain sensitive information like user name or login ID, this issue
  is potentially critical.\n\nUsers are recommended to upgrade to version 3.9.2, 3.8.4
  which fixes the issue.\n"
date: "2024-03-15"
pubdate: "2024-03-15"
affected_range: "[3.8.0,3.8.4),[3.9.0,3.9.2),[3.6.0,3.7.2]"
fixed_versions:
- "3.8.4"
- "3.9.2"
affected_versions: "All versions starting from 3.6.0 up to 3.7.2, all versions starting
  from 3.8.0 before 3.8.4, all versions starting from 3.9.0 before 3.9.2"
not_impacted: "All versions before 3.6.0, all versions after 3.7.2 before 3.8.0, all
  versions starting from 3.8.4 before 3.9.0, all versions starting from 3.9.2"
solution: "Upgrade to versions 3.8.4, 3.9.2 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-23944"
- "https://github.com/advisories/GHSA-r978-9m6m-6gm6"
- "https://github.com/apache/zookeeper/commit/29c7b9462681f47c2ac12e609341cf9f52abac5c"
- "https://github.com/apache/zookeeper/commit/65b91d2d9a56157285c2a86b106e67c26520b01d"
- "https://github.com/apache/zookeeper/commit/daf7cfd04005cff1a4f7cab5ab13d41db88d0cd8"
- "https://github.com/apache/zookeeper"
- "https://lists.apache.org/thread/96s5nqssj03rznz9hv58txdb2k1lr79k"
uuid: "a6c7d1bd-19d6-4ace-bc9d-eabc05043efa"
cwe_ids:
- "CWE-200"
- "CWE-937"
- "CWE-1035"
