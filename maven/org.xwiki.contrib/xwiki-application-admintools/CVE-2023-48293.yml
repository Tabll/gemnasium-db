---
identifier: "CVE-2023-48293"
identifiers:
- "GHSA-4f4c-rhjv-4wgv"
- "CVE-2023-48293"
package_slug: "maven/org.xwiki.contrib/xwiki-application-admintools"
title: "Cross-Site Request Forgery (CSRF)"
description: "The XWiki Admin Tools Application provides tools to help the administration
  of XWiki. Prior to version 4.5.1, a cross-site request forgery vulnerability in
  the query on XWiki tool allows executing arbitrary database queries on the database
  of the XWiki installation. Among other things, this allows modifying and deleting
  all data of the wiki. This could be both used to damage the wiki and to create an
  account with elevated privileges for the attacker, thus impacting the confidentiality,
  integrity and availability of the whole XWiki instance. A possible attack vector
  are comments on the wiki, by embedding an image with wiki syntax like `[[image:path:/xwiki/bin/view/Admin/QueryOnXWiki?query=DELETE%20FROM%20xwikidoc]]`,
  all documents would be deleted from the database when an admin user views this comment.
  This has been patched in Admin Tools Application 4.5.1 by adding form token checks.
  Some workarounds are available. The patch can also be applied manually to the affected
  pages. Alternatively, if the query tool is not needed, by deleting the document
  `Admin.SQLToolsGroovy`, all database query tools can be deactivated."
date: "2023-11-20"
pubdate: "2023-11-20"
affected_range: "(,4.5.1)"
fixed_versions:
- "4.5.1"
affected_versions: "All versions before 4.5.1"
not_impacted: "All versions starting from 4.5.1"
solution: "Upgrade to version 4.5.1 or above."
urls:
- "https://github.com/xwiki-contrib/application-admintools/security/advisories/GHSA-4f4c-rhjv-4wgv"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-48293"
- "https://github.com/xwiki-contrib/application-admintools/commit/45298b4fbcafba6914537dcdd798a1e1385f9e46"
- "https://jira.xwiki.org/browse/ADMINTOOL-92"
- "https://github.com/advisories/GHSA-4f4c-rhjv-4wgv"
uuid: "59b54580-0267-4c54-ad89-c92211fd9022"
cwe_ids:
- "CWE-1035"
- "CWE-352"
- "CWE-937"
