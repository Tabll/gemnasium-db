---
identifier: "CVE-2023-37895"
identifiers:
- "CVE-2023-37895"
- "GHSA-q8cm-3v62-jj79"
package_slug: "maven/org.apache.jackrabbit/jackrabbit-standalone-components"
title: "Remote code execution in Apache Jackrabbit"
description: "Java object deserialization issue in Jackrabbit webapp/standalone on
  all platforms allows attacker to remotely execute code via RMIVersions up to (including)
  2.20.10 (stable branch) and 2.21.17 (unstable branch) use the component \"commons-beanutils\",
  which contains a class that can be used for remote code execution over RMI.\n\nUsers
  are advised to immediately update to versions 2.20.11 or 2.21.18. Note that earlier
  stable branches (1.0.x .. 2.18.x) have been EOLd already and do not receive updates
  anymore.\n\nIn general, RMI support can expose vulnerabilities by the mere presence
  of an exploitable class on the classpath. Even if Jackrabbit itself does not contain
  any code known to be exploitable anymore, adding other components to your server
  can expose the same type of problem. We therefore recommend to disable RMI access
  altogether (see further below), and will discuss deprecating RMI support in future
  Jackrabbit releases.\n\nHow to check whether RMI support is enabledRMI support can
  be over an RMI-specific TCP port, and over an HTTP binding. Both are by default
  enabled in Jackrabbit webapp/standalone.\n\nThe native RMI protocol by default uses
  port 1099. To check whether it is enabled, tools like \"netstat\" can be used to
  check.\n\nRMI-over-HTTP in Jackrabbit by default uses the path \"/rmi\". So when
  running standalone on port 8080, check whether an HTTP GET request on localhost:8080/rmi
  returns 404 (not enabled) or 200 (enabled). Note that the HTTP path may be different
  when the webapp is deployed in a container as non-root context, in which case the
  prefix is under the user's control.\n\nTurning off RMIFind web.xml (either in JAR/WAR
  file or in unpacked web application folder), and remove the declaration and the
  mapping definition for the RemoteBindingServlet:
  <servlet>
  <servlet-name>RMI</servlet-name>
  <servlet-class>org.apache.jackrabbit.servlet.remote.RemoteBindingServlet</servlet-class>
  </servlet>
  
  <servlet-mapping>
  <servlet-name>RMI</servlet-name>
  <url-pattern>/rmi</url-pattern>
  </servlet-mapping>
  
  Find the bootstrap.properties file (in $REPOSITORY_HOME), and set
  rmi.enabled=false and also remove 
  rmi.host 
  rmi.port
  rmi.url-pattern
  
  If there is no file named bootstrap.properties in $REPOSITORY_HOME, it is located 
  somewhere in the classpath. In this case, place a copy in $REPOSITORY_HOME 
  and modify it as explained."
date: "2025-02-13"
pubdate: "2023-07-25"
affected_range: "[2.21.0,2.21.18),[1.0.0,2.20.11)"
fixed_versions:
- "2.21.18"
- "2.20.11"
affected_versions: "All versions starting from 1.0.0 before 2.20.11, all versions
  starting from 2.21.0 before 2.21.18"
not_impacted: "All versions before 1.0.0, all versions starting from 2.20.11 before
  2.21.0, all versions starting from 2.21.18"
solution: "Upgrade to versions 2.20.11, 2.21.18 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2023-37895"
- "https://github.com/advisories/GHSA-q8cm-3v62-jj79"
- "https://github.com/apache/jackrabbit"
- "https://lists.apache.org/list.html?users@jackrabbit.apache.org"
- "https://lists.apache.org/thread/j03b3qdhborc2jrhdc4d765d3jkh8bfw"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "5c52cfb4-fe5b-409b-a491-6e38e58596aa"
cwe_ids:
- "CWE-502"
- "CWE-937"
- "CWE-1035"
