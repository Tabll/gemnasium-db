---
identifier: "CVE-2022-33681"
identifiers:
- "CVE-2022-33681"
package_slug: "maven/org.apache.pulsar/pulsar"
title: "Improper Certificate Validation"
description: "Delayed TLS hostname verification in the Pulsar Java Client and the
  Pulsar Proxy make each client vulnerable to a man in the middle attack. Connections
  from the Pulsar Java Client to the Pulsar Broker/Proxy and connections from the
  Pulsar Proxy to the Pulsar Broker is vulnerable. Authentication data is sent before
  verifying the server’s TLS certificate matches the hostname, which means authentication
  data could be exposed to an attacker. An attacker can only take advantage of this
  vulnerability by taking control of a machine 'between' the client and the server.
  The attacker must then actively manipulate traffic to perform the attack by providing
  the client with a cryptographically valid certificate for an unrelated host. Because
  the client sends authentication data before performing hostname verification, an
  attacker could gain access to the client’s authentication data. The client eventually
  closes the connection when it verifies the hostname and identifies the targeted
  hostname does not match a hostname on the certificate. Because the client eventually
  closes the connection, the value of the intercepted authentication data depends
  on the authentication method used by the client. Token based authentication and
  username/password authentication methods is vulnerable because the authentication
  data can be used to impersonate the client in a separate session. This issue affects
  Apache Pulsar Java Client versions 2.7.0 to 2.7.4; 2.8.0 to 2.8.3; 2.9.0 to 2.9.2;
  2.10.0; 2.6.4 and earlier."
date: "2022-09-27"
pubdate: "2022-09-23"
affected_range: "(,2.7.5),[2.8.0,2.8.4),[2.9.0,2.9.3),[2.10.0]"
fixed_versions:
- "2.7.5"
- "2.8.4"
- "2.9.3"
affected_versions: "All versions before 2.7.5, all versions starting from 2.8.0 before
  2.8.4, all versions starting from 2.9.0 before 2.9.3, version 2.10.0"
not_impacted: ""
solution: "Upgrade to versions 2.7.5, 2.8.4, 2.9.3 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-33681"
- "https://lists.apache.org/thread/fpo6x10trvn20hlk0dmnr5vlz5v4kl3d"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N"
uuid: "4036d199-4c45-4798-ac05-016610e7333f"
cwe_ids:
- "CWE-1035"
- "CWE-295"
- "CWE-937"
