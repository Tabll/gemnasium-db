---
identifier: "CVE-2024-27317"
identifiers:
- "CVE-2024-27317"
- "GHSA-jg2g-4rjg-cmqh"
package_slug: "maven/org.apache.pulsar/pulsar-functions-worker"
title: "Apache Pulsar: Pulsar Functions Worker's Archive Extraction Vulnerability
  Allows Unauthorized File Modification"
description: "In Pulsar Functions Worker, authenticated users can upload functions
  in jar or nar files. These files, essentially zip files, are extracted by the Functions
  Worker. However, if a malicious file is uploaded, it could exploit a directory traversal
  vulnerability. This occurs when the filenames in the zip files, which aren't properly
  validated, contain special elements like \"..\", altering the directory path. This
  could allow an attacker to create or modify files outside of the designated extraction
  directory, potentially influencing system behavior. This vulnerability also applies
  to the Pulsar Broker when it is configured with \"functionsWorkerEnabled=true\".\n\nThis
  issue affects Apache Pulsar versions from 2.4.0 to 2.10.5, from 2.11.0 to 2.11.3,
  from 3.0.0 to 3.0.2, from 3.1.0 to 3.1.2, and 3.2.0. \n\n2.10 Pulsar Function Worker
  users should upgrade to at least 2.10.6.\n2.11 Pulsar Function Worker users should
  upgrade to at least 2.11.4.\n3.0 Pulsar Function Worker users should upgrade to
  at least 3.0.3.\n3.1 Pulsar Function Worker users should upgrade to at least 3.1.3.\n3.2
  Pulsar Function Worker users should upgrade to at least 3.2.1.\n\nUsers operating
  versions prior to those listed above should upgrade to the aforementioned patched
  versions or newer versions."
date: "2024-03-14"
pubdate: "2024-03-12"
affected_range: "[2.4.0,2.10.6),[2.11.0,2.11.4),[3.0.0,3.0.3),[3.1.0,3.1.3),[3.2.0,3.2.1)"
fixed_versions:
- "2.10.6"
- "2.11.4"
- "3.0.3"
- "3.1.3"
- "3.2.1"
affected_versions: "All versions starting from 2.4.0 before 2.10.6, all versions starting
  from 2.11.0 before 2.11.4, all versions starting from 3.0.0 before 3.0.3, all versions
  starting from 3.1.0 before 3.1.3, all versions starting from 3.2.0 before 3.2.1"
not_impacted: "All versions before 2.4.0, all versions starting from 2.10.6 before
  2.11.0, all versions starting from 2.11.4 before 3.0.0, all versions starting from
  3.0.3 before 3.1.0, all versions starting from 3.1.3 before 3.2.0, all versions
  starting from 3.2.1"
solution: "Upgrade to versions 2.10.6, 2.11.4, 3.0.3, 3.1.3, 3.2.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-27317"
- "https://github.com/advisories/GHSA-jg2g-4rjg-cmqh"
- "https://github.com/apache/pulsar"
- "https://lists.apache.org/thread/ct9xmvlf7lompc1pxvlsb60qstfsm9po"
- "https://pulsar.apache.org/security/CVE-2024-27317"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:L"
uuid: "7bba1495-b640-4ce6-aff0-520ed011aabe"
cwe_ids:
- "CWE-22"
- "CWE-937"
- "CWE-1035"
