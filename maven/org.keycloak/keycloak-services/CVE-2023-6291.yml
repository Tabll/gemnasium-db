---
identifier: "CVE-2023-6291"
identifiers:
- "CVE-2023-6291"
- "GHSA-mpwq-j3xf-7m5w"
package_slug: "maven/org.keycloak/keycloak-services"
title: "The redirect_uri validation logic allows for bypassing explicitly allowed
  hosts that would otherwise be restricted"
description: "An issue was found in the redirect_uri validation logic that allows
  for a bypass of otherwise explicitly allowed hosts.\n\nThe problem arises in the
  verifyRedirectUri method, which attempts to enforce rules on user-controllable input,
  but essentially causes a desynchronization in how Keycloak and browsers interpret
  URLs. Keycloak, for example, receives \"[www%2ekeycloak%2eorg%2fapp%2f:y@example.com](https://www%2ekeycloak%2eorg%2fapp%2f:y@example.com/)\"
  and thinks the authority to be keycloak.org when it is actually example.com. This
  happens because the validation logic is performed on a URL decoded version, which
  no longer represents the original input.\n\n### Acknowledgements\nKarel Knibbe "
date: "2024-02-14"
pubdate: "2024-01-26"
affected_range: "(,22.0.7)"
fixed_versions:
- "23.0.0"
affected_versions: "All versions before 22.0.7"
not_impacted: "All versions starting from 22.0.7"
solution: "Upgrade to version 23.0.0 or above."
urls:
- "https://github.com/keycloak/keycloak/security/advisories/GHSA-mpwq-j3xf-7m5w"
- "https://github.com/keycloak/keycloak/commit/b2e91105315ccf2c1df549b4f6c5948322cbfd1b"
- "https://github.com/advisories/GHSA-mpwq-j3xf-7m5w"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:L"
uuid: "e3365d4d-b063-4f2b-91b3-a8d645fff9b7"
cwe_ids:
- "CWE-1035"
- "CWE-601"
- "CWE-937"
