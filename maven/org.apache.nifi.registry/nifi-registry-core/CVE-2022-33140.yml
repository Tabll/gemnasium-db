---
identifier: "CVE-2022-33140"
identifiers:
- "GHSA-77hf-23pq-2g7c"
- "CVE-2022-33140"
package_slug: "maven/org.apache.nifi.registry/nifi-registry-core"
title: "Improper Neutralization of Special Elements used in an OS Command ('OS Command
  Injection')"
description: "The optional ShellUserGroupProvider in Apache NiFi 1.10.0 to 1.16.2
  and Apache NiFi Registry 0.6.0 to 1.16.2 does not neutralize arguments for group
  resolution commands, allowing injection of operating system commands on Linux and
  macOS platforms. The ShellUserGroupProvider is not included in the default configuration.
  Command injection requires ShellUserGroupProvider to be one of the enabled User
  Group Providers in the Authorizers configuration. Command injection also requires
  an authenticated user with elevated privileges. Apache NiFi requires an authenticated
  user with authorization to modify access policies in order to execute the command.
  Apache NiFi Registry requires an authenticated user with authorization to read user
  groups in order to execute the command. The resolution removes command formatting
  based on user-provided arguments."
date: "2022-06-17"
pubdate: "2022-06-16"
affected_range: "[0.6.0,1.16.3)"
fixed_versions:
- "1.16.3"
affected_versions: "All versions starting from 0.6.0 before 1.16.3"
not_impacted: "All versions before 0.6.0, all versions starting from 1.16.3"
solution: "Upgrade to version 1.16.3 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-33140"
- "https://lists.apache.org/thread/bzs2pcdjsdrh5039oslmfr9mbs9qqdhr"
- "https://nifi.apache.org/security.html#CVE-2022-33140"
- "https://github.com/advisories/GHSA-77hf-23pq-2g7c"
uuid: "d1ec81b2-bb67-418b-bd21-52c361c62a95"
cwe_ids:
- "CWE-1035"
- "CWE-78"
- "CWE-937"
cvss_v2: "AV:N/AC:M/Au:S/C:P/I:P/A:P"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
