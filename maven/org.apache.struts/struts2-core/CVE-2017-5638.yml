---
identifier: "CVE-2017-5638"
package_slug: "maven/org.apache.struts/struts2-core"
title: "Possible Remote Code Execution when performing file upload based on Jakarta
  Multipart parser."
description: "The Jakarta Multipart parser in Apache has incorrect exception handling
  and error-message generation during file-upload attempts, which allows remote attackers
  to execute arbitrary commands via a crafted `Content-Type`, `Content-Disposition`,
  or `Content-Length` HTTP header."
date: "2018-03-04"
pubdate: "2017-03-11"
affected_range: "[2.3.5,2.3.14.3],[2.3.15,2.3.15.3],[2.3.16,2.3.16.3],[2.3.17], [2.3.19,2.3.20.3],[2.3.21,2.3.24.3],[2.3.25,2.3.28.1],[2.3.29,2.3.31],
  [2.5,2.5.10]"
fixed_versions:
- "2.3.32"
- "2.5.10.1"
affected_versions: "All versions starting from 2.3.5 up to 2.3.14.3, all versions
  starting from 2.3.15 up to 2.3.15.3, all versions starting from 2.3.16 up to 2.3.16.3,
  version 2.3.17, all versions starting from 2.3.19 up to 2.3.20.3, all versions starting
  from 2.3.21 up to 2.3.24.3, all versions starting from 2.3.25 up to 2.3.28.1, all
  versions starting from 2.3.29 up to 2.3.31, all versions starting from 2.5 up to
  2.5.10"
not_impacted: "All versions before 2.3.5, all versions after 2.3.14.3 before 2.3.15,
  all versions after 2.3.15.3 before 2.3.16, all versions after 2.3.16.3 before 2.3.17,
  all versions after 2.3.17 before 2.3.19, all versions after 2.3.20.3 before 2.3.21,
  all versions after 2.3.24.3 before 2.3.25, all versions after 2.3.28.1 before 2.3.29,
  all versions after 2.3.31 before 2.5, all versions after 2.5.10"
solution: "Upgrade to versions 2.3.32, 2.5.10.1 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2017-5638"
- "http://www.securityfocus.com/bid/96729"
- "https://cwiki.apache.org/confluence/display/WW/S2-045"
- "https://exploit-db.com/exploits/41570"
- "https://packetstormsecurity.com/files/141494/S2-45-poc.py.txt"
- "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5638"
cvss_v2: "AV:N/AC:L/Au:N/C:C/I:C/A:C"
cvss_v3: "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H"
uuid: "40296bd2-1706-4e1b-9f25-8636282fb531"
cwe_ids:
- "CWE-1035"
- "CWE-20"
- "CWE-937"
identifiers:
- "CVE-2017-5638"
