---
identifier: "CVE-2024-22201"
identifiers:
- "CVE-2024-22201"
- "GHSA-rggv-cv7r-mw98"
package_slug: "maven/org.eclipse.jetty.http3/http3-common"
title: "Connection leaking on idle timeout when TCP congested"
description: "### Impact\nIf an HTTP/2 connection gets TCP congested, when an idle
  timeout occurs the HTTP/2 session is marked as closed, and then a GOAWAY frame is
  queued to be written.\nHowever it is not written because the connection is TCP congested.\nWhen
  another idle timeout period elapses, it is then supposed to hard close the connection,
  but it delegates to the HTTP/2 session which reports that it has already been closed
  so it does not attempt to hard close the connection.\n\nThis leaves the connection
  in ESTABLISHED state (i.e. not closed), TCP congested, and idle.\n\nAn attacker
  can cause many connections to end up in this state, and the server may run out of
  file descriptors, eventually causing the server to stop accepting new connections
  from valid clients.\n\nThe client may also be impacted (if the server does not read
  causing a TCP congestion), but the issue is more severe for servers.\n\n### Patches\nPatched
  versions:\n* 9.4.54\n* 10.0.20\n* 11.0.20\n* 12.0.6\n\n### Workarounds\nDisable
  HTTP/2 and HTTP/3 support until you can upgrade to a patched version of Jetty.\nHTTP/1.x
  is not affected.\n\n### References\n* https://github.com/jetty/jetty.project/issues/11256.\n"
date: "2024-02-26"
pubdate: "2024-02-26"
affected_range: "[10.0.8,10.0.20),[11.0.8,11.0.20)"
fixed_versions:
- "10.0.20"
- "11.0.20"
affected_versions: "All versions starting from 10.0.8 before 10.0.20, all versions
  starting from 11.0.8 before 11.0.20"
not_impacted: "All versions before 10.0.8, all versions starting from 10.0.20 before
  11.0.8, all versions starting from 11.0.20"
solution: "Upgrade to versions 10.0.20, 11.0.20 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-22201"
- "https://github.com/advisories/GHSA-rggv-cv7r-mw98"
- "https://github.com/jetty/jetty.project/security/advisories/GHSA-rggv-cv7r-mw98"
- "https://github.com/jetty/jetty.project/issues/11256"
- "https://github.com/jetty/jetty.project/issues/11259"
- "https://github.com/jetty/jetty.project/commit/0839a208cdc3fcfe25206a77af59ba9fda260188"
- "https://github.com/jetty/jetty.project/commit/b953871c9a5ff4fbca4a2499848f75182dbd9810"
- "https://github.com/jetty/jetty.project"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
uuid: "d8a9a9a7-2bda-4c9f-abaf-6d3555987e5a"
cwe_ids:
- "CWE-400"
- "CWE-937"
- "CWE-1035"
_sync: "true"
