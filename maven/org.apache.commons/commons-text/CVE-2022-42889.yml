---
identifier: "CVE-2022-42889"
identifiers:
- "CVE-2022-42889"
- "GHSA-599f-7c49-w659"
package_slug: "maven/org.apache.commons/commons-text"
title: "Improper Neutralization of Special Elements used in an OS Command ('OS Command
  Injection')"
description: "Apache Commons Text performs variable interpolation, allowing properties
  to be dynamically evaluated and expanded. The standard format for interpolation
  is \"${prefix:name}\", where \"prefix\" is used to locate an instance of org.apache.commons.text.lookup.StringLookup
  that performs the interpolation. Starting with version 1.5 and continuing through
  1.9, the set of default Lookup instances included interpolators that could result
  in arbitrary code execution or contact with remote servers. These lookups are: -
  \"script\" - execute expressions using the JVM script execution engine (javax.script)
  - \"dns\" - resolve dns records - \"url\" - load values from urls, including from
  remote servers Applications using the interpolation defaults in the affected versions
  may be vulnerable to remote code execution or unintentional contact with remote
  servers if untrusted configuration values are used. Users are recommended to upgrade
  to Apache Commons Text 1.10.0, which disables the problematic interpolators by default."
date: "2022-11-29"
pubdate: "2022-10-13"
affected_range: "[1.5,1.10.0)"
fixed_versions:
- "1.10.0"
affected_versions: "All versions starting from 1.5 before 1.10.0"
not_impacted: ""
solution: "Upgrade to version 1.10.0 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2022-42889"
- "https://lists.apache.org/thread/n2bd4vdsgkqh2tm14l1wyc3jyol7s1om"
- "http://www.openwall.com/lists/oss-security/2022/10/13/4"
- "https://github.com/advisories/GHSA-599f-7c49-w659"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
uuid: "d9bd344f-2ac1-4d98-883d-9b9a4df54c4b"
cwe_ids:
- "CWE-1035"
- "CWE-937"
- "CWE-94"
