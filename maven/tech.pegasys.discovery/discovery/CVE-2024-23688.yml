---
identifier: "CVE-2024-23688"
identifiers:
- "CVE-2024-23688"
- "GHSA-w3hj-wr2q-x83g"
package_slug: "maven/tech.pegasys.discovery/discovery"
title: "Discovery uses the same AES/GCM Nonce throughout the session"
description: "Discovery uses the same AES/GCM Nonce throughout the session though
  it should be generated on per message basis which can lead to the leaking of the
  session key.  As the actual ENR record is signed with a different key it is not
  possible for an attacker to alter the ENR record. Note that the node private key
  is not compromised, only the session key generated to communicate with an individual
  peer."
date: "2025-12-02"
pubdate: "2021-04-06"
affected_range: "[,0.4.5)"
fixed_versions:
- "0.4.5"
affected_versions: "All versions before 0.4.5"
not_impacted: "All versions starting from 0.4.5"
solution: "Upgrade to version 0.4.5 or above."
urls:
- "https://nvd.nist.gov/vuln/detail/CVE-2024-23688"
- "https://github.com/advisories/GHSA-w3hj-wr2q-x83g"
- "https://github.com/ConsenSys/discovery/security/advisories/GHSA-w3hj-wr2q-x83g"
- "https://github.com/ConsenSys/discovery"
- "https://vulncheck.com/advisories/vc-advisory-GHSA-w3hj-wr2q-x83g"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N"
uuid: "5e76fbbb-03fc-475b-b16d-48c43f317b4b"
cwe_ids:
- "CWE-323"
- "CWE-330"
- "CWE-937"
- "CWE-1035"
