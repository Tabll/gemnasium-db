---
identifier: "CVE-2023-51652"
identifiers:
- "GHSA-8x6f-956f-q43w"
- "CVE-2023-51652"
package_slug: "nuget/OWASP.AntiSamy"
title: "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
description: "OWASP AntiSamy .NET is a library for performing cleansing of HTML coming
  from untrusted sources. Prior to version 1.2.0, there is a potential for a mutation
  cross-site scripting (mXSS) vulnerability in AntiSamy caused by flawed parsing of
  the HTML being sanitized. To be subject to this vulnerability the `preserveComments`
  directive must be enabled in your policy file and also allow for certain tags at
  the same time. As a result, certain crafty inputs can result in elements in comment
  tags being interpreted as executable when using AntiSamy's sanitized output. This
  is patched in OWASP AntiSamy .NET 1.2.0 and later. See important remediation details
  in the reference given below. As a workaround, manually edit the AntiSamy policy
  file (e.g., antisamy.xml) by deleting the `preserveComments` directive or setting
  its value to `false`, if present. Also it would be useful to make AntiSamy remove
  the `noscript` tag by adding a line described in the GitHub Security Advisory to
  the tag definitions under the `<tagrules>` node, or deleting it entirely if present.
  As the previously mentioned policy settings are preconditions for the mXSS attack
  to work, changing them as recommended should be sufficient to protect you against
  this vulnerability when using a vulnerable version of this library. However, the
  existing bug would still be present in AntiSamy or its parser dependency (HtmlAgilityPack).
  The safety of this workaround relies on configurations that may change in the future
  and don't address the root cause of the vulnerability. As such, it is strongly recommended
  to upgrade to a fixed version of AntiSamy."
date: "2024-01-02"
pubdate: "2024-01-02"
affected_range: "(,1.2.0)"
fixed_versions:
- "1.2.0"
affected_versions: "All versions before 1.2.0"
not_impacted: "All versions starting from 1.2.0"
solution: "Upgrade to version 1.2.0 or above."
urls:
- "https://github.com/spassarop/antisamy-dotnet/security/advisories/GHSA-8x6f-956f-q43w"
- "https://github.com/spassarop/antisamy-dotnet/commit/7e500daef6ad9c10e97c68feab78f4cb6e3083c6"
- "https://github.com/spassarop/antisamy-dotnet/commit/8117911933e75a25cd0054ef017577486338444a"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-51652"
- "https://github.com/advisories/GHSA-8x6f-956f-q43w"
cvss_v3: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N"
uuid: "6dd05413-7145-4334-82c6-60e2ac61b6dd"
cwe_ids:
- "CWE-1035"
- "CWE-79"
- "CWE-79"
- "CWE-937"
