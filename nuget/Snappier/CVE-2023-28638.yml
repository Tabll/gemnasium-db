---
identifier: "CVE-2023-28638"
identifiers:
- "GHSA-838x-pcvx-6p5w"
- "CVE-2023-28638"
package_slug: "nuget/Snappier"
title: "Snappier vulnerable to buffer overrun due to improper restriction of operations
  within the bounds of a memory buffer"
description: "### Impact\nThis is a buffer overrun vulnerability that can affect any
  user of Snappier 1.1.0. In this release, much of the code was rewritten to use byte
  references rather than pointers to pinned buffers. This change generally improves
  performance and reduces workload on the garbage collector. However, when the garbage
  collector performs compaction and rearranges memory, it must update any byte references
  on the stack to refer to the updated location. The .NET garbage collector can only
  update these byte references if they still point within the buffer or to a point
  one byte past the end of the buffer. If they point outside this area, the buffer
  itself may be moved while the byte reference stays the same.\n\nThere are several
  places in 1.1.0 where byte references very briefly point outside the valid areas
  of buffers. These are at locations in the code being used for buffer range checks.
  While the invalid references are never dereferenced directly, if a GC compaction
  were to occur during the brief window when they are on the stack then it could invalidate
  the buffer range check and allow other operations to overrun the buffer.\n\nThis
  should be very difficult for an attacker to trigger intentionally. It would require
  a repetitive bulk attack with the hope that a GC compaction would occur at precisely
  the right moment during one of the requests. However, one of the range checks with
  this problem is a check based on input data in the decompression buffer, meaning
  malformed input data could be used to increase the chance of success.\n\nNote that
  any resulting buffer overrun is likely to cause access to protected memory, which
  will then cause an exception and the process to be terminated. Therefore, the most
  likely result of an attack is a denial of service.\n\n### Patches\nThis is patched
  in release 1.1.1.\n\n### Workarounds\nPinning any buffers to a fixed location before
  using them for compression or decompression should mitigate some, but not all, of
  these cases. At least one temporary decompression buffer is internal to the library
  and never pinned.\n"
date: "2023-03-27"
pubdate: "2023-03-27"
affected_range: "[1.1.0]"
fixed_versions:
- "1.1.1"
affected_versions: "Version 1.1.0"
not_impacted: "All versions before 1.1.0, all versions after 1.1.0"
solution: "Upgrade to version 1.1.1 or above."
urls:
- "https://github.com/brantburnett/Snappier/security/advisories/GHSA-838x-pcvx-6p5w"
- "https://nvd.nist.gov/vuln/detail/CVE-2023-28638"
- "https://github.com/brantburnett/Snappier/pull/73"
- "https://github.com/brantburnett/Snappier/commit/d7ac5267b5b18439e6d108f8138edf48c436b32f"
- "https://github.com/brantburnett/Snappier/releases/tag/release%2F1.1.1"
- "https://github.com/advisories/GHSA-838x-pcvx-6p5w"
uuid: "478eec62-20f8-4e74-9f7e-425e3f9599ee"
cwe_ids:
- "CWE-1035"
- "CWE-937"
cvss_v3: "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H"
